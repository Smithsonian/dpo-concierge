/*! For license information please see voyager-explorer.min.js.LICENSE */
!function(e){var t={};function s(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=e,s.c=t,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(r,i,function(t){return e[t]}.bind(null,i));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=70)}([function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(8),i=s(71);t.types=i.types;const n=s(131),o=s(73),a=s(132),l=s(10);t.Node=l.default;class c extends r.default{constructor(e,t){super({knownEvents:!1}),this.ins=new n.default(this),this.outs=new n.default(this),this.changed=!0,this.updated=!1,this._name="",this._tags=new Set,this._trackers=[],this.node=e,this.id=t}static getTypeName(e){return"function"==typeof e?e.typeName:"object"==typeof e?e.constructor.typeName:e||c.typeName}create(){this.node._addComponent(this),this.graph.isActive&&this.activate&&this.activate()}dispose(){this.graph.isActive&&this.deactivate&&this.deactivate(),this.emit({type:"dispose",component:this}),this.ins.dispose(),this.outs.dispose(),this._trackers.forEach(e=>e.dispose()),this.node&&(this.node._removeComponent(this),this.node=null)}get isNodeSingleton(){return this.constructor.isNodeSingleton}get isGraphSingleton(){return this.constructor.isGraphSingleton}get isSystemSingleton(){return this.constructor.isSystemSingleton}get typeName(){return this.constructor.typeName}get displayTypeName(){const e=this.typeName;return"Component"===e?e:e.substr(1)}get text(){return this.constructor.text}get icon(){return this.constructor.icon}get name(){return this._name}get displayName(){return this._name||this.text||this.displayTypeName}set name(e){this._name=e,this.emit({type:"change",component:this,what:"name"})}get tags(){return this._tags}addTag(e){this._tags.has(e)||(this._tags.add(e),this.node._addComponentTag(e,this))}removeTag(e){this._tags.has(e)&&(this._tags.delete(e),this.node._removeComponentTag(e,this))}get graph(){return this.node.graph}get system(){return this.node.system}get components(){return this.node.components}get isActive(){return this.graph.isActive}getComponent(e,t=!1){return this.node.components.get(e,t)}getComponents(e){return this.node.components.getArray(e)}getComponentsByTag(e){return this.node.components.getByTag(e)}createComponent(e){return this.node.createComponent(e)}getOrCreateComponent(e){return this.node.components.get(e,!0)||this.node.createComponent(e)}hasComponent(e){return this.node.components.has(e)}getGraphComponent(e,t=!1){return this.node.graph.components.get(e,t)}getGraphComponents(e){return this.node.graph.components.getArray(e)}getGraphComponentsByTag(e){return this.node.graph.components.getByTag(e)}hasGraphComponent(e){return this.node.graph.components.has(e)}getMainComponent(e,t=!1){return this.node.system.graph.components.get(e,t)}getMainComponents(e){return this.node.system.graph.components.getArray(e)}getMainComponentsByTag(e){return this.node.system.graph.components.getByTag(e)}hasMainComponent(e){return this.node.system.graph.components.has(e)}getSystemComponent(e,t=!1){return this.node.system.components.get(e,t)}getSystemComponents(e){return this.node.system.components.getArray(e)}getSystemComponentsByTag(e){return this.node.system.components.getByTag(e)}hasSystemComponent(e){return this.node.system.components.has(e)}getComponentById(e){return this.node.system.components.getById(e)}getNode(e,t=!1){return this.node.graph.nodes.get(e,t)}getNodes(e){return this.node.graph.nodes.getArray(e)}getNodesByTag(e){return this.node.graph.nodes.getByTag(e)}hasNode(e){return this.node.graph.nodes.has(e)}getMainNode(e,t=!1){return this.node.system.graph.nodes.get(e,t)}getMainNodes(e){return this.node.system.graph.nodes.getArray(e)}getMainNodesByTag(e){return this.node.system.graph.nodes.getByTag(e)}hasMainNode(e){return this.node.system.graph.nodes.has(e)}getSystemNode(e,t=!1){return this.node.system.nodes.get(e,t)}getSystemNodes(e){return this.node.system.nodes.getArray(e)}getSystemNodesByTag(e){return this.node.system.nodes.getByTag(e)}hasSystemNode(e){return this.node.system.nodes.has(e)}getNodeById(e){return this.node.system.nodes.getById(e)}activate(){}update(e){throw new Error("this should never be called")}tick(e){throw new Error("this should never be called")}tock(e){throw new Error("this should never be called")}deactivate(){}requestSort(){this.graph.requestSort()}is(e){const t=c.getTypeName(e);let s=this;do{if((s=Object.getPrototypeOf(s)).constructor.typeName===t)return!0}while(s.constructor.typeName!==c.typeName);return!1}unlinkAllProperties(){this.ins.unlinkAllProperties(),this.outs.unlinkAllProperties()}resetChanged(){this.changed=!1;const e=this.ins.properties;for(let t=0,s=e.length;t<s;++t)e[t].changed=!1;const t=this.outs.properties;for(let e=0,s=t.length;e<s;++e)t[e].changed=!1}trackComponent(e,t,s){const r=new o.default(this.node.components,e,t,s);return this._trackers.push(r),r}referenceComponent(e){return new a.default(this.system,e)}toString(){return`${this.typeName}${this.name?" ("+this.name+")":""}`}dump(e=""){console.log(e+`%cComponent '${this.typeName}' (${this.displayName})`,"color: green"),this.ins.properties.forEach(t=>t.dump(e+"  IN  ")),this.outs.properties.forEach(t=>t.dump(e+"  OUT "))}toJSON(){let e={};const t=this.ins.toJSON();t&&(e.ins=t);const s=this.outs.toJSON();return s&&(e.outs=s),e}fromJSON(e){e.ins&&this.ins.fromJSON(e.ins),e.outs&&this.outs.fromJSON(e.outs)}referencesFromJSON(e){const t=this.system.components.getDictionary();e.ins&&this.ins.linksFromJSON(e.ins,t),e.outs&&this.outs.linksFromJSON(e.outs,t)}addCustomInput(e,t,s){return this.changed=!0,this.ins.createCustomProperty(e,t,s)}allowCustomInput(e){return!1}addCustomOutput(e,t,s){return this.outs.createCustomProperty(e,t,s)}allowCustomOutput(e){return!1}addInputs(e,t){return this.ins.createProperties(e,t)}addOutputs(e,t){return this.outs.createProperties(e,t)}}t.default=c,c.typeName="Component",c.text="",c.icon="",c.isNodeSingleton=!0,c.isGraphSingleton=!1,c.isSystemSingleton=!1,c.prototype.activate=null,c.prototype.update=null,c.prototype.tick=null,c.prototype.tock=null,c.prototype.deactivate=null},function(e,t){e.exports=THREE},function(e,t,s){"use strict";var r,i=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const n=s(127);var o=s(127);t.property=o.property;var a=s(4);t.html=a.html,t.svg=a.svg,t.render=a.render,t.TemplateResult=a.TemplateResult;var l=s(133);t.repeat=l.repeat;let c=r=class extends n.LitElement{constructor(){super(...arguments),this._isFirstConnected=!1}static setStyle(e,t){Object.assign(e.style,t)}static setAttribs(e,t){for(let s in t)e.setAttribute(s,t[s])}get shady(){return this.constructor.shady}appendTo(e){return e.appendChild(this),this}removeChildren(){for(;this.firstChild;)this.removeChild(this.firstChild)}getChildrenArray(){return Array.from(this.children)}appendElement(e,t){return this.createElement(e,t,this)}createElement(e,t,s){let r;return r="string"==typeof e?document.createElement(e):e instanceof HTMLElement?e:new e,t&&Object.assign(r.style,t),s&&s.appendChild(r),r}setStyle(e){return r.setStyle(this,e),this}setAttribute(e,t){return super.setAttribute(e,t),this}setAttributes(e){return r.setAttribs(this,e),this}addClass(...e){return e.forEach(e=>this.classList.add(e)),this}removeClass(...e){return e.forEach(e=>this.classList.remove(e)),this}setClass(e,t){return t?this.classList.add(e):this.classList.remove(e),this}hasFocus(){return document.activeElement===this}on(e,t,s){return this.addEventListener(e,t,s),this}off(e,t,s){return this.removeEventListener(e,t,s),this}connectedCallback(){this._isFirstConnected||(this._isFirstConnected=!0,this.firstConnected()),this.connected(),super.connectedCallback()}disconnectedCallback(){super.disconnectedCallback(),this.disconnected()}createRenderRoot(){return this.shady?super.createRenderRoot():this}firstConnected(){}connected(){}disconnected(){}onUpdate(){this.requestUpdate()}};function h(e){return t=>(t.tagName=e,customElements.define(t.tagName,t),t)}c.tagName="ff-custom-element",c.shady=!1,c=r=i([h("ff-custom-element")],c),t.default=c,t.customElement=h},function(e,t,s){"use strict";s.d(t,"f",(function(){return r})),s.d(t,"g",(function(){return i})),s.d(t,"b",(function(){return o})),s.d(t,"a",(function(){return a})),s.d(t,"d",(function(){return c})),s.d(t,"c",(function(){return h})),s.d(t,"e",(function(){return u}));const r=`{{lit-${String(Math.random()).slice(2)}}}`,i=`\x3c!--${r}--\x3e`,n=new RegExp(`${r}|${i}`),o="$lit$";class a{constructor(e,t){this.parts=[],this.element=t;const s=[],i=[],a=document.createTreeWalker(t.content,133,null,!1);let c=0,d=-1,p=0;const{strings:f,values:{length:m}}=e;for(;p<m;){const e=a.nextNode();if(null!==e){if(d++,1===e.nodeType){if(e.hasAttributes()){const t=e.attributes,{length:s}=t;let r=0;for(let e=0;e<s;e++)l(t[e].name,o)&&r++;for(;r-- >0;){const t=f[p],s=u.exec(t)[2],r=s.toLowerCase()+o,i=e.getAttribute(r);e.removeAttribute(r);const a=i.split(n);this.parts.push({type:"attribute",index:d,name:s,strings:a}),p+=a.length-1}}"TEMPLATE"===e.tagName&&(i.push(e),a.currentNode=e.content)}else if(3===e.nodeType){const t=e.data;if(t.indexOf(r)>=0){const r=e.parentNode,i=t.split(n),a=i.length-1;for(let t=0;t<a;t++){let s,n=i[t];if(""===n)s=h();else{const e=u.exec(n);null!==e&&l(e[2],o)&&(n=n.slice(0,e.index)+e[1]+e[2].slice(0,-o.length)+e[3]),s=document.createTextNode(n)}r.insertBefore(s,e),this.parts.push({type:"node",index:++d})}""===i[a]?(r.insertBefore(h(),e),s.push(e)):e.data=i[a],p+=a}}else if(8===e.nodeType)if(e.data===r){const t=e.parentNode;null!==e.previousSibling&&d!==c||(d++,t.insertBefore(h(),e)),c=d,this.parts.push({type:"node",index:d}),null===e.nextSibling?e.data="":(s.push(e),d--),p++}else{let t=-1;for(;-1!==(t=e.data.indexOf(r,t+1));)this.parts.push({type:"node",index:-1}),p++}}else a.currentNode=i.pop()}for(const e of s)e.parentNode.removeChild(e)}}const l=(e,t)=>{const s=e.length-t.length;return s>=0&&e.slice(s)===t},c=e=>-1!==e.index,h=()=>document.createComment(""),u=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/},function(e,t,s){"use strict";s.r(t);var r=s(5);class i{handleAttributeExpressions(e,t,s,i){const n=t[0];if("."===n){return new r.f(e,t.slice(1),s).parts}return"@"===n?[new r.d(e,t.slice(1),i.eventContext)]:"?"===n?[new r.c(e,t.slice(1),s)]:new r.a(e,t,s).parts}handleTextExpression(e){return new r.e(e)}}const n=new i;var o=s(20),a=s(17),l=s(9),c=s(6),h=s(18),u=s(16),d=s(25),p=s(3);s.d(t,"html",(function(){return f})),s.d(t,"svg",(function(){return m})),s.d(t,"DefaultTemplateProcessor",(function(){return i})),s.d(t,"defaultTemplateProcessor",(function(){return n})),s.d(t,"directive",(function(){return a.a})),s.d(t,"isDirective",(function(){return a.b})),s.d(t,"removeNodes",(function(){return l.b})),s.d(t,"reparentNodes",(function(){return l.c})),s.d(t,"noChange",(function(){return c.a})),s.d(t,"nothing",(function(){return c.b})),s.d(t,"AttributeCommitter",(function(){return r.a})),s.d(t,"AttributePart",(function(){return r.b})),s.d(t,"BooleanAttributePart",(function(){return r.c})),s.d(t,"EventPart",(function(){return r.d})),s.d(t,"isIterable",(function(){return r.h})),s.d(t,"isPrimitive",(function(){return r.i})),s.d(t,"NodePart",(function(){return r.e})),s.d(t,"PropertyCommitter",(function(){return r.f})),s.d(t,"PropertyPart",(function(){return r.g})),s.d(t,"parts",(function(){return h.a})),s.d(t,"render",(function(){return h.b})),s.d(t,"templateCaches",(function(){return u.a})),s.d(t,"templateFactory",(function(){return u.b})),s.d(t,"TemplateInstance",(function(){return d.a})),s.d(t,"SVGTemplateResult",(function(){return o.a})),s.d(t,"TemplateResult",(function(){return o.b})),s.d(t,"createMarker",(function(){return p.c})),s.d(t,"isTemplatePartActive",(function(){return p.d})),s.d(t,"Template",(function(){return p.a})),(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.1.2");const f=(e,...t)=>new o.b(e,t,"html",n),m=(e,...t)=>new o.a(e,t,"svg",n)},function(e,t,s){"use strict";s.d(t,"i",(function(){return c})),s.d(t,"h",(function(){return h})),s.d(t,"a",(function(){return u})),s.d(t,"b",(function(){return d})),s.d(t,"e",(function(){return p})),s.d(t,"c",(function(){return f})),s.d(t,"f",(function(){return m})),s.d(t,"g",(function(){return v})),s.d(t,"d",(function(){return y}));var r=s(17),i=s(9),n=s(6),o=s(25),a=s(20),l=s(3);const c=e=>null===e||!("object"==typeof e||"function"==typeof e),h=e=>Array.isArray(e)||!(!e||!e[Symbol.iterator]);class u{constructor(e,t,s){this.dirty=!0,this.element=e,this.name=t,this.strings=s,this.parts=[];for(let e=0;e<s.length-1;e++)this.parts[e]=this._createPart()}_createPart(){return new d(this)}_getValue(){const e=this.strings,t=e.length-1;let s="";for(let r=0;r<t;r++){s+=e[r];const t=this.parts[r];if(void 0!==t){const e=t.value;if(c(e)||!h(e))s+="string"==typeof e?e:String(e);else for(const t of e)s+="string"==typeof t?t:String(t)}}return s+=e[t]}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class d{constructor(e){this.value=void 0,this.committer=e}setValue(e){e===n.a||c(e)&&e===this.value||(this.value=e,Object(r.b)(e)||(this.committer.dirty=!0))}commit(){for(;Object(r.b)(this.value);){const e=this.value;this.value=n.a,e(this)}this.value!==n.a&&this.committer.commit()}}class p{constructor(e){this.value=void 0,this.__pendingValue=void 0,this.options=e}appendInto(e){this.startNode=e.appendChild(Object(l.c)()),this.endNode=e.appendChild(Object(l.c)())}insertAfterNode(e){this.startNode=e,this.endNode=e.nextSibling}appendIntoPart(e){e.__insert(this.startNode=Object(l.c)()),e.__insert(this.endNode=Object(l.c)())}insertAfterPart(e){e.__insert(this.startNode=Object(l.c)()),this.endNode=e.endNode,e.endNode=this.startNode}setValue(e){this.__pendingValue=e}commit(){for(;Object(r.b)(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=n.a,e(this)}const e=this.__pendingValue;e!==n.a&&(c(e)?e!==this.value&&this.__commitText(e):e instanceof a.b?this.__commitTemplateResult(e):e instanceof Node?this.__commitNode(e):h(e)?this.__commitIterable(e):e===n.b?(this.value=n.b,this.clear()):this.__commitText(e))}__insert(e){this.endNode.parentNode.insertBefore(e,this.endNode)}__commitNode(e){this.value!==e&&(this.clear(),this.__insert(e),this.value=e)}__commitText(e){const t=this.startNode.nextSibling,s="string"==typeof(e=null==e?"":e)?e:String(e);t===this.endNode.previousSibling&&3===t.nodeType?t.data=s:this.__commitNode(document.createTextNode(s)),this.value=e}__commitTemplateResult(e){const t=this.options.templateFactory(e);if(this.value instanceof o.a&&this.value.template===t)this.value.update(e.values);else{const s=new o.a(t,e.processor,this.options),r=s._clone();s.update(e.values),this.__commitNode(r),this.value=s}}__commitIterable(e){Array.isArray(this.value)||(this.value=[],this.clear());const t=this.value;let s,r=0;for(const i of e)void 0===(s=t[r])&&(s=new p(this.options),t.push(s),0===r?s.appendIntoPart(this):s.insertAfterPart(t[r-1])),s.setValue(i),s.commit(),r++;r<t.length&&(t.length=r,this.clear(s&&s.endNode))}clear(e=this.startNode){Object(i.b)(this.startNode.parentNode,e.nextSibling,this.endNode)}}class f{constructor(e,t,s){if(this.value=void 0,this.__pendingValue=void 0,2!==s.length||""!==s[0]||""!==s[1])throw new Error("Boolean attributes can only contain a single expression");this.element=e,this.name=t,this.strings=s}setValue(e){this.__pendingValue=e}commit(){for(;Object(r.b)(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=n.a,e(this)}if(this.__pendingValue===n.a)return;const e=!!this.__pendingValue;this.value!==e&&(e?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=e),this.__pendingValue=n.a}}class m extends u{constructor(e,t,s){super(e,t,s),this.single=2===s.length&&""===s[0]&&""===s[1]}_createPart(){return new v(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class v extends d{}let g=!1;try{const e={get capture(){return g=!0,!1}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){}class y{constructor(e,t,s){this.value=void 0,this.__pendingValue=void 0,this.element=e,this.eventName=t,this.eventContext=s,this.__boundHandleEvent=e=>this.handleEvent(e)}setValue(e){this.__pendingValue=e}commit(){for(;Object(r.b)(this.__pendingValue);){const e=this.__pendingValue;this.__pendingValue=n.a,e(this)}if(this.__pendingValue===n.a)return;const e=this.__pendingValue,t=this.value,s=null==e||null!=t&&(e.capture!==t.capture||e.once!==t.once||e.passive!==t.passive),i=null!=e&&(null==t||s);s&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),i&&(this.__options=b(e),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=e,this.__pendingValue=n.a}handleEvent(e){"function"==typeof this.value?this.value.call(this.eventContext||this.element,e):this.value.handleEvent(e)}}const b=e=>e&&(g?{capture:e.capture,passive:e.passive,once:e.once}:e.capture)},function(e,t,s){"use strict";s.d(t,"a",(function(){return r})),s.d(t,"b",(function(){return i}));const r={},i={}},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0}),s(49);const i=s(2);let n=class extends i.default{constructor(){super(),this.name="",this.index=0,this.selectedIndex=-1,this.selected=!1,this.selectable=!1,this.disabled=!1,this.icon="",this.caret=!1,this.inline=!1,this.transparent=!1,this.addEventListener("click",e=>this.onClick(e)),this.addEventListener("keydown",e=>this.onKeyDown(e))}firstConnected(){this.tabIndex=0,this.classList.add("ff-button")}shouldUpdate(e){return(e.has("selectedIndex")||e.has("index"))&&this.selectedIndex>=0&&(this.selected=this.index===this.selectedIndex),e.has("disabled")&&this.setClass("ff-disabled",this.disabled),!0}update(e){this.classList.remove("ff-inline","ff-transparent","ff-control"),this.inline?this.classList.add("ff-inline"):this.transparent?this.classList.add("ff-transparent"):this.classList.add("ff-control"),super.update(e)}render(){return i.html`${this.renderIcon()}${this.renderText()}${this.renderCaret()}`}renderIcon(){return this.icon?i.html`<ff-icon class="ff-off" name=${this.icon}></ff-icon>`:null}renderText(){return this.text?i.html`<div class="ff-text ff-off">${this.text}</div>`:null}renderCaret(){return this.caret?i.html`<div class="ff-caret-down ff-off"></div>`:null}onClick(e){this.selectable&&(this.selected=!this.selected)}onKeyDown(e){document.activeElement!==this||"Space"!==e.code&&"Enter"!==e.code||this.dispatchEvent(new MouseEvent("click",{bubbles:!0}))}};r([i.property({type:String})],n.prototype,"name",void 0),r([i.property({type:Number})],n.prototype,"index",void 0),r([i.property({type:Number})],n.prototype,"selectedIndex",void 0),r([i.property({type:Boolean,reflect:!0})],n.prototype,"selected",void 0),r([i.property({type:Boolean})],n.prototype,"selectable",void 0),r([i.property({type:Boolean})],n.prototype,"disabled",void 0),r([i.property()],n.prototype,"text",void 0),r([i.property()],n.prototype,"icon",void 0),r([i.property({type:Boolean})],n.prototype,"caret",void 0),r([i.property({type:Boolean})],n.prototype,"inline",void 0),r([i.property({type:Boolean})],n.prototype,"transparent",void 0),n=r([i.customElement("ff-button")],n),t.default=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=Symbol("Publisher private data"),i=Symbol("Publisher strict option");t.default=class{constructor(e){const t=!e||e.knownEvents;this[r]={[i]:t}}on(e,t,s){if(Array.isArray(e))return void e.forEach(e=>{this.on(e,t,s)});if(!t)throw new Error("missing callback function");let n=this[r][e];if(!n){if(this[r][i])throw new Error(`can't subscribe; unknown event: '${e}'`);n=this[r][e]=[]}let o={callback:t,context:s};n.push(o)}addEventListener(e,t,s){this.on(e,t,s)}once(e,t,s){if(Array.isArray(e))return void e.forEach(e=>{this.once(e,t,s)});const r=i=>{this.off(e,r,s),t.call(s,i)};r.cb=t,this.on(e,r,s)}off(e,t,s){if("object"==typeof e){if(Array.isArray(e))e.forEach(e=>{this.off(e,t,s)});else{const t=this[r];for(let s=0,r=Object.keys(t).length;s<r;++s){const s=t[e],r=[];for(let t=0,i=s.length;t<i;++t){const i=s[t];e&&i.context!==e&&r.push(i)}t[e]=r}}return}const i=this[r][e];if(!i)throw new Error(`can't unsubscribe; unknown event type: '${e}'`);const n=[];for(let e=0,r=i.length;e<r;++e){const r=i[e];(t&&t!==r.callback&&t!==r.callback.cb||s&&s!==r.context)&&n.push(r)}this[r][e]=n}removeEventListener(e,t,s){this.off(e,t,s)}emit(e,t){let s,n;if("string"==typeof e?(s=e,n=t):(s=e.type,n=e),!s)throw new Error(`empty or invalid event type: '${s}'`);const o=this[r],a=o[s];if(a)for(let e=0,t=a.length;e<t;++e){const t=a[e];t.context?t.callback.call(t.context,n):t.callback(n)}else if(o[i])throw new Error(`can't emit; unknown event type: '${s}'`)}addEvent(e){this[r][e]||(this[r][e]=[])}addEvents(...e){e.forEach(e=>{this[r][e]||(this[r][e]=[])})}hasEvent(e){return!!this[r][e]}listEvents(){return Object.getOwnPropertyNames(this[r])}}},function(e,t,s){"use strict";s.d(t,"a",(function(){return r})),s.d(t,"c",(function(){return i})),s.d(t,"b",(function(){return n}));const r=void 0!==window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,i=(e,t,s=null,r=null)=>{for(;t!==s;){const s=t.nextSibling;e.insertBefore(t,r),t=s}},n=(e,t,s=null)=>{for(;t!==s;){const s=t.nextSibling;e.removeChild(t),t=s}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(30),i=s(8),n=s(40),o=s(0);class a extends i.default{constructor(e,t){super({knownEvents:!1}),this.graph=null,this.components=new n.default(o.default),this._name="",this._tags=new Set,this._isLocked=void 0,this.graph=e,this.id=t}static getTypeName(e){return"function"==typeof e?e.typeName:"object"==typeof e?e.constructor.typeName:e||a.typeName}get typeName(){return this.constructor.typeName}get displayTypeName(){const e=this.typeName;return"Node"===e?e:e.substr(1)}get isLocked(){return this._isLocked}get text(){return this.constructor.text}get icon(){return this.constructor.icon}get name(){return this._name}get displayName(){return this._name||this.text||this.displayTypeName}set name(e){this._name=e,this.emit({type:"change",what:"name",node:this})}get tags(){return this._tags}addTag(e){this._tags.has(e)||(this._tags.add(e),this.graph._addNodeTag(e,this))}removeTag(e){this._tags.has(e)&&(this._tags.delete(e),this.graph._removeNodeTag(e,this))}get system(){return this.graph.system}getComponent(e,t=!1){return this.components.get(e,t)}getComponents(e){return this.components.getArray(e)}getComponentsByTag(e){return this.components.getByTag(e)}getOrCreateComponent(e){return this.components.get(e,!0)||this.createComponent(e)}hasComponent(e){return this.components.has(e)}getGraphComponent(e,t=!1){return this.graph.components.get(e,t)}getGraphComponents(e){return this.graph.components.getArray(e)}getGraphComponentsByTag(e){return this.graph.components.getByTag(e)}hasGraphComponent(e){return this.graph.components.has(e)}getMainComponent(e,t=!1){return this.graph.system.graph.components.get(e,t)}getMainComponents(e){return this.graph.system.graph.components.getArray(e)}getMainComponentsByTag(e){return this.graph.system.graph.components.getByTag(e)}hasMainComponent(e){return this.graph.system.graph.components.has(e)}getSystemComponent(e,t=!1){return this.graph.system.components.get(e,t)}getSystemComponents(e){return this.graph.system.components.getArray(e)}getSystemComponentsByTag(e){return this.graph.system.components.getByTag(e)}hasSystemComponent(e){return this.graph.system.components.has(e)}getComponentById(e){return this.graph.system.components.getById(e)}getNode(e,t=!1){return this.graph.nodes.get(e,t)}getNodes(e){return this.graph.nodes.getArray(e)}getNodesByTag(e){return this.graph.nodes.getByTag(e)}hasNode(e){return this.graph.nodes.has(e)}getMainNode(e,t=!1){return this.graph.system.graph.nodes.get(e,t)}getMainNodes(e){return this.graph.system.graph.nodes.getArray(e)}getMainNodesByTag(e){return this.graph.system.graph.nodes.getByTag(e)}hasMainNode(e){return this.graph.system.graph.nodes.has(e)}getSystemNode(e,t=!1){return this.graph.system.nodes.get(e,t)}getSystemNodes(e){return this.graph.system.nodes.getArray(e)}getSystemNodesByTag(e){return this.graph.system.nodes.getByTag(e)}hasSystemNode(e){return this.graph.system.nodes.has(e)}getNodeById(e){return this.graph.system.nodes.getById(e)}lock(){if(!1===this._isLocked)throw new Error("can't lock an unlocked node again");this._isLocked=!0}unlock(){this._isLocked=!1}create(){this.graph._addNode(this)}createComponents(){}clear(){this.components.getArray().slice().forEach(e=>e.dispose())}dispose(){this.components.cloneArray().reverse().forEach(e=>e.dispose()),this.emit({type:"dispose",node:this}),this.graph&&(this.graph._removeNode(this),this.graph=null)}createComponent(e,t,s){if(!0===this._isLocked)throw new Error("node is locked, can't create component");const i=this.system.registry.getType(e);if(!i)throw new Error(`component type '${o.default.getTypeName(e)}' not registered`);const n=new i(this,s||r.default(12,this.system.components.getDictionary()));return n.create(),t&&(n.name=t),n}is(e){const t=a.getTypeName(e);let s=this;do{if((s=Object.getPrototypeOf(s)).constructor.typeName===t)return!0}while(s.constructor.typeName!==a.typeName);return!1}toString(e=!1){const t=this.components.getArray(),s=`Node '${this.name}' - ${t.length} components`;return e?s+"\n"+t.map(e=>"  "+e.toString()).join("\n"):s}dump(e=""){console.log(e+`%cNode '${this.typeName}' (${this.displayName})`,"color: blue"),this.components.getArray().forEach(t=>t.dump(e+"  "))}toJSON(){const e={},t=[];this._isLocked&&(e.locked=!0);const s=this.components.getArray();for(let e=0,r=s.length;e<r;++e){const r=s[e],i=this.componentToJSON(r);i&&(i.type=r.typeName,i.id=r.id,r.name&&(i.name=r.name),t.push(i))}return t.length>0&&(e.components=t),e}fromJSON(e){this._isLocked=!!e.locked,e.components&&e.components.forEach(e=>this.componentFromJSON(e))}componentFromJSON(e){this.createComponent(e.type,e.name,e.id).fromJSON(e)}referencesFromJSON(e){e.components&&e.components.forEach(e=>{this.components.getById(e.id).referencesFromJSON(e)})}componentToJSON(e){return e.toJSON()}_addComponent(e){if(e.isNodeSingleton&&this.components.has(e))throw new Error(`only one component of type '${e.typeName}' allowed per node`);this.components.add(e),this.graph._addComponent(e)}_removeComponent(e){this.graph._removeComponent(e),this.components.remove(e)}_addComponentTag(e,t){this.components.addByTag(e,t),this.graph._addComponentTag(e,t)}_removeComponentTag(e,t){this.graph._removeComponentTag(e,t),this.components.removeByTag(e,t)}}t.default=a,a.typeName="Node",a.text="",a.icon=""},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(0);t.Node=i.Node,t.types=i.types;const n=s(55),o=s(31),a=s(21);t.ERotationOrder=a.ERotationOrder;const l=new r.Vector3;class c extends i.default{constructor(e,t){super(e,t),this.ins=this.addInputs(c.object3DIns),this.outs=this.addOutputs(c.object3DOuts),this._object3D=null,this._isPickable=!1,this.addEvent("object"),this.node.components.on(this.parentComponentClass,this._onParent,this)}get parentComponentClass(){return this.constructor.parentComponentClass}get parentComponent(){return this.node.components.get(this.parentComponentClass,!0)}get transform(){return this.node.components.get(a.default,!0)}get scene(){const e=this.transform;return e?e.getParentComponent(o.default,!0):void 0}get object3D(){return this._object3D}set object3D(e){const t=this.parentComponent,s=this._object3D;s&&(s.userData.component=null,this.unregisterPickableObject3D(s,!0),s.parent&&this.onRemoveFromParent(s.parent)),this.emit({type:"object",current:s,next:e}),this._object3D=e,e&&(e.userData.component=this,e.matrixAutoUpdate=!1,e.visible=this.ins.visible.value,this.registerPickableObject3D(e,!0),t&&this.onAddToParent(t.object3D))}update(e){const{visible:t,pickable:s}=this.ins;return t.changed&&this._object3D&&(this._object3D.visible=t.value),s.changed&&s.value!==this._isPickable&&(this._isPickable=s.value,s.value?this.enablePointerEvents():this.disablePointerEvents()),!0}dispose(){this.object3D=null,this.ins.pickable.value&&this.disablePointerEvents(),this.node.components.off(this.parentComponentClass,this._onParent,this),super.dispose()}preRender(e){}postRender(e){}toString(){return super.toString()+(this._object3D?` - type: ${this._object3D.type}`:" - (null)")}onPointer(e){const t=this.outs;"pointer-down"===e.type?(t.pointerDown.set(),t.pointerActive.setValue(!0)):"pointer-up"===e.type&&(t.pointerUp.set(),t.pointerActive.setValue(!1)),e.stopPropagation=!0}enablePointerEvents(){this.on("pointer-down",this.onPointer,this),this.on("pointer-up",this.onPointer,this)}disablePointerEvents(){this.off("pointer-down",this.onPointer,this),this.off("pointer-up",this.onPointer,this);const e=this.outs;e.pointerActive.value&&(e.pointerUp.set(),e.pointerActive.setValue(!1))}updateTransform(){const e=this._object3D;if(!e)return;const{position:t,rotation:s,order:i,scale:n}=this.ins;if(t.changed||s.changed||i.changed||n.changed){e.position.fromArray(t.value),l.fromArray(s.value).multiplyScalar(r.Math.DEG2RAD);const o=i.getOptionText();e.rotation.setFromVector3(l,o),e.scale.fromArray(n.value),e.updateMatrix()}return!0}onAddToParent(e){e.add(this._object3D)}onRemoveFromParent(e){e.remove(this._object3D)}addObject3D(e){this._object3D.add(e),this.registerPickableObject3D(e,!0)}removeObject3D(e){this.unregisterPickableObject3D(e,!0),this._object3D.remove(e)}registerPickableObject3D(e,t){n.default.add(e,t)}unregisterPickableObject3D(e,t){n.default.remove(e,t)}_onParent(e){this._object3D&&!this._object3D.parent&&e.add&&this.onAddToParent(e.object.object3D)}}t.default=c,c.typeName="CObject3D",c.parentComponentClass=a.default,c.object3DIns={visible:i.types.Boolean("Object.Visible",!0),pickable:i.types.Boolean("Object.Pickable")},c.object3DOuts={pointerDown:i.types.Event("Pointer.Down"),pointerUp:i.types.Event("Pointer.Up"),pointerActive:i.types.Boolean("Pointer.Active")},c.transformIns=a.default.transformIns,c.prototype.preRender=null,c.prototype.postRender=null},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r={PI:3.141592653589793,DOUBLE_PI:6.283185307179586,HALF_PI:1.5707963267948966,QUARTER_PI:.7853981633974483,DEG2RAD:.017453292519943295,RAD2DEG:57.29577951308232,limit:(e,t,s)=>e<t?t:e>s?s:e,limitInt:function(e,t,s){return(e=Math.trunc(e))<t?t:e>s?s:e},normalize:(e,t,s)=>(e-t)/(s-t),normalizeLimit:(e,t,s)=>(e=(e-t)/(s-t))<0?0:e>1?1:e,denormalize:(e,t,s)=>(t+e)*(s-t),scale:(e,t,s,r,i)=>r+(e-t)/(s-t)*(i-r),scaleLimit:(e,t,s,r,i)=>r+((e=e<t?t:e>s?s:e)-t)/(s-t)*(i-r),deg2rad:function(e){return.017453292519943295*e},rad2deg:function(e){return 57.29577951308232*e},deltaRadians:function(e,t){return e=(e%=r.DOUBLE_PI)<0?e+r.DOUBLE_PI:e,(t=(t%=r.DOUBLE_PI)<0?t+r.DOUBLE_PI:t)-e>r.PI&&(e+=r.DOUBLE_PI),t-e},deltaDegrees:function(e,t){return e=(e%=r.DOUBLE_PI)<0?e+r.DOUBLE_PI:e,(t=(t%=r.DOUBLE_PI)<0?t+r.DOUBLE_PI:t)-e>r.PI&&(e+=r.DOUBLE_PI),t-e},curves:{linear:e=>e,easeIn:e=>Math.sin(e*r.HALF_PI),easeOut:e=>Math.cos(e*r.HALF_PI-r.PI)+1,ease:e=>.5*Math.cos(e*r.PI-r.PI)+.5,easeInQuad:e=>e*e,easeOutQuad:e=>e*(2-e),easeQuad:e=>e<.5?2*e*e:(4-2*e)*e-1,easeInCubic:e=>e*e*e,easeOutCubic:e=>--e*e*e+1,easeCubic:e=>e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1,easeInQuart:e=>e*e*e*e,easeOutQuart:e=>1- --e*e*e*e,easeQuart:e=>e<.5?8*e*e*e*e:1-8*--e*e*e*e}};t.default=r},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0);class i extends r.default{constructor(){super(...arguments),this._title="Untitled"}setTitle(e){this._title=e}sendProperty(e,t){if(ga){const s=void 0!==t?t.toString():void 0;ga("send","event",this._title,e,s)}}}t.default=i,i.typeName="CVAnalytics",i.text="Analytics",i.icon="",i.isSystemSingleton=!0},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(48),i=s(11);var n;!function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High"}(n=t.EShadowMapResolution||(t.EShadowMapResolution={}));const o={[n.Low]:512,[n.Medium]:1024,[n.High]:2048};class a extends i.default{constructor(){super(...arguments),this.ins=this.addInputs(a.lightIns)}get light(){return this.object3D}update(e){super.update(e);const t=this.light,s=this.ins;if((s.color.changed||s.intensity.changed)&&(t.color.fromArray(s.color.value),t.intensity=s.intensity.value),s.shadowEnabled.changed||s.shadowEnabled.value&&(s.shadowResolution.changed||s.shadowBlur.changed)){t.castShadow=s.shadowEnabled.value;const e=o[s.shadowResolution.getValidatedValue()];t.shadow.mapSize.set(e,e),t.shadow.radius=s.shadowBlur.value}return!0}}t.default=a,a.typeName="CLight",a.lightIns={color:r.types.ColorRGB("Light.Color"),intensity:r.types.Number("Light.Intensity",1),shadowEnabled:r.types.Boolean("Shadow.Enabled"),shadowResolution:r.types.Enum("Shadow.Resolution",n,n.Medium),shadowBlur:r.types.Number("Shadow.Blur",1)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(50),n=s(0),o=s(11),a=s(54),l=s(36),c=s(207),h=s(56),u=s(208),d=s(61),p=s(32),f=s(26),m=new r.Vector3,v=new r.Vector3,g=new r.Quaternion,y=new r.Box3;class b extends o.default{constructor(e,t){super(e,t),this.ins=this.addInputs(b.ins),this.outs=this.addOutputs(b.outs),this._derivatives=new u.default,this._activeDerivative=null,this._visible=!0,this._boxFrame=null,this._localBoundingBox=new r.Box3,this.object3D=new r.Group}get settingProperties(){return[this.ins.visible,this.ins.quality,this.ins.localUnits,this.ins.tags,this.ins.shader,this.ins.override,this.ins.color,this.ins.opacity,this.ins.hiddenOpacity,this.ins.roughness,this.ins.metalness,this.ins.occlusion]}get derivatives(){return this._derivatives}get activeDerivative(){return this._activeDerivative}get localBoundingBox(){return this._localBoundingBox}get assetReader(){return this.getMainComponent(p.default)}get renderer(){return this.getMainComponent(f.default)}create(){super.create(),this.node.createComponent(d.default).ins.unitScale.linkFrom(this.outs.unitScale);const e=this.renderer.outs.maxTextureSize.value;e<2048?this.ins.quality.setValue(l.EDerivativeQuality.Low):e<4096?this.ins.quality.setValue(l.EDerivativeQuality.Medium):this.ins.quality.setValue(l.EDerivativeQuality.High)}update(){const e=this.ins;if(e.tags.changed||e.activeTags.changed||e.visible.changed){let t=e.visible.value;if(t){const s=e.tags.value.split(",").map(e=>e.trim()).filter(e=>e),r=e.activeTags.value.split(",").map(e=>e.trim()).filter(e=>e);t=!s.length,r.forEach(e=>{s.indexOf(e)>=0&&(t=!0)})}const s=this.ins.override.value;this._visible=t,t?(this.object3D.visible=!0,s&&this.updateMaterial()):e.visible.value&&s&&this.ins.hiddenOpacity.value>0?(this.object3D.visible=!0,this.updateMaterial()):this.object3D.visible=!1}if(e.tags.changed&&this.emit({type:"tag-update"}),!this.activeDerivative&&e.autoLoad.changed&&e.autoLoad.value)this.autoLoad(e.quality.value);else if(e.quality.changed){const t=this.derivatives.select(l.EDerivativeUsage.Web3D,e.quality.value);t&&t!==this.activeDerivative&&this.loadDerivative(t).catch(e=>{console.warn("Model.update - failed to load derivative"),console.warn(e)})}return(e.localUnits.changed||e.globalUnits.changed)&&this.updateUnitScale(),e.shader.changed&&this.updateShader(),e.override.value&&e.shader.value===h.EShaderMode.Default&&(e.override.changed||e.color.changed||e.opacity.changed||e.roughness.changed||e.metalness.changed||e.occlusion.changed)&&this.updateMaterial(),e.center.changed&&this.center(),(e.position.changed||e.rotation.changed)&&this.updateMatrixFromProps(),e.dumpDerivatives.changed&&console.log(this.derivatives.toString(!0)),!0}dispose(){this.derivatives.clear(),this._activeDerivative=null,super.dispose()}center(){const e=this.object3D,t=this.ins.position;e.matrix.decompose(m,g,v),e.matrix.makeRotationFromQuaternion(g),y.makeEmpty(),a.computeLocalBoundingBox(e,y,e.parent),y.getCenter(m),m.multiplyScalar(-1).toArray(t.value),t.set()}setFromMatrix(e){const t=this.ins;e.decompose(m,g,v),m.multiplyScalar(1/this.outs.unitScale.value).toArray(t.position.value),t.position.set(),a.quaternionToDegrees(g,b.rotationOrder,t.rotation.value),t.rotation.set()}fromDocument(e,t){const{ins:s,outs:i}=this;if(!isFinite(t.model))throw new Error("model property missing in node");const n=e.models[t.model],o=l.EUnitType[n.units||"cm"];if(s.localUnits.setValue(isFinite(o)?o:l.EUnitType.cm),s.visible.setValue(void 0===n.visible||n.visible),s.tags.setValue(n.tags||""),s.position.reset(),s.rotation.reset(),n.translation&&s.position.copyValue(n.translation),n.rotation&&(g.fromArray(n.rotation),a.quaternionToDegrees(g,b.rotationOrder,s.rotation.value),s.rotation.set()),n.boundingBox){const e=this._localBoundingBox;e.min.fromArray(n.boundingBox.min),e.max.fromArray(n.boundingBox.max),this._boxFrame=new r.Box3Helper(e,"#009cde"),this.addObject3D(this._boxFrame),i.updated.set()}if(n.derivatives&&this.derivatives.fromJSON(n.derivatives),n.material){const e=n.material;s.copyValues({override:!0,color:e.color||s.color.schema.preset,opacity:void 0!==e.opacity?e.opacity:s.opacity.schema.preset,hiddenOpacity:void 0!==e.hiddenOpacity?e.hiddenOpacity:s.hiddenOpacity.schema.preset,roughness:void 0!==e.roughness?e.roughness:s.roughness.schema.preset,metalness:void 0!==e.metalness?e.metalness:s.metalness.schema.preset,occlusion:void 0!==e.occlusion?e.occlusion:s.occlusion.schema.preset})}return n.annotations&&this.getComponent(d.default).fromData(n.annotations),this.emit({type:"tag-update"}),this.ins.autoLoad.set(),t.model}toDocument(e,t){const s={units:l.EUnitType[this.ins.localUnits.getValidatedValue()]},r=this.ins;r.visible.value||(s.visible=!1),r.tags.value&&(s.tags=r.tags.value);const i=r.position.value;0===i[0]&&0===i[1]&&0===i[2]||(s.translation=r.position.value);const n=r.rotation.value;0===n[0]&&0===n[1]&&0===n[2]||(a.degreesToQuaternion(n,b.rotationOrder,g),s.rotation=g.toArray()),r.override.value&&(s.material={color:r.color.value,opacity:r.opacity.value,hiddenOpacity:r.hiddenOpacity.value,roughness:r.roughness.value,metalness:r.metalness.value,occlusion:r.occlusion.value}),s.boundingBox={min:this._localBoundingBox.min.toArray(),max:this._localBoundingBox.max.toArray()},s.derivatives=this.derivatives.toJSON();const o=this.getComponent(d.default).toData();o&&o.length>0&&(s.annotations=o),e.models=e.models||[];const c=e.models.length;return e.models.push(s),c}updateShader(){const e=this.ins.shader.getValidatedValue();this.object3D.traverse(t=>{const s=t.material;s&&s.isUberPBRMaterial&&s.setShaderMode(e)})}updateMaterial(){const e=this.ins;this.object3D.traverse(t=>{const s=t.material;s&&s.isUberPBRMaterial&&(s.aoMapMix.setScalar(e.occlusion.value),s.color.fromArray(e.color.value),s.opacity=this._visible?e.opacity.value:e.hiddenOpacity.value,s.transparent=s.opacity<1||!!s.alphaMap,s.depthWrite=1===s.opacity,s.roughness=e.roughness.value,s.metalness=e.metalness.value)})}updateUnitScale(){const e=this.ins.localUnits.getValidatedValue(),t=this.ins.globalUnits.getValidatedValue();this.outs.unitScale.setValue(c.default(e,t)),this.updateMatrixFromProps()}updateMatrixFromProps(){const e=this.ins,t=this.outs.unitScale.value,s=this.object3D;m.fromArray(e.position.value).multiplyScalar(t),a.degreesToQuaternion(e.rotation.value,b.rotationOrder,g),v.setScalar(t),s.matrix.compose(m,g,v),s.matrixWorldNeedsUpdate=!0,this.outs.updated.set()}autoLoad(e){const t=[],s=this.derivatives.select(l.EDerivativeUsage.Web3D,l.EDerivativeQuality.Thumb);s&&t.push(s);const r=this.derivatives.select(l.EDerivativeUsage.Web3D,e);return r&&r!==s&&t.push(r),0===t.length?(i.default.show(`No 3D derivatives available for '${this.displayName}'.`),Promise.resolve()):t.reduce((e,t)=>e.then(()=>this.loadDerivative(t)),Promise.resolve())}loadDerivative(e){return e.load(this.assetReader).then(()=>{e.model&&(this._activeDerivative&&(this.removeObject3D(this._activeDerivative.model),this._activeDerivative.unload()),this._activeDerivative=e,this.addObject3D(e.model),this._boxFrame&&(this.removeObject3D(this._boxFrame),this._boxFrame.geometry.dispose(),this._boxFrame=null),a.computeLocalBoundingBox(e.model,this._localBoundingBox),this.outs.updated.set(),this.outs.quality.setValue(e.data.quality),this.ins.override&&this.updateMaterial())}).catch(e=>i.default.show(`Failed to load model derivative: ${e.message}`))}}t.default=b,b.typeName="CVModel2",b.text="Model",b.icon="cube",b.rotationOrder="ZYX",b.ins={globalUnits:n.types.Enum("Model.GlobalUnits",l.EUnitType,l.EUnitType.cm),localUnits:n.types.Enum("Model.LocalUnits",l.EUnitType,l.EUnitType.cm),quality:n.types.Enum("Model.Quality",l.EDerivativeQuality,l.EDerivativeQuality.High),tags:n.types.String("Model.Tags"),activeTags:n.types.String("Model.ActiveTags"),autoLoad:n.types.Boolean("Model.AutoLoad",!0),position:n.types.Vector3("Model.Position"),rotation:n.types.Vector3("Model.Rotation"),center:n.types.Event("Model.Center"),shader:n.types.Enum("Material.Shader",h.EShaderMode,h.EShaderMode.Default),override:n.types.Boolean("Material.Override"),color:n.types.ColorRGB("Material.BaseColor"),opacity:n.types.Percent("Material.Opacity",1),hiddenOpacity:n.types.Percent("Material.HiddenOpacity",0),roughness:n.types.Percent("Material.Roughness",.8),metalness:n.types.Percent("Material.Metalness",.1),occlusion:n.types.Percent("Material.Occlusion",.3),dumpDerivatives:n.types.Event("Derivatives.Dump")},b.outs={unitScale:n.types.Number("UnitScale",{preset:1,precision:5}),quality:n.types.Enum("LoadedQuality",l.EDerivativeQuality),updated:n.types.Event("Updated")}},function(e,t,s){"use strict";s.d(t,"b",(function(){return i})),s.d(t,"a",(function(){return n}));var r=s(3);function i(e){let t=n.get(e.type);void 0===t&&(t={stringsArray:new WeakMap,keyString:new Map},n.set(e.type,t));let s=t.stringsArray.get(e.strings);if(void 0!==s)return s;const i=e.strings.join(r.f);return void 0===(s=t.keyString.get(i))&&(s=new r.a(e,e.getTemplateElement()),t.keyString.set(i,s)),t.stringsArray.set(e.strings,s),s}const n=new Map},function(e,t,s){"use strict";s.d(t,"a",(function(){return i})),s.d(t,"b",(function(){return n}));const r=new WeakMap,i=e=>(...t)=>{const s=e(...t);return r.set(s,!0),s},n=e=>"function"==typeof e&&r.has(e)},function(e,t,s){"use strict";s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return a}));var r=s(9),i=s(5),n=s(16);const o=new WeakMap,a=(e,t,s)=>{let a=o.get(t);void 0===a&&(Object(r.b)(t,t.firstChild),o.set(t,a=new i.e(Object.assign({templateFactory:n.b},s))),a.appendInto(t)),a.setValue(e),a.commit()}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(0);class n extends i.default{constructor(){super(...arguments),this.ins=this.addInputs(n.ins),this.outs=this.addOutputs(n.outs),this._loadingManager=new o(this),this._baseUrl=window.location.href}get loadingManager(){return this._loadingManager}get baseUrl(){return this._baseUrl}set baseUrl(e){this._baseUrl=new URL(e,window.location.href).href}getAssetName(e){return e.split("/").pop()}getAssetUrl(e){return new URL(e,this._baseUrl).href}getAssetPath(e){const t=this._baseUrl,s=e.indexOf(t);return s>=0?e.substr(s+t.length):e}getAssetBasePath(e){const t=this.getAssetPath(e).split("/");t.pop();const s=t.join("/");return s?s+"/":s}getRelativeAssetPath(e,t){const s=this.getAssetUrl(e),r=this.getAssetUrl(t),i=s.indexOf(r);return i>=0?s.substr(i+r.length):this.getAssetPath(s)}create(){super.create()}update(){const{ins:e,outs:t}=this;if(e.busy.changed){const s=e.busy.value||this._loadingManager.isBusy;t.busy.setValue(s),s||t.completed.set()}return!0}}t.default=n,n.typeName="CVAssetManager",n.text="AssetManager",n.icon="",n.isSystemSingleton=!0,n.ins={busy:i.types.Boolean("State.Busy")},n.outs={busy:i.types.Boolean("State.Busy"),completed:i.types.Event("State.Completed")};class o extends r.LoadingManager{constructor(e){super(),this._manager=e,this._isBusy=!1,this.onStart=this.onLoadingStart.bind(this),this.onProgress=this.onLoadingProgress.bind(this),this.onLoad=this.onLoadingCompleted.bind(this),this.onError=this.onLoadingError.bind(this)}get isBusy(){return this._isBusy}onLoadingStart(){this._isBusy=!0,this._manager.ins.busy.set()}onLoadingProgress(e,t,s){0}onLoadingCompleted(){this._isBusy=!1,this._manager.ins.busy.set()}onLoadingError(){this._isBusy=!1,this._manager.ins.busy.set()}}},function(e,t,s){"use strict";s.d(t,"b",(function(){return o})),s.d(t,"a",(function(){return a}));var r=s(9),i=s(3);const n=` ${i.f} `;class o{constructor(e,t,s,r){this.strings=e,this.values=t,this.type=s,this.processor=r}getHTML(){const e=this.strings.length-1;let t="",s=!1;for(let r=0;r<e;r++){const e=this.strings[r],o=e.lastIndexOf("\x3c!--");s=(o>-1||s)&&-1===e.indexOf("--\x3e",o+1);const a=i.e.exec(e);t+=null===a?e+(s?n:i.g):e.substr(0,a.index)+a[1]+a[2]+i.b+a[3]+i.f}return t+=this.strings[e]}getTemplateElement(){const e=document.createElement("template");return e.innerHTML=this.getHTML(),e}}class a extends o{getHTML(){return`<svg>${super.getHTML()}</svg>`}getTemplateElement(){const e=super.getTemplateElement(),t=e.content,s=t.firstChild;return t.removeChild(s),Object(r.c)(t,s.firstChild),e}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(12),n=s(0);t.types=n.types;const o=s(81),a=new r.Vector3,l=new r.Vector3,c=new r.Quaternion,h=new r.Euler;var u;!function(e){e[e.XYZ=0]="XYZ",e[e.YZX=1]="YZX",e[e.ZXY=2]="ZXY",e[e.XZY=3]="XZY",e[e.YXZ=4]="YXZ",e[e.ZYX=5]="ZYX"}(u=t.ERotationOrder||(t.ERotationOrder={}));class d extends o.default{constructor(e,t){super(e,t),this.ins=this.addInputs(d.transformIns),this.outs=this.addOutputs(d.transformOuts),this._object3D=this.createObject3D(),this._object3D.matrixAutoUpdate=!1}get transform(){return this}get object3D(){return this._object3D}get children(){return this._children||[]}get matrix(){return this._object3D.matrix}update(e){const t=this._object3D,{position:s,rotation:r,order:n,scale:o}=this.ins,{matrix:l}=this.outs;t.position.fromArray(s.value),a.fromArray(r.value).multiplyScalar(i.default.DEG2RAD);const c=n.getOptionText();return t.rotation.setFromVector3(a,c),t.scale.fromArray(o.value),t.updateMatrix(),t.matrix.toArray(l.value),l.set(),!0}dispose(){this._object3D&&(this._object3D.children.slice().forEach(e=>this._object3D.remove(e)),this._object3D.parent&&this._object3D.parent.remove(this._object3D)),super.dispose()}setPropertiesFromMatrix(e){const t=!e;e=e||this._object3D.matrix;const{position:s,rotation:r,order:n,scale:o}=this.ins;e.decompose(a,c,l),a.toArray(s.value);const u=n.getOptionText();h.setFromQuaternion(c,u),h.toVector3(a),a.multiplyScalar(i.default.RAD2DEG).toArray(r.value),l.toArray(o.value),s.set(t),r.set(t),o.set(t)}addChild(e){super.addChild(e),this._object3D.add(e._object3D)}removeChild(e){this._object3D.remove(e._object3D),super.removeChild(e)}createObject3D(){return new r.Object3D}}t.default=d,d.typeName="CTransform",d.transformIns={position:n.types.Vector3("Transform.Position"),rotation:n.types.Vector3("Transform.Rotation"),order:n.types.Enum("Transform.Order",u),scale:n.types.Scale3("Transform.Scale")},d.transformOuts={matrix:n.types.Matrix4("Transform.Matrix")}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(0),n=s(43),o=s(60),a=s(15),l=new r.Vector3;class c extends o.default{constructor(){super(...arguments),this.ins=this.addInputs(c.ins),this.outs=this.addOutputs(c.outs)}get settingProperties(){return null}get snapshotProperties(){return null}get models(){return this.getGraphComponents(a.default)}create(){super.create(),this.outs.boundingBox.setValue(new r.Box3),this.graph.components.on(a.default,this.onModelComponent,this),this.models.forEach(e=>{e.ins.globalUnits.linkFrom(this.ins.units),this.ins.modelUpdated.linkFrom(e.outs.updated)})}update(e){const t=this.ins;return t.units.changed&&this.updateModelBoundingBox(),t.modelUpdated.changed&&this.updateModelBoundingBox(),!0}dispose(){this.graph.components.off(a.default,this.onModelComponent,this),super.dispose()}fromDocument(e,t){this.ins.units.setValue(n.EUnitType[t.units]||0)}toDocument(e,t){t.units=n.EUnitType[this.ins.units.getValidatedValue()]}onModelComponent(e){const t=e.object;e.add&&(t.ins.globalUnits.linkFrom(this.ins.units),this.ins.modelUpdated.linkFrom(t.outs.updated)),this.updateModelBoundingBox()}updateModelBoundingBox(){const e=this.outs.boundingBox.value;e.makeEmpty(),this.models.forEach(t=>e.expandByObject(t.object3D)),e.getSize(l),this.outs.boundingBox.set(),this.outs.boundingRadius.setValue(.5*l.length())}}t.default=c,c.typeName="CVScene",c.text="Scene",c.icon="hierarchy",c.ins={units:i.types.Enum("Scene.Units",n.EUnitType,n.EUnitType.cm),modelUpdated:i.types.Event("Scene.ModelUpdated")},c.outs={boundingBox:i.types.Object("Models.BoundingBox",r.Box3),boundingRadius:i.types.Number("Models.BoundingRadius")}},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(0);t.types=i.types;const n=s(239),o=s(13),a=s(241);t.customElement=a.customElement,t.property=a.property,t.html=a.html;class l extends n.default{constructor(){super(...arguments),this.ins=this.addInputs(l.toolIns),this.outs=this.addOutputs(l.toolOuts),this._isActiveTool=!1}get isActiveTool(){return this._isActiveTool}dispose(){this._isActiveTool&&this.deactivateTool(),super.dispose()}createView(){throw new Error("must override")}activateTool(){this._isActiveTool=!0,this.startObserving()}deactivateTool(){this.stopObserving(),this._isActiveTool=!1}}t.default=l,l.typeName="CVTool",l.toolIns={},l.toolOuts={};class c extends a.default{constructor(e){super(e.system),this.tool=null,this.tool=e}get analytics(){return this.system.getMainComponent(o.default)}firstConnected(){this.classList.add("sv-group","sv-tool-view")}connected(){super.connected(),this.tool.on("update",this.onUpdate,this)}disconnected(){this.tool.off("update",this.onUpdate,this),super.disconnected()}}r([a.property({attribute:!1})],c.prototype,"tool",void 0),t.ToolView=c},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(2);t.customElement=r.customElement,t.property=r.property,t.html=r.html,t.TemplateResult=r.TemplateResult;const i=s(67),n=s(29);class o extends i.default{constructor(){super(...arguments),this.activeDocument=null}get documentProvider(){return this.system.getMainComponent(n.default)}connected(){const e=this.documentProvider;e.on("active-component",this.onActiveDocumentEvent,this);const t=e.activeComponent;t&&(this.activeDocument=t,this.onActiveDocument(null,t))}disconnected(){this.documentProvider.off("active-component",this.onActiveDocumentEvent,this);const e=this.activeDocument;e&&(this.activeDocument=null,this.onActiveDocument(e,null))}onActiveDocument(e,t){}onActiveDocumentEvent(e){this.activeDocument=e.next,this.onActiveDocument(e.previous,e.next)}}t.default=o},function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var r=s(9),i=s(3);class n{constructor(e,t,s){this.__parts=[],this.template=e,this.processor=t,this.options=s}update(e){let t=0;for(const s of this.__parts)void 0!==s&&s.setValue(e[t]),t++;for(const e of this.__parts)void 0!==e&&e.commit()}_clone(){const e=r.a?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),t=[],s=this.template.parts,n=document.createTreeWalker(e,133,null,!1);let o,a=0,l=0,c=n.nextNode();for(;a<s.length;)if(o=s[a],Object(i.d)(o)){for(;l<o.index;)l++,"TEMPLATE"===c.nodeName&&(t.push(c),n.currentNode=c.content),null===(c=n.nextNode())&&(n.currentNode=t.pop(),c=n.nextNode());if("node"===o.type){const e=this.processor.handleTextExpression(this.options);e.insertAfterNode(c.previousSibling),this.__parts.push(e)}else this.__parts.push(...this.processor.handleAttributeExpressions(c,o.name,o.strings,this.options));a++}else this.__parts.push(void 0),a++;return r.a&&(document.adoptNode(e),customElements.upgrade(e)),e}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(51);class n extends r.default{constructor(e,t){super(e,t),this.ins=this.addInputs(n.ins),this.outs=this.addOutputs(n.outs),this.views=[],this._activeSceneComponent=null,this._forceRender=!1,this.addEvents("active-scene","active-camera")}get activeSceneComponent(){return this._activeSceneComponent}set activeSceneComponent(e){if(e!==this._activeSceneComponent){const t=this._activeSceneComponent,s=this.activeCameraComponent;t&&t.off("active-camera",this.onActiveCamera,this),e&&e.on("active-camera",this.onActiveCamera,this),this._activeSceneComponent=e;const r=this.activeCameraComponent,i={type:"active-scene",previous:t,next:e};this.emit(i);const n={type:"active-camera",previous:s,next:r};this.emit(n)}}get activeSceneGraph(){return this._activeSceneComponent?this._activeSceneComponent.graph:null}get activeScene(){return this._activeSceneComponent?this._activeSceneComponent.scene:null}get activeCameraComponent(){return this._activeSceneComponent?this._activeSceneComponent.activeCameraComponent:null}get activeCamera(){const e=this._activeSceneComponent?this._activeSceneComponent.activeCameraComponent:null;return e?e.camera:null}forceRender(){this._forceRender=!0}create(){super.create(),this.trackComponent(i.default,e=>{e.on("pulse",this.onPulse,this)},e=>{e.off("pulse",this.onPulse,this)})}update(){const e=this.ins;if(e.shadowsEnabled.changed&&this.views.forEach(t=>t.renderer.shadowMap.enabled=e.shadowsEnabled.value),e.exposure.changed&&this.views.forEach(t=>t.renderer.toneMappingExposure=e.exposure.value),e.gamma.changed){this.views.forEach(t=>t.renderer.gammaFactor=e.gamma.value);const t=this.activeScene;t&&t.traverse(e=>{const t=e;t.isMesh&&(Array.isArray(t.material)?t.material.forEach(e=>e.needsUpdate=!0):t.material.needsUpdate=!0)})}return!0}attachView(e){if(0===this.views.length){const t=e.renderer,s=this.outs;s.maxTextureSize.setValue(t.capabilities.maxTextureSize),s.maxCubemapSize.setValue(t.capabilities.maxCubemapSize)}this.views.push(e)}detachView(e){const t=this.views.indexOf(e);if(t<0)throw new Error("render view not registered");this.views.splice(t,1)}logInfo(){this.views.forEach(e=>{console.log(e.renderer.info)})}onPulse(e){(e.systemUpdated||this._forceRender)&&(this.views.forEach(e=>{e.render()}),this._forceRender=!1)}onActiveCamera(e){this.emit(e)}}t.default=n,n.typeName="CRenderer",n.isSystemSingleton=!0,n.ins={exposure:r.types.Number("Shading.Exposure",1),gamma:r.types.Number("Shading.Gamma",2),shadowsEnabled:r.types.Boolean("Shadows.Enabled",!0)},n.outs={maxTextureSize:r.types.Integer("Caps.MaxTextureSize"),maxCubemapSize:r.types.Integer("Caps.MaxCubemapSize")}},function(e,t,s){"use strict";function r(e,t,s){var r=s?" !== ":" === ",i=s?" || ":" && ",n=s?"!":"",o=s?"":"!";switch(e){case"null":return t+r+"null";case"array":return n+"Array.isArray("+t+")";case"object":return"("+n+t+i+"typeof "+t+r+'"object"'+i+o+"Array.isArray("+t+"))";case"integer":return"(typeof "+t+r+'"number"'+i+o+"("+t+" % 1)"+i+t+r+t+")";default:return"typeof "+t+r+'"'+e+'"'}}e.exports={copy:function(e,t){for(var s in t=t||{},e)t[s]=e[s];return t},checkDataType:r,checkDataTypes:function(e,t){switch(e.length){case 1:return r(e[0],t,!0);default:var s="",i=n(e);for(var o in i.array&&i.object&&(s=i.null?"(":"(!"+t+" || ",s+="typeof "+t+' !== "object")',delete i.null,delete i.array,delete i.object),i.number&&delete i.integer,i)s+=(s?" && ":"")+r(o,t,!0);return s}},coerceToTypes:function(e,t){if(Array.isArray(t)){for(var s=[],r=0;r<t.length;r++){var n=t[r];i[n]?s[s.length]=n:"array"===e&&"array"===n&&(s[s.length]=n)}if(s.length)return s}else{if(i[t])return[t];if("array"===e&&"array"===t)return["array"]}},toHash:n,getProperty:l,escapeQuotes:c,equal:s(58),ucs2length:s(164),varOccurences:function(e,t){t+="[^0-9]";var s=e.match(new RegExp(t,"g"));return s?s.length:0},varReplace:function(e,t,s){return t+="([^0-9])",s=s.replace(/\$/g,"$$$$"),e.replace(new RegExp(t,"g"),s+"$1")},cleanUpCode:function(e){return e.replace(h,"").replace(u,"").replace(d,"if (!($1))")},finalCleanUpCode:function(e,t){var s=e.match(p);s&&2==s.length&&(e=t?e.replace(m,"").replace(y,b):e.replace(f,"").replace(v,g));return(s=e.match(w))&&3===s.length?e.replace(_,""):e},schemaHasRules:function(e,t){if("boolean"==typeof e)return!e;for(var s in e)if(t[s])return!0},schemaHasRulesExcept:function(e,t,s){if("boolean"==typeof e)return!e&&"not"!=s;for(var r in e)if(r!=s&&t[r])return!0},schemaUnknownRules:function(e,t){if("boolean"==typeof e)return;for(var s in e)if(!t[s])return s},toQuotedString:E,getPathExpr:function(e,t,s,r){return S(e,s?"'/' + "+t+(r?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):r?"'[' + "+t+" + ']'":"'[\\'' + "+t+" + '\\']'")},getPath:function(e,t,s){var r=E(s?"/"+C(t):l(t));return S(e,r)},getData:function(e,t,s){var r,i,n,o;if(""===e)return"rootData";if("/"==e[0]){if(!x.test(e))throw new Error("Invalid JSON-pointer: "+e);i=e,n="rootData"}else{if(!(o=e.match(P)))throw new Error("Invalid JSON-pointer: "+e);if(r=+o[1],"#"==(i=o[2])){if(r>=t)throw new Error("Cannot access property/index "+r+" levels up, current level is "+t);return s[t-r]}if(r>t)throw new Error("Cannot access data "+r+" levels up, current level is "+t);if(n="data"+(t-r||""),!i)return n}for(var a=n,c=i.split("/"),h=0;h<c.length;h++){var u=c[h];u&&(n+=l(T(u)),a+=" && "+n)}return a},unescapeFragment:function(e){return T(decodeURIComponent(e))},unescapeJsonPointer:T,escapeFragment:function(e){return encodeURIComponent(C(e))},escapeJsonPointer:C};var i=n(["string","number","integer","boolean","null"]);function n(e){for(var t={},s=0;s<e.length;s++)t[e[s]]=!0;return t}var o=/^[a-z$_][a-z$_0-9]*$/i,a=/'|\\/g;function l(e){return"number"==typeof e?"["+e+"]":o.test(e)?"."+e:"['"+c(e)+"']"}function c(e){return e.replace(a,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}var h=/else\s*{\s*}/g,u=/if\s*\([^)]+\)\s*\{\s*\}(?!\s*else)/g,d=/if\s*\(([^)]+)\)\s*\{\s*\}\s*else(?!\s*if)/g;var p=/[^v.]errors/g,f=/var errors = 0;|var vErrors = null;|validate.errors = vErrors;/g,m=/var errors = 0;|var vErrors = null;/g,v="return errors === 0;",g="validate.errors = null; return true;",y=/if \(errors === 0\) return data;\s*else throw new ValidationError\(vErrors\);/,b="return data;",w=/[^A-Za-z_$]rootData[^A-Za-z0-9_$]/g,_=/if \(rootData === undefined\) rootData = data;/;function E(e){return"'"+c(e)+"'"}var x=/^\/(?:[^~]|~0|~1)*$/,P=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function S(e,t){return'""'==e?t:(e+" + "+t).replace(/' \+ '/g,"")}function C(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}function T(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(205),i=s(206),n=s(0),o=s(96);class a extends n.default{constructor(){super(...arguments),this.collection=new i.default,this.process=new i.default,this.images=new i.default,this.articles=new r.default,this.leadArticle=null,this.notes=[]}fromDocument(e,t){if(!isFinite(t.meta))throw new Error("info property missing in node");const s=e.metas[t.meta];if(s.collection&&(this.collection.dictionary=s.collection),s.process&&(this.process.dictionary=s.process),s.images){const e={};s.images.forEach(t=>e[t.quality]=t),this.images.dictionary=e}return s.articles&&(this.articles.items=s.articles.map(e=>o.default.fromJSON(e)),void 0!==s.leadArticle&&(this.leadArticle=this.articles.getAt(s.leadArticle))),this.emit("load"),t.meta}toDocument(e,t){let s=null;if(this.collection.length>0&&(s={collection:this.collection.dictionary}),this.process.length>0&&((s=s||{}).process=this.process.dictionary),this.images.length>0&&((s=s||{}).images=this.images.items),this.articles.length>0){s=s||{};const e=this.articles.items;s.articles=e.map(e=>e.toJSON()),this.leadArticle&&(s.leadArticle=e.indexOf(this.leadArticle))}if(s){e.metas=e.metas||[];const t=e.metas.length;return e.metas.push(s),t}}}t.default=a,a.typeName="CVMeta",a.text="Meta",a.icon="document"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(52),n=s(83);class o extends i.default{constructor(e,t){super(e,t),this.outs=this.addOutputs(o.outs),this.scope=i.EComponentScope.Node}createDocument(e,t){const s=this.node.createComponent(n.default);return this.activeComponent=s,e&&s.openDocument(e,t),s}amendDocument(e,t,s){const r=this.activeComponent;if(!r)throw new Error("no active document, can't amend");return r.openDocument(e,t,s),r}appendModel(e,t){const s=this.activeComponent;if(!s)throw new Error("no active document, can't append model");return s.appendModel(e,t),s}appendGeometry(e,t,s,r,i){const n=this.activeComponent;if(!n)throw new Error("no active document, can't append geometry");return n.appendGeometry(e,t,s,r,i),n}removeActiveDocument(){const e=this.activeComponent;e&&e.dispose()}activateComponent(e){e.ins.visible.setValue(!0),e.ins.active.setValue(!0)}deactivateComponent(e){e.ins.visible.setValue(!1),e.ins.active.setValue(!1)}onActiveComponent(e,t){this.outs.activeDocument.setValue(t)}onScopedComponents(){this.outs.changedDocuments.set()}}t.default=o,o.typeName="CVDocumentProvider",o.componentType=n.default,o.outs={activeDocument:r.types.Object("Documents.Active",n.default),changedDocuments:r.types.Event("Documents.Changed")}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";t.default=function(e,t){let s;e&&"number"==typeof e||(e=12);do{s="";for(let t=0;t<e;++t)s+=r[62*Math.random()|0]}while(t&&t[s]);return s}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(0),n=s(26),o=s(21),a={view:null,viewport:null,renderer:null,scene:null,camera:null},l={type:"before-render",component:null,context:a},c={type:"after-render",component:null,context:a},h={activate:i.types.Event("Scene.Activate")};class u extends o.default{constructor(e,t){super(e,t),this._activeCameraComponent=null,this._preRenderList=[],this._postRenderList=[],this._renderListsNeedUpdate=!0,this.ins=this.addInputs(h,0),this.addEvents("before-render","after-render","active-camera")}get scene(){return this.object3D}get activeCameraComponent(){return this._activeCameraComponent}set activeCameraComponent(e){if(e!==this._activeCameraComponent){const t=this._activeCameraComponent;this._activeCameraComponent=e;const s={type:"active-camera",previous:t,next:e};this.emit(s)}}get activeCamera(){return this._activeCameraComponent?this._activeCameraComponent.camera:null}get renderer(){return this.getMainComponent(n.default)}create(){super.create(),this.on("hierarchy",this.shouldUpdateRenderLists,this),this.on("child",this.shouldUpdateRenderLists,this);const e=this.renderer;e&&!e.activeSceneComponent&&(e.activeSceneComponent=this)}update(e){if(super.update(e),this.ins.activate.changed){const e=this.renderer;e&&(e.activeSceneComponent=this)}return!0}tick(e){return this._renderListsNeedUpdate&&(this.updateRenderLists(),this._renderListsNeedUpdate=!1),!1}dispose(){const e=this.renderer;e&&e.activeSceneComponent===this&&(e.activeSceneComponent=null),this.off("hierarchy",this.shouldUpdateRenderLists,this),this.off("child",this.shouldUpdateRenderLists,this),super.dispose()}preRender(e){const t=this._preRenderList;for(let s=0,r=t.length;s<r;++s)t[s].preRender(e)}postRender(e){const t=this._postRenderList;for(let s=0,r=t.length;s<r;++s)t[s].postRender(e)}createObject3D(){const e=new r.Scene;return e.onBeforeRender=this._onBeforeRender.bind(this),e.onAfterRender=this._onAfterRender.bind(this),e}shouldUpdateRenderLists(){this._renderListsNeedUpdate=!0}updateRenderLists(){this._preRenderList=[],this._postRenderList=[],this.traverseDown(!1,!0,!0,e=>(e.preRender&&this._preRenderList.push(e),e.postRender&&this._postRenderList.push(e),!1)),this.changed=!0}_onBeforeRender(e,t,s){a.view=e.__view,a.viewport=e.__viewport,a.renderer=e,a.scene=t,a.camera=s,this.preRender(a),l.component=this,this.emit(l)}_onAfterRender(e,t,s){a.view=e.__view,a.viewport=e.__viewport,a.renderer=e,a.scene=t,a.camera=s,this.postRender(a),c.component=this,this.emit(c)}}t.default=u,u.typeName="CScene",u.isGraphSingleton=!0},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function o(e){try{l(r.next(e))}catch(e){n(e)}}function a(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=s(146),n=s(0),o=s(147),a=s(148),l=s(154),c=s(157),h=s(82),u=s(19);class d extends n.default{constructor(e,t){super(e,t);const s=this.assetManager.loadingManager;this.jsonLoader=new o.default(s),this.modelLoader=new a.default(s),this.geometryLoader=new l.default(s),this.textureLoader=new c.default(s),this.fontReader=new h.default(s)}get assetManager(){return this.getMainComponent(u.default)}getJSON(e){return r(this,void 0,void 0,(function*(){const t=this.assetManager.getAssetUrl(e);return this.jsonLoader.get(t)}))}getText(e){return r(this,void 0,void 0,(function*(){const t=this.assetManager.getAssetUrl(e);return i.default.text(t,"GET")}))}getModel(e){return r(this,void 0,void 0,(function*(){const t=this.assetManager.getAssetUrl(e);return this.modelLoader.get(t)}))}getGeometry(e){return r(this,void 0,void 0,(function*(){const t=this.assetManager.getAssetUrl(e);return this.geometryLoader.get(t)}))}getTexture(e){return r(this,void 0,void 0,(function*(){const t=this.assetManager.getAssetUrl(e);return this.textureLoader.get(t)}))}getFont(e){return r(this,void 0,void 0,(function*(){const t=this.assetManager.getAssetUrl(e);return this.fontReader.load(t)}))}}t.default=d,d.typeName="CVAssetReader",d.text="AssetReader",d.icon="",d.isSystemSingleton=!0},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Default=0]="Default",e[e.Clay=1]="Clay",e[e.XRay=2]="XRay",e[e.Normals=3]="Normals",e[e.Wireframe=4]="Wireframe"}(t.EShaderMode||(t.EShaderMode={})),function(e){e[e.Solid=0]="Solid",e[e.LinearGradient=1]="LinearGradient",e[e.RadialGradient=2]="RadialGradient"}(t.EBackgroundStyle||(t.EBackgroundStyle={})),function(e){e[e.Orbit=0]="Orbit",e[e.Walk=1]="Walk"}(t.ENavigationType||(t.ENavigationType={})),function(e){e[e.Overlay=0]="Overlay",e[e.Left=1]="Left",e[e.Right=2]="Right"}(t.EReaderPosition||(t.EReaderPosition={})),function(e){e[e.X=0]="X",e[e.Y=1]="Y",e[e.Z=2]="Z"}(t.ESliceAxis||(t.ESliceAxis={}))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(10),i=s(60),n=s(92),o=s(201),a=s(93),l=s(94),c=s(95),h=s(28),u=s(15),d=s(22);class p extends r.default{get transform(){return this.components.get(i.default)}get meta(){return this.components.get(h.default,!0)}get model(){return this.components.get(u.default,!0)}get camera(){return this.components.get(n.default,!0)}get light(){return this.components.get(o.CLight,!0)}get scene(){return this.components.get(d.default,!0)}createComponents(){this.name="Node",this.createComponent(i.default)}createModel(){this.name="Model",this.createComponent(h.default),this.createComponent(u.default)}fromDocument(e,t,s){const r=e.nodes[t];this.transform.fromData(r),s.set(`node/${t}`,this.transform);let i="Node";if(isFinite(r.meta)&&(this.createComponent(h.default).fromDocument(e,r),s.set(`meta/${r.meta}`,this.meta),i="Meta"),isFinite(r.model)&&(this.createComponent(u.default).fromDocument(e,r),s.set(`model/${r.model}`,this.model),i="Model"),isFinite(r.camera)&&(this.createComponent(n.default).fromDocument(e,r),s.set(`camera/${r.camera}`,this.camera),i="Camera"),isFinite(r.light)){const t=e.lights[r.light].type;switch(t){case"directional":this.createComponent(a.default).fromDocument(e,r),i="Directional Light";break;case"point":this.createComponent(l.default).fromDocument(e,r),i="Point Light";break;case"spot":this.createComponent(c.default).fromDocument(e,r),i="Spot Light";break;default:throw new Error(`unknown light type: '${t}'`)}s.set(`light/${r.light}`,this.light)}this.name=r.name||i;const o=r.children;o&&o.forEach(t=>{const r=this.graph.createCustomNode(p);this.transform.addChild(r.transform),r.fromDocument(e,t,s)})}toDocument(e,t,s){s=s||{meta:!0,setup:!0,model:!0,camera:!0,light:!0},e.nodes=e.nodes||[];const r=e.nodes.length,i=this.transform.toData();return e.nodes.push(i),t.set(this.transform,`node/${r}`),this.name&&(i.name=this.name),this.model&&s.model&&(i.model=this.model.toDocument(e,i),t.set(this.model,`model/${i.model}`)),this.camera&&s.camera&&(i.camera=this.camera.toDocument(e,i),t.set(this.camera,`camera/${i.camera}`)),this.light&&s.light&&(i.light=this.light.toDocument(e,i),t.set(this.light,`light/${i.light}`)),this.meta&&s.meta&&(i.meta=this.meta.toDocument(e,i),t.set(this.meta,`info/${i.meta}`)),this.transform.children.map(e=>e.node).filter(e=>e.is(p)).forEach(r=>{if(r.hasNodeComponents(s)){const n=r.toDocument(e,t,s);i.children=i.children||[],i.children.push(n)}}),r}hasNodeComponents(e){if(!e)return!0;const t=this.transform,s=this.components;return!(!e.model||!s.has(u.default)&&!t.hasChildComponents(u.default,!0))||(!(!e.camera||!s.has(n.default)&&!t.hasChildComponents(n.default,!0))||!(!e.light||!s.has(o.CLight)&&!t.hasChildComponents(o.CLight,!0)))}}t.default=p,p.typeName="NVNode"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(12),n=.5*Math.PI,o=new r.Box3,a=new r.Vector3,l=new r.Vector3,c=new r.Vector3,h=new r.Matrix4,u=(new r.Matrix4,[new r.Vector3(0,-n,0),new r.Vector3(0,n,0),new r.Vector3(-n,0,0),new r.Vector3(n,0,0),new r.Vector3(0,0,0),new r.Vector3(0,Math.PI,0)]);var d,p;!function(e){e[e.Perspective=0]="Perspective",e[e.Orthographic=1]="Orthographic"}(d=t.EProjection||(t.EProjection={})),function(e){e[e.None=-1]="None",e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Top=2]="Top",e[e.Bottom=3]="Bottom",e[e.Front=4]="Front",e[e.Back=5]="Back"}(p=t.EViewPreset||(t.EViewPreset={}));class f extends r.Camera{constructor(e){super(),this.isUniversalCamera=!0,this.fov=50,this.size=20,this.aspect=1,this.distance=20,this.zoom=1,this.near=.1,this.far=2e3,this.focus=10,this.filmGauge=35,this.filmOffset=0,this.view=null,this.setProjection(e)}setProjection(e){e===d.Orthographic?(this.type="OrthographicCamera",this.isPerspectiveCamera=!1,this.isOrthographicCamera=!0):(this.type="PerspectiveCamera",this.isPerspectiveCamera=!0,this.isOrthographicCamera=!1),this.updateProjectionMatrix()}getProjection(){return this.isOrthographicCamera?d.Orthographic:d.Perspective}setPreset(e){e!==p.None?(this.rotation.setFromVector3(u[e],"XYZ"),this.position.set(0,0,this.distance).applyQuaternion(this.quaternion)):(this.rotation.set(0,0,0),this.position.set(0,0,0)),this.updateMatrix()}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*r.Math.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*r.Math.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*r.Math.RAD2DEG*Math.atan(Math.tan(.5*r.Math.DEG2RAD*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,s,i,n,o){this.isPerspectiveCamera?r.PerspectiveCamera.prototype.setViewOffset.call(this,e,t,s,i,n,o):r.OrthographicCamera.prototype.setViewOffset.call(this,e,t,s,i,n,o)}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}zoomToView(){}moveToView(e){this.updateMatrixWorld(!1),o.copy(e),h.extractRotation(this.matrixWorldInverse),o.applyMatrix4(h),o.getSize(a),o.getCenter(l);const t=Math.max(a.x/this.aspect,a.y);c.set(-l.x,-l.y,0),this.isPerspectiveCamera?c.z=a.z/(2*Math.tan(this.fov*i.default.DEG2RAD*.5)):(this.size=.5*t,c.z=2*a.z,this.far=Math.max(this.far,2*c.z)),h.extractRotation(this.matrixWorld),c.applyMatrix4(h),this.matrix.decompose(this.position,this.quaternion,this.scale),this.position.copy(c),this.updateMatrix()}updateProjectionMatrix(){const e=this.near,t=this.far,s=this.aspect,i=this.zoom,n=this.view;if(this.isOrthographicCamera){const r=this.size,o=r/(2*i),a=o*s;let l=-a,c=a,h=o,u=-o;if(n&&n.enabled){const e=i/(n.width/n.fullWidth),t=i/(n.height/n.fullHeight),o=r*s/n.width,a=r/n.height;c=(l+=o*(n.offsetX/e))+o*(n.width/e),u=(h-=a*(n.offsetY/t))-a*(n.height/t)}this.projectionMatrix.makeOrthographic(l,c,h,u,e,t)}else{let a=e*Math.tan(.5*r.Math.DEG2RAD*this.fov)/i,l=2*a,c=s*l,h=-.5*c;n&&n.enabled&&(h+=n.offsetX*c/n.fullWidth,a-=n.offsetY*l/n.fullHeight,c*=n.width/n.fullWidth,l*=n.height/n.fullHeight);var o=this.filmOffset;0!==o&&(h+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(h,h+c,a,a-l,e,t)}this.projectionMatrixInverse.getInverse(this.projectionMatrix)}copy(e,t){return super.copy(e,t),this.type=e.type,this.isOrthographicCamera=e.isOrthographicCamera,this.isPerspectiveCamera=e.isPerspectiveCamera,this.fov=e.fov,this.size=e.size,this.aspect=e.aspect,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this.view=e.view?Object.assign({},e.view):null,this}clone(){return(new this.constructor).copy(this)}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.size=this.size,t.object.aspect=this.aspect,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}t.default=f},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(43);t.EUnitType=r.EUnitType,function(e){e[e.Image2D=0]="Image2D",e[e.Web3D=1]="Web3D",e[e.Print3D=2]="Print3D",e[e.Editorial3D=3]="Editorial3D"}(t.EDerivativeUsage||(t.EDerivativeUsage={})),function(e){e[e.Thumb=0]="Thumb",e[e.Low=1]="Low",e[e.Medium=2]="Medium",e[e.High=3]="High",e[e.Highest=4]="Highest",e[e.LOD=5]="LOD",e[e.Stream=6]="Stream"}(t.EDerivativeQuality||(t.EDerivativeQuality={})),function(e){e[e.Model=0]="Model",e[e.Geometry=1]="Geometry",e[e.Image=2]="Image",e[e.Texture=3]="Texture",e[e.Points=4]="Points",e[e.Volume=5]="Volume"}(t.EAssetType||(t.EAssetType={})),function(e){e[e.Color=0]="Color",e[e.Emissive=1]="Emissive",e[e.Occlusion=2]="Occlusion",e[e.Normal=3]="Normal",e[e.MetallicRoughness=4]="MetallicRoughness",e[e.Zone=5]="Zone"}(t.EMapType||(t.EMapType={}))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{static registerType(e){if(this.types[e.typeName])throw new Error(`Annotation type '${e.typeName}' already registered.`);this.types[e.typeName]=e}static registerDefaultType(e){this.defaultType=e}static get typeNames(){return[this.defaultTypeName,...Object.keys(this.types).sort()]}static get defaultTypeName(){return this.defaultType.typeName}static getType(e){const t=this.types[e]||this.defaultType;if(!t)throw new Error(`type '${e}' not registered and no default type set.`);return t}static createInstance(e,t){return t=t||e.data.style,new(this.getType(t))(e)}}t.default=r,r.types={},r.defaultType=null},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(52),n=s(23),o=s(13);class a extends i.default{constructor(e,t){super(e,t),this.ins=this.addInputs(a.ins),this.scope=i.EComponentScope.Node}get analytics(){return this.getMainComponent(o.default)}update(e){const t=this.ins;return t.visible.changed&&(t.visible.value&&!this.activeComponent&&(this.activeComponent=this.scopedComponents[0]),this.analytics.sendProperty("Tools.Visible",t.visible.value)),!0}activateComponent(e){e.activateTool(),this.analytics.sendProperty("Tools.ActiveTool",e.text)}deactivateComponent(e){e.deactivateTool()}onActiveComponent(e,t){}}t.default=a,a.typeName="CVToolProvider",a.isSystemSingleton=!0,a.componentType=n.default,a.ins={visible:r.types.Boolean("Tools.Visible")}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0);class i extends r.default{constructor(e,t){super(e,t),this.ins=this.addInputs(i.ins),this.outs=this.addOutputs(i.outs),this._fullscreenElement=null,this.onFullscreenChange=this.onFullscreenChange.bind(this);const s=document.documentElement,r=s.requestFullscreen||s.mozRequestFullScreen||s.webkitRequestFullscreen;this.outs.fullscreenAvailable.setValue(!!r),this.ins.toggle.on("value",this.toggle,this)}get fullscreenElement(){return this._fullscreenElement}set fullscreenElement(e){e!==this._fullscreenElement&&(this._fullscreenElement&&this._fullscreenElement.removeEventListener("fullscreenchange",this.onFullscreenChange),this._fullscreenElement=e,e&&e.addEventListener("fullscreenchange",this.onFullscreenChange))}update(e){return!0}toggle(){const e=this.outs,t=this._fullscreenElement;if(t){const s=e.fullscreenActive.value;if(!s&&e.fullscreenAvailable.value)t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);else if(s){const e=document;e.exitFullscreen?e.exitFullscreen():e.cancelFullScreen?e.cancelFullScreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitCancelFullScreen&&e.webkitCancelFullScreen()}}}onFullscreenChange(e){const t=document,s=t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement;this.outs.fullscreenActive.setValue(!!s)}}t.default=i,i.typeName="CFullscreen",i.ins={toggle:r.types.Event("Fullscreen.Toggle")},i.outs={fullscreenAvailable:r.types.Boolean("Fullscreen.Available",!1),fullscreenActive:r.types.Boolean("Fullscreen.Active",!1)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(8),i=[];class n extends r.default{constructor(e){super({knownEvents:!1});const t=e.typeName;if(!t)throw new Error("root type must have a 'typeName' member");this._rootTypeName=t,this._objLists={[this._rootTypeName]:[]},this._objTags={},this._objDict={}}static getTypeName(e){return"function"==typeof e?e.typeName:"object"==typeof e?e.constructor.typeName:e}add(e){const t=e.id;if("string"==typeof t){if(void 0!==this._objDict[t])throw new Error("object already registered");this._objDict[t]=e}let s,r=e;const i=this._rootTypeName,n={type:"",add:!0,remove:!1,object:e};do{(s=(r=Object.getPrototypeOf(r)).constructor.typeName)&&((this._objLists[s]||(this._objLists[s]=[])).push(e),n.type=s,this.emit(n))}while(s!==i)}remove(e){const t=e.id;if("string"==typeof t){if(this._objDict[t]!==e)throw new Error("object not registered");delete this._objDict[t]}let s,r=e;const i=this._rootTypeName,n={type:"",add:!1,remove:!0,object:e};do{if(s=(r=Object.getPrototypeOf(r)).constructor.typeName){n.type=s,this.emit(n);const t=this._objLists[s];t.splice(t.indexOf(e),1)}}while(s!==i)}addByTag(e,t){if(!e||"tag"===e)throw new Error("illegal tag name");(this._objTags[e]||(this._objTags[e]=[])).push(t);const s={type:"tag",add:!0,remove:!1,object:t,tag:e};this.emit(s),s.type=e,this.emit(s)}removeByTag(e,t){if(!e||"tag"===e)throw new Error("illegal tag name");const s=this._objTags[e];if(s){const r=s.indexOf(t);if(r>=0){const i={type:"tag",add:!1,remove:!0,object:t,tag:e};return this.emit(i),i.type=e,this.emit(i),s.splice(r,1),!0}}return!1}clear(){this.cloneArray().forEach(e=>this.remove(e))}get length(){return this._objLists[this._rootTypeName].length}count(e){const t=this._objLists[this.getTypeName(e)];return t?t.length:0}has(e){if("function"==typeof e){const t=this._objLists[e.typeName];return!!t&&t.length>0}if("string"==typeof e){const t=this._objLists[e];return!!t&&t.length>0}const t=this._objLists[e.constructor.typeName];return t&&t.indexOf(e)>=0}contains(e){const t=e.id;if("string"==typeof t)return!!this._objDict[t];const s=this._objLists[e.constructor.typeName];return s&&s.indexOf(e)>=0}get(e,t=!1){const s=this.getTypeName(e),r=this._objLists[s],i=r?r[0]:void 0;if(!t&&!i)throw new Error(`no instances of class '${s}' in object registry`);return i}getArray(e){return this._objLists[this.getTypeName(e)]||i}cloneArray(e){return this.getArray(e).slice()}getById(e){return this._objDict[e]}getDictionary(){return this._objDict}getByTag(e){return this._objTags[e]||i}on(e,t,s){super.on(this.getTypeName(e),t,s)}once(e,t,s){super.once(this.getTypeName(e),t,s)}off(e,t,s){super.off(this.getTypeName(e),t,s)}getTypeName(e){return"function"==typeof e?e.typeName:"object"==typeof e?e.constructor.typeName:e||this._rootTypeName}}t.default=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0);t.types=r.types;const i=s(77),n=s(10);t.Node=n.default;class o extends r.default{constructor(e,t){super(e,t),this.ins=this.addInputs(o.graphIns),this._innerGraph=null,this._innerRoot=null,this._innerGraph=new i.default(this.system,this)}get innerGraph(){return this._innerGraph}get innerNodes(){return this._innerGraph.nodes}get innerComponents(){return this._innerGraph.components}get innerRoots(){return this._innerGraph.roots}getInnerComponent(e,t=!1){return this._innerGraph.components.get(e,t)}getInnerComponents(e){return this._innerGraph.components.getArray(e)}hasInnerComponent(e){return this._innerGraph.components.has(e)}getInnerNode(e,t=!1){return this._innerGraph.nodes.get(e,t)}getInnerNodes(e){return this._innerGraph.nodes.getArray(e)}hasInnerNode(e){return this._innerGraph.nodes.has(e)}isEmpty(){return 0===this._innerGraph.nodes.count()}update(e){const t=this.ins;if(t.active.changed){const e=t.active.value;e!==this._innerGraph.isActive&&(e?this.activateInnerGraph():this.deactivateInnerGraph())}return!0}tick(e){return this._innerGraph.tick(e)}tock(e){return this._innerGraph.tock(e)}dispose(){this._innerGraph.clear(),this._innerGraph=null,this._innerRoot=null,super.dispose()}clearInnerGraph(){this._innerGraph.clear()}fromJSON(e){super.fromJSON(e),this._innerGraph.clear(),this._innerGraph.fromJSON(e.graph)}toJSON(){const e=super.toJSON();return e.graph=this._innerGraph.toJSON(),e}dump(e=""){super.dump(e),this.innerGraph.dump(e+"  ")}onAddInnerRoot(e){}onRemoveInnerRoot(e){}activateInnerGraph(){this._innerGraph.activate()}deactivateInnerGraph(){this._innerGraph.deactivate()}}t.default=o,o.typeName="CGraph",o.graphIns={active:r.types.Boolean("Graph.Active",!0)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(8),i=s(30);class n extends r.default{constructor(e){super(),this.addEvents("update","dispose"),e?this.fromJSON(e):this._data=this.init()}static generateId(){return i.default()}get id(){return this._data.id}get data(){return this._data}set(e,t){this._data[e]=t,this.update()}get(e){return this._data[e]}update(){this.emit({type:"update",document:this})}dispose(){this.emit({type:"dispose",document:this}),this._data=null}fromJSON(e){return this._data={},this.inflate(e,this._data),this.update(),this}toJSON(e){return e=e||{},this.deflate(this._data,e),e}init(){return{}}inflate(e,t){Object.assign(t,e)}deflate(e,t){t=t||{},Object.assign(t,this._data)}}t.default=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.mm=0]="mm",e[e.cm=1]="cm",e[e.m=2]="m",e[e.km=3]="km",e[e.in=4]="in",e[e.ft=5]="ft",e[e.yd=6]="yd",e[e.mi=7]="mi"}(t.EUnitType||(t.EUnitType={}))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(100);t.Vector3=r.default;const i=s(212);t.Vector4=i.default;class n{constructor(e=0,t=0,s=0,r=1){e instanceof n?(this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w):Array.isArray(e)?(this.x=e[0]||0,this.y=e[1]||0,this.z=e[2]||0,this.w=void 0!==e[3]?e[3]:1):"string"==typeof e?this.setString(e):(this.x=e,this.y=t,this.z=s,this.w=r)}static fromString(e){return(new n).setString(e)}static fromArray(e){return new n(e)}get r(){return this.x}get g(){return this.y}get b(){return this.z}get a(){return this.w}set r(e){this.x=e}set g(e){this.y=e}set b(e){this.z=e}set a(e){this.w=e}get red(){return this.x}get green(){return this.y}get blue(){return this.z}get alpha(){return this.w}set red(e){this.x=e}set green(e){this.y=e}set blue(e){this.z=e}set alpha(e){this.w=e}get redByte(){return Math.floor(255*this.x)}get greenByte(){return Math.floor(255*this.y)}get blueByte(){return Math.floor(255*this.z)}get alphaByte(){return Math.floor(255*this.w)}set redByte(e){this.x=e/255}set greenByte(e){this.y=e/255}set blueByte(e){this.z=e/255}set alphaByte(e){this.w=e/255}inverseMultiply(e){return this.x=this.x*(1-e)+e,this.y=this.y*(1-e)+e,this.z=this.z*(1-e)+e,this}multiply(e){return this.x*=e,this.y*=e,this.z*=e,this}copy(e){this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w}clone(){return new n(this.x,this.y,this.z,this.w)}set(e,t,s,r){return this.x=e,this.y=t,this.z=s,this.w=void 0===r?1:r,this}setBytes(e,t,s,r){return this.x=e/255,this.y=t/255,this.z=s/255,this.w=void 0===r?1:r/255,this}setUInt24RGB(e){return this.x=e>>16&255,this.y=e>>8&255,this.z=255&e,this.w=1,this}setUInt32RGBA(e){return this.x=e>>24&255,this.y=e>>16&255,this.z=e>>8&255,this.w=255&e,this.w=1,this}setRed(e){return this.x=e,this}setGreen(e){return this.y=e,this}setBlue(e){return this.z=e,this}setAlpha(e){return this.w=e,this}setRedByte(e){return this.x=e/255,this}setGreenByte(e){return this.y=e/255,this}setBlueByte(e){return this.z=e/255,this}setAlphaByte(e){return this.w=e/255,this}setHSV(e,t=1,s=1,r){"object"==typeof e&&(t=e.y,s=e.z,r=void 0!==e.w?e.w:r,e=e.x);const i=Math.floor(e/60),n=e/60-i,o=s*(1-t),a=s*(1-n*t),l=s*(1-(1-n)*t);let c,h,u;switch(i%6){case 0:c=s,h=l,u=o;break;case 1:c=a,h=s,u=o;break;case 2:c=o,h=s,u=l;break;case 3:c=o,h=a,u=s;break;case 4:c=l,h=o,u=s;break;case 5:c=s,h=o,u=a}return this.x=c,this.y=h,this.z=u,void 0!==r&&(this.w=r),this}setHSL(e,t=1,s=1,r){if("object"==typeof e&&(t=e.y,s=e.z,r=void 0!==e.w?e.w:r,e=e.x),0===t)this.x=this.y=this.z=s;else{function i(e,t,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?e+6*(t-e)*s:s<.5?t:s<2/3?e+(t-e)*(2/3-s)*6:e}e/=360;var n=s<.5?s*(1+t):s+t-s*t,o=2*s-n;this.x=i(o,n,e+1/3),this.y=i(o,n,e),this.z=i(o,n,e-1/3)}return void 0!==r&&(this.w=r),this}fromArray(e){this.x=e[0]||0,this.y=e[1]||0,this.z=e[2]||0,this.w=void 0!==e[3]?e[3]:1}setString(e,t=1,s=!0){e=e.trim().toLowerCase();let r=(e=n.presets[e]||e).match(/^#?([0-9a-f]{3})$/i);if(r){const e=r[1],s=1/15;return this.x=Number.parseInt(e.charAt(0),16)*s,this.y=Number.parseInt(e.charAt(1),16)*s,this.z=Number.parseInt(e.charAt(2),16)*s,this.w=t,this}if(r=e.match(/^#?([0-9a-f]{6})$/i)){const e=r[1],s=1/255;return this.x=Number.parseInt(e.substr(0,2),16)*s,this.y=Number.parseInt(e.substr(2,2),16)*s,this.z=Number.parseInt(e.substr(4,2),16)*s,this.w=t,this}if(0===e.indexOf("rgb")){let s=e.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i);if(s){const e=1/255;return this.x=Number.parseInt(s[1])*e,this.y=Number.parseInt(s[2])*e,this.z=Number.parseInt(s[3])*e,this.w=t,this}if(s=e.match(/^rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+.*\d*)\s*\)$/i)){const e=1/255;return this.x=Number.parseInt(s[1])*e,this.y=Number.parseInt(s[2])*e,this.z=Number.parseInt(s[3])*e,this.w=Number.parseFloat(s[4]),this}}if(0===e.indexOf("hsl")){let s=e.match(/(\d+(\.\d+)?)/g);return s&&this.setHSL(Number.parseFloat(s[0]),.01*Number.parseFloat(s[1]),.01*Number.parseFloat(s[2]),void 0!==s[3]?Number.parseFloat(s[3]):t),this}if(s)throw new RangeError("failed to parse color from string: "+e);return this}toUInt24RGB(){return Math.floor(255*this.x)<<16+Math.floor(255*this.y)<<8+Math.floor(255*this.z)}toUInt32RGBA(){return Math.floor(255*this.x)<<24+Math.floor(255*this.y)<<16+Math.floor(255*this.z)<<8+Math.floor(255*this.w)}toVector3(e){return e?(e.x=this.r,e.y=this.g,e.z=this.b,e):new r.default(this.r,this.g,this.b)}toVector4(e){return e?(e.x=this.r,e.y=this.g,e.z=this.b,e.w=this.a,e):new i.default(this.r,this.g,this.b,this.a)}toHSV(e){let t=this.x,s=this.y,i=this.z,n=Math.min(t,s,i),o=Math.max(t,s,i),a=o-n,l=0,c=0===o?0:a/o,h=o;return 0!==a&&(l=60*(t===o?(s-i)/a+(s<i?6:0):s===o?(i-t)/a+2:(t-s)/a+4)),e?(e.x=l,e.y=c,e.z=h,e):new r.default(l,c,h)}toHSL(e){let t=this.x,s=this.y,i=this.z,n=Math.min(t,s,i),o=Math.max(t,s,i),a=o-n,l=0,c=0,h=.5*(o+n);return 0!==a&&(c=h>.5?a/(2-o-n):a/(o+n),l=60*(t===o?(s-i)/a+(s<i?6:0):s===o?2+(i-t)/a:4+(t-s)/a)),e?(e.x=l,e.y=c,e.z=h,e):new r.default(l,c,h)}toRGBArray(e){return e?(e[0]=this.r,e[1]=this.g,e[2]=this.b,e):[this.r,this.g,this.b]}toRGBAArray(e){return e?(e[0]=this.r,e[1]=this.g,e[2]=this.b,e[3]=this.a,e):[this.r,this.g,this.b,this.a]}toString(e=!0){if(e&&this.w<1)return`rgba(${this.redByte}, ${this.greenByte}, ${this.blueByte}, ${this.w})`;return`#${((1<<24)+(this.redByte<<16)+(this.greenByte<<8)+this.blueByte).toString(16).slice(1)}`}}t.default=n,n.presets={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(21),n=s(105),o=s(106),a=s(62),l=s(64),c=s(108),h=s(110),u=s(111),d=s(65),p=s(112),f=s(113),m=s(66);class v extends r.default{get featureMap(){return this.constructor.featureMap}get transform(){return this.getComponent(i.default)}create(){super.create();const e=this.node,t=v.featureMap;for(const s in t)this[s]=e.createComponent(t[s]);this.snapshots=e.createComponent(m.default)}fromDocument(e,t,s){const r=e.scenes[t];if(!isFinite(r.setup))throw new Error("setup property missing in node");const i=e.setups[r.setup],n=v.featureMap;for(const e in n){s.set(`scenes/${t}/setup/${e}`,this[e]);const r=i[e];r&&this[e].fromData(r)}i.snapshots&&this.snapshots.fromData(i.snapshots,s)}toDocument(e,t,s){let r=null;const i=v.featureMap;for(const e in i){s.set(this[e],`scenes/${t}/setup/${e}`);const i=this[e].toData();i&&((r=r||{})[e]=i)}const n=this.snapshots.toData(s);if(n&&((r=r||{}).snapshots=n),r){e.setups=e.setups||[];const s=e.setups.length;e.setups.push(r),e.scenes[t].setup=s}}}t.default=v,v.typeName="CVSetup",v.featureMap={interface:n.default,reader:a.default,viewer:o.default,navigation:l.default,background:c.default,floor:h.default,grid:u.default,tape:d.default,slicer:p.default,tours:f.default}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(78),n=s(34),o=s(29);class a extends i.default{constructor(e,t){super(e,t),this.outs=this.addOutputs(a.outs),this.scope=i.ENodeScope.Graph}get documentProvider(){return this.getComponent(o.default)}create(){super.create(),this.documentProvider.on("active-component",this.onActiveDocument,this)}dispose(){this.documentProvider.off("active-component",this.onActiveDocument,this),super.dispose()}onActiveDocument(e){this.scopedGraph=e.next}onActiveNode(e,t){this.outs.activeNode.setValue(t);const s=this.selection;t?s.nodeContainsSelectedComponent(t)||s.selectNode(t):e&&s.clearSelection()}onScopedNodes(){this.outs.changedNodes.set()}}t.default=a,a.typeName="CVNodeProvider",a.nodeType=n.default,a.followComponentSelection=!0,a.outs={activeNode:r.types.Object("Nodes.Active",n.default),changedNodes:r.types.Event("Nodes.Changed")}},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(2);s(7);let n=class extends i.default{constructor(){super(...arguments),this.property=null,this.name="",this.options=null,this.indexMap=null}firstConnected(){this.classList.add("sv-property-view","sv-property-options")}update(e){if(!this.property)throw new Error("missing property attribute");if("number"!==this.property.type||!this.property.schema.options)throw new Error("not an options property");if(e.has("property")){const t=e.get("property");t&&t.off("value",this.onUpdate,this),this.property&&this.property.on("value",this.onUpdate,this)}super.update(e)}render(){const e=this.property,t=this.indexMap,s=this.name||e.name,r=this.options||e.schema.options,n=e.value;let o;return o=t?t.map(e=>i.html`<ff-button .text=${r[e]} .index=${e} .selectedIndex=${n} @click=${this.onButtonClick}>
                    </ff-button>`):r.map((e,t)=>i.html`<ff-button .text=${e} .index=${t} .selectedIndex=${n} @click=${this.onButtonClick}>
                    </ff-button>`),i.html`<label class="ff-label ff-off">${s}</label><div class="sv-options">${o}</div>`}onButtonClick(e){const t=e.target.index;this.property.setValue(t)}};r([i.property({attribute:!1})],n.prototype,"property",void 0),r([i.property({type:String})],n.prototype,"name",void 0),r([i.property({attribute:!1})],n.prototype,"options",void 0),r([i.property({attribute:!1})],n.prototype,"indexMap",void 0),n=r([i.customElement("sv-property-options")],n),t.default=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(130);t.labels={xyzw:["X","Y","Z","W"],rgba:["R","G","B","A"]};const i=function(e){return void 0===e||"object"==typeof e&&!Array.isArray(e)?e:{preset:e}};t.makeType=function(e,t,s){return{path:t,schema:(s=i(s))?Object.assign({},e,s):e}},t.makeEnumType=function(e,t,s){s=i(s);const n={enum:e,options:r.enumToArray(e),preset:0};return{path:t,schema:s?Object.assign({},n,s):n}},t.makeOptionType=function(e,t,s){const r={options:e,preset:0};return{path:t,schema:(s=i(s))?Object.assign({},r,s):r}},t.makeObjectType=function(e,t,s){const r={preset:null,objectType:e};return{path:t,schema:(s=i(s))?Object.assign({},r,s):r}},t.schemas={Number:{preset:0},Integer:{preset:0,step:1,speed:.34,precision:0},Natural:{preset:0,step:1,speed:.34,precision:0,min:0},Unit:{preset:0,min:0,max:1,bar:!0},Percent:{preset:0,min:0,max:1,bar:!0,percent:!0},Vector2:{preset:[0,0]},Vector3:{preset:[0,0,0]},Vector4:{preset:[0,0,0,0]},Matrix2:{preset:[1,0,0,1]},Matrix3:{preset:[1,0,0,0,1,0,0,0,1]},Matrix4:{preset:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},Scale:{preset:1},Scale2:{preset:[1,1]},Scale3:{preset:[1,1,1]},IntVec2:{preset:[0,0],step:1,speed:.34,precision:0},IntVec3:{preset:[0,0,0],step:1,speed:.34,precision:0},ColorRGB:{preset:[1,1,1],semantic:"color",labels:t.labels.rgba,min:0,max:1,bar:!0},ColorRGBA:{preset:[1,1,1,1],semantic:"color",labels:t.labels.rgba,min:0,max:1,bar:!0},Boolean:{preset:!1},String:{preset:""},AssetPath:{preset:"",semantic:"asset-path"},Object:{preset:null,objectType:Object},Event:{preset:0,event:!0}},t.types={Property:(e,s)=>t.makeType(void 0,e,s),Number:(e,s)=>t.makeType(t.schemas.Number,e,s),Integer:(e,s)=>t.makeType(t.schemas.Integer,e,s),Natural:(e,s)=>t.makeType(t.schemas.Natural,e,s),Unit:(e,s)=>t.makeType(t.schemas.Unit,e,s),Percent:(e,s)=>t.makeType(t.schemas.Percent,e,s),Vector2:(e,s)=>t.makeType(t.schemas.Vector2,e,s),Vector3:(e,s)=>t.makeType(t.schemas.Vector3,e,s),Vector4:(e,s)=>t.makeType(t.schemas.Vector4,e,s),IntVec2:(e,s)=>t.makeType(t.schemas.IntVec2,e,s),IntVec3:(e,s)=>t.makeType(t.schemas.IntVec3,e,s),Matrix2:(e,s)=>t.makeType(t.schemas.Matrix2,e,s),Matrix3:(e,s)=>t.makeType(t.schemas.Matrix3,e,s),Matrix4:(e,s)=>t.makeType(t.schemas.Matrix4,e,s),Scale:(e,s)=>t.makeType(t.schemas.Scale,e,s),Scale2:(e,s)=>t.makeType(t.schemas.Scale2,e,s),Scale3:(e,s)=>t.makeType(t.schemas.Scale3,e,s),ColorRGB:(e,s)=>t.makeType(t.schemas.ColorRGB,e,s),ColorRGBA:(e,s)=>t.makeType(t.schemas.ColorRGBA,e,s),Boolean:(e,s)=>t.makeType(t.schemas.Boolean,e,s),String:(e,s)=>t.makeType(t.schemas.String,e,s),AssetPath:(e,s)=>t.makeType(t.schemas.AssetPath,e,s),Enum:(e,s,r)=>t.makeEnumType(s,e,r),Option:(e,s,r)=>t.makeOptionType(s,e,r),Object:(e,s,r)=>t.makeObjectType(s,e,r),Event:(e,s)=>t.makeType(t.schemas.Event,e,s)}},function(e,t,s){"use strict";var r,i=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const n=s(2);t.html=n.html;let o=r=class extends n.default{constructor(e){super(),this.template=null,this.name=e||""}static add(e,t){if(r.templates[e])throw new Error(`icon already registered: '${e}'`);r.templates[e]=t}static getTemplateNames(){return Object.keys(r.templates)}firstConnected(){this.classList.add("ff-icon")}render(){if(this.name){const e=this.constructor.templates[this.name];return e||console.warn(`icon not found: '${this.name}'`),e}return this.template?this.template:n.html`[icon undefined]`}};o.templates={},i([n.property({attribute:!1})],o.prototype,"template",void 0),i([n.property({type:String})],o.prototype,"name",void 0),o=r=i([n.customElement("ff-icon")],o),t.default=o,o.add("empty",n.html``),o.add("check",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"/></svg>`),o.add("close",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512"><path d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"/></svg>`),o.add("grip",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M149.333 56v80c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V56c0-13.255 10.745-24 24-24h101.333c13.255 0 24 10.745 24 24zm181.334 240v-80c0-13.255-10.745-24-24-24H205.333c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24h101.333c13.256 0 24.001-10.745 24.001-24zm32-240v80c0 13.255 10.745 24 24 24H488c13.255 0 24-10.745 24-24V56c0-13.255-10.745-24-24-24H386.667c-13.255 0-24 10.745-24 24zm-32 80V56c0-13.255-10.745-24-24-24H205.333c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24h101.333c13.256 0 24.001-10.745 24.001-24zm-205.334 56H24c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24h101.333c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24zM0 376v80c0 13.255 10.745 24 24 24h101.333c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H24c-13.255 0-24 10.745-24 24zm386.667-56H488c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H386.667c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24zm0 160H488c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H386.667c-13.255 0-24 10.745-24 24v80c0 13.255 10.745 24 24 24zM181.333 376v80c0 13.255 10.745 24 24 24h101.333c13.255 0 24-10.745 24-24v-80c0-13.255-10.745-24-24-24H205.333c-13.255 0-24 10.745-24 24z"/></svg>`),o.add("up",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6 0-33.9L207 39c9.4-9.4 24.6-9.4 33.9 0l194.3 194.3c9.4 9.4 9.4 24.6 0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"/></svg>`),o.add("down",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M413.1 222.5l22.2 22.2c9.4 9.4 9.4 24.6 0 33.9L241 473c-9.4 9.4-24.6 9.4-33.9 0L12.7 278.6c-9.4-9.4-9.4-24.6 0-33.9l22.2-22.2c9.5-9.5 25-9.3 34.3.4L184 343.4V56c0-13.3 10.7-24 24-24h32c13.3 0 24 10.7 24 24v287.4l114.8-120.5c9.3-9.8 24.8-10 34.3-.4z"/></svg>`),o.add("caret-up",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M288.662 352H31.338c-17.818 0-26.741-21.543-14.142-34.142l128.662-128.662c7.81-7.81 20.474-7.81 28.284 0l128.662 128.662c12.6 12.599 3.676 34.142-14.142 34.142z"/></svg>`),o.add("caret-down",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z"/></svg>`),o.add("folder",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 128H272l-64-64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V176c0-26.51-21.49-48-48-48z"/></svg>`),o.add("file",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zM332.1 128H256V51.9l76.1 76.1zM48 464V48h160v104c0 13.3 10.7 24 24 24h104v288H48z"/></svg>`),o.add("info",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"/></svg>`),o.add("warning",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/></svg>`),o.add("error",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"/></svg>`),o.add("prompt",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zM262.655 90c-54.497 0-89.255 22.957-116.549 63.758-3.536 5.286-2.353 12.415 2.715 16.258l34.699 26.31c5.205 3.947 12.621 3.008 16.665-2.122 17.864-22.658 30.113-35.797 57.303-35.797 20.429 0 45.698 13.148 45.698 32.958 0 14.976-12.363 22.667-32.534 33.976C247.128 238.528 216 254.941 216 296v4c0 6.627 5.373 12 12 12h56c6.627 0 12-5.373 12-12v-1.333c0-28.462 83.186-29.647 83.186-106.667 0-58.002-60.165-102-116.531-102zM256 338c-25.365 0-46 20.635-46 46 0 25.364 20.635 46 46 46s46-20.636 46-46c0-25.365-20.635-46-46-46z"/></svg>`)},function(e,t,s){"use strict";var r,i=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0}),s(49);const n=s(2),o={info:"ff-info",success:"ff-success",warning:"ff-warning",error:"ff-error"},a={info:"info",success:"check",warning:"warning",error:"error"},l={info:2e3,success:2e3,warning:5e3,error:0};let c=r=class extends n.default{constructor(e,t,s){super(),this._handler=0,this.on("transitionend",this.remove.bind(this)),this.message=e||"<messge>",this.level=t||"info",this.timeout=void 0!==s?s:l[this.level];const i=document.getElementById(r.stackId);i?i.appendChild(this):console.warn(`element '#${r.stackId}' not found`)}static show(e,t,s){new r(e,t,s)}close(){this._handler>0&&(window.clearTimeout(this._handler),this._handler=0),this.classList.add("ff-out")}firstUpdated(){this.classList.add("ff-notification",o[this.level]),this.timeout>0&&(this._handler=window.setTimeout(()=>this.close(),this.timeout))}render(){const e=a[this.level];return n.html`<ff-icon name=${e}></ff-icon>
            <div class="ff-text">${this.message}</div>
            <ff-button inline icon="close" @click=${this.onClose}>`}onClose(e){e.stopPropagation(),this.close()}};c.stackId="ff-notification-stack",i([n.property({type:String})],c.prototype,"message",void 0),i([n.property({type:String})],c.prototype,"level",void 0),i([n.property({type:Number})],c.prototype,"timeout",void 0),c=r=i([n.customElement("ff-notification")],c),t.default=c,t.info=(e,t)=>new c(e,"info",t),t.success=(e,t)=>new c(e,"success",t),t.warning=(e,t)=>new c(e,"warning",t),t.error=(e,t)=>new c(e,"error",t)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0);class i extends r.default{constructor(e,t){super(e,t),this.outs=this.addOutputs(i.pulseOuts),this._systemUpdated=!1,this.addEvent("pulse"),this.onAnimationFrame=this.onAnimationFrame.bind(this),this.context={time:new Date,secondsElapsed:0,secondsDelta:0,frameNumber:0},this._secondsStarted=.001*Date.now(),this._secondsStopped=this._secondsStarted,this._animHandler=0,this._pulseEvent={type:"pulse",context:this.context,systemUpdated:!1}}start(){0===this._animHandler&&(this._secondsStopped>0&&(this._secondsStarted+=.001*Date.now()-this._secondsStopped,this._secondsStopped=0),this._animHandler=window.requestAnimationFrame(this.onAnimationFrame))}stop(){0!==this._animHandler&&(0===this._secondsStopped&&(this._secondsStopped=.001*Date.now()),window.cancelAnimationFrame(this._animHandler),this._animHandler=0)}pulse(e){const t=this.context,s=this.outs;t.time.setTime(e);const r=.001*e-this._secondsStarted;t.secondsDelta=r-t.secondsElapsed,t.secondsElapsed=r,t.frameNumber++,s.time.setValue(t.secondsElapsed),s.frame.setValue(t.frameNumber),this._pulseEvent.systemUpdated=this.system.graph.tick(this.context)||this._systemUpdated,this.emit(this._pulseEvent),this._systemUpdated=this.system.graph.tock(this.context)}onAnimationFrame(){this.pulse(Date.now()),this._animHandler=window.requestAnimationFrame(this.onAnimationFrame)}}t.default=i,i.typeName="CPulse",i.isSystemSingleton=!0,i.pulseOuts={time:r.types.Number("Pulse.Time"),frame:r.types.Integer("Pulse.Frame")}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(10),n=s(53);var o;!function(e){e[e.Node=0]="Node",e[e.Graph=1]="Graph",e[e.Main=2]="Main",e[e.System=3]="System"}(o=t.EComponentScope||(t.EComponentScope={}));class a extends r.default{constructor(){super(...arguments),this._scope=o.Node,this._scopedNode=null,this._scopedGraph=null,this._activeComponent=null}get componentType(){return this.constructor.componentType}get followComponentSelection(){return this.constructor.followComponentSelection}get followNodeSelection(){return this.constructor.followNodeSelection}get retainSelection(){return this.constructor.retainSelection}get scope(){return this._scope}set scope(e){this._scope=e,this._activeComponent&&!this.isComponentInScope(this._activeComponent)&&(this.activeComponent=null)}get scopedNode(){return this._scopedNode}set scopedNode(e){e!==this._scopedNode&&(this._scopedNode=e,this._activeComponent&&!this.isComponentInScope(this._activeComponent)&&(this.activeComponent=null),this.onScopedComponents(),this.emit({type:"scoped-components"}))}get scopedGraph(){return this._scopedGraph}set scopedGraph(e){e!==this._scopedGraph&&(this._scopedGraph=e,this._activeComponent&&!this.isComponentInScope(this._activeComponent)&&(this.activeComponent=null),this.onScopedComponents(),this.emit({type:"scoped-components"}))}get scopedComponents(){switch(this._scope){case o.Node:return(this._scopedNode||this.node).getComponents(this.componentType);case o.Graph:return(this._scopedGraph?this._scopedGraph.innerGraph:this.graph).getComponents(this.componentType);case o.Main:return this.getMainComponents(this.componentType);case o.System:return this.getSystemComponents(this.componentType)}}get activeComponent(){return this._activeComponent}set activeComponent(e){const t=this.activeComponent;if(e!==t){if(t&&this.deactivateComponent(t),e){if(!this.isComponentInScope(e))throw new Error("can't activate, component out of scope");this.activateComponent(e)}this._activeComponent=e,this.onActiveComponent(t,e),this.emit({type:"active-component",previous:t,next:e})}}get selection(){return this.getSystemComponent(n.default)}create(){super.create(),this.system.components.on(r.default,this.onComponent,this),this.followComponentSelection&&this.selection.selectedComponents.on(this.componentType,this.onSelectComponent,this),this.followNodeSelection&&this.selection.selectedNodes.on(i.default,this.onSelectNode,this)}dispose(){this.activeComponent&&(this.activeComponent=null),this.system.components.off(r.default,this.onComponent,this),this.followComponentSelection&&this.selection.selectedComponents.off(this.componentType,this.onSelectComponent,this),this.followNodeSelection&&this.selection.selectedNodes.off(i.default,this.onSelectNode,this),super.dispose()}activateComponent(e){}deactivateComponent(e){}onActiveComponent(e,t){}onScopedComponents(){}onComponent(e){e.remove&&e.object===this.activeComponent&&(this.activeComponent=null),this.isComponentInScope(e.object)&&(this.onScopedComponents(),this.emit({type:"scoped-components"}))}onSelectComponent(e){const t=e.object;this.isComponentInScope(t)&&(e.add?this.activeComponent=t:e.remove&&!this.retainSelection&&t===this.activeComponent&&(this.activeComponent=null))}onSelectNode(e){const t=e.object;if(this.isNodeInScope(t)){const s=t.getComponent(this.componentType);s&&this.onSelectComponent({type:s.typeName,object:s,add:e.add,remove:e.remove})}}isComponentInScope(e){if(!e.is(this.componentType))return!1;switch(this._scope){case o.Node:const t=this._scopedNode||this.node;return e.node===t;case o.Graph:const s=this._scopedGraph?this._scopedGraph.innerGraph:this.graph;return e.graph===s;case o.Main:return e.graph===this.system.graph;case o.System:return!0}return!1}isNodeInScope(e){switch(this._scope){case o.Node:return e===(this._scopedNode||this.node);case o.Graph:const t=this._scopedGraph?this._scopedGraph.innerGraph:this.graph;return e.graph===t;case o.Main:return e.graph===this.system.graph;case o.System:return!0}}}t.default=a,a.typeName="CComponentProvider",a.componentType=r.default,a.followComponentSelection=!0,a.followNodeSelection=!1,a.retainSelection=!0},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(40),i=s(48),n=s(0),o=s(10),a=s(41),l=s(140);class c extends l.default{constructor(e,t){super(e,t),this.outs=this.addOutputs(c.selOuts),this.multiSelect=!1,this.exclusiveSelect=!0,this.selectedNodes=new r.default(o.default),this.selectedComponents=new r.default(n.default),this._activeGraph=null,this.addEvents("select-node","select-component","active-graph","update"),this.selectedNodes.on(o.default,e=>this.onSelectNode(e.object,e.add)),this.selectedComponents.on(n.default,e=>this.onSelectComponent(e.object,e.add)),this._activeGraph=this.system.graph}getSelectedNode(e){return this.selectedNodes.get(e,!0)}getSelectedNodes(e){return this.selectedNodes.getArray(e)}getSelectedComponent(e){return this.selectedComponents.get(e,!0)}getSelectedComponents(e){return this.selectedComponents.getArray(e)}get activeGraph(){return this._activeGraph}set activeGraph(e){if(e!==this.activeGraph){this.clearSelection();const t=this._activeGraph;this._activeGraph=e,this.onActiveGraph(e),this.emit({type:"active-graph",previous:t,next:e})}}hasParentGraph(){return this._activeGraph&&this._activeGraph.parent}activateParentGraph(){this._activeGraph&&this._activeGraph.parent.graph&&(this.activeGraph=this._activeGraph.parent.graph)}hasChildGraph(){return this.selectedComponents.has(a.default)}activateChildGraph(){const e=this.selectedComponents.get(a.default,!0);e&&(this.activeGraph=e.innerGraph)}create(){super.create(),this.system.nodes.on(o.default,this.onSystemNode,this),this.system.components.on(n.default,this.onSystemComponent,this)}dispose(){this.system.nodes.off(o.default,this.onSystemNode,this),this.system.components.off(n.default,this.onSystemComponent,this),super.dispose()}createActions(e){return{selectNode:e.register({name:"Select Node",do:this.selectNode,target:this}),selectComponent:e.register({name:"Select Component",do:this.selectComponent,target:this}),clearSelection:e.register({name:"Clear Selection",do:this.clearSelection,target:this})}}nodeContainsSelectedComponent(e){const t=e.components.getArray();for(let e=0,s=t.length;e<s;++e)if(this.selectedComponents.contains(t[e]))return!0;return!1}selectNode(e,t=!1){this.activeGraph=e.graph;const s=this.selectedNodes,r=this.multiSelect&&t;e&&s.contains(e)?r&&s.remove(e):(this.exclusiveSelect&&this.selectedComponents.clear(),r||s.clear(),e&&s.add(e)),this.updateStats()}selectComponent(e,t=!1){this.activeGraph=e.graph;const s=this.selectedComponents,r=this.multiSelect&&t;e&&s.contains(e)?r&&s.remove(e):(this.exclusiveSelect&&this.selectedNodes.clear(),r||s.clear(),e&&s.add(e)),this.updateStats()}clearSelection(){this.selectedNodes.clear(),this.selectedComponents.clear(),this.updateStats()}onSelectNode(e,t){}onSelectComponent(e,t){}onActiveGraph(e){}onSystemNode(e){e.remove&&this.selectedNodes.contains(e.object)&&(this.selectedNodes.remove(e.object),this.updateStats())}onSystemComponent(e){e.remove&&this.selectedComponents.contains(e.object)&&(this.selectedComponents.remove(e.object),this.updateStats())}updateStats(){const e=this.outs;e.selNodeCount.setValue(this.selectedNodes.length),e.selComponentCount.setValue(this.selectedComponents.length)}}t.default=c,c.typeName="CSelection",c.selOuts={selNodeCount:i.types.Integer("Selection.Nodes"),selComponentCount:i.types.Integer("Selection.Components")}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=new r.Vector3,n=new r.Matrix4,o=new r.Euler;new r.Quaternion;t.degreesToQuaternion=function(e,t,s){const n=s||new r.Quaternion;return i.fromArray(e).multiplyScalar(r.Math.DEG2RAD),o.setFromVector3(i,t),n.setFromEuler(o),n},t.quaternionToDegrees=function(e,t,s){const n=s||[0,0,0];return o.setFromQuaternion(e,t),o.toVector3(i),i.multiplyScalar(r.Math.RAD2DEG).toArray(n),n},t.disposeObject=function(e){const t=new Map,s=new Map,r=new Map;e.traverse(e=>{const i=e;if(i.isMesh){const e=i.geometry;e&&t.set(e.uuid,e);const n=i.material;if(n){s.set(n.uuid,n);for(let e in n){const t=n[e];t&&t.isTexture&&r.set(t.uuid,t)}}}});for(let e of r)e[1].dispose();for(let e of s)e[1].dispose();for(let e of t)e[1].dispose()},t.computeLocalBoundingBox=function e(t,s,r){r||(r=t);const o=t.geometry;if(o&&t.visible){let e=t;for(n.identity();e&&e!==r;)n.premultiply(e.matrix),e=e.parent;if(o.isGeometry){const e=o.vertices;for(let t=0,r=e.length;t<r;++t)i.copy(e[t]).applyMatrix4(n),s.expandByPoint(i)}else if(o.isBufferGeometry){const e=o.attributes.position;if(void 0!==e)for(let t=0,r=e.count;t<r;++t)i.fromBufferAttribute(e,t).applyMatrix4(n),s.expandByPoint(i)}}const a=t.children;for(let t=0,i=a.length;t<i;++t)e(a[t],s,r)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(143),n=s(144),o=s(145),a=new r.Vector3,l=new r.Box3(new r.Vector3(-1e4,-1e4,-1e4),new r.Vector3(1e4,1e4,1e4));t.default=class{constructor(e){this.renderer=e,this.pickTextures=[];for(let e=0;e<3;++e)this.pickTextures[e]=new r.WebGLRenderTarget(1,1,{stencilBuffer:!1});this.pickBuffer=new Uint8Array(4),this.indexShader=new i.default,this.positionShader=new n.default,this.normalShader=new o.default}static add(e,t){const s=e=>{e.material&&(e.onBeforeRender=function(t,s,r,i,n){n.isIndexShader&&n.setIndex(e.id)})};t?e.traverse(e=>s(e)):s(e)}static remove(e,t){const s=e=>{e.material&&(e.onBeforeRender=null)};t?e.traverse(e=>s(e)):s(e)}pickObject(e,t,s){const r=this.pickIndex(e,t,s);if(r>0)return e.getObjectById(r)}pickIndex(e,t,s){const r=s.viewport;t=r.updateCamera(t);const i=e.overrideMaterial;e.overrideMaterial=this.indexShader;const n=this.renderer,o=this.pickTextures[0],a=n.getClearColor().clone();r.applyPickViewport(o,s),n.setRenderTarget(o),n.setClearColor(0),n.clear(),n.render(e,t),n.setRenderTarget(null),n.setClearColor(a),e.overrideMaterial=i;const l=this.pickBuffer;return n.readRenderTargetPixels(o,0,0,1,1,l),l[0]+256*l[1]+65536*l[2]}pickPosition(e,t,s,i,n){i=i||l,n=n||new r.Vector3;const o=s.viewport;t=o.updateCamera(t);const c=e.overrideMaterial,h=e.overrideMaterial=this.positionShader,u=this.renderer,d=this.pickTextures,p=u.getClearColor().clone();u.setClearColor(0);for(let r=0;r<3;++r)h.uniforms.index.value=r,h.uniforms.range.value[0]=i.min.getComponent(r),h.uniforms.range.value[1]=i.max.getComponent(r),o.applyPickViewport(d[r],s),u.setRenderTarget(d[r]),u.clear(),u.render(e,t);u.setRenderTarget(null),u.setClearColor(p),e.overrideMaterial=c;const f=this.pickBuffer;for(let e=0;e<3;++e)u.readRenderTargetPixels(d[e],0,0,1,1,f),n.setComponent(e,2.337437050015319e-10*f[3]+5.983838848039216e-8*f[2]+1531862745098039e-20*f[1]+.003921568627451*f[0]);return i.getSize(a),n.multiply(a).add(i.min)}pickNormal(e,t,s,i){i=i||new r.Vector3;const n=s.viewport;t=n.updateCamera(t);const o=e.overrideMaterial;e.overrideMaterial=this.normalShader;const a=this.renderer,l=this.pickTextures[0],c=a.getClearColor().clone();n.applyPickViewport(l,s),a.setRenderTarget(l),a.setClearColor(0),a.clear(),a.render(e,t),a.setRenderTarget(null),a.setClearColor(c),e.overrideMaterial=o;const h=this.pickBuffer;return a.readRenderTargetPixels(l,0,0,1,1,h),i.set(h[0]/255*2-1,h[1]/255*2-1,h[2]/255*2-1).normalize()}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(152).default,n=s(153).default,o=s(33);t.EShaderMode=o.EShaderMode;class a extends r.MeshStandardMaterial{constructor(e){super(),this._clayColor=new r.Color("#a67a6c"),this._wireColor=new r.Color("#004966"),this._wireEmissiveColor=new r.Color("#004966"),this._objectSpaceNormalMap=!1,this._paramCopy={},this._sideCopy=r.FrontSide,this.type="UberPBRMaterial",this.isUberPBRMaterial=!0,this.isMeshStandardMaterial=!0,this.isMeshPhysicalMaterial=!1,this.defines={STANDARD:!0,PHYSICAL:!1,OBJECTSPACE_NORMALMAP:!1,MODE_NORMALS:!1,MODE_XRAY:!1,CUT_PLANE:!1},this.uniforms=r.UniformsUtils.merge([r.ShaderLib.standard.uniforms,{aoMapMix:{value:new r.Vector3(.25,.25,.25)},cutPlaneDirection:{value:new r.Vector4(0,0,-1,0)},cutPlaneColor:{value:new r.Vector3(1,0,0)}}]),this._aoMapMix=this.uniforms.aoMapMix.value,this._cutPlaneDirection=this.uniforms.cutPlaneDirection.value,this._cutPlaneColor=this.uniforms.cutPlaneColor.value,this.vertexShader=n,this.fragmentShader=i,this.color=new r.Color(16777215),this.roughness=.7,this.metalness=0,e&&this.setValues(e)}set cutPlaneDirection(e){this._cutPlaneDirection.copy(e)}get cutPlaneDirection(){return this._cutPlaneDirection}set cutPlaneColor(e){this._cutPlaneColor.copy(e)}get cutPlaneColor(){return this._cutPlaneColor}set aoMapMix(e){this._aoMapMix.copy(e)}get aoMapMix(){return this._aoMapMix}setShaderMode(e){switch(Object.assign(this,this._paramCopy),this.defines.MODE_NORMALS=!1,this.defines.MODE_XRAY=!1,this.defines.OBJECTSPACE_NORMALMAP=this.normalMap&&this._objectSpaceNormalMap,this.needsUpdate=!0,e){case o.EShaderMode.Clay:this._paramCopy={color:this.color,map:this.map,roughness:this.roughness,metalness:this.metalness,aoMapIntensity:this.aoMapIntensity,blending:this.blending,transparent:this.transparent,depthWrite:this.depthWrite},this.color=this._clayColor,this.map=null,this.roughness=1,this.metalness=0,this.aoMapIntensity*=1,this.blending=r.NoBlending,this.transparent=!1,this.depthWrite=!0;break;case o.EShaderMode.Normals:this._paramCopy={blending:this.blending,transparent:this.transparent,depthWrite:this.depthWrite},this.defines.MODE_NORMALS=!0,this.blending=r.NoBlending,this.transparent=!1,this.depthWrite=!0;break;case o.EShaderMode.XRay:this._paramCopy={side:this.side,blending:this.blending,transparent:this.transparent,depthWrite:this.depthWrite},this.defines.MODE_XRAY=!0,this.side=r.DoubleSide,this.blending=r.AdditiveBlending,this.transparent=!0,this.depthWrite=!1;break;case o.EShaderMode.Wireframe:this._paramCopy={color:this.color,emissive:this.emissive,roughness:this.roughness,metalness:this.metalness,wireframe:this.wireframe,map:this.map,aoMap:this.aoMap,emissiveMap:this.emissiveMap,normalMap:this.normalMap},this.color=this._wireColor,this.emissive=this._wireEmissiveColor,this.roughness=.8,this.metalness=.1,this.wireframe=!0,this.map=null,this.aoMap=null,this.emissiveMap=null,this.normalMap=null,this.defines.OBJECTSPACE_NORMALMAP=!1}}enableCutPlane(e){this.defines.CUT_PLANE=e,e?(this._sideCopy=this.side,this.side=r.DoubleSide):this.side=this._sideCopy}enableObjectSpaceNormalMap(e){e!==this._objectSpaceNormalMap&&(this._objectSpaceNormalMap=e),this.normalMap&&(this.defines.OBJECTSPACE_NORMALMAP=e,this.needsUpdate=!0)}copyStandardMaterial(e){return this.color=e.color,this.roughness=e.roughness,this.roughnessMap=e.roughnessMap,this.metalness=e.metalness,this.metalnessMap=e.metalnessMap,this.map=e.map,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.normalMap=e.normalMap,this}}t.default=a},function(e,t,s){"use strict";var r=s(163),i=s(58),n=s(27),o=s(84),a=s(165);function l(e,t,s){var r=this._refs[s];if("string"==typeof r){if(!this._refs[r])return l.call(this,e,t,r);r=this._refs[r]}if((r=r||this._schemas[s])instanceof o)return f(r.schema,this._opts.inlineRefs)?r.schema:r.validate||this._compile(r);var i,n,a,h=c.call(this,t,s);return h&&(i=h.schema,t=h.root,a=h.baseId),i instanceof o?n=i.validate||e.call(this,i.schema,t,void 0,a):void 0!==i&&(n=f(i,this._opts.inlineRefs)?i:e.call(this,i,t,void 0,a)),n}function c(e,t){var s=r.parse(t),i=v(s),n=m(this._getId(e.schema));if(0===Object.keys(e.schema).length||i!==n){var a=y(i),l=this._refs[a];if("string"==typeof l)return h.call(this,e,l,s);if(l instanceof o)l.validate||this._compile(l),e=l;else{if(!((l=this._schemas[a])instanceof o))return;if(l.validate||this._compile(l),a==y(t))return{schema:l,root:e,baseId:n};e=l}if(!e.schema)return;n=m(this._getId(e.schema))}return d.call(this,s,n,e.schema,e)}function h(e,t,s){var r=c.call(this,e,t);if(r){var i=r.schema,n=r.baseId;e=r.root;var o=this._getId(i);return o&&(n=b(n,o)),d.call(this,s,n,i,e)}}e.exports=l,l.normalizeId=y,l.fullPath=m,l.url=b,l.ids=function(e){var t=y(this._getId(e)),s={"":t},o={"":m(t,!1)},l={},c=this;return a(e,{allKeys:!0},(function(e,t,a,h,u,d,p){if(""!==t){var f=c._getId(e),m=s[h],v=o[h]+"/"+u;if(void 0!==p&&(v+="/"+("number"==typeof p?p:n.escapeFragment(p))),"string"==typeof f){f=m=y(m?r.resolve(m,f):f);var g=c._refs[f];if("string"==typeof g&&(g=c._refs[g]),g&&g.schema){if(!i(e,g.schema))throw new Error('id "'+f+'" resolves to more than one schema')}else if(f!=y(v))if("#"==f[0]){if(l[f]&&!i(e,l[f]))throw new Error('id "'+f+'" resolves to more than one schema');l[f]=e}else c._refs[f]=v}s[t]=m,o[t]=v}})),l},l.inlineRef=f,l.schema=c;var u=n.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function d(e,t,s,r){if(e.fragment=e.fragment||"","/"==e.fragment.slice(0,1)){for(var i=e.fragment.split("/"),o=1;o<i.length;o++){var a=i[o];if(a){if(void 0===(s=s[a=n.unescapeFragment(a)]))break;var l;if(!u[a]&&((l=this._getId(s))&&(t=b(t,l)),s.$ref)){var h=b(t,s.$ref),d=c.call(this,r,h);d&&(s=d.schema,r=d.root,t=d.baseId)}}}return void 0!==s&&s!==r.schema?{schema:s,root:r,baseId:t}:void 0}}var p=n.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function f(e,t){return!1!==t&&(void 0===t||!0===t?function e(t){var s;if(Array.isArray(t)){for(var r=0;r<t.length;r++)if("object"==typeof(s=t[r])&&!e(s))return!1}else for(var i in t){if("$ref"==i)return!1;if("object"==typeof(s=t[i])&&!e(s))return!1}return!0}(e):t?function e(t){var s,r=0;if(Array.isArray(t)){for(var i=0;i<t.length;i++)if("object"==typeof(s=t[i])&&(r+=e(s)),r==1/0)return 1/0}else for(var n in t){if("$ref"==n)return 1/0;if(p[n])r++;else if("object"==typeof(s=t[n])&&(r+=e(s)+1),r==1/0)return 1/0}return r}(e)<=t:void 0)}function m(e,t){return!1!==t&&(e=y(e)),v(r.parse(e))}function v(e){return r.serialize(e).split("#")[0]+"#"}var g=/#\/?$/;function y(e){return e?e.replace(g,""):""}function b(e,t){return t=y(t),r.resolve(e,t)}},function(e,t,s){"use strict";var r=Array.isArray,i=Object.keys,n=Object.prototype.hasOwnProperty;e.exports=function e(t,s){if(t===s)return!0;if(t&&s&&"object"==typeof t&&"object"==typeof s){var o,a,l,c=r(t),h=r(s);if(c&&h){if((a=t.length)!=s.length)return!1;for(o=a;0!=o--;)if(!e(t[o],s[o]))return!1;return!0}if(c!=h)return!1;var u=t instanceof Date,d=s instanceof Date;if(u!=d)return!1;if(u&&d)return t.getTime()==s.getTime();var p=t instanceof RegExp,f=s instanceof RegExp;if(p!=f)return!1;if(p&&f)return t.toString()==s.toString();var m=i(t);if((a=m.length)!==i(s).length)return!1;for(o=a;0!=o--;)if(!n.call(s,m[o]))return!1;for(o=a;0!=o--;)if(!e(t[l=m[o]],s[l]))return!1;return!0}return t!=t&&s!=s}},function(e,t,s){"use strict";var r=s(57);function i(e,t,s){this.message=s||i.message(e,t),this.missingRef=r.url(e,t),this.missingSchema=r.normalizeId(r.fullPath(this.missingRef))}function n(e){return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}e.exports={Validation:n((function(e){this.message="validation failed",this.errors=e,this.ajv=this.validation=!0})),MissingRef:n(i)},i.message=function(e,t){return"can't resolve reference "+t+" from id "+e}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(21),n=new r.Vector3,o=new r.Vector3,a=new r.Matrix4,l=new r.Quaternion,c=new r.Euler;class h extends i.default{get settingProperties(){return[this.ins.position,this.ins.rotation,this.ins.scale]}get snapshotProperties(){return[this.ins.position,this.ins.rotation,this.ins.scale]}fromData(e){const{position:t,rotation:s,order:h,scale:u}=this.ins,d=i.ERotationOrder[h.getValidatedValue()];e.matrix?(a.fromArray(e.matrix),a.decompose(n,l,o),n.toArray(t.value),c.setFromQuaternion(l,d),c.toVector3(n).multiplyScalar(r.Math.RAD2DEG).toArray(s.value),o.toArray(u.value),t.set(),s.set(),u.set()):(e.translation&&t.setValue(e.translation.slice()),e.rotation&&(l.fromArray(e.rotation),c.setFromQuaternion(l,d),c.toVector3(n).multiplyScalar(r.Math.RAD2DEG).toArray(s.value),s.set()),e.scale&&u.setValue(e.scale.slice()),this.transform.changed=!0)}toData(){this.object3D.matrix.decompose(n,l,o);const e={};return 0===n.x&&0===n.y&&0===n.z||(e.translation=n.toArray()),0===l.x&&0===l.y&&0===l.z&&1===l.w||(e.rotation=l.toArray()),1===o.x&&1===o.y&&1===o.z||(e.scale=o.toArray()),e}}t.default=h,h.typeName="CVNode",h.text="Transform",h.icon=""},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(210),n=s(11),o=s(15),a=s(28),l=s(62),c=s(99);t.Annotation=c.default;const h=s(37);s(211),s(213),s(214);class u extends n.default{constructor(e,t){super(e,t),this.ins=this.addInputs(u.ins),this._activeAnnotation=null,this._annotations={},this._viewports=new Set,this._sprites={},this.addEvents("active-annotation","group"),this.onSpriteClick=this.onSpriteClick.bind(this),this.onSpriteLink=this.onSpriteLink.bind(this),this.on("pointer-up",this.onPointerUp,this),this.system.on("pointer-up",this.onSystemPointerUp,this),this.object3D=new i.default}get model(){return this.getComponent(o.default)}get meta(){return this.getComponent(a.default,!0)}get reader(){return this.getGraphComponent(l.default,!0)}get articles(){const e=this.meta;return e?e.articles:null}get activeAnnotation(){return this._activeAnnotation}set activeAnnotation(e){if(e!==this._activeAnnotation){const t=this._activeAnnotation;t&&(t.set("expanded",!1),this.updateSprite(t)),this._activeAnnotation=e,e&&(e.set("expanded",!0),this.updateSprite(e));const s=this.ins;s.marker.setValue(e?e.data.marker:"",!0),s.title.setValue(e?e.data.title:"",!0),s.lead.setValue(e?e.data.lead:"",!0),s.tags.setValue(e?e.data.tags.join(", "):"",!0),s.style.setOption(e?e.data.style:h.default.defaultTypeName,!0),s.scale.setValue(e?e.data.scale:1,!0),s.offset.setValue(e?e.data.offset:0,!0),s.tilt.setValue(e?e.data.tilt:0,!0),s.azimuth.setValue(e?e.data.azimuth:0,!0),s.color.setValue(e?e.data.color.slice():[1,1,1],!0);const r=this.articles;if(r){const t=r.items.map(e=>e.data.title);t.unshift("(none)"),s.article.setOptions(t);const i=e?r.getById(e.data.articleId):null;s.article.setValue(i?r.getIndexOf(i)+1:0,!0)}else s.article.setOptions(["(none)"]),s.article.setValue(0);s.image.setValue(e?e.data.imageUri:"",!0),this.emit({type:"annotation-update",annotation:e})}}setActiveAnnotationById(e){this.activeAnnotation=this._annotations[e]}update(e){super.update(e);const t=this.ins,s=this.object3D,r=this.activeAnnotation;if(t.unitScale.changed&&(s.scale.setScalar(t.unitScale.value),s.updateMatrix()),t.activeTags.changed){const e=t.activeTags.value.split(",").map(e=>e.trim()).filter(e=>e);for(const t in this._annotations){const s=this._annotations[t],r=s.data.tags;let i=0===r.length;e.forEach(e=>{r.indexOf(e)>=0&&(i=!0)}),s.set("visible",i),this.updateSprite(s)}}if(r){if(t.marker.changed&&r.set("marker",t.marker.value),t.title.changed&&r.set("title",t.title.value),t.lead.changed&&r.set("lead",t.lead.value),t.tags.changed&&(r.set("tags",t.tags.value.split(",").map(e=>e.trim()).filter(e=>e)),this.emit({type:"tag-update"})),t.style.changed&&(r.set("style",t.style.getOptionText()),this.createSprite(r)),t.scale.changed&&r.set("scale",t.scale.value),t.offset.changed&&r.set("offset",t.offset.value),t.tilt.changed&&r.set("tilt",t.tilt.value),t.azimuth.changed&&r.set("azimuth",t.azimuth.value),t.color.changed&&r.set("color",t.color.value.slice()),t.image.changed&&r.set("imageUri",t.image.value),t.article.changed){const e=this.articles,s=e&&e.getAt(t.article.getValidatedValue()-1);r.set("articleId",s?s.id:"")}this.updateSprite(r),this.emit({type:"annotation-update",annotation:r})}return!0}tock(){if(this.updated)return!0}postRender(e){const t=e.viewport;this._viewports.has(t)||(t.on("dispose",this.onViewportDispose,this),this._viewports.add(t)),this.object3D.render(t.overlay,e.camera)}dispose(){this.object3D.dispose(),this.off("pointer-up",this.onPointerUp,this),this.system.off("pointer-up",this.onSystemPointerUp,this),this._viewports.forEach(e=>e.off("dispose",this.onViewportDispose,this)),this._viewports.clear(),super.dispose()}getAnnotations(){return Object.keys(this._annotations).map(e=>this._annotations[e])}addAnnotation(e){this._annotations[e.id]=e,this.createSprite(e),this.changed=!0}removeAnnotation(e){const t=Object.keys(this._annotations);if(delete this._annotations[e.id],this.removeSprite(e),e===this.activeAnnotation){const s=Math.min(t.indexOf(e.id)+1,t.length-1);this.activeAnnotation=s<0?null:this._annotations[t[s]]}this.changed=!0}updateAnnotation(e){this.changed=!0}toJSON(){const e=super.toJSON(),t=this.toData();return t&&(e.data=t),e}fromJSON(e){e.data&&this.fromData(e.data)}toData(){const e=Object.keys(this._annotations);return 0===e.length?null:e.map(e=>this._annotations[e].toJSON())}fromData(e){e.forEach(e=>this.addAnnotation(new c.default(e))),this.emit({type:"tag-update"})}onPointerUp(e){if(e.isDragging)return;let t=e.object3D;for(;t&&!t.isHTMLSprite;)t=t.parent;const s=t&&t.annotation;s&&(this.emit({type:"click",sprite:t,annotation:s}),e.stopPropagation=!0)}onSystemPointerUp(e){e.isDragging||this.emit({type:"click",sprite:null,annotation:null})}onViewportDispose(e){this.object3D.disposeHTMLElements(e.viewport.overlay)}onSpriteClick(e){this.emit(e)}onSpriteLink(e){this.reader&&(this.reader.ins.articleId.setValue(e.annotation.data.articleId),this.reader.ins.enabled.setValue(!0))}createSprite(e){this.removeSprite(e);const t=h.default.createInstance(e);t.addEventListener("click",this.onSpriteClick),t.addEventListener("link",this.onSpriteLink),this._sprites[e.id]=t,this.object3D.add(t),this.registerPickableObject3D(t,!0)}removeSprite(e){const t=this._sprites[e.id];t&&(t.removeEventListener("click",this.onSpriteClick),t.removeEventListener("link",this.onSpriteLink),t.dispose(),this._sprites[e.id]=void 0,this.object3D.remove(t),this.unregisterPickableObject3D(t,!0))}updateSprite(e){const t=this._sprites[e.id];t&&t.update()}}t.default=u,u.typeName="CVAnnotationView",u.ins={unitScale:r.types.Number("Transform.UnitScale",{preset:1,precision:5}),activeTags:r.types.String("Tags.Active"),title:r.types.String("Annotation.Title"),lead:r.types.String("Annotation.Lead"),marker:r.types.String("Annotation.Marker"),tags:r.types.String("Annotation.Tags"),style:r.types.Option("Annotation.Style",h.default.typeNames),scale:r.types.Scale("Annotation.Scale",{preset:1,precision:3}),offset:r.types.Number("Annotation.Offset",{preset:0,precision:3}),article:r.types.Option("Annotation.Article",[]),image:r.types.String("Annotation.Image"),tilt:r.types.Number("Annotation.Tilt"),azimuth:r.types.Number("Annotation.Azimuth"),color:r.types.ColorRGB("Annotation.Color")}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(33);t.EReaderPosition=i.EReaderPosition;const n=s(96);t.Article=n.default;const o=s(34),a=s(28),l=s(19),c=s(32),h=s(13);class u extends r.default{constructor(){super(...arguments),this.ins=this.addInputs(u.ins),this.outs=this.addOutputs(u.outs)}get settingProperties(){return[this.ins.enabled,this.ins.position]}get snapshotProperties(){return[this.ins.enabled,this.ins.articleId]}get articles(){return Object.keys(this._articles).map(e=>this._articles[e])}get activeArticle(){return this.outs.article.value}get assetManager(){return this.getMainComponent(l.default)}get assetReader(){return this.getMainComponent(c.default)}get analytics(){return this.getMainComponent(h.default)}create(){super.create(),this.graph.components.on(a.default,this.onMetaComponent,this),this.updateArticles()}dispose(){this.graph.components.off(a.default,this.onMetaComponent,this),super.dispose()}update(e){const t=this.ins,s=this.outs;if(t.enabled.changed&&this.analytics.sendProperty("Reader.Enabled",t.enabled.value),t.articleId.changed){const e=this._articles[t.articleId.value]||null,r=e&&e.article;s.node.setValue(e&&e.node),s.article.setValue(r),s.content.setValue(""),r&&(this.readArticle(r),this.analytics.sendProperty("Reader.ArticleId",r.data.title))}return!0}readArticle(e){const t=this.outs,s=e.data.uri;if(s)return this.assetReader.getText(s).then(e=>this.parseArticle(e,s)).then(e=>t.content.setValue(e)).catch(e=>t.content.setValue(`<h2>Article not found at ${s}</h2>`));t.content.setValue("<h2>Can't display article: no URI.</h2>")}parseArticle(e,t){e=e.replace(/[\n\r]/g,"");const s=this.assetManager.getAssetBasePath(t);return e=e.replace(/(src=\")(.*?)(\")/g,(e,t,r,i)=>(r.startsWith("/")||r.startsWith("http")||(r=this.assetManager.getAssetUrl(s+r)),t+r+i)),Promise.resolve(e)}onMetaComponent(e){e.add&&e.object.articles.on("update",this.updateArticles,this),e.remove&&e.object.articles.off("update",this.updateArticles,this),this.updateArticles()}updateArticles(){const e=this.getGraphComponents(a.default),t=this._articles={};e.forEach(e=>{const s=e.articles,r=e.node;s.items.forEach(e=>{t[e.id]={article:e,node:r}})});const s=e[0];s&&s.leadArticle?this.ins.articleId.setValue(s.leadArticle.id):this.ins.articleId.setValue("")}fromData(e){e=e||{},this.ins.setValues({enabled:!!e.enabled,position:i.EReaderPosition[e.position]||i.EReaderPosition.Overlay,articleId:e.articleId||""})}toData(){const e=this.ins,t={enabled:e.enabled.value,position:i.EReaderPosition[e.position.value]||"Overlay"};return e.articleId.value&&(t.articleId=e.articleId.value),t}}t.default=u,u.typeName="CVReader",u.text="Reader",u.icon="",u.ins={enabled:r.types.Boolean("Reader.Enabled"),position:r.types.Enum("Reader.Position",i.EReaderPosition),articleId:r.types.String("Article.ID")},u.outs={article:r.types.Object("Article.Active",n.default),content:r.types.String("Article.Content"),node:r.types.Object("Article.Node",o.default)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(98);t.html=i.html;const n=s(99);t.Annotation=n.default;const o=new r.Vector3(0,1,0),a=new r.Vector3;class l extends i.default{constructor(e){super(),this.annotation=e,this.matrixAutoUpdate=!1}get typeName(){return this.constructor.typeName}update(){super.update();const e=this.annotation.data;this.position.fromArray(e.position),a.fromArray(e.direction).normalize(),this.quaternion.setFromUnitVectors(o,a),this.updateMatrix()}emitClickEvent(){const e={type:"click",annotation:this.annotation,sprite:this};this.dispatchEvent(e)}emitLinkEvent(e){const t={type:"link",annotation:this.annotation,sprite:this,link:e};this.dispatchEvent(t)}}t.default=l,l.typeName="Annotation";class c extends i.SpriteElement{constructor(e){super(),this.sprite=e,this.discardEvent=this.discardEvent.bind(this),this.addEventListener("pointerdown",this.discardEvent),this.addEventListener("pointermove",this.discardEvent),this.addEventListener("pointerup",this.discardEvent),this.addEventListener("pointercancel",this.discardEvent),this.addEventListener("click",this.discardEvent)}firstConnected(){super.firstConnected(),this.classList.add("sv-annotation")}discardEvent(e){e.stopPropagation()}}t.AnnotationElement=c},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(11),n=s(107),o=s(21),a=s(35);t.EProjection=a.EProjection;const l=s(22),c=s(19);var h;!function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Top=2]="Top",e[e.Bottom=3]="Bottom",e[e.Front=4]="Front",e[e.Back=5]="Back",e[e.None=6]="None"}(h=t.EViewPreset||(t.EViewPreset={}));new r.Vector3;const u=[];u[h.Left]=[0,-90,0],u[h.Right]=[0,90,0],u[h.Front]=[0,0,0],u[h.Back]=[0,180,0],u[h.Top]=[-90,0,0],u[h.Bottom]=[90,0,0];const d=function(e,t){for(let s=0,r=e.length;s<r;++s)e[s]=null===e[s]?t:e[s];return e};class p extends i.default{constructor(e,t){super(e,t),this.ins=this.addInputs(p.ins),this._controller=new n.default,this._scene=null,this._modelBoundingBox=null,this._hasChanged=!1,this._scene=this.scene}get settingProperties(){return[this.ins.enabled,this.ins.orbit,this.ins.offset,this.ins.autoZoom,this.ins.autoRotation,this.ins.lightsFollowCamera,this.ins.minOrbit,this.ins.minOffset,this.ins.maxOrbit,this.ins.maxOffset]}get snapshotProperties(){return[this.ins.orbit,this.ins.offset]}get assetManager(){return this.getMainComponent(c.default)}create(){super.create(),this.system.on(["pointer-down","pointer-up","pointer-move"],this.onPointer,this),this.system.on("wheel",this.onTrigger,this),this.assetManager.outs.completed.on("value",this.onLoadingCompleted,this)}dispose(){this.assetManager.outs.completed.off("value",this.onLoadingCompleted,this),this.system.off(["pointer-down","pointer-up","pointer-move"],this.onPointer,this),this.system.off("wheel",this.onTrigger,this),super.dispose()}update(){const e=this.ins,t=this._controller,s=this._scene.activeCameraComponent,r=s?s.camera:null,{projection:i,preset:n,orbit:a,offset:c}=e;if(s&&i.changed&&(r.setProjection(i.getValidatedValue()),s.ins.projection.setValue(i.value,!0)),n.changed&&n.value!==h.None&&a.setValue(u[n.getValidatedValue()].slice()),r&&e.zoomExtents.changed){const e=this.getGraphComponent(l.default);this._modelBoundingBox=e.outs.boundingBox.value,t.zoomExtents(this._modelBoundingBox)}if(e.lightsFollowCamera.changed){const t=this.getLightTransform();t&&(e.lightsFollowCamera.value?(t.ins.order.setValue(o.ERotationOrder.ZXY),t.ins.rotation.reset(),t.ins.rotation.linkFrom(a,1,1)):(t.ins.rotation.unlinkFrom(a,1,1),t.ins.rotation.reset()))}const{minOrbit:d,minOffset:p,maxOrbit:f,maxOffset:m}=e;return(a.changed||c.changed)&&(t.orbit.fromArray(a.value),t.offset.fromArray(c.value)),(d.changed||p.changed||f.changed||m.changed)&&(t.minOrbit.fromArray(d.value),t.minOffset.fromArray(p.value),t.maxOrbit.fromArray(f.value),t.maxOffset.fromArray(m.value)),!0}tick(){const e=this.ins,t=this._scene.activeCameraComponent;if(!e.enabled.value||!t)return;const s=this._controller;s.camera=t.camera;const r=t.transform,i=this.changed;return!!s.updateCamera(r.object3D,i)&&(s.orbit.toArray(e.orbit.value),e.orbit.set(!0),s.offset.toArray(e.offset.value),e.offset.set(!0),e.preset.value===h.None||e.preset.changed||e.preset.setValue(h.None,!0),r?r.setPropertiesFromMatrix():t.setPropertiesFromMatrix(),!0)}preRender(e){this._modelBoundingBox&&e.viewport.zoomExtents(this._modelBoundingBox)}tock(){return this._modelBoundingBox=null,!1}fromData(e){const t=(e=e||{}).orbit||{orbit:[-25,-25,0],offset:[0,0,100],minOrbit:[-90,-1/0,-1/0],minOffset:[-1/0,-1/0,.1],maxOrbit:[90,1/0,1/0],maxOffset:[1/0,1/0,1/0]};this.ins.copyValues({enabled:!!e.enabled,autoZoom:!!e.autoZoom,autoRotation:!!e.autoRotation,lightsFollowCamera:!!e.lightsFollowCamera,orbit:t.orbit,offset:t.offset,minOrbit:d(t.minOrbit,-1/0),maxOrbit:d(t.maxOrbit,1/0),minOffset:d(t.minOffset,-1/0),maxOffset:d(t.maxOffset,1/0)})}toData(){const e=this.ins,t={};return t.enabled=e.enabled.value,t.autoZoom=e.autoZoom.value,t.autoRotation=e.autoRotation.value,t.lightsFollowCamera=e.lightsFollowCamera.value,t.type="Orbit",t.orbit={orbit:e.orbit.cloneValue(),offset:e.offset.cloneValue(),minOrbit:e.minOrbit.cloneValue(),maxOrbit:e.maxOrbit.cloneValue(),minOffset:e.minOffset.cloneValue(),maxOffset:e.maxOffset.cloneValue()},t}getLightTransform(){const e=this.graph.findNodeByName("Lights");return e&&e.getComponent(o.default,!0)}onPointer(e){const t=e.viewport;t.camera||(this.ins.enabled.value&&this._scene.activeCameraComponent&&(this._controller.setViewportSize(t.width,t.height),this._controller.onPointer(e),e.stopPropagation=!0),this._hasChanged=!0)}onTrigger(e){const t=e.viewport;t.camera||(this.ins.enabled.value&&this._scene.activeCameraComponent&&(this._controller.setViewportSize(t.width,t.height),this._controller.onTrigger(e),e.stopPropagation=!0),this._hasChanged=!0)}onLoadingCompleted(e){this.ins.autoZoom.value&&!this._hasChanged&&this.ins.zoomExtents.set()}}t.default=p,p.typeName="CVOrbitNavigation",p.text="Orbit Navigation",p.icon="",p.ins={enabled:i.types.Boolean("Settings.Enabled",!0),preset:i.types.Enum("Camera.ViewPreset",h,h.None),projection:i.types.Enum("Camera.Projection",a.EProjection,a.EProjection.Perspective),lightsFollowCamera:i.types.Boolean("Navigation.LightsFollowCam",!0),autoRotation:i.types.Boolean("Navigation.AutoRotation",!1),zoomExtents:i.types.Event("Settings.ZoomExtents"),autoZoom:i.types.Boolean("Settings.AutoZoom",!0),orbit:i.types.Vector3("Current.Orbit",[-25,-25,0]),offset:i.types.Vector3("Current.Offset",[0,0,100]),minOrbit:i.types.Vector3("Limits.Min.Orbit",[-90,-1/0,-1/0]),minOffset:i.types.Vector3("Limits.Min.Offset",[-1/0,-1/0,.1]),maxOrbit:i.types.Vector3("Limits.Max.Orbit",[90,1/0,1/0]),maxOffset:i.types.Vector3("Limits.Max.Offset",[1/0,1/0,1/0])}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(11),n=s(236),o=s(15),a=s(22),l=new r.Matrix3,c=new r.Vector3,h=new r.Vector3,u=new r.Vector3(0,1,0);var d;!function(e){e[e.SetStart=0]="SetStart",e[e.SetEnd=1]="SetEnd"}(d=t.ETapeState||(t.ETapeState={}));class p extends i.default{constructor(e,t){super(e,t),this.ins=this.addInputs(p.tapeIns),this.outs=this.addOutputs(p.tapeOuts),this.startPin=null,this.endPin=null,this.line=null,this.object3D=new r.Group,this.startPin=new n.default,this.startPin.matrixAutoUpdate=!1,this.startPin.visible=!1,this.endPin=new n.default,this.endPin.matrixAutoUpdate=!1,this.endPin.visible=!1;const s=new r.Geometry;s.vertices.push(new r.Vector3(0,0,0),new r.Vector3(0,0,0));const i=new r.LineBasicMaterial;i.depthTest=!1,i.transparent=!0,this.line=new r.Line(s,i),this.line.visible=!1,this.object3D.add(this.startPin,this.endPin,this.line)}get settingProperties(){return[this.ins.visible]}get snapshotProperties(){return[this.ins.visible,this.ins.startPosition,this.ins.startDirection,this.ins.endPosition,this.ins.endDirection]}create(){super.create();const e=this.getGraphComponent(a.default);this.ins.boundingBox.linkFrom(e.outs.boundingBox)}update(e){super.update(e);const t=this.ins,s=this.line.geometry;if(t.boundingBox.changed&&t.boundingBox.value){t.boundingBox.value.getSize(c);const e=.5*c.length();this.startPin.scale.setScalar(.003*e),this.startPin.updateMatrix(),this.endPin.scale.setScalar(.003*e),this.endPin.updateMatrix()}if(t.visible.changed&&(t.visible.value?this.system.on("pointer-up",this.onPointerUp,this):this.system.off("pointer-up",this.onPointerUp,this)),t.startPosition.changed||t.startDirection.changed){const e=this.startPin;e.position.fromArray(t.startPosition.value),c.fromArray(t.startDirection.value),e.quaternion.setFromUnitVectors(u,c),e.updateMatrix(),s.vertices[0].copy(e.position),s.verticesNeedUpdate=!0}if(t.endPosition.changed||t.endDirection.changed){const e=this.endPin;e.position.fromArray(t.endPosition.value),c.fromArray(t.endDirection.value),e.quaternion.setFromUnitVectors(u,c),e.updateMatrix(),s.vertices[1].copy(e.position),s.verticesNeedUpdate=!0}return c.fromArray(t.startPosition.value),h.fromArray(t.endPosition.value),this.outs.distance.setValue(c.distanceTo(h)),!0}fromData(e){this.ins.copyValues({visible:e.enabled,startPosition:e.startPosition,startDirection:e.startDirection,endPosition:e.endPosition,endDirection:e.endDirection})}toData(){const e=this.ins;return{enabled:e.visible.cloneValue(),startPosition:e.startPosition.cloneValue(),startDirection:e.startDirection.cloneValue(),endPosition:e.endPosition.cloneValue(),endDirection:e.endDirection.cloneValue()}}onPointerUp(e){if(e.isDragging||!e.component||!e.component.is(o.default))return;const t=e.component.object3D.matrixWorld;l.getNormalMatrix(t);const s=e.view.pickPosition(e).applyMatrix4(t),r=e.view.pickNormal(e).applyMatrix3(l).normalize(),{startPin:i,endPin:n,line:a,ins:c,outs:h}=this;h.state.value===d.SetStart?(s.toArray(c.startPosition.value),r.toArray(c.startDirection.value),c.startPosition.set(),c.startDirection.set(),i.visible=!0,n.visible=!1,a.visible=!1,h.state.setValue(d.SetEnd)):(s.toArray(c.endPosition.value),r.toArray(c.endDirection.value),c.endPosition.set(),c.endDirection.set(),i.visible=!0,n.visible=!0,a.visible=!0,h.state.setValue(d.SetStart))}}t.default=p,p.typeName="CVTape",p.text="Tape",p.icon="",p.tapeIns={startPosition:i.types.Vector3("Start.Position"),startDirection:i.types.Vector3("Start.Direction"),endPosition:i.types.Vector3("End.Position"),endDirection:i.types.Vector3("End.Direction"),boundingBox:i.types.Object("Scene.BoundingBox",r.Box3)},p.tapeOuts={state:i.types.Enum("Tape.State",d),distance:i.types.Number("Tape.Distance")}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(79);t.EEasingCurve=r.EEasingCurve;const i=s(14),n=s(45),o=s(15);class a extends r.default{constructor(){super(...arguments),this.targetFeatures={}}create(){super.create();const e=this.getGraphComponent(n.default);Object.keys(e.featureMap).forEach(e=>{this.targetFeatures[e]=!1}),this.targetFeatures.models=!1,this.targetFeatures.lights=!1,this.initializeTargetFeatures()}initializeTargetFeatures(){const e=this.targetFeatures;Object.keys(e).forEach(t=>e[t]=!1),e.navigation=!0,e.reader=!0,this.updateTargets()}updateTargets(){const e=this.targetFeatures,t=this.getGraphComponent(n.default);Object.keys(e).forEach(s=>{const r=t[s],i=e[s];r&&this.updateComponentTarget(r,i)}),this.getGraphComponents(o.default).forEach(t=>this.updateComponentTarget(t.transform,!!e.models)),this.getGraphComponents(i.default).forEach(t=>this.updateComponentTarget(t,!!e.lights))}updateComponentTarget(e,t){const s=e.snapshotProperties;s&&s.forEach(e=>{if(!e.schema.event&&"object"!==e.type){const s=this.hasTargetProperty(e);t&&!s?this.addTargetProperty(e):!t&&s&&this.removeTargetProperty(e)}})}fromData(e,t){this.clear();const s=this.targetFeatures,i=Object.keys(s);e.features?i.forEach(t=>s[t]=e.features.indexOf(t)>=0):this.initializeTargetFeatures();const n=new Set;e.targets.forEach((e,s)=>{const r=e.lastIndexOf("/"),i=e.substr(0,r),o=e.substr(r+1),a=t.get(i),l=a?a.ins[o]:null;l?this.addTargetProperty(l):(console.warn(`missing snapshot target property for '${e}'`),n.add(s))}),e.states.forEach(e=>{this.setState({id:e.id,curve:void 0!==e.curve?r.EEasingCurve[e.curve]:r.EEasingCurve.EaseQuad,duration:void 0!==e.duration?e.duration:2,threshold:void 0!==e.threshold?e.threshold:.5,values:e.values.filter((e,t)=>!n.has(t))})})}toData(e){const t=this.targetFeatures,s={features:Object.keys(t).filter(e=>t[e]),targets:this.targets.map(t=>{const s=t.property.group.linkable,r=t.property.key,i=e.get(s);if(!i)throw new Error(`snapshot path not registered for component '${s.displayName}'`);return i+"/"+r}),states:Object.keys(this.states).map(e=>{const t=this.states[e],s={id:t.id,values:t.values};return t.curve!==r.EEasingCurve.EaseQuad&&(s.curve=r.EEasingCurve[t.curve]),2!==t.duration&&(s.duration=t.duration),.5!==t.threshold&&(s.threshold=t.threshold),s})};return s.targets.length>0&&s.states.length>0?s:null}}t.default=a,a.typeName="CVSnapshots"},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(76);t.System=i.default;const n=s(2);t.customElement=n.customElement,t.property=n.property,t.html=n.html,t.TemplateResult=n.TemplateResult;class o extends n.default{constructor(e){super(),this.system=e}}r([n.property({attribute:!1})],o.prototype,"system",void 0),t.default=o},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(2);s(7);let n=class extends i.default{constructor(){super(...arguments),this.property=null,this.name="",this.text=null}firstConnected(){this.classList.add("sv-property-view","sv-property-boolean")}update(e){if(!this.property)throw new Error("missing property attribute");if("boolean"!==this.property.type)throw new Error("not a boolean property");if(e.has("property")){const t=e.get("property");t&&t.off("value",this.onUpdate,this),this.property&&this.property.on("value",this.onUpdate,this)}super.update(e)}render(){const e=this.property,t=this.name||e.name,s=this.text;let r=e.value?Array.isArray(s)?s[1]:s||"On":Array.isArray(s)?s[0]:s||"Off";return i.html`<label class="ff-label ff-off">${t}</label>
            <ff-button .text=${r} ?selected=${e.value} @click=${this.onButtonClick}></ff-button>`}onButtonClick(e){this.property.setValue(!this.property.value)}};r([i.property({attribute:!1})],n.prototype,"property",void 0),r([i.property({type:String})],n.prototype,"name",void 0),r([i.property({attribute:!1})],n.prototype,"text",void 0),n=r([i.customElement("sv-property-boolean")],n),t.default=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t,s){this._type=e,this._callback=t,this._context=s,this._publishers=[]}on(...e){return e.forEach(e=>{this._publishers.push(e),e.on(this._type,this._callback,this._context)}),this}off(){return this._publishers.forEach(e=>e.off(this._type,this._callback,this._context)),this._publishers.length=0,this}}},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(39),n=s(2),o=s(49),a=s(50),l=s(134),c=s(249),h=s(259);s(270),o.default.add("globe",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M336.5 160C322 70.7 287.8 8 248 8s-74 62.7-88.5 152h177zM152 256c0 22.2 1.2 43.5 3.3 64h185.3c2.1-20.5 3.3-41.8 3.3-64s-1.2-43.5-3.3-64H155.3c-2.1 20.5-3.3 41.8-3.3 64zm324.7-96c-28.6-67.9-86.5-120.4-158-141.6 24.4 33.8 41.2 84.7 50 141.6h108zM177.2 18.4C105.8 39.6 47.8 92.1 19.3 160h108c8.7-56.9 25.5-107.8 49.9-141.6zM487.4 192H372.7c2.1 21 3.3 42.5 3.3 64s-1.2 43-3.3 64h114.6c5.5-20.5 8.6-41.8 8.6-64s-3.1-43.5-8.5-64zM120 256c0-21.5 1.2-43 3.3-64H8.6C3.2 212.5 0 233.8 0 256s3.2 43.5 8.6 64h114.6c-2-21-3.2-42.5-3.2-64zm39.5 96c14.5 89.3 48.7 152 88.5 152s74-62.7 88.5-152h-177zm159.3 141.6c71.4-21.2 129.4-73.7 158-141.6h-108c-8.8 56.9-25.6 107.8-50 141.6zM19.3 352c28.6 67.9 86.5 120.4 158 141.6-24.4-33.8-41.2-84.7-50-141.6h-108z"/></svg>`),o.default.add("cog",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M444.788 291.1l42.616 24.599c4.867 2.809 7.126 8.618 5.459 13.985-11.07 35.642-29.97 67.842-54.689 94.586a12.016 12.016 0 0 1-14.832 2.254l-42.584-24.595a191.577 191.577 0 0 1-60.759 35.13v49.182a12.01 12.01 0 0 1-9.377 11.718c-34.956 7.85-72.499 8.256-109.219.007-5.49-1.233-9.403-6.096-9.403-11.723v-49.184a191.555 191.555 0 0 1-60.759-35.13l-42.584 24.595a12.016 12.016 0 0 1-14.832-2.254c-24.718-26.744-43.619-58.944-54.689-94.586-1.667-5.366.592-11.175 5.459-13.985L67.212 291.1a193.48 193.48 0 0 1 0-70.199l-42.616-24.599c-4.867-2.809-7.126-8.618-5.459-13.985 11.07-35.642 29.97-67.842 54.689-94.586a12.016 12.016 0 0 1 14.832-2.254l42.584 24.595a191.577 191.577 0 0 1 60.759-35.13V25.759a12.01 12.01 0 0 1 9.377-11.718c34.956-7.85 72.499-8.256 109.219-.007 5.49 1.233 9.403 6.096 9.403 11.723v49.184a191.555 191.555 0 0 1 60.759 35.13l42.584-24.595a12.016 12.016 0 0 1 14.832 2.254c24.718 26.744 43.619 58.944 54.689 94.586 1.667 5.366-.592 11.175-5.459 13.985L444.788 220.9a193.485 193.485 0 0 1 0 70.2zM336 256c0-44.112-35.888-80-80-80s-80 35.888-80 80 35.888 80 80 80 80-35.888 80-80z"/></svg>`),o.default.add("video",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M543.9 96c-6.2 0-12.5 1.8-18.2 5.7L416 170.1v-58.3c0-26.4-23.2-47.8-51.8-47.8H51.8C23.2 64 0 85.4 0 111.8v288.4C0 426.6 23.2 448 51.8 448h312.4c28.6 0 51.8-21.4 51.8-47.8v-58.3l109.7 68.3c5.7 4 12.1 5.7 18.2 5.7 16.6 0 32.1-13 32.1-31.5V127.5C576 109 560.5 96 543.9 96zM368 200v198.9c-.6.4-1.8 1.1-3.8 1.1H51.8c-2 0-3.2-.6-3.8-1.1V113.1c.6-.4 1.8-1.1 3.8-1.1h312.4c2 0 3.2.6 3.8 1.1V200zm160 155.2l-112-69.8v-58.7l112-69.8v198.3z"/></svg>`),o.default.add("eye",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M569.354 231.631C512.969 135.949 407.81 72 288 72 168.14 72 63.004 135.994 6.646 231.631a47.999 47.999 0 0 0 0 48.739C63.031 376.051 168.19 440 288 440c119.86 0 224.996-63.994 281.354-159.631a47.997 47.997 0 0 0 0-48.738zM288 392c-75.162 0-136-60.827-136-136 0-75.162 60.826-136 136-136 75.162 0 136 60.826 136 136 0 75.162-60.826 136-136 136zm104-136c0 57.438-46.562 104-104 104s-104-46.562-104-104c0-17.708 4.431-34.379 12.236-48.973l-.001.032c0 23.651 19.173 42.823 42.824 42.823s42.824-19.173 42.824-42.823c0-23.651-19.173-42.824-42.824-42.824l-.032.001C253.621 156.431 270.292 152 288 152c57.438 0 104 46.562 104 104z"/></svg>`),o.default.add("palette",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M128 224c-17.7 0-32 14.3-32 32s14.3 32 32 32 32-14.3 32-32-14.4-32-32-32zM418.6 58.1C359.2 9.3 281.3-10 204.6 5 104.9 24.4 24.7 104.2 5.1 203.7c-16.7 84.2 8.1 168.3 67.8 230.6 47.3 49.4 109.7 77.8 167.9 77.8 8.8 0 17.5-.6 26.1-2 24.2-3.7 44.6-18.7 56.1-41.1 12.3-24 12.3-52.7.2-76.6-6.1-12-5.5-26.2 1.8-38 7-11.8 18.7-18.4 32-18.4h72.2c46.4 0 82.8-35.7 82.8-81.3-.2-76.4-34.3-148.1-93.4-196.6zM429.2 288H357c-29.9 0-57.2 15.4-73 41.3-16 26.1-17.3 57.8-3.6 84.9 5.1 10.1 5.1 22.7-.2 32.9-2.6 5-8.7 13.7-20.6 15.6-49.3 7.7-108.9-16.6-152-61.6-48.8-50.9-69-119.4-55.4-188 15.9-80.6 80.8-145.3 161.6-161 62.6-12.3 126.1 3.5 174.3 43.1 48.1 39.5 75.7 97.6 75.9 159.6 0 18.6-15.3 33.2-34.8 33.2zM160 128c-17.7 0-32 14.3-32 32s14.3 32 32 32 32-14.3 32-32-14.4-32-32-32zm96-32.1c-17.7 0-32 14.3-32 32s14.3 32 32 32 32-14.3 32-32c0-17.6-14.3-32-32-32zm96 32.1c-17.7 0-32 14.3-32 32s14.3 32 32 32 32-14.3 32-32-14.3-32-32-32z"/></svg>`),o.default.add("comment",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 32C114.6 32 0 125.1 0 240c0 49.6 21.4 95 57 130.7C44.5 421.1 2.7 466 2.2 466.5c-2.2 2.3-2.8 5.7-1.5 8.7S4.8 480 8 480c66.3 0 116-31.8 140.6-51.4 32.7 12.3 69 19.4 107.4 19.4 141.4 0 256-93.1 256-208S397.4 32 256 32z"/></svg>`),o.default.add("information",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><path d="M84.06,204.23h24.07V138.77H93.06A9.06,9.06,0,0,1,84,129.71V108.06A9.06,9.06,0,0,1,93.06,99h56.75a9.07,9.07,0,0,1,9.07,9.06v96.17h24.06a9.06,9.06,0,0,1,9.06,9.06v21.65a9.06,9.06,0,0,1-9.06,9.06H84.06A9.06,9.06,0,0,1,75,234.94V213.29A9.06,9.06,0,0,1,84.06,204.23ZM133.5,12a32.63,32.63,0,1,0,32.63,32.63A32.62,32.62,0,0,0,133.5,12Z"/></svg>`),o.default.add("article",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm64 236c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-64c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-72v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm96-114.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"/></svg>`),o.default.add("document",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M288 248v28c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-28c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm-12 72H108c-6.6 0-12 5.4-12 12v28c0 6.6 5.4 12 12 12h168c6.6 0 12-5.4 12-12v-28c0-6.6-5.4-12-12-12zm108-188.1V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V48C0 21.5 21.5 0 48 0h204.1C264.8 0 277 5.1 286 14.1L369.9 98c9 8.9 14.1 21.2 14.1 33.9zm-128-80V128h76.1L256 51.9zM336 464V176H232c-13.3 0-24-10.7-24-24V48H48v416h288z"/></svg>`),o.default.add("share",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M352 320c-22.608 0-43.387 7.819-59.79 20.895l-102.486-64.054a96.551 96.551 0 0 0 0-41.683l102.486-64.054C308.613 184.181 329.392 192 352 192c53.019 0 96-42.981 96-96S405.019 0 352 0s-96 42.981-96 96c0 7.158.79 14.13 2.276 20.841L155.79 180.895C139.387 167.819 118.608 160 96 160c-53.019 0-96 42.981-96 96s42.981 96 96 96c22.608 0 43.387-7.819 59.79-20.895l102.486 64.054A96.301 96.301 0 0 0 256 416c0 53.019 42.981 96 96 96s96-42.981 96-96-42.981-96-96-96z"/></svg>`),o.default.add("expand",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><path d="M241,29V141.53a14,14,0,0,1-14,14h-18.7a14,14,0,0,1-14-14V61.74H114.45a14,14,0,0,1-14-14L100.3,29a14,14,0,0,1,14-14H226.89A14,14,0,0,1,241,29Z"/><path class="cls-1" d="M15,226.67V114.11a14,14,0,0,1,14-14h18.7a14,14,0,0,1,14,14V193.9h79.79a14,14,0,0,1,14,14l.12,18.74a14,14,0,0,1-14,14H29.07A14,14,0,0,1,15,226.67Z"/></svg>`),o.default.add("zoom",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M0 180V56c0-13.3 10.7-24 24-24h124c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H64v84c0 6.6-5.4 12-12 12H12c-6.6 0-12-5.4-12-12zM288 44v40c0 6.6 5.4 12 12 12h84v84c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12V56c0-13.3-10.7-24-24-24H300c-6.6 0-12 5.4-12 12zm148 276h-40c-6.6 0-12 5.4-12 12v84h-84c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h124c13.3 0 24-10.7 24-24V332c0-6.6-5.4-12-12-12zM160 468v-40c0-6.6-5.4-12-12-12H64v-84c0-6.6-5.4-12-12-12H12c-6.6 0-12 5.4-12 12v124c0 13.3 10.7 24 24 24h124c6.6 0 12-5.4 12-12z"/></svg>`),o.default.add("tools",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M501.1 395.7L384 278.6c-23.1-23.1-57.6-27.6-85.4-13.9L192 158.1V96L64 0 0 64l96 128h62.1l106.6 106.6c-13.6 27.8-9.2 62.3 13.9 85.4l117.1 117.1c14.6 14.6 38.2 14.6 52.7 0l52.7-52.7c14.5-14.6 14.5-38.2 0-52.7zM331.7 225c28.3 0 54.9 11 74.9 31l19.4 19.4c15.8-6.9 30.8-16.5 43.8-29.5 37.1-37.1 49.7-89.3 37.9-136.7-2.2-9-13.5-12.1-20.1-5.5l-74.4 74.4-67.9-11.3L334 98.9l74.4-74.4c6.6-6.6 3.4-17.9-5.7-20.2-47.4-11.7-99.6.9-136.6 37.9-28.5 28.5-41.9 66.1-41.2 103.6l82.1 82.1c8.1-1.9 16.5-2.9 24.7-2.9zm-103.9 82l-56.7-56.7L18.7 402.8c-25 25-25 65.5 0 90.5s65.5 25 90.5 0l123.6-123.6c-7.6-19.9-9.9-41.6-5-62.7zM64 472c-13.2 0-24-10.8-24-24 0-13.3 10.7-24 24-24s24 10.7 24 24c0 13.2-10.7 24-24 24z"/></svg>`),o.default.add("environment",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><path d="M219.81,14.75H36.19A21.19,21.19,0,0,0,15,35.94V220.06a21.19,21.19,0,0,0,21.19,21.19H219.81A21.19,21.19,0,0,0,241,220.06V35.94A21.19,21.19,0,0,0,219.81,14.75Zm-2.65,205.31H38.84a2.64,2.64,0,0,1-2.65-2.65V38.59a2.64,2.64,0,0,1,2.65-2.65H217.16a2.64,2.64,0,0,1,2.65,2.65V217.41A2.64,2.64,0,0,1,217.16,220.06ZM72.16,71.59A18.32,18.32,0,1,0,90.47,89.91,18.32,18.32,0,0,0,72.16,71.59ZM57.51,198.15H204V141.53l-40.06-40.06a5.49,5.49,0,0,0-7.77,0l-54.72,54.71L83.36,138.09a5.47,5.47,0,0,0-7.76,0L57.51,156.18Z"/></svg>`),o.default.add("bulb",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path d="M44.73 323.21c-7.65 4.42-10.28 14.2-5.86 21.86l8 13.86c4.42 7.65 14.21 10.28 21.86 5.86l93.26-53.84a207.865 207.865 0 0 1-26.83-39.93l-90.43 52.19zM112.46 168H16c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h100.21a210.423 210.423 0 0 1-3.75-48zm127.6 291.17c0 3.15.93 6.22 2.68 8.84l24.51 36.84c2.97 4.46 7.97 7.14 13.32 7.14h78.85c5.36 0 10.36-2.68 13.32-7.14l24.51-36.84c1.74-2.62 2.67-5.7 2.68-8.84l.05-43.18H240.02l.04 43.18zM44.73 60.78l78.98 45.6c5.37-15.29 12.97-29.48 21.64-42.93L68.73 19.21c-7.65-4.42-17.44-1.8-21.86 5.86l-8 13.86c-4.42 7.65-1.79 17.44 5.86 21.85zm550.54 0c7.65-4.42 10.28-14.2 5.86-21.86l-8-13.86c-4.42-7.65-14.21-10.28-21.86-5.86l-76.61 44.23c8.68 13.41 15.76 27.9 21.2 43.19l79.41-45.84zm0 262.43l-90.97-52.52c-7.33 14.23-15.8 27.88-26.36 40.21l93.33 53.88c7.65 4.42 17.44 1.8 21.86-5.86l8-13.86c4.42-7.64 1.79-17.43-5.86-21.85zM624 168h-96.41c.1 2.68.41 5.3.41 8 0 13.54-1.55 26.89-4.12 40H624c8.84 0 16-7.16 16-16v-16c0-8.84-7.16-16-16-16zM320 80c-52.94 0-96 43.06-96 96 0 8.84 7.16 16 16 16s16-7.16 16-16c0-35.3 28.72-64 64-64 8.84 0 16-7.16 16-16s-7.16-16-16-16zm0-80C217.72 0 144 82.97 144 176c0 44.37 16.45 84.85 43.56 115.78 16.64 18.99 42.74 58.8 52.42 92.16v.06h48v-.12c-.01-4.77-.72-9.51-2.15-14.07-5.59-17.81-22.82-64.77-62.17-109.67-20.53-23.43-31.52-53.14-31.61-84.14-.2-73.64 59.67-128 127.95-128 70.58 0 128 57.42 128 128 0 30.97-11.24 60.85-31.65 84.14-39.11 44.61-56.42 91.47-62.1 109.46a47.507 47.507 0 0 0-2.22 14.3v.1h48v-.05c9.68-33.37 35.78-73.18 52.42-92.16C479.55 260.85 496 220.37 496 176 496 78.8 417.2 0 320 0z"/></svg>`),o.default.add("tape",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path d="M624 432H362.3c52.1-41 85.7-104.5 85.7-176 0-123.7-100.3-224-224-224S0 132.3 0 256s100.3 224 224 224h400c8.8 0 16-7.2 16-16v-16c0-8.8-7.2-16-16-16zm-400 0c-97 0-176-79-176-176S127 80 224 80s176 79 176 176-79 176-176 176zm0-272c-53 0-96 43-96 96s43 96 96 96 96-43 96-96-43-96-96-96zm0 144c-26.5 0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48z"/></svg>`),o.default.add("knife",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M566.28 88.57c12.96-12.5 12.96-32.76 0-45.25L531.07 9.37c-12.96-12.5-33.98-12.5-46.94 0L319.99 160 4.76 464.14c-8.25 7.96-5.38 22.16 5.53 25.69C53.72 503.86 102.37 512 150.51 512c75.83 0 150.42-20.19 201.49-69.35l104.4-100.04c12.95-12.41 13.17-33.05.49-45.73L448 288v-80L566.28 88.57zM496 64c8.84 0 16 7.16 16 16s-7.16 16-16 16-16-7.16-16-16 7.16-16 16-16zM318.71 408.07C281.24 444.14 221.5 464 150.51 464c-23.16 0-46.79-2.1-70.07-6.17L319.4 227.28l91.99 91.99-92.68 88.8zM432 160c-8.84 0-16-7.16-16-16s7.16-16 16-16 16 7.16 16 16-7.17 16-16 16z"/></svg>`),o.default.add("upload",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M369.83 97.98L285.94 14.1c-9-9-21.2-14.1-33.89-14.1H47.99C21.5.1 0 21.6 0 48.09v415.92C0 490.5 21.5 512 47.99 512h287.94c26.5 0 48.07-21.5 48.07-47.99V131.97c0-12.69-5.17-24.99-14.17-33.99zM255.95 51.99l76.09 76.08h-76.09V51.99zM336 464.01H47.99V48.09h159.97v103.98c0 13.3 10.7 23.99 24 23.99H336v287.95zM182.98 227.79l-72.31 71.77c-7.6 7.54-2.26 20.52 8.45 20.52H168v84c0 6.63 5.37 12 12 12h24c6.63 0 12-5.37 12-12v-84h48.88c10.71 0 16.05-12.97 8.45-20.52l-72.31-71.77c-4.99-4.95-13.05-4.95-18.04 0z"/></svg>`),o.default.add("download",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M216 236.07c0-6.63-5.37-12-12-12h-24c-6.63 0-12 5.37-12 12v84.01h-48.88c-10.71 0-16.05 12.97-8.45 20.52l72.31 71.77c4.99 4.95 13.04 4.95 18.03 0l72.31-71.77c7.6-7.54 2.26-20.52-8.45-20.52H216v-84.01zM369.83 97.98L285.94 14.1c-9-9-21.2-14.1-33.89-14.1H47.99C21.5.1 0 21.6 0 48.09v415.92C0 490.5 21.5 512 47.99 512h287.94c26.5 0 48.07-21.5 48.07-47.99V131.97c0-12.69-5.17-24.99-14.17-33.99zM255.95 51.99l76.09 76.08h-76.09V51.99zM336 464.01H47.99V48.09h159.97v103.98c0 13.3 10.7 23.99 24 23.99H336v287.95z"/></svg>`),o.default.add("trash",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M192 188v216c0 6.627-5.373 12-12 12h-24c-6.627 0-12-5.373-12-12V188c0-6.627 5.373-12 12-12h24c6.627 0 12 5.373 12 12zm100-12h-24c-6.627 0-12 5.373-12 12v216c0 6.627 5.373 12 12 12h24c6.627 0 12-5.373 12-12V188c0-6.627-5.373-12-12-12zm132-96c13.255 0 24 10.745 24 24v12c0 6.627-5.373 12-12 12h-20v336c0 26.51-21.49 48-48 48H80c-26.51 0-48-21.49-48-48V128H12c-6.627 0-12-5.373-12-12v-12c0-13.255 10.745-24 24-24h74.411l34.018-56.696A48 48 0 0 1 173.589 0h100.823a48 48 0 0 1 41.16 23.304L349.589 80H424zm-269.611 0h139.223L276.16 50.913A6 6 0 0 0 271.015 48h-94.028a6 6 0 0 0-5.145 2.913L154.389 80zM368 128H80v330a6 6 0 0 0 6 6h276a6 6 0 0 0 6-6V128z"/></svg>`),o.default.add("bars",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"/></svg>`),o.default.add("triangle-left",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><path d="M191.33,31.38V224.62a15,15,0,0,1-25.64,10.62L69.07,138.62a15,15,0,0,1,0-21.24l96.62-96.62A15,15,0,0,1,191.33,31.38Z"/></svg>`),o.default.add("triangle-right",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><path d="M64.67,224.62V31.38A15,15,0,0,1,90.31,20.76l96.62,96.62a15,15,0,0,1,0,21.24L90.31,235.24A15,15,0,0,1,64.67,224.62Z"/></svg>`),o.default.add("twitter",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>`),o.default.add("facebook",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 264 512"><path d="M76.7 512V283H0v-91h76.7v-71.7C76.7 42.4 124.3 0 193.8 0c33.3 0 61.9 2.5 70.2 3.6V85h-48.2c-37.8 0-45.1 18-45.1 44.3V192H256l-11.7 91h-73.6v229"/></svg>`),o.default.add("instagram",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg>`),o.default.add("linkedin",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448.1 512"><path d="M100.3 448H7.4V148.9h92.9V448zM53.8 108.1C24.1 108.1 0 83.5 0 53.8S24.1 0 53.8 0s53.8 24.1 53.8 53.8-24.1 54.3-53.8 54.3zM448 448h-92.7V302.4c0-34.7-.7-79.2-48.3-79.2-48.3 0-55.7 37.7-55.7 76.7V448h-92.8V148.9h89.1v40.8h1.3c12.4-23.5 42.7-48.3 87.9-48.3 94 0 111.3 61.9 111.3 142.3V448h-.1z"/></svg>`),o.default.add("email",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm0 48v40.805c-22.422 18.259-58.168 46.651-134.587 106.49-16.841 13.247-50.201 45.072-73.413 44.701-23.208.375-56.579-31.459-73.413-44.701C106.18 199.465 70.425 171.067 48 152.805V112h416zM48 400V214.398c22.914 18.251 55.409 43.862 104.938 82.646 21.857 17.205 60.134 55.186 103.062 54.955 42.717.231 80.509-37.199 103.053-54.947 49.528-38.783 82.032-64.401 104.947-82.653V400H48z"/></svg>`),o.default.add("copy",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"/></svg>`),o.default.add("cube",n.html`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M239.1 7.5l-208 78c-18.7 7-31.1 25-31.1 45v225.1c0 18.2 10.3 34.8 26.5 42.9l208 104c13.5 6.8 29.4 6.8 42.9 0l208-104c16.3-8.1 26.5-24.8 26.5-42.9V130.5c0-20-12.4-37.9-31.1-44.9l-208-78C262 3.4 250 3.4 239.1 7.5zm16.9 45l208 78v.3l-208 84.5-208-84.5v-.3l208-78zM48 182.6l184 74.8v190.2l-184-92v-173zm232 264.9V257.4l184-74.8v172.9l-184 92z"/></svg>`);let u=class extends n.default{constructor(e){super(),this.application=null,e&&(this.application=e)}get fullscreen(){return this.application.system.getMainComponent(i.default)}firstConnected(){if(super.firstConnected(),!this.application){const e={root:this.getAttribute("root"),document:this.getAttribute("document"),model:this.getAttribute("model"),geometry:this.getAttribute("geometry"),texture:this.getAttribute("texture"),quality:this.getAttribute("quality")};this.application=new l.default(null,e)}const e=this.application.system;new c.default(e).appendTo(this),new h.default(e).appendTo(this);const t=document.createElement("div");t.setAttribute("id",a.default.stackId),this.appendChild(t)}connected(){this.fullscreen.fullscreenElement=this}disconnected(){this.fullscreen.fullscreenElement=null}};u=r([n.customElement("voyager-explorer")],u),t.default=u},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(128),i=s(8),n=s(72),o=s(129),a=s(48);t.schemas=a.schemas,t.types=a.types;class l extends i.default{constructor(e,t,s){if(super(),this.addEvents("value","link","change","dispose"),!t||void 0===t.preset)throw new Error("missing schema/preset");const r=t.preset,i=Array.isArray(r);this.type=typeof(i?r[0]:r),this.schema=t,this.custom=s||!1,this.elementCount=i?r.length:1,this.inLinks=[],this.outLinks=[],this._group=null,this._key="",this._path=e,this.value=null,this.reset(),this.changed=!t.event}get group(){return this._group}get key(){return this._key}get path(){return this._path}set path(e){this._path=e,this.emit({type:"change",what:"path",property:this})}get name(){return this._path.split(".").pop()}dispose(){this.unlink(),this._group&&this._group.removeProperty(this),this.emit({type:"dispose",property:this})}setValue(e,t,s){this.value=e,t||(this.changed=!0,this.isInput()&&(this._group.linkable.changed=!0)),s||this.emit("value",e);const r=this.outLinks;for(let e=0,t=r.length;e<t;++e)r[e].push()}setOption(e,t,s){if(!this.schema.options)throw new Error("not an 'option' type");const r=this.schema.options.indexOf(e);r>=0&&this.setValue(r,t,s)}copyValue(e,t){Array.isArray(e)&&(e=e.slice()),this.setValue(e,t)}set(e){e||(this.changed=!0,this.isInput()&&(this._group.linkable.changed=!0)),this.emit("value",this.value);const t=this.outLinks;for(let e=0,s=t.length;e<s;++e)t[e].push()}cloneValue(){const e=this.value;return Array.isArray(e)?e.slice():e}getValidatedValue(e){const t=this.value;if(this.isArray()){e=e||[];for(let s=0,r=t.length;s<r;++s)e[s]=this.validateValue(t[s]);return e}return this.validateValue(t)}linkTo(e,t,s){e.linkFrom(this,t,s)}linkFrom(e,t,s){if(!this.canLinkFrom(e,t,s))throw new Error(`can't link from '${e.path}' to '${this.path}'`);const r=new o.default(e,this,t,s);e.addOutLink(r),this.addInLink(r)}unlinkTo(e,t,s){e.unlinkFrom(this,t,s)}unlinkFrom(e,t,s){const r=this.inLinks.find(r=>r.source===e&&r.sourceIndex===t&&r.destinationIndex===s);return!!r&&(e.removeOutLink(r),this.removeInLink(r),!0)}unlink(){if(this.inLinks.slice().forEach(e=>{e.source.removeOutLink(e),this.removeInLink(e)}),this.outLinks.slice().forEach(e=>{this.removeOutLink(e),e.destination.removeInLink(e)}),0!==this.inLinks.length||0!==this.outLinks.length)throw new Error("fatal: leftover links")}addInLink(e){if(e.destination!==this)throw new Error("input link's destination must equal this");this.inLinks.push(e),this.requestSort(),this.emit({type:"link",add:!0,remove:!1,link:e})}addOutLink(e){if(e.source!==this)throw new Error("output link's source must equal this");this.outLinks.push(e),this.requestSort(),e.push()}removeInLink(e){const t=this.inLinks.indexOf(e);if(t<0)throw new Error("input link not found");this.inLinks.splice(t,1),this.requestSort(),0===this.inLinks.length&&"object"===this.type&&this.reset(),this.emit({type:"link",add:!1,remove:!0,link:e})}removeOutLink(e){const t=this.outLinks.indexOf(e);if(t<0)throw new Error("output link not found");this.outLinks.splice(t,1),this.requestSort()}canLinkTo(e,t,s){return e.canLinkFrom(this,t,s)}canLinkFrom(e,t,s){if(this.isOutput())return!1;const i=t>=0,o=s>=0;if(!e.isArray()&&i)throw new Error("non-array source property; can't link to element");if(!this.isArray()&&o)throw new Error("non-array destination property; can't link to element");const a=e.isArray()&&!i;return a===(this.isArray()&&!o)&&((!a||e.elementCount===this.elementCount)&&(!("object"===e.type&&"object"===this.type&&!r.default(e.schema.objectType,this.schema.objectType))&&n.canConvert(e.type,this.type)))}reset(){let e;if(this.isMulti()){let t=this.value;t?t.length=1:e=t=[],t[0]=this.clonePreset()}else e=this.clonePreset();this.setValue(e)}setMultiChannelCount(e){if(!this.isMulti())throw new Error("can't set multi channel count on non-multi property");const t=this.value,s=t.length;t.length=e;for(let r=s;r<e;++r)t[r]=this.clonePreset();this.changed=!0}requestSort(){this._group&&this._group.linkable&&this._group.linkable.requestSort()}setOptions(e){if(!this.schema.options)throw new Error(`property type mismatch, can't set options on '${this.path}'`);this.schema.options=e.slice(),this.emit({type:"change",what:"options",property:this})}getOptionText(){const e=this.schema.options;if("number"===this.type&&e){const t=Math.trunc(this.value);return e[t<0?0:t>=e.length?0:t]||""}}isInput(){return this._group&&this._group===this._group.linkable.ins}isOutput(){return this._group&&this._group===this._group.linkable.outs}isArray(){return Array.isArray(this.schema.preset)}isMulti(){return!!this.schema.multi}isDefault(){const e=this.schema.multi?this.value[0]:this.value,t=this.schema.preset,s=Array.isArray(e)?e.length:-1;if(s!==(Array.isArray(t)?t.length:-1))return!1;if(s>=0){for(let r=0;r<s;++r)if(e[r]!==t[r])return!1;return!0}return e===t}hasLinks(){return this.inLinks.length>0||this.outLinks.length>0}hasInLinks(e){const t=this.inLinks;if(!(e>=0))return t.length>0;for(let s=0,r=t.length;s<r;++s)if(t[s].destinationIndex===e)return!0;return!1}hasMainInLinks(){const e=this.inLinks;for(let t=0,s=e.length;t<s;++t)if(!(e[t].destinationIndex>=0))return!0;return!1}hasOutLinks(e){const t=this.outLinks;if(!(e>=0))return t.length>0;for(let s=0,r=t.length;s<r;++s)if(t[s].sourceIndex===e)return!0;return!1}inLinkCount(){return this.inLinks.length}outLinkCount(){return this.outLinks.length}toJSON(){let e=this.custom?{path:this.path,schema:Object.assign({},this.schema)}:null;return this.isOutput()||this.hasMainInLinks()||this.isDefault()||"object"===this.type||((e=e||{}).value=this.value),this.outLinks.length>0&&((e=e||{}).links=this.outLinks.map(e=>{const t={id:e.destination._group.linkable.id,key:e.destination.key};return e.sourceIndex>=0&&(t.srcIndex=e.sourceIndex),e.destinationIndex>=0&&(t.dstIndex=e.destinationIndex),t})),e}fromJSON(e,t){void 0!==e.value&&(this.value=e.value),void 0!==e.links&&e.links.forEach(e=>{t[e.id].ins[e.key].linkFrom(this,e.srcIndex,e.dstIndex)})}toString(){const e=this.schema,t=e.event?"event":e.options?"enum":this.type;return`${this.path} [${t}]`}dump(e=""){console.log(e+`Property '${this.path}', key: ${this.key}, value: ${this.value}`)}validateValue(e){const t=this.schema;if(t.enum){const s=Math.trunc(e);return t.enum[s]?s:0}if(t.options){const s=Math.trunc(e);return s<0?0:s>=t.options.length?0:s}return"number"===this.type?(e=t.min?Math.max(t.min,e):e,e=t.max?Math.min(t.max,e):e):e}clonePreset(){const e=this.schema.preset;return Array.isArray(e)?e.slice():e}}t.default=l},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=[function(e){return e},function(e,t){for(let s=0,r=t.length;s<r;++s)t[s]=e[s];return t}],i=[function(e){return!!e},function(e,t){for(let s=0,r=t.length;s<r;++s)t[s]=!!e[s];return t}],n=[function(e){return String(e)},function(e,t){for(let s=0,r=t.length;s<r;++s)t[s]=String(e[s]);return t}],o=[function(e,t){throw new Error(`illegal value conversion from ${typeof e} to ${typeof t}`)},function(e,t,s){throw new Error(`illegal array conversion from ${typeof e[0]} to ${typeof t[0]}`)}],a={number:{number:r,boolean:i,string:n,object:o},boolean:{number:[function(e){return e?1:0},function(e,t){for(let s=0,r=t.length;s<r;++s)t[s]=e[s]?1:0;return t}],boolean:r,string:n,object:o},string:{number:[function(e){return parseFloat(e)||0},function(e,t){for(let s=0,r=t.length;s<r;++s)t[s]=parseFloat(e[s])||0;return t}],boolean:i,string:r,object:o},object:{number:o,boolean:i,string:n,object:r}},l={number:{number:!0,boolean:!0,string:!0,object:!1},boolean:{number:!0,boolean:!0,string:!0,object:!1},string:{number:!0,boolean:!0,string:!0,object:!1},object:{number:!1,boolean:!0,string:!0,object:!0}},c=[[function(e,t,s){return s(e,t)},function(e,t,s){return t[0]=s(e),t},function(e,t,s){return t[1]=s(e),t},function(e,t,s){return t[2]=s(e),t},function(e,t,s){return t[3]=s(e),t}],[function(e,t,s){return s(e[0])},function(e,t,s){return t[0]=s(e[0]),t},function(e,t,s){return t[1]=s(e[0]),t},function(e,t,s){return t[2]=s(e[0]),t},function(e,t,s){return t[3]=s(e[0]),t}],[function(e,t,s){return s(e[1])},function(e,t,s){return t[0]=s(e[1]),t},function(e,t,s){return t[1]=s(e[1]),t},function(e,t,s){return t[2]=s(e[1]),t},function(e,t,s){return t[3]=s(e[1]),t}],[function(e,t,s){return s(e[2])},function(e,t,s){return t[0]=s(e[2]),t},function(e,t,s){return t[1]=s(e[2]),t},function(e,t,s){return t[2]=s(e[2]),t},function(e,t,s){return t[3]=s(e[2]),t}],[function(e,t,s){return s(e[3])},function(e,t,s){return t[0]=s(e[3]),t},function(e,t,s){return t[1]=s(e[3]),t},function(e,t,s){return t[2]=s(e[3]),t},function(e,t,s){return t[3]=s(e[3]),t}]];t.getConversionFunction=function(e,t,s){const r=s?1:0;return a[e][t][r]},t.canConvert=function(e,t){return l[e][t]},t.getElementCopyFunction=function(e,t,s){return-1===e&&-1===t?s:e<=3&&t<=3?c[e+1][t+1]:function(s,r,i){return r[t]=i(s[e]),r}},t.getMultiCopyFunction=function(e,t,s){return!1===e?!1===t?s:function(e,t,r){for(let r=0,i=t.length;r<i;++r)t[r]=s(e,t[r]);return t}:!1===t?function(e,t,r){return e.length>0&&(t=s(e[0],t)),t}:function(e,t,r){for(let r=0,i=e.length,n=t.length;r<n;++r)t[r]=s(e[r%i],t[r]);return t}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0);t.default=class{constructor(e,t,s,i){this.typeName=r.default.getTypeName(t),this.didAdd=s,this.willRemove=i,this._registry=e,e.on(this.typeName,this.onComponent,this),this.component=e.get(t,!0),this.component&&s&&s(this.component)}dispose(){this._registry.off(this.typeName,this.onComponent,this),this.component=null,this.didAdd=null,this.willRemove=null}onComponent(e){e.add?(this.component=e.object,this.didAdd&&this.didAdd(e.object)):e.remove&&(this.willRemove&&this.willRemove(e.object),this.component=null)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(8),i=s(136);class n extends r.default{constructor(e){super(),this.addEvent("update"),this.stack=[],this.pointer=-1,this.capacity=void 0!==e?e:n.defaultCapacity}register(e){let t;t="function"==typeof e?e:t=>new i.default(t,e);return(...e)=>{const s=t(e);this.do(s)}}setCapacity(e){for(this.capacity=e;this.stack.length>e;)this.stack.shift(),this.pointer--;this.pointer<0&&(this.stack=[],this.pointer=-1)}do(e){console.log(`Commander.do - '${e.name}'`),e.do(),e.canUndo()&&(this.stack.splice(this.pointer+1),this.stack.push(e),this.stack.length>this.capacity&&this.stack.shift(),this.pointer=this.stack.length-1,this.emit("update"))}undo(){if(this.pointer>=0){this.stack[this.pointer].undo(),this.pointer--,this.emit("update")}}redo(){if(this.pointer<this.stack.length-1){this.pointer++,this.stack[this.pointer].do(),this.emit("update")}}clear(){this.stack.length>0&&(this.stack=[],this.pointer=-1,this.emit("update"))}canUndo(){return this.pointer>=0}canRedo(){return this.pointer<this.stack.length-1}getUndoText(){return this.pointer>=0?"Undo "+this.stack[this.pointer].name:"Can't Undo"}getRedoText(){return this.pointer<this.stack.length-1?"Redo "+this.stack[this.pointer+1].name:"Can't Redo"}}t.default=n,n.defaultCapacity=30},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(8);class i extends r.default{constructor(){super(),this._dict={},this.addEvent("type")}add(e){if(Array.isArray(e))return void e.forEach(e=>this.add(e));const t=e.typeName;if(!t)throw new Error("type must have a 'typeName' member");if(this._dict[t])throw new Error(`type '${t}' already registered`);this._dict[t]=e,this.emit({type:"type",add:!0,remove:!1,classType:e})}remove(e){if(Array.isArray(e))return void e.forEach(e=>this.remove(e));const t=e.typeName;if(!t)throw new Error("type must have a 'typeName' member");if(!this._dict[t])throw new Error(`type '${t}' not registered`);delete this._dict[t],this.emit({type:"type",add:!1,remove:!0,classType:e})}getType(e){let t=e;return"function"==typeof e?t=e.typeName:"object"==typeof e&&(t=e.constructor.typeName),this._dict[t]}createInstance(e,...t){const s=this.getType(e);if(!s)throw new Error(`type '${e}' not registered`);return new s(...t)}}t.default=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(8),i=s(40),n=s(75),o=s(0),a=s(10),l=s(77);class c extends r.default{constructor(e){super({knownEvents:!1}),this.nodes=new i.default(a.default),this.components=new i.default(o.default),this.registry=e||new n.default,this.graph=new l.default(this,null),this.graph.activate()}getComponent(e,t=!1){return this.components.get(e,t)}getComponents(e){return this.components.getArray(e)}getComponentsByTag(e){return this.components.getByTag(e)}hasComponents(e){return this.components.has(e)}getMainComponent(e,t=!1){return this.graph.components.get(e,t)}getMainComponents(e){return this.graph.components.getArray(e)}getMainComponentsByTag(e){return this.graph.components.getByTag(e)}hasMainComponents(e){return this.graph.components.has(e)}getNode(e,t=!1){return this.nodes.get(e,t)}getNodes(e){return this.nodes.getArray(e)}getNodesByTag(e){return this.nodes.getByTag(e)}hasNodes(e){return this.nodes.has(e)}getMainNode(e,t=!1){return this.graph.nodes.get(e,t)}getMainNodes(e){return this.graph.nodes.getArray(e)}getMainNodesByTag(e){return this.graph.nodes.getByTag(e)}hasMainNodes(e){return this.graph.nodes.has(e)}findNodeByName(e,t){const s=this.nodes.getArray(t);for(let t=0,r=s.length;t<r;++t)if(s[t].name===e)return s[t]}toJSON(){return this.graph.toJSON()}fromJSON(e){this.graph.clear(),this.graph.fromJSON(e)}toString(e=!1){const t=this.nodes.getArray(),s=this.components.count(),r=`System - ${t.length} nodes, ${s} components.`;return e?r+"\n"+t.map(e=>e.toString(!0)).join("\n"):r}_addNode(e){this.nodes.add(e)}_removeNode(e){this.nodes.remove(e)}_addNodeTag(e,t){this.nodes.addByTag(e,t)}_removeNodeTag(e,t){this.nodes.removeByTag(e,t)}_addComponent(e){if(e.isSystemSingleton&&this.components.has(e))throw new Error(`only one component of type '${e.typeName}' allowed per system`);this.components.add(e)}_removeComponent(e){this.components.remove(e)}_addComponentTag(e,t){this.components.addByTag(e,t)}_removeComponentTag(e,t){this.components.removeByTag(e,t)}}t.default=c},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(30),i=s(8),n=s(138),o=s(0),a=s(10),l=s(40);class c extends i.default{constructor(e,t){super({knownEvents:!1}),this.nodes=new l.default(a.default),this.components=new l.default(o.default),this.roots=[],this._sorter=new n.default,this._sortRequested=!0,this._sortedList=null,this._tockList=[],this._isActive=!1,this.system=e,this.parent=t}get isActive(){return this._isActive}getComponent(e,t=!1){return this.components.get(e,t)}getComponents(e){return this.components.getArray(e)}getComponentsByTag(e){return this.components.getByTag(e)}hasComponent(e){return this.components.has(e)}getMainComponent(e,t=!1){return this.system.graph.components.get(e,t)}getMainComponents(e){return this.system.graph.components.getArray(e)}getMainComponentsByTag(e){return this.system.graph.components.getByTag(e)}hasMainComponent(e){return this.system.graph.components.has(e)}getSystemComponent(e,t=!1){return this.system.components.get(e,t)}getSystemComponents(e){return this.system.components.getArray(e)}getSystemComponentsByTag(e){return this.system.components.getByTag(e)}hasSystemComponent(e){return this.system.components.has(e)}getComponentById(e){return this.system.components.getById(e)}getNode(e,t=!1){return this.nodes.get(e,t)}getNodes(e){return this.nodes.getArray(e)}getNodesByTag(e){return this.nodes.getByTag(e)}hasNode(e){return this.nodes.has(e)}getMainNode(e,t=!1){return this.system.graph.nodes.get(e,t)}getMainNodes(e){return this.system.graph.nodes.getArray(e)}getMainNodesByTag(e){return this.system.graph.nodes.getByTag(e)}hasMainNode(e){return this.system.graph.nodes.has(e)}getSystemNode(e,t=!1){return this.system.nodes.get(e,t)}getSystemNodes(e){return this.system.nodes.getArray(e)}getSystemNodesByTag(e){return this.system.nodes.getByTag(e)}hasSystemNode(e){return this.system.nodes.has(e)}getNodeById(e){return this.system.nodes.getById(e)}activate(){if(this._isActive)return;this._isActive=!0,this._sortRequested&&(this._sortRequested=!1,this.sort());const e=this._sortedList;for(let t=0,s=e.length;t<s;++t){const s=e[t];s.activate&&s.activate()}}deactivate(){if(!this._isActive)return;this._isActive=!1;const e=this._sortedList;for(let t=0,s=e.length;t<s;++t){const s=e[t];s.deactivate&&s.deactivate()}}tick(e){if(!this._isActive)return;this._sortRequested&&(this._sortRequested=!1,this.sort());const t=this._sortedList;let s=!1;for(let r=0,i=t.length;r<i;++r){const i=t[r];i.updated=!1,i.changed?(i.update&&i.update(e)&&(i.updated=!0),i.tick&&i.tick(e)&&(i.updated=!0),i.resetChanged()):i.tick&&i.tick(e)&&(i.updated=!0),i.updated&&(s=!0,i.emit("update"))}return s}tock(e){if(!this._isActive)return;const t=this._tockList;let s=!1;for(let r=0,i=t.length;r<i;++r)s=t[r].tock(e)||s;return s}clear(){const e=this.nodes.cloneArray().reverse();for(let t=0,s=e.length;t<s;++t)e[t].dispose();if(this.nodes.length>0)throw new Error("graph not empty")}requestSort(){this._sortRequested=!0}sort(){this._sortedList=this._sorter.sort(this.components.getArray());this.parent&&(this.parent.name||this.parent.typeName)}createCustomNode(e,t,s){const i=this.system.registry.getType(e);if(!i)throw new Error(`node type '${a.default.getTypeName(e)}' not registered`);const n=new i(this,s||r.default(12,this.system.nodes.getDictionary()));return n.create(),t&&(n.name=t),s||(n.createComponents(),n.unlock()),n}createNode(e,t){const s=new a.default(this,t||r.default(12,this.system.nodes.getDictionary()));return s.create(),e&&(s.name=e),s.unlock(),s}findNodeByName(e,t){const s=this.nodes.getArray(t);for(let t=0,r=s.length;t<r;++t)if(s[t].name===e)return s[t]}findRootNodes(e){const t=this.nodes.getArray(e),s=[];for(let e=0,r=t.length;e<r;++e){const r=t[e].components.get("CHierarchy",!0);r&&r.parent||s.push(t[e])}return s}toString(e=!1){const t=this.nodes.getArray(),s=this.components.count(),r=`Graph - ${t.length} nodes, ${s} components.`;return e?r+"\n"+t.map(e=>e.toString(!0)).join("\n"):r}dump(e=""){console.log(e+"%cGraph","color: red"),this.findRootNodes().forEach(t=>t.dump(e+"  "))}toJSON(){const e={},t=[],s=this.nodes.getArray();for(let e=0,r=s.length;e<r;++e){const r=s[e],i=this.nodeToJSON(r);i.type=r.typeName,i.id=r.id,r.name&&(i.name=r.name),t.push(i)}return t.length>0&&(e.nodes=t),e}fromJSON(e){e.nodes&&(e.nodes.forEach(e=>{this.createCustomNode(e.type,e.name,e.id).fromJSON(e)}),e.nodes.forEach(e=>{this.nodes.getById(e.id).referencesFromJSON(e)}))}nodeToJSON(e){return e.toJSON()}_addNode(e){this.nodes.add(e),this.system._addNode(e)}_removeNode(e){this.system._removeNode(e),this.nodes.remove(e)}_addNodeTag(e,t){this.nodes.addByTag(e,t),this.system._addNodeTag(e,t)}_removeNodeTag(e,t){this.system._removeNodeTag(e,t),this.nodes.removeByTag(e,t)}_addComponent(e){if(e.isGraphSingleton&&this.components.has(e))throw new Error(`only one component of type '${e.typeName}' allowed per graph`);this.components.add(e),this.system._addComponent(e),e.tock&&this._tockList.push(e),this._sortRequested=!0}_removeComponent(e){this.system._removeComponent(e),this.components.remove(e),e.tock&&this._tockList.splice(this._tockList.indexOf(e),1),this._sortRequested=!0}_addComponentTag(e,t){this.components.addByTag(e,t),this.system._addComponentTag(e,t)}_removeComponentTag(e,t){this.system._removeComponentTag(e,t),this.components.removeByTag(e,t)}_addRoot(e){this.roots.push(e),this.parent&&this.parent.onAddInnerRoot(e)}_removeRoot(e){this.parent&&this.parent.onRemoveInnerRoot(e),this.roots.splice(this.roots.indexOf(e),1)}}t.default=c},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(10),n=s(53);var o;!function(e){e[e.Graph=0]="Graph",e[e.Main=1]="Main",e[e.System=2]="System"}(o=t.ENodeScope||(t.ENodeScope={}));class a extends r.default{constructor(){super(...arguments),this._scope=o.Graph,this._scopedGraph=null,this._activeNode=null}get nodeType(){return this.constructor.nodeType}get followNodeSelection(){return this.constructor.followNodeSelection}get followComponentSelection(){return this.constructor.followComponentSelection}get retainSelection(){return this.constructor.retainSelection}get scope(){return this._scope}set scope(e){this._scope=e,this._activeNode&&!this.isNodeInScope(this._activeNode)&&(this.activeNode=null)}get scopedGraph(){return this._scopedGraph}set scopedGraph(e){e!==this._scopedGraph&&(this._scopedGraph=e,this._activeNode&&!this.isNodeInScope(this._activeNode)&&(this.activeNode=null),this.onScopedNodes(),this.emit({type:"scoped-nodes"}))}get scopedNodes(){switch(this._scope){case o.Graph:return(this._scopedGraph?this._scopedGraph.innerGraph:this.graph).getNodes(this.nodeType);case o.Main:return this.getMainNodes(this.nodeType);case o.System:return this.getSystemNodes(this.nodeType)}}get activeNode(){return this._activeNode}set activeNode(e){const t=this.activeNode;if(e!==t){if(t&&this.deactivateNode(t),e){if(!this.isNodeInScope(e))throw new Error("can't activate, node out of scope");this.activateNode(e)}this._activeNode=e,this.onActiveNode(t,e),this.emit({type:"active-node",previous:t,next:e})}}get selection(){return this.getSystemComponent(n.default)}create(){super.create(),this.system.nodes.on(i.default,this.onNode,this),this.followNodeSelection&&this.selection.selectedNodes.on(this.nodeType,this.onSelectNode,this),this.followComponentSelection&&this.selection.selectedComponents.on(r.default,this.onSelectComponent,this)}dispose(){this.activeNode&&(this.activeNode=null),this.system.nodes.off(i.default,this.onNode,this),this.followNodeSelection&&this.selection.selectedNodes.off(this.nodeType,this.onSelectNode,this),this.followComponentSelection&&this.selection.selectedComponents.off(r.default,this.onSelectComponent,this),super.dispose()}activateNode(e){}deactivateNode(e){}onActiveNode(e,t){}onScopedNodes(){}onNode(e){e.remove&&e.object===this.activeNode&&(this.activeNode=null),this.isNodeInScope(e.object)&&(this.onScopedNodes(),this.emit({type:"scoped-nodes"}))}onSelectNode(e){const t=e.object;this.isNodeInScope(t)&&(e.add?this.activeNode=t:e.remove&&!this.retainSelection&&t===this.activeNode&&(this.activeNode=null))}onSelectComponent(e){const t=e.object.node;t.is(this.nodeType)&&this.onSelectNode({type:t.typeName,object:t,add:e.add,remove:e.remove})}isNodeInScope(e){if(!e.is(this.nodeType))return!1;switch(this._scope){case o.Graph:const t=this._scopedGraph?this._scopedGraph.innerGraph:this.graph;return e.graph===t;case o.Main:return e.graph===this.system.graph;case o.System:return!0}return!1}}t.default=a,a.typeName="CNodeProvider",a.nodeType=i.default,a.followNodeSelection=!0,a.followComponentSelection=!1,a.retainSelection=!0},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(141);t.EEasingCurve=r.EEasingCurve;const i=s(0),n=s(30);class o extends i.default{constructor(){super(...arguments),this.ins=this.addInputs(o.ins),this.outs=this.addOutputs(o.outs),this.targets=[],this.states={},this._currentValues=null,this._targetState=null,this._startTime=0,this._easingFunction=null}getState(e){return this.states[e]}setState(e){return e.id=e.id||n.default(6),this.states[e.id]=e,e.id}deleteState(e){delete this.states[e]}clear(){this.targets.forEach(e=>e.property.off("dispose",this.onPropertyDispose,this)),this.targets.length=0,this.states={},this._currentValues=null,this._targetState=null,this._startTime=0,this._easingFunction=null}dispose(){this.clear(),super.dispose()}tweenTo(e,t){const s=this.states[e],i=this.outs;if(s)return this._targetState=s,this._currentValues=this.getCurrentValues(),this._startTime=t,this._easingFunction=r.getEasingFunction(s.curve),i.switched.setValue(!1),i.tweening.setValue(!0),i.start.set(),!0}update(e){const t=this.ins,s=this.states,r=t.id.value,i=s[r];if(i){if((t.tween.changed||t.recall.changed)&&(t.curve.setValue(i.curve),t.duration.setValue(i.duration),t.threshold.setValue(i.threshold)),t.tween.changed)return this.tweenTo(r,e.secondsElapsed),!0;if(t.recall.changed)return this.setValues(i.values),!0;(t.curve.changed||t.duration.changed||t.threshold.changed)&&(i.curve=t.curve.value,i.duration=t.duration.value,i.threshold=t.threshold.value),t.store.changed&&(i.values=this.getCurrentValues()),t.delete.changed&&delete s[r]}else if(r&&t.store.changed){const e={id:this.ins.id.value,curve:this.ins.curve.getValidatedValue(),duration:this.ins.duration.value,threshold:this.ins.threshold.value,values:this.getCurrentValues()};s[e.id]=e}return!0}tick(e){const t=this._targetState;if(!t)return!1;const s=this.outs,r=this._currentValues,i=this._startTime,n=e.secondsElapsed-i,o=n/t.duration;if(o<1){const e=this._easingFunction(o),i=o>=t.threshold&&!s.switched.value;this.setValues(r,t.values,e,i),s.time.setValue(n),s.completed.setValue(o),i&&(s.switched.setValue(!0),s.switch.set())}else this.setValues(r,t.values,1,!s.switched.value),s.tweening.setValue(!1),s.time.setValue(t.duration),s.completed.setValue(1),s.end.set(),s.switched.value||s.switched.setValue(!0),this._currentValues=null,this._targetState=null,this._startTime=0,this._easingFunction=null;return!0}addTargetProperty(e){if("object"===e.type||e.schema.event)throw new Error("can't add object or event properties");if(this.getTarget(e))throw new Error("can't add, target already exists");e.on("dispose",this.onPropertyDispose,this);const t="number"===e.type&&!e.schema.options,s=e.isArray();this.targets.push({property:e,isNumber:t,isArray:s});const r=this.states,i=Object.keys(r);for(let t=0,s=i.length;t<s;++t)r[i[t]].values.push(e.cloneValue());this._currentValues&&this._currentValues.push(e.cloneValue())}removeTargetProperty(e){const t=this.getTarget(e);if(!t)throw new Error("can't remove, target doesn't exist");this.removeTarget(t)}hasTargetProperty(e){return!!this.getTarget(e)}fromJSON(e){super.fromJSON(e),e.state&&this.stateFromJSON(e.state)}stateFromJSON(e){e.targets&&(this.targets=e.targets.map(e=>{const t=this.getProperty(e.id,e.key);return{property:t,isNumber:!!t&&"number"===t.type&&!t.schema.options,isArray:!!t&&t.isArray()}})),e.states&&e.states.forEach(e=>this.states[e.id]=e),this._startTime=0}toJSON(){const e=super.toJSON(),t=this.stateToJSON();return t&&(e.state=t),e}stateToJSON(){const e={},t=this.targets;t.length>0&&(e.targets=t.map(e=>({id:e.property.group.linkable.id,key:e.property.key})));const s=Object.keys(this.states);return s.length>0&&(e.states=s.map(e=>this.states[e])),e}getTargetProperties(){return this.targets.map(e=>e.property)}onPropertyDispose(e){e.property.off("dispose",this.onPropertyDispose,this);const t=this.getTarget(e.property);this.removeTarget(t)}removeTarget(e){const t=this.targets.indexOf(e);this.targets.splice(t,1),this.removeChannel(t)}removeChannel(e){const t=this.states,s=Object.keys(t);for(let r=0,i=s.length;r<i;++r)t[s[r]].values.splice(e,1);this._currentValues&&this._currentValues.splice(e,1)}getTarget(e){return this.targets.find(t=>t.property===e)}getProperty(e,t){const s=this.system.components.getById(e);return s?s.ins[t]:null}setValues(e,t,s,r){const i=this.targets;for(let n=0,o=i.length;n<o;++n){const o=i[n],a=o.property;if(o.isNumber&&t){const r=e[n],i=t[n];if(o.isArray){let e=!1;for(let t=0,n=r.length;t<n;++t){const n=r[t]+s*(i[t]-r[t]);e=a.value[t]!==n||e,a.value[t]=n}e&&a.set()}else{const e=r+s*(i-r);e!==a.value&&a.setValue(e)}}else if(!t||r){const s=t?t[n]:e[n];if(o.isArray){let e=!1;for(let t=0,r=s.length;t<r;++t)e=a.value[t]!==s[t]||e,a.value[t]=s[t];e&&a.set()}else s!==a.value&&a.setValue(s)}}}getCurrentValues(){const e=[],t=this.targets;for(let s=0,r=t.length;s<r;++s)e.push(t[s].property.cloneValue());return e}}t.default=o,o.typeName="CTweenMachine",o.ins={id:i.types.String("Snapshot.Id"),curve:i.types.Enum("Tween.Curve",r.EEasingCurve),duration:i.types.Number("Tween.Duration",2),threshold:i.types.Percent("Tween.Threshold",.5),tween:i.types.Event("Control.Tween"),recall:i.types.Event("Control.Recall"),store:i.types.Event("Control.Store"),delete:i.types.Event("Control.Delete"),clear:i.types.Event("Control.Clear")},o.outs={count:i.types.Integer("Snapshots.Count"),tweening:i.types.Boolean("Tween.IsTweening"),time:i.types.Number("Tween.Time"),completed:i.types.Percent("Tween.Completed"),switched:i.types.Boolean("Tween.Switched"),start:i.types.Event("Tween.Start"),switch:i.types.Event("Tween.Switch"),end:i.types.Event("Tween.End")}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(73),n=s(53),o=s(142),a=s(11),l=s(21),c=s(31),h={viewportPicking:r.types.Boolean("Viewport.Picking",!0),viewportBrackets:r.types.Boolean("Viewport.Brackets",!0)};class u extends n.default{constructor(){super(...arguments),this.ins=this.addInputs(h),this._brackets=new Map,this._sceneTracker=null}create(){super.create(),this.system.on("pointer-up",this.onPointerUp,this),this._sceneTracker=new i.default(this.system.components,c.default,e=>{e.on("after-render",this.onSceneAfterRender,this)},e=>{e.off("after-render",this.onSceneAfterRender,this)})}dispose(){this._sceneTracker.dispose(),this.system.off("pointer-up",this.onPointerUp,this),this._sceneTracker.dispose(),super.dispose()}update(){return!0}onSelectNode(e,t){super.onSelectNode(e,t);const s=e.getComponent(l.default,!0);s&&this.updateBracket(s,t)}onSelectComponent(e,t){super.onSelectComponent(e,t),(e instanceof a.default||e instanceof l.default)&&this.updateBracket(e,t)}onPointerUp(e){this.ins.viewportPicking.value&&e.isPrimary&&!e.isDragging&&(e.component?this.selectComponent(e.component,e.ctrlKey):e.ctrlKey||this.clearSelection())}onSceneAfterRender(e){if(!this.ins.viewportBrackets.value)return;const t=e.context.renderer,s=e.context.camera;for(let e of this._brackets)t.render(e[1],s)}updateBracket(e,t){if(e){if(t){if(e.object3D){const t=new o.default(e.object3D);this._brackets.set(e,t)}}else{const t=this._brackets.get(e);t&&(this._brackets.delete(e),t.dispose())}this.changed=!0}}}t.default=u,u.typeName="CPickSelection"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(10);t.Node=i.default;const n=s(41),o=(e,t,s)=>{let r;const i=e.children;for(let e=0,s=i.length;e<s;++e)if(r=i[e].components.has(t))return!0;if(s)for(let e=0,s=i.length;e<s;++e)if(r=o(i[e],t,!0))return!0;return!1},a=(e,t,s)=>{let r;const i=e.children;for(let e=0,s=i.length;e<s;++e)if(r=i[e].components.get(t))return r;if(s)for(let e=0,s=i.length;e<s;++e)if(r=a(i[e],t,!0))return r;return null},l=(e,t,s)=>{let r=[];const i=e.children;for(let e=0,s=i.length;e<s;++e)r=r.concat(i[e].components.getArray(t));if(s)for(let e=0,s=i.length;e<s;++e)r=r.concat(l(i[e],t,!0));return r};class c extends r.default{constructor(){super(...arguments),this._parent=null,this._children=[]}get parent(){return this._parent}get children(){return this._children||[]}create(){super.create(),this.graph._addRoot(this),this.node.components.on(r.default,this.onComponent,this)}dispose(){this.node.components.off(r.default,this.onComponent,this),this._children.slice().forEach(e=>e.node.dispose()),this._parent&&this._parent.removeChild(this),this.graph._removeRoot(this),super.dispose()}getRootComponent(e){let t=this;for(;t._parent;)t=t._parent;return t?t.node.components.get(e):null}getParentComponent(e,t){let s=this;for(;;){if(!(s=s._parent)){const e=this.graph.parent;s=e?e.components.get(c):void 0}if(!s)return;const r=s.node.components.get(e,!0);if(r)return r;if(!t)return}}getParentNode(e,t){let s=this;for(;;){if(!(s=s._parent)){const e=this.graph.parent;s=e?e.components.get(c):void 0}if(!s)return;const r=s.node;if(r.is(e))return r;if(!t)return}}getSiblingNode(e){return this.getSiblingNodes(e)[0]}getSiblingNodes(e){const t=this._parent;return this.graph.nodes.getArray(e).filter(e=>{const s=e.components.get(c);return(s?s._parent:null)==t})}hasChildComponents(e,t){return o(this,e,t)}getChildComponent(e,t){return a(this,e,t)}getChildComponents(e,t){return l(this,e,t)}traverseUp(e,t,s,r){if(e)if(t){const e=this.node.components.getArray();for(let t=0,s=e.length;t<s;++t)if(r(e[t]))return}else if(r(this))return;let i=this._parent;if(!i&&s){const e=this.node.graph.parent;i=e?e.getComponent(c,!0):null}i&&i.traverseUp(!0,t,s,r)}traverseDown(e,t,s,r){if(e)if(t){const e=this.node.components.getArray();for(let t=0,s=e.length;t<s;++t)if(r(e[t]))return}else if(r(this))return;if(s){const e=this.node.components.getArray(n.default);for(let i=0,n=e.length;i<n;++i){const n=e[i].innerRoots;for(let e=0,i=n.length;e<i;++e)n[e].traverseDown(!0,t,s,r)}}const i=this._children;for(let e=0,n=i.length;e<n;++e)i[e].traverseDown(!0,t,s,r)}propagateUp(e,t,s){this.traverseUp(!0,e,t,e=>(e.emit(s),s.stopPropagation))}propagateDown(e,t,s){this.traverseDown(!0,e,t,e=>(e.emit(s),s.stopPropagation))}addChild(e){if(e===this)throw new Error("can't add self as child");if(e._parent)throw new Error("can't add child, component has a parent");if(e.graph!==this.graph)throw new Error("can't add child, component in different graph");e._parent=this,this._children.push(e),this.graph._removeRoot(e);const t={type:"hierarchy",add:!0,remove:!1,parent:this,child:e};this.traverseUp(!0,!1,!0,e=>e.emit(t)),this.traverseDown(!1,!1,!0,e=>e.emit(t)),this.system.emit(t)}removeChild(e){if(e._parent!==this)throw new Error("component not a child of this");const t={type:"hierarchy",add:!1,remove:!0,parent:this,child:e};this.traverseUp(!0,!1,!0,e=>e.emit(t)),this.traverseDown(!1,!1,!0,e=>e.emit(t)),this.system.emit(t);const s=this._children.indexOf(e);this._children.splice(s,1),e._parent=null,this.graph._addRoot(e)}onComponent(e){if(e.object===this)return;const t={type:"child",add:e.add,remove:e.remove,component:e.object};this.traverseUp(!0,!1,!0,e=>e.emit(t))}toJSON(){const e=super.toJSON();return this._children.length>0&&(e.children=this._children.map(e=>e.id)),e}referencesFromJSON(e){super.referencesFromJSON(e);const t=this.system.components.getDictionary();e.children&&e.children.forEach(e=>{const s=t[e];this.addChild(s)})}toString(){return super.toString()+` - children: ${this.children.length}`}dump(e=""){super.dump(e),this.children.length>0&&(console.log(e+"%cChildren","color: purple"),this.children.forEach(t=>t.node.dump(e+"  ")))}}t.default=c,c.typeName="CHierarchy"},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function o(e){try{l(r.next(e))}catch(e){n(e)}}function a(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=s(1);t.default=class{constructor(e){this._loadingManager=e,this._textureLoader=new i.TextureLoader(e),this._cache={}}get(e){return this._cache[e]}load(e){return r(this,void 0,void 0,(function*(){if(this._cache[e])return Promise.resolve(this._cache[e]);this._loadingManager.itemStart(e);const t=e+".json",s=e+".png",r=fetch(t,{headers:{Accept:"application/json"}}).then(s=>{if(!s.ok)throw this._loadingManager.itemError(e),new Error(`failed to load bitmap font descriptor: '${t}', status: ${s.status} ${s.statusText}`);return s.json()}),i=new Promise((e,t)=>{this._textureLoader.load(s,r=>r?e(r):t(new Error(`failed to load font texture from '${s}'`)))});return Promise.all([r,i]).then(t=>{const s={descriptor:t[0],texture:t[1]};return this._cache[e]=s,this._loadingManager.itemEnd(e),s})}))}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(158),i=s(0),n=s(159),o=s(160),a=s(34),l=s(104),c=s(28),h=s(45),u=s(19),d=s(13);class p extends n.default{constructor(e,t){super(e,t),this.ins=this.addInputs(p.ins),this.outs=this.addOutputs(p.outs),this.innerGraph.createCustomNode(l.default),this.ins.active.setValue(!1),this.ins.visible.setValue(!1)}get root(){return this.innerNodes.get(l.default)}get setup(){return this.innerComponents.get(h.default)}get assetPath(){return this.outs.assetPath.value}get assetBaseName(){let e=this.assetPath;const t=e.indexOf(".svx.json");return t>=0&&(e=e.substr(0,t)),e}get analytics(){return this.getMainComponent(d.default)}create(){super.create(),this.innerGraph.components.on(c.default,this.onMetaComponent,this)}dispose(){this.innerGraph.components.off(c.default,this.onMetaComponent,this),super.dispose()}update(e){super.update(e);const{ins:t,outs:s}=this;if(t.dumpJson.changed){const e=this.deflateDocument();console.log("-------------------- VOYAGER DOCUMENT --------------------"),console.log(JSON.stringify(e,(e,t)=>"number"==typeof t?parseFloat(t.toFixed(5)):t,2))}if(t.dumpTree.changed&&(console.log("-------------------- VOYAGER DOCUMENT --------------------"),this.dump()),t.download.changed){const e=s.assetPath.value.split("/").pop()||"voyager-document.json";r.default.json(this.deflateDocument(),e)}return!0}clearNodeTree(){this.root.transform.children.slice().forEach(e=>e.node.dispose())}openDocument(e,t,s){if(!p.validator.validate(e))throw new Error("document schema validation failed");s||this.clearNodeTree(),this.onMetaComponent({type:"CVMeta",object:this.root.meta,add:!0,remove:!1});let r="object"==typeof s?s:this.root;if(r.graph!==this.innerGraph)throw new Error("invalid parent node");const i=new Map;if(r instanceof l.default)r.fromDocument(e,e.scene,i);else{e.scenes[e.scene].nodes.forEach(t=>{const s=this.innerGraph.createCustomNode(a.default);r.transform.addChild(s.transform),s.fromDocument(e,t,i)})}t&&(this.outs.assetPath.setValue(t),this.name=this.getMainComponent(u.default).getAssetName(t))}appendModel(e,t,s){if(s&&s.graph!==this.innerGraph)throw new Error("invalid parent node");if(this.isEmpty())throw new Error("empty document, can't append model");s=s||this.root;const r=this.innerGraph.createCustomNode(a.default);s.transform.addChild(r.transform),r.createModel(),r.model.derivatives.createModelAsset(e,t)}appendGeometry(e,t,s,r,i,n){if(n&&n.graph!==this.innerGraph)throw new Error("invalid parent node");if(this.isEmpty())throw new Error("empty document, can't append geometry");n=n||this.root;const o=this.innerGraph.createCustomNode(a.default);n.transform.addChild(o.transform),o.createModel(),o.model.derivatives.createMeshAsset(e,t,s,r,i)}deflateDocument(e){if(this.isEmpty())throw new Error("empty document, can't serialize");const t={asset:{type:p.mimeType,version:p.version,generator:"Voyager",copyright:"(c) Smithsonian Institution. All rights reserved."},scene:0,scenes:[]},s=new Map;return t.scene=this.root.toDocument(t,s,e),t}onMetaComponent(e){const t=e.object,s=this.outs.title;e.add&&!s.value&&t.once("load",()=>{const e=t.collection.get("title")||"";s.setValue(e),this.analytics.setTitle(e)})}}t.default=p,p.typeName="CVDocument",p.mimeType="application/si-dpo-3d.document+json",p.version="1.0",p.validator=new o.default,p.ins={dumpJson:i.types.Event("Document.DumpJSON"),dumpTree:i.types.Event("Document.DumpTree"),download:i.types.Event("Document.Download")},p.outs={assetPath:i.types.AssetPath("Asset.Path"),title:i.types.String("Document.Title")}},function(e,t,s){"use strict";var r=s(27);e.exports=function(e){r.copy(e,this)}},function(e,t,s){"use strict";e.exports=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var s,r="boolean"==typeof t.cycles&&t.cycles,i=t.cmp&&(s=t.cmp,function(e){return function(t,r){var i={key:t,value:e[t]},n={key:r,value:e[r]};return s(i,n)}}),n=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);var s,o;if(Array.isArray(t)){for(o="[",s=0;s<t.length;s++)s&&(o+=","),o+=e(t[s])||"null";return o+"]"}if(null===t)return"null";if(-1!==n.indexOf(t)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var a=n.push(t)-1,l=Object.keys(t).sort(i&&i(t));for(o="",s=0;s<l.length;s++){var c=l[s],h=e(t[c]);h&&(o&&(o+=","),o+=JSON.stringify(c)+":"+h)}return n.splice(a,1),"{"+o+"}"}}(e)}},function(e,t,s){"use strict";e.exports=function(e,t,s){var r="",i=!0===e.schema.$async,n=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"),o=e.self._getId(e.schema);if(e.opts.strictKeywords){var a=e.util.schemaUnknownRules(e.schema,e.RULES.keywords);if(a){var l="unknown keyword: "+a;if("log"!==e.opts.strictKeywords)throw new Error(l);e.logger.warn(l)}}if(e.isTop&&(r+=" var validate = ",i&&(e.async=!0,r+="async "),r+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",o&&(e.opts.sourceCode||e.opts.processCode)&&(r+=" /*# sourceURL="+o+" */ ")),"boolean"==typeof e.schema||!n&&!e.schema.$ref){var c=e.level,h=e.dataLevel,u=e.schema["false schema"],d=e.schemaPath+e.util.getProperty("false schema"),p=e.errSchemaPath+"/false schema",f=!e.opts.allErrors,m="data"+(h||""),v="valid"+c;if(!1===e.schema){e.isTop?f=!0:r+=" var "+v+" = false; ",(J=J||[]).push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'false schema' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(p)+" , params: {} ",!1!==e.opts.messages&&(r+=" , message: 'boolean schema is false' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";var g=r;r=J.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+g+"]); ":r+=" validate.errors = ["+g+"]; return false; ":r+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else e.isTop?r+=i?" return data; ":" validate.errors = null; return true; ":r+=" var "+v+" = true; ";return e.isTop&&(r+=" }; return validate; "),r}if(e.isTop){var y=e.isTop;c=e.level=0,h=e.dataLevel=0,m="data";if(e.rootId=e.resolve.fullPath(e.self._getId(e.root.schema)),e.baseId=e.baseId||e.rootId,delete e.isTop,e.dataPathArr=[void 0],void 0!==e.schema.default&&e.opts.useDefaults&&e.opts.strictDefaults){var b="default is ignored in the schema root";if("log"!==e.opts.strictDefaults)throw new Error(b);e.logger.warn(b)}r+=" var vErrors = null; ",r+=" var errors = 0;     ",r+=" if (rootData === undefined) rootData = data; "}else{c=e.level,m="data"+((h=e.dataLevel)||"");if(o&&(e.baseId=e.resolve.url(e.baseId,o)),i&&!e.async)throw new Error("async schema in sync schema");r+=" var errs_"+c+" = errors;"}v="valid"+c,f=!e.opts.allErrors;var w="",_="",E=e.schema.type,x=Array.isArray(E);if(E&&e.opts.nullable&&!0===e.schema.nullable&&(x?-1==E.indexOf("null")&&(E=E.concat("null")):"null"!=E&&(E=[E,"null"],x=!0)),x&&1==E.length&&(E=E[0],x=!1),e.schema.$ref&&n){if("fail"==e.opts.extendRefs)throw new Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'" (see option extendRefs)');!0!==e.opts.extendRefs&&(n=!1,e.logger.warn('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"'))}if(e.schema.$comment&&e.opts.$comment&&(r+=" "+e.RULES.all.$comment.code(e,"$comment")),E){if(e.opts.coerceTypes)var P=e.util.coerceToTypes(e.opts.coerceTypes,E);var S=e.RULES.types[E];if(P||x||!0===S||S&&!K(S)){d=e.schemaPath+".type",p=e.errSchemaPath+"/type",d=e.schemaPath+".type",p=e.errSchemaPath+"/type";var C=x?"checkDataTypes":"checkDataType";if(r+=" if ("+e.util[C](E,m,!0)+") { ",P){var T="dataType"+c,M="coerced"+c;r+=" var "+T+" = typeof "+m+"; ","array"==e.opts.coerceTypes&&(r+=" if ("+T+" == 'object' && Array.isArray("+m+")) "+T+" = 'array'; "),r+=" var "+M+" = undefined; ";var A="",O=P;if(O)for(var R,D=-1,j=O.length-1;D<j;)R=O[D+=1],D&&(r+=" if ("+M+" === undefined) { ",A+="}"),"array"==e.opts.coerceTypes&&"array"!=R&&(r+=" if ("+T+" == 'array' && "+m+".length == 1) { "+M+" = "+m+" = "+m+"[0]; "+T+" = typeof "+m+";  } "),"string"==R?r+=" if ("+T+" == 'number' || "+T+" == 'boolean') "+M+" = '' + "+m+"; else if ("+m+" === null) "+M+" = ''; ":"number"==R||"integer"==R?(r+=" if ("+T+" == 'boolean' || "+m+" === null || ("+T+" == 'string' && "+m+" && "+m+" == +"+m+" ","integer"==R&&(r+=" && !("+m+" % 1)"),r+=")) "+M+" = +"+m+"; "):"boolean"==R?r+=" if ("+m+" === 'false' || "+m+" === 0 || "+m+" === null) "+M+" = false; else if ("+m+" === 'true' || "+m+" === 1) "+M+" = true; ":"null"==R?r+=" if ("+m+" === '' || "+m+" === 0 || "+m+" === false) "+M+" = null; ":"array"==e.opts.coerceTypes&&"array"==R&&(r+=" if ("+T+" == 'string' || "+T+" == 'number' || "+T+" == 'boolean' || "+m+" == null) "+M+" = ["+m+"]; ");r+=" "+A+" if ("+M+" === undefined) {   ",(J=J||[]).push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(p)+" , params: { type: '",r+=x?""+E.join(","):""+E,r+="' } ",!1!==e.opts.messages&&(r+=" , message: 'should be ",r+=x?""+E.join(","):""+E,r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+d+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";g=r;r=J.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+g+"]); ":r+=" validate.errors = ["+g+"]; return false; ":r+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else {  ";var k=h?"data"+(h-1||""):"parentData";r+=" "+m+" = "+M+"; ",h||(r+="if ("+k+" !== undefined)"),r+=" "+k+"["+(h?e.dataPathArr[h]:"parentDataProperty")+"] = "+M+"; } "}else{(J=J||[]).push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(p)+" , params: { type: '",r+=x?""+E.join(","):""+E,r+="' } ",!1!==e.opts.messages&&(r+=" , message: 'should be ",r+=x?""+E.join(","):""+E,r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+d+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";g=r;r=J.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+g+"]); ":r+=" validate.errors = ["+g+"]; return false; ":r+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}r+=" } "}}if(e.schema.$ref&&!n)r+=" "+e.RULES.all.$ref.code(e,"$ref")+" ",f&&(r+=" } if (errors === ",r+=y?"0":"errs_"+c,r+=") { ",_+="}");else{var L=e.RULES;if(L)for(var N=-1,V=L.length-1;N<V;)if(K(S=L[N+=1])){if(S.type&&(r+=" if ("+e.util.checkDataType(S.type,m)+") { "),e.opts.useDefaults)if("object"==S.type&&e.schema.properties){u=e.schema.properties;var I=Object.keys(u);if(I)for(var B,z=-1,F=I.length-1;z<F;){if(void 0!==(H=u[B=I[z+=1]]).default){var $=m+e.util.getProperty(B);if(e.compositeRule){if(e.opts.strictDefaults){b="default is ignored for: "+$;if("log"!==e.opts.strictDefaults)throw new Error(b);e.logger.warn(b)}}else r+=" if ("+$+" === undefined ","empty"==e.opts.useDefaults&&(r+=" || "+$+" === null || "+$+" === '' "),r+=" ) "+$+" = ","shared"==e.opts.useDefaults?r+=" "+e.useDefault(H.default)+" ":r+=" "+JSON.stringify(H.default)+" ",r+="; "}}}else if("array"==S.type&&Array.isArray(e.schema.items)){var U=e.schema.items;if(U){D=-1;for(var H,G=U.length-1;D<G;)if(void 0!==(H=U[D+=1]).default){$=m+"["+D+"]";if(e.compositeRule){if(e.opts.strictDefaults){b="default is ignored for: "+$;if("log"!==e.opts.strictDefaults)throw new Error(b);e.logger.warn(b)}}else r+=" if ("+$+" === undefined ","empty"==e.opts.useDefaults&&(r+=" || "+$+" === null || "+$+" === '' "),r+=" ) "+$+" = ","shared"==e.opts.useDefaults?r+=" "+e.useDefault(H.default)+" ":r+=" "+JSON.stringify(H.default)+" ",r+="; "}}}var q=S.rules;if(q)for(var Q,Y=-1,X=q.length-1;Y<X;)if(Z(Q=q[Y+=1])){var W=Q.code(e,Q.keyword,S.type);W&&(r+=" "+W+" ",f&&(w+="}"))}if(f&&(r+=" "+w+" ",w=""),S.type&&(r+=" } ",E&&E===S.type&&!P)){r+=" else { ";var J;d=e.schemaPath+".type",p=e.errSchemaPath+"/type";(J=J||[]).push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(p)+" , params: { type: '",r+=x?""+E.join(","):""+E,r+="' } ",!1!==e.opts.messages&&(r+=" , message: 'should be ",r+=x?""+E.join(","):""+E,r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+d+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";g=r;r=J.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+g+"]); ":r+=" validate.errors = ["+g+"]; return false; ":r+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } "}f&&(r+=" if (errors === ",r+=y?"0":"errs_"+c,r+=") { ",_+="}")}}function K(e){for(var t=e.rules,s=0;s<t.length;s++)if(Z(t[s]))return!0}function Z(t){return void 0!==e.schema[t.keyword]||t.implements&&function(t){for(var s=t.implements,r=0;r<s.length;r++)if(void 0!==e.schema[s[r]])return!0}(t)}return f&&(r+=" "+_+" "),y?(i?(r+=" if (errors === 0) return data;           ",r+=" else throw new ValidationError(vErrors); "):(r+=" validate.errors = vErrors; ",r+=" return errors === 0;       "),r+=" }; return validate;"):r+=" var "+v+" = errors === errs_"+c+";",r=e.util.cleanUpCode(r),y&&(r=e.util.finalCleanUpCode(r,i)),r}},function(e,t,s){"use strict";e.exports=function(e,t,s){var r,i=" ",n=e.level,o=e.dataLevel,a=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,h=!e.opts.allErrors,u="data"+(o||""),d=e.opts.$data&&a&&a.$data;d?(i+=" var schema"+n+" = "+e.util.getData(a.$data,o,e.dataPathArr)+"; ",r="schema"+n):r=a;var p="maximum"==t,f=p?"exclusiveMaximum":"exclusiveMinimum",m=e.schema[f],v=e.opts.$data&&m&&m.$data,g=p?"<":">",y=p?">":"<",b=void 0;if(v){var w=e.util.getData(m.$data,o,e.dataPathArr),_="exclusive"+n,E="exclType"+n,x="exclIsNumber"+n,P="' + "+(T="op"+n)+" + '";i+=" var schemaExcl"+n+" = "+w+"; ",i+=" var "+_+"; var "+E+" = typeof "+(w="schemaExcl"+n)+"; if ("+E+" != 'boolean' && "+E+" != 'undefined' && "+E+" != 'number') { ";var S;b=f;(S=S||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(b||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",!1!==e.opts.messages&&(i+=" , message: '"+f+" should be boolean' "),e.opts.verbose&&(i+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";var C=i;i=S.pop(),!e.compositeRule&&h?e.async?i+=" throw new ValidationError(["+C+"]); ":i+=" validate.errors = ["+C+"]; return false; ":i+=" var err = "+C+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } else if ( ",d&&(i+=" ("+r+" !== undefined && typeof "+r+" != 'number') || "),i+=" "+E+" == 'number' ? ( ("+_+" = "+r+" === undefined || "+w+" "+g+"= "+r+") ? "+u+" "+y+"= "+w+" : "+u+" "+y+" "+r+" ) : ( ("+_+" = "+w+" === true) ? "+u+" "+y+"= "+r+" : "+u+" "+y+" "+r+" ) || "+u+" !== "+u+") { var op"+n+" = "+_+" ? '"+g+"' : '"+g+"='; ",void 0===a&&(b=f,c=e.errSchemaPath+"/"+f,r=w,d=v)}else{P=g;if((x="number"==typeof m)&&d){var T="'"+P+"'";i+=" if ( ",d&&(i+=" ("+r+" !== undefined && typeof "+r+" != 'number') || "),i+=" ( "+r+" === undefined || "+m+" "+g+"= "+r+" ? "+u+" "+y+"= "+m+" : "+u+" "+y+" "+r+" ) || "+u+" !== "+u+") { "}else{x&&void 0===a?(_=!0,b=f,c=e.errSchemaPath+"/"+f,r=m,y+="="):(x&&(r=Math[p?"min":"max"](m,a)),m===(!x||r)?(_=!0,b=f,c=e.errSchemaPath+"/"+f,y+="="):(_=!1,P+="="));T="'"+P+"'";i+=" if ( ",d&&(i+=" ("+r+" !== undefined && typeof "+r+" != 'number') || "),i+=" "+u+" "+y+" "+r+" || "+u+" !== "+u+") { "}}b=b||t,(S=S||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(b||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { comparison: "+T+", limit: "+r+", exclusive: "+_+" } ",!1!==e.opts.messages&&(i+=" , message: 'should be "+P+" ",i+=d?"' + "+r:r+"'"),e.opts.verbose&&(i+=" , schema:  ",i+=d?"validate.schema"+l:""+a,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";C=i;return i=S.pop(),!e.compositeRule&&h?e.async?i+=" throw new ValidationError(["+C+"]); ":i+=" validate.errors = ["+C+"]; return false; ":i+=" var err = "+C+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } ",h&&(i+=" else { "),i}},function(e,t,s){"use strict";e.exports=function(e,t,s){var r,i=" ",n=e.level,o=e.dataLevel,a=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,h=!e.opts.allErrors,u="data"+(o||""),d=e.opts.$data&&a&&a.$data;d?(i+=" var schema"+n+" = "+e.util.getData(a.$data,o,e.dataPathArr)+"; ",r="schema"+n):r=a,i+="if ( ",d&&(i+=" ("+r+" !== undefined && typeof "+r+" != 'number') || "),i+=" "+u+".length "+("maxItems"==t?">":"<")+" "+r+") { ";var p=t,f=f||[];f.push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(p||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+r+" } ",!1!==e.opts.messages&&(i+=" , message: 'should NOT have ",i+="maxItems"==t?"more":"fewer",i+=" than ",i+=d?"' + "+r+" + '":""+a,i+=" items' "),e.opts.verbose&&(i+=" , schema:  ",i+=d?"validate.schema"+l:""+a,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";var m=i;return i=f.pop(),!e.compositeRule&&h?e.async?i+=" throw new ValidationError(["+m+"]); ":i+=" validate.errors = ["+m+"]; return false; ":i+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",h&&(i+=" else { "),i}},function(e,t,s){"use strict";e.exports=function(e,t,s){var r,i=" ",n=e.level,o=e.dataLevel,a=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,h=!e.opts.allErrors,u="data"+(o||""),d=e.opts.$data&&a&&a.$data;d?(i+=" var schema"+n+" = "+e.util.getData(a.$data,o,e.dataPathArr)+"; ",r="schema"+n):r=a;var p="maxLength"==t?">":"<";i+="if ( ",d&&(i+=" ("+r+" !== undefined && typeof "+r+" != 'number') || "),!1===e.opts.unicode?i+=" "+u+".length ":i+=" ucs2length("+u+") ",i+=" "+p+" "+r+") { ";var f=t,m=m||[];m.push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(f||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+r+" } ",!1!==e.opts.messages&&(i+=" , message: 'should NOT be ",i+="maxLength"==t?"longer":"shorter",i+=" than ",i+=d?"' + "+r+" + '":""+a,i+=" characters' "),e.opts.verbose&&(i+=" , schema:  ",i+=d?"validate.schema"+l:""+a,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";var v=i;return i=m.pop(),!e.compositeRule&&h?e.async?i+=" throw new ValidationError(["+v+"]); ":i+=" validate.errors = ["+v+"]; return false; ":i+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",h&&(i+=" else { "),i}},function(e,t,s){"use strict";e.exports=function(e,t,s){var r,i=" ",n=e.level,o=e.dataLevel,a=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,h=!e.opts.allErrors,u="data"+(o||""),d=e.opts.$data&&a&&a.$data;d?(i+=" var schema"+n+" = "+e.util.getData(a.$data,o,e.dataPathArr)+"; ",r="schema"+n):r=a,i+="if ( ",d&&(i+=" ("+r+" !== undefined && typeof "+r+" != 'number') || "),i+=" Object.keys("+u+").length "+("maxProperties"==t?">":"<")+" "+r+") { ";var p=t,f=f||[];f.push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(p||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+r+" } ",!1!==e.opts.messages&&(i+=" , message: 'should NOT have ",i+="maxProperties"==t?"more":"fewer",i+=" than ",i+=d?"' + "+r+" + '":""+a,i+=" properties' "),e.opts.verbose&&(i+=" , schema:  ",i+=d?"validate.schema"+l:""+a,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";var m=i;return i=f.pop(),!e.compositeRule&&h?e.async?i+=" throw new ValidationError(["+m+"]); ":i+=" validate.errors = ["+m+"]; return false; ":i+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",h&&(i+=" else { "),i}},function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"http://json-schema.org/draft-07/schema#","title":"Core schema meta-schema","definitions":{"schemaArray":{"type":"array","minItems":1,"items":{"$ref":"#"}},"nonNegativeInteger":{"type":"integer","minimum":0},"nonNegativeIntegerDefault0":{"allOf":[{"$ref":"#/definitions/nonNegativeInteger"},{"default":0}]},"simpleTypes":{"enum":["array","boolean","integer","null","number","object","string"]},"stringArray":{"type":"array","items":{"type":"string"},"uniqueItems":true,"default":[]}},"type":["object","boolean"],"properties":{"$id":{"type":"string","format":"uri-reference"},"$schema":{"type":"string","format":"uri"},"$ref":{"type":"string","format":"uri-reference"},"$comment":{"type":"string"},"title":{"type":"string"},"description":{"type":"string"},"default":true,"readOnly":{"type":"boolean","default":false},"examples":{"type":"array","items":true},"multipleOf":{"type":"number","exclusiveMinimum":0},"maximum":{"type":"number"},"exclusiveMaximum":{"type":"number"},"minimum":{"type":"number"},"exclusiveMinimum":{"type":"number"},"maxLength":{"$ref":"#/definitions/nonNegativeInteger"},"minLength":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"pattern":{"type":"string","format":"regex"},"additionalItems":{"$ref":"#"},"items":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/schemaArray"}],"default":true},"maxItems":{"$ref":"#/definitions/nonNegativeInteger"},"minItems":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"uniqueItems":{"type":"boolean","default":false},"contains":{"$ref":"#"},"maxProperties":{"$ref":"#/definitions/nonNegativeInteger"},"minProperties":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"required":{"$ref":"#/definitions/stringArray"},"additionalProperties":{"$ref":"#"},"definitions":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"properties":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"patternProperties":{"type":"object","additionalProperties":{"$ref":"#"},"propertyNames":{"format":"regex"},"default":{}},"dependencies":{"type":"object","additionalProperties":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/stringArray"}]}},"propertyNames":{"$ref":"#"},"const":true,"enum":{"type":"array","items":true,"minItems":1,"uniqueItems":true},"type":{"anyOf":[{"$ref":"#/definitions/simpleTypes"},{"type":"array","items":{"$ref":"#/definitions/simpleTypes"},"minItems":1,"uniqueItems":true}]},"format":{"type":"string"},"contentMediaType":{"type":"string"},"contentEncoding":{"type":"string"},"if":{"$ref":"#"},"then":{"$ref":"#"},"else":{"$ref":"#"},"allOf":{"$ref":"#/definitions/schemaArray"},"anyOf":{"$ref":"#/definitions/schemaArray"},"oneOf":{"$ref":"#/definitions/schemaArray"},"not":{"$ref":"#"}},"default":true}')},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(200);class i extends r.default{get settingProperties(){return[this.ins.projection,this.ins.fov,this.ins.size,this.ins.near,this.ins.far]}fromDocument(e,t){if(!isFinite(t.camera))throw new Error("camera property missing in node");const s=e.cameras[t.camera];return"perspective"===s.type?this.ins.copyValues({projection:r.EProjection.Perspective,fov:s.perspective.yfov,near:s.perspective.znear,far:s.perspective.zfar}):this.ins.copyValues({projection:r.EProjection.Orthographic,size:s.orthographic.ymag,near:s.orthographic.znear,far:s.orthographic.zfar}),t.camera}toDocument(e,t){const s=this.ins,i={};s.projection.getValidatedValue()===r.EProjection.Perspective?(i.type="perspective",i.perspective={yfov:s.fov.value,znear:s.near.value,zfar:s.far.value}):(i.type="orthographic",i.orthographic={ymag:s.size.value,znear:s.near.value,zfar:s.far.value}),e.cameras=e.cameras||[];const n=e.cameras.length;return e.cameras.push(i),n}}t.default=i,i.typeName="CVCamera",i.text="Camera",i.icon="video"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(202),i=s(14);class n extends r.default{get settingProperties(){return[this.ins.color,this.ins.intensity,this.ins.shadowEnabled,this.ins.shadowSize,this.ins.shadowResolution,this.ins.shadowBlur]}get snapshotProperties(){return[this.ins.color,this.ins.intensity]}fromDocument(e,t){if(!isFinite(t.light))throw new Error("light property missing in node");const s=e.lights[t.light],r=this.ins;if("directional"!==s.type)throw new Error("light type mismatch: not a directional light");return r.copyValues({color:void 0!==s.color?s.color:r.color.schema.preset,intensity:void 0!==s.intensity?s.intensity:r.intensity.schema.preset,position:r.position.schema.preset,target:r.target.schema.preset,shadowEnabled:s.shadowEnabled||!1,shadowSize:void 0!==s.shadowSize?s.shadowSize:r.shadowSize.schema.preset,shadowResolution:void 0!==s.shadowResolution&&i.EShadowMapResolution[s.shadowResolution]||1,shadowBlur:void 0!==s.shadowBlur?s.shadowBlur:r.shadowBlur.schema.preset}),t.light}toDocument(e,t){const s=this.ins,r={color:s.color.cloneValue(),intensity:s.intensity.value,type:"directional"};s.shadowEnabled.value&&(r.shadowEnabled=!0,s.shadowSize.isDefault()||(r.shadowSize=s.shadowSize.value),s.shadowBlur.isDefault()||(r.shadowBlur=s.shadowBlur.value),s.shadowResolution.isDefault()||(r.shadowResolution=i.EShadowMapResolution[s.shadowResolution.value])),e.lights=e.lights||[];const n=e.lights.length;return e.lights.push(r),n}}t.default=n,n.typeName="CVDirectionalLight",n.text="Directional Light",n.icon="bulb"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(203),i=s(14);class n extends r.default{get settingProperties(){return[this.ins.color,this.ins.intensity,this.ins.distance,this.ins.decay,this.ins.shadowEnabled,this.ins.shadowResolution,this.ins.shadowBlur]}get snapshotProperties(){return[this.ins.color,this.ins.intensity]}fromDocument(e,t){if(!isFinite(t.light))throw new Error("light property missing in node");const s=e.lights[t.light],r=this.ins;if("point"!==s.type)throw new Error("light type mismatch: not a point light");return s.point=s.point||{},r.copyValues({color:void 0!==s.color?s.color:r.color.schema.preset,intensity:void 0!==s.intensity?s.intensity:r.intensity.schema.preset,position:r.position.schema.preset,distance:s.point.distance||r.distance.schema.preset,decay:void 0!==s.point.decay?s.point.decay:r.decay.schema.preset,shadowEnabled:s.shadowEnabled||!1,shadowResolution:void 0!==s.shadowResolution&&i.EShadowMapResolution[s.shadowResolution]||1,shadowBlur:void 0!==s.shadowBlur?s.shadowBlur:r.shadowBlur.schema.preset}),t.light}toDocument(e,t){const s=this.ins,r={color:s.color.cloneValue(),intensity:s.intensity.value,point:{distance:s.distance.value,decay:s.decay.value},type:"point"};s.shadowEnabled.value&&(r.shadowEnabled=!0,s.shadowBlur.isDefault()||(r.shadowBlur=s.shadowBlur.value),s.shadowResolution.isDefault()||(r.shadowResolution=i.EShadowMapResolution[s.shadowResolution.value])),e.lights=e.lights||[];const n=e.lights.length;return e.lights.push(r),n}}t.default=n,n.typeName="CVPointLight",n.text="Point Light",n.icon="bulb"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(204),i=s(14);class n extends r.default{get settingProperties(){return[this.ins.color,this.ins.intensity,this.ins.distance,this.ins.decay,this.ins.angle,this.ins.penumbra,this.ins.shadowEnabled,this.ins.shadowResolution,this.ins.shadowBlur]}get snapshotProperties(){return[this.ins.color,this.ins.intensity]}fromDocument(e,t){if(!isFinite(t.light))throw new Error("light property missing in node");const s=e.lights[t.light],r=this.ins;if("spot"!==s.type)throw new Error("light type mismatch: not a spot light");return s.spot=s.spot||{},r.copyValues({color:void 0!==s.color?s.color:r.color.schema.preset,intensity:void 0!==s.intensity?s.intensity:r.intensity.schema.preset,position:r.position.schema.preset,target:r.target.schema.preset,distance:s.spot.distance||r.distance.schema.preset,decay:void 0!==s.spot.decay?s.spot.decay:r.decay.schema.preset,angle:void 0!==s.spot.angle?s.spot.angle:r.angle.schema.preset,penumbra:s.spot.penumbra||r.penumbra.schema.preset,shadowEnabled:s.shadowEnabled||!1,shadowResolution:void 0!==s.shadowResolution&&i.EShadowMapResolution[s.shadowResolution]||1,shadowBlur:void 0!==s.shadowBlur?s.shadowBlur:r.shadowBlur.schema.preset}),t.light}toDocument(e,t){const s=this.ins,r={color:s.color.cloneValue(),intensity:s.intensity.value,spot:{distance:s.distance.value,decay:s.decay.value,angle:s.angle.value,penumbra:s.penumbra.value},type:"spot"};s.shadowEnabled.value&&(r.shadowEnabled=!0,s.shadowBlur.isDefault()||(r.shadowBlur=s.shadowBlur.value),s.shadowResolution.isDefault()||(r.shadowResolution=i.EShadowMapResolution[s.shadowResolution.value])),e.lights=e.lights||[];const n=e.lights.length;return e.lights.push(r),n}}t.default=n,n.typeName="CVSpotLight",n.text="Spot Light",n.icon="bulb"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(42);class i extends r.default{static fromJSON(e){return new i(e)}toString(){return this.data.title}init(){return{id:r.default.generateId(),title:"New Article",lead:"",tags:[],uri:"",mimeType:"",thumbnailUri:""}}deflate(e,t){t.id=e.id,t.uri=e.uri,e.title&&(t.title=e.title),e.lead&&(t.lead=e.lead),e.tags.length>0&&(t.tags=e.tags.slice()),e.mimeType&&(t.mimeType=e.mimeType),e.thumbnailUri&&(t.thumbnailUri=e.thumbnailUri)}inflate(e,t){t.id=e.id,t.uri=e.uri,t.title=e.title||"",t.lead=e.lead||"",t.tags=e.tags||[],t.mimeType=e.mimeType||"",t.thumbnailUri=e.thumbnailUri||""}}t.default=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(42),i=s(36);t.EAssetType=i.EAssetType,t.EMapType=i.EMapType;class n extends r.default{setModel(e){this.data.uri=e,this.data.type=i.EAssetType.Model,this.data.mimeType=this.guessAssetMimeType()}setGeometry(e){this.data.uri=e,this.data.type=i.EAssetType.Geometry,this.data.mimeType=this.guessAssetMimeType()}setTexture(e,t){this.data.uri=e,this.data.type=i.EAssetType.Image,this.data.mimeType=this.guessAssetMimeType(),this.data.mapType=t}isValid(){return!!this.data.uri&&void 0!==this.data.type}toString(){const e=this.data;return`Asset - type: '${i.EAssetType[e.type]}', uri: '${e.uri}', mime type: '${e.mimeType||"(not set)"}'`}init(){return{uri:"",mimeType:"",type:void 0,mapType:void 0,byteSize:0,numFaces:0,numVertices:0,imageSize:0}}deflate(e,t){t.uri=e.uri,t.type=i.EAssetType[e.type],e.mimeType&&(t.mimeType=e.mimeType),void 0!==e.mapType&&(t.mapType=i.EMapType[e.mapType]),e.byteSize>0&&(t.byteSize=e.byteSize),e.type!==i.EAssetType.Model&&e.type!==i.EAssetType.Geometry||e.numFaces>0&&(t.numFaces=e.numFaces),e.type!==i.EAssetType.Model&&e.type!==i.EAssetType.Image&&e.type!==i.EAssetType.Texture||e.imageSize>0&&(t.imageSize=e.imageSize)}inflate(e,t){t.uri=e.uri,t.mimeType=e.mimeType||"",t.type=i.EAssetType[e.type],t.mapType=i.EMapType[e.mapType],t.byteSize=e.byteSize||0,t.numFaces=e.numFaces||0,t.imageSize=e.imageSize||0,void 0===t.type&&(t.type=this.guessAssetType(),void 0===t.type&&console.warn(`failed to determine asset type from asset: ${t.uri}`))}guessAssetType(){const e=this.data;if(void 0!==e.type&&i.EAssetType[e.type])return e.type;if(e.mimeType){if(e.mimeType===n.mimeType.gltfJson||e.mimeType===n.mimeType.gltfBinary)return i.EAssetType.Model;if(e.mimeType===n.mimeType.imageJpeg||e.mimeType===n.mimeType.imagePng)return i.EAssetType.Image}const t=e.uri.split(".").pop().toLowerCase();return"gltf"===t||"glb"===t?i.EAssetType.Model:"obj"===t||"ply"===t?i.EAssetType.Geometry:"jpg"===t||"png"===t?i.EAssetType.Image:void 0}guessAssetMimeType(){const e=this.data;if(e.mimeType)return e.mimeType;const t=e.uri.split(".").pop().toLowerCase();return"gltf"===t?n.mimeType.gltfJson:"glb"===t?n.mimeType.gltfBinary:"jpg"===t?n.mimeType.imageJpeg:"png"===t?n.mimeType.imagePng:""}}t.default=n,n.mimeType={gltfJson:"model/gltf+json",gltfBinary:"model/gltf-binary",imageJpeg:"image/jpeg",imagePng:"image/png"}},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(1),n=s(2);t.html=n.html;const o=new i.Vector3,a=new i.Vector3,l=new i.Vector3,c=new i.Vector3,h=new i.Vector2,u=new i.Vector2;var d;!function(e){e[e.TopRight=0]="TopRight",e[e.TopLeft=1]="TopLeft",e[e.BottomLeft=2]="BottomLeft",e[e.BottomRight=3]="BottomRight"}(d=t.EQuadrant||(t.EQuadrant={}));class p extends i.Object3D{constructor(){super(),this.isHTMLSprite=!0,this.viewAngle=0,this.orientationAngle=0,this.orientationQuadrant=d.TopLeft,this._elements=new Map,this._visible=!0,this.frustumCulled=!1}get visible(){return this._visible}set visible(e){e!==this._visible&&this._elements&&(this._visible=e,this._elements.forEach(t=>{t&&t.setVisible(e)}))}dispose(){this._elements.forEach((e,t)=>{e&&t.removeChild(e)}),this._elements.clear()}disposeHTMLElement(e){const t=this._elements.get(e);t&&(this._elements.delete(e),e.removeChild(t))}update(){this._elements.forEach(e=>{e&&this.updateHTMLElement(e)})}renderHTMLElement(e,t,s,r,i){r=r||this,o.set(0,0,0),o.applyMatrix4(r.modelViewMatrix),i?a.copy(i):a.set(0,1,0),a.applyMatrix4(r.modelViewMatrix),l.copy(a).sub(o).normalize(),c.set(0,0,1),this.viewAngle=l.angleTo(c),o.applyMatrix4(s.projectionMatrix),a.applyMatrix4(s.projectionMatrix),u.set(a.x,a.y),h.set(o.x,o.y),u.sub(h);const n=.5*(a.x+1)*t.clientWidth,d=.5*(1-a.y)*t.clientHeight;e.setPosition(n,d);const p=this.orientationAngle=u.angle();this.orientationQuadrant=Math.floor(2*p/Math.PI)}getHTMLElement(e){let t=this._elements.get(e);return t||(t=this.createHTMLElement())&&(t.setVisible(this._visible),e.appendChild(t),this._elements.set(e,t)),t}createHTMLElement(){return null}updateHTMLElement(e){e.requestUpdate()}}t.default=p;let f=class extends n.default{setVisible(e){this.style.display=e?"block":"none"}setOpacity(e){this.style.opacity=e.toString(),this.style.visibility=e>0?"visible":"hidden"}setPosition(e,t){this.style.left=e.toString()+"px",this.style.top=t.toString()+"px"}};f=r([n.customElement("ff-sprite-element")],f),t.SpriteElement=f},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(42),i=s(37);class n extends r.default{static fromJSON(e){return new n(e)}init(){return{id:r.default.generateId(),title:"New Annotation",lead:"",marker:"",tags:[],articleId:"",imageUri:"",style:i.default.defaultTypeName,visible:!0,expanded:!1,position:null,direction:null,scale:1,offset:0,tilt:0,azimuth:0,color:[0,.61,.87],zoneIndex:-1}}deflate(e,t){t.id=e.id,e.title&&(t.title=e.title),e.lead&&(t.lead=e.lead),e.marker&&(t.marker=e.marker),e.tags.length>0&&(t.tags=e.tags),e.articleId&&(t.articleId=e.articleId),e.imageUri&&(t.imageUri=e.imageUri),e.style!==i.default.defaultTypeName&&(t.style=e.style),!1===e.visible&&(t.visible=e.visible),e.position&&(t.position=e.position.slice()),e.direction&&(t.direction=e.direction.slice()),1!==e.scale&&(t.scale=e.scale),0!==e.offset&&(t.offset=e.offset),0!==e.tilt&&(t.tilt=e.tilt),0!==e.azimuth&&(t.azimuth=e.azimuth);const s=e.color;return!s||1===s[0]&&1===s[1]&&1===s[2]||(t.color=s.slice()),e.zoneIndex>-1&&(t.zoneIndex=e.zoneIndex),e}inflate(e,t){t.id=e.id,t.title=e.title||"",t.lead=e.lead||"",t.marker=e.marker||"",t.tags=e.tags||[],t.articleId=e.articleId||"",t.imageUri=e.imageUri||"",t.style=e.style||i.default.defaultTypeName,t.visible=void 0===e.visible||e.visible,t.expanded=!1,t.position=e.position.slice(),t.direction=e.direction.slice(),t.scale=void 0!==e.scale?e.scale:1,t.offset=e.offset||0,t.tilt=e.tilt||0,t.azimuth=e.azimuth||0,t.color=e.color||n.defaultColor.slice(),t.zoneIndex=void 0!==e.zoneIndex?e.zoneIndex:-1}}t.default=n,n.defaultColor=[0,.61,.87]},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(101);class i{constructor(e,t,s){this.x=e||0,this.y=t||0,this.z=s||0}static makeZeros(){return new i(0,0,0)}static makeOnes(){return new i(1,1,1)}static makeUnitX(){return new i(1,0,0)}static makeUnitY(){return new i(0,1,0)}static makeUnitZ(){return new i(0,0,1)}static makeCopy(e){return new i(e.x,e.y,e.z)}static makeFromScalar(e){return new i(e,e,e)}static makeFromArray(e){return new i(e[0],e[1],e[2])}static toString(e){return`[${e.x}, ${e.y}, ${e.z}]`}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}set(e,t,s){return this.x=e,this.y=t,this.z=s,this}setFromScalar(e){return this.x=e,this.y=e,this.z=e,this}setFromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}setZeros(){return this.x=0,this.y=0,this.z=0,this}setOnes(){return this.x=1,this.y=1,this.z=1,this}setUnitX(){return this.x=1,this.y=0,this.z=0,this}setUnitY(){return this.x=0,this.y=1,this.z=0,this}setUnitZ(){return this.x=0,this.y=0,this.z=1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}mul(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}div(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}mulScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}divScalar(e){return this.x/=e,this.y/=e,this.z/=e,this}translate(e,t,s){return this.x+=e,this.y+=t,this.z+=s,this}rotateX(e){const t=Math.cos(e),s=Math.sin(e),r=this.y,i=this.z;return this.y=t*r-s*i,this.z=s*r+t*i,this}rotateY(e){const t=Math.cos(e),s=Math.sin(e),r=this.x,i=this.z;return this.x=t*r+s*i,this.z=-s*r+t*i,this}rotateZ(e){const t=Math.cos(e),s=Math.sin(e),r=this.x,i=this.y;return this.x=t*r-s*i,this.y=s*r+t*i,this}scale(e,t,s){return this.x*=e,this.y*=t,this.z*=s,this}invert(){return this.x=1/this.x,this.y=1/this.y,this.z=1/this.z,this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}normalize(){const e=1/Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return this.x*=e,this.y*=e,this.z*=e,this}homogenize(){return this.x/=this.z,this.y/=this.z,this.z=1,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}cross(e){const t=this.y*e.z-this.z*e.y,s=this.z*e.x-this.x*e.z,r=this.x*e.y-this.y*e.x;return this.x=t,this.y=s,this.z=r,this}length(){const e=this.x,t=this.y,s=this.z;return Math.sqrt(e*e+t*t+s*s)}lengthSquared(){const e=this.x,t=this.y,s=this.z;return e*e+t*t+s*s}distanceTo(e){const t=e.x-this.x,s=e.y-this.y,r=e.z-this.z;return Math.sqrt(t*t+s*s+r*r)}min(){return this.x<this.y?this.x<this.z?this.x:this.z:this.y<this.z?this.y:this.z}max(){return this.x>this.y?this.x>this.z?this.x:this.z:this.y>this.z?this.y:this.z}isZero(){return 0===this.x&&0===this.y&&0===this.z}clone(){return new i(this.x,this.y,this.z)}toArray(e,t){return e?(void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e):[this.x,this.y,this.z]}toVector2(e){return e?(e.x=this.x,e.y=this.y,e):new r.default(this.x,this.y)}toString(){return i.toString(this)}}t.default=i,i.zeros=new i(0,0,0),i.ones=new i(1,1,1),i.unitX=new i(1,0,0),i.unitY=new i(0,1,0),i.unitZ=new i(0,0,1)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e,t){this.x=e||0,this.y=t||0}static makeZeros(){return new r(0,0)}static makeOnes(){return new r(1,1)}static makeUnitX(){return new r(1,0)}static makeUnitY(){return new r(0,1)}static makeCopy(e){return new r(e.x,e.y)}static makeFromScalar(e){return new r(e,e)}static makeFromArray(e){return new r(e[0],e[1])}static toString(e){return`[${e.x}, ${e.y}]`}copy(e){return this.x=e.x,this.y=e.y,this}set(e,t){return this.x=e,this.y=t,this}setFromScalar(e){return this.x=e,this.y=e,this}setFromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}setZeros(){return this.x=0,this.y=0,this}setOnes(){return this.x=1,this.y=1,this}setUnitX(){return this.x=1,this.y=0,this}setUnitY(){return this.x=0,this.y=1,this}add(e){return this.x+=e.x,this.y+=e.y,this}sub(e){return this.x-=e.x,this.y-=e.y,this}mul(e){return this.x*=e.x,this.y*=e.y,this}div(e){return this.x/=e.x,this.y/=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}subScalar(e){return this.x-=e,this.y-=e,this}mulScalar(e){return this.x*=e,this.y*=e,this}divScalar(e){return this.x/=e,this.y/=e,this}translate(e,t){return this.x+=e,this.y+=t,this}rotate(e){const t=Math.cos(e),s=Math.sin(e),r=this.x,i=this.y;return this.x=t*r-s*i,this.y=s*r+t*i,this}scale(e,t){return this.x*=e,this.y*=t,this}invert(){return this.x=1/this.x,this.y=1/this.y,this}negate(){return this.x=-this.x,this.y=-this.y,this}normalize(){const e=1/Math.sqrt(this.x*this.x+this.y*this.y);return this.x*=e,this.y*=e,this}dot(e){return this.x*e.x+this.y*e.y}length(){const e=this.x,t=this.y;return Math.sqrt(e*e+t*t)}lengthSquared(){const e=this.x,t=this.y;return e*e+t*t}distanceTo(e){const t=e.x-this.x,s=e.y-this.y;return Math.sqrt(t*t+s*s)}angle(){return Math.atan2(this.y,this.x)}angleTo(e){const t=this.x,s=this.y,r=e.x,i=e.y;return Math.acos((t*r+s*i)/(Math.sqrt(t*t+s*s)+Math.sqrt(r*r+i*i)))}min(){return this.x<this.y?this.x:this.y}max(){return this.x>this.y?this.x:this.y}isZero(){return 0===this.x&&0===this.y}clone(){return new r(this.x,this.y)}toArray(e,t){return e?(void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e):[this.x,this.y]}toString(){return r.toString(this)}}t.default=r,r.zeros=new r(0,0),r.ones=new r(1,1),r.unitX=new r(1,0),r.unitY=new r(0,1)},function(e,t){e.exports=function(e){switch(e){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},function(e,t,s){"use strict";var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},s=0;s<10;s++)t["_"+String.fromCharCode(s)]=s;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var s,a,l=o(e),c=1;c<arguments.length;c++){for(var h in s=Object(arguments[c]))i.call(s,h)&&(l[h]=s[h]);if(r){a=r(s);for(var u=0;u<a.length;u++)n.call(s,a[u])&&(l[a[u]]=s[a[u]])}}return l}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(34),i=s(22),n=s(45),o=s(28);class a extends r.default{get setup(){return this.components.get(n.default,!0)}createComponents(){this.createComponent(i.default),this.createComponent(n.default),this.createComponent(o.default)}fromDocument(e,t,s){const i=e.scenes[t];i.name&&(this.name=i.name),this.scene.fromDocument(e,i);const n=i.nodes;n&&n.forEach(t=>{const i=this.graph.createCustomNode(r.default);this.transform.addChild(i.transform),i.fromDocument(e,t,s)}),isFinite(i.meta)&&(this.meta.fromDocument(e,i),s.set(`meta/${i.meta}`,this.meta)),isFinite(i.setup)&&this.setup.fromDocument(e,t,s)}toDocument(e,t,s){e.scenes=e.scenes||[];const i=e.scenes.length,n={units:"cm"};return e.scenes.push(n),this.name&&(n.name=this.name),this.scene.toDocument(e,n),this.transform.children.map(e=>e.node).filter(e=>e.is(r.default)).forEach(r=>{if(r.hasNodeComponents(s)){const i=r.toDocument(e,t,s);n.nodes=n.nodes||[],n.nodes.push(i)}}),s&&!s.setup||(this.meta&&(n.meta=this.meta.toDocument(e,n),t.set(this.meta,`meta/${n.meta}`)),this.setup&&this.setup.toDocument(e,i,t)),i}}t.default=a,a.typeName="NVScene"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0);class i extends r.default{constructor(){super(...arguments),this.ins=this.addInputs(i.ins),this.outs=this.addOutputs(i.outs)}update(e){return!0}fromData(e){e=e||{},this.ins.setValues({visible:void 0===e.visible||e.visible,logo:void 0===e.logo||e.logo,menu:void 0===e.menu||e.menu,tools:void 0===e.tools||e.tools})}toData(){const e=this.ins;return{visible:e.visible.value,logo:e.logo.value,menu:e.menu.value,tools:e.tools.value}}}t.default=i,i.typeName="CVInterface",i.ins={visible:r.types.Boolean("Interface.Visible",!0),logo:r.types.Boolean("Interface.Logo",!0),menu:r.types.Boolean("Interface.Menu",!0),tools:r.types.Boolean("Interface.Tools",!0)},i.outs={documentTitle:r.types.String("Document.Title")}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(26),n=s(33),o=s(36),a=s(15),l=s(61),c=s(13);class h extends r.default{constructor(){super(...arguments),this.ins=this.addInputs(h.ins),this.outs=this.addOutputs(h.outs)}get settingProperties(){return[this.ins.annotationsVisible,this.ins.activeTags,this.ins.sortedTags,this.ins.radioTags,this.ins.shader,this.ins.exposure,this.ins.gamma]}get snapshotProperties(){return[this.ins.annotationsVisible,this.ins.activeAnnotation,this.ins.activeTags,this.ins.shader,this.ins.exposure]}get analytics(){return this.getMainComponent(c.default)}get renderer(){return this.getMainComponent(i.default)}create(){super.create(),this.graph.components.on(a.default,this.onModelComponent,this),this.graph.components.on(l.default,this.onAnnotationsComponent,this)}dispose(){this.graph.components.off(a.default,this.onModelComponent,this),this.graph.components.off(l.default,this.onAnnotationsComponent,this),super.dispose()}update(e){const t=this.ins;if(t.shader.changed){const e=t.shader.getValidatedValue();this.getGraphComponents(a.default).forEach(t=>t.ins.shader.setValue(e))}if(t.exposure.changed&&this.renderer.ins.exposure.setValue(t.exposure.value),t.gamma.changed&&this.renderer.ins.gamma.setValue(t.gamma.value),t.quality.changed){const e=t.quality.getValidatedValue();this.getGraphComponents(a.default).forEach(t=>t.ins.quality.setValue(e))}if(t.activeAnnotation.changed){const e=t.activeAnnotation.value;this.getGraphComponents(l.default).forEach(t=>t.setActiveAnnotationById(e))}if(t.annotationsVisible.changed){const e=t.annotationsVisible.value;this.getGraphComponents(l.default).forEach(t=>t.ins.visible.setValue(e)),this.analytics.sendProperty("Annotations.Visible",t.annotationsVisible.value)}if(t.activeTags.changed){const e=t.activeTags.value;this.getGraphComponents(l.default).forEach(t=>t.ins.activeTags.setValue(e)),this.getGraphComponents(a.default).forEach(t=>t.ins.activeTags.setValue(e))}return t.sortedTags.changed&&this.refreshTagCloud(),!0}fromData(e){const t=this.ins;t.copyValues({shader:n.EShaderMode[e.shader]||n.EShaderMode.Default,exposure:void 0!==e.exposure?e.exposure:t.exposure.schema.preset,gamma:void 0!==e.gamma?e.gamma:t.gamma.schema.preset,annotationsVisible:!!e.annotationsVisible,activeTags:e.activeTags||"",sortedTags:e.sortedTags||"",radioTags:void 0!==e.radioTags?!!e.radioTags:t.radioTags.schema.preset})}toData(){const e=this.ins,t={shader:n.EShaderMode[e.shader.value],exposure:e.exposure.value,gamma:e.gamma.value};return e.annotationsVisible.value&&(t.annotationsVisible=!0),e.activeTags.value&&(t.activeTags=e.activeTags.value),e.sortedTags.value&&(t.sortedTags=e.sortedTags.value),e.radioTags.value&&(t.radioTags=e.radioTags.value),t}refreshTagCloud(){const e=new Set;this.getGraphComponents(a.default).forEach(t=>{t.ins.tags.value.split(",").map(e=>e.trim()).filter(e=>e).forEach(t=>e.add(t))}),this.getGraphComponents(l.default).forEach(t=>{t.getAnnotations().forEach(t=>{t.data.tags.forEach(t=>e.add(t))})});const t=Array.from(e),s=this.ins.sortedTags.value.split(",").map(e=>e.trim()).filter(e=>e);t.sort((e,t)=>{const r=s.indexOf(e),i=s.indexOf(t);return r<i?-1:r>i?1:0}),this.outs.tagCloud.setValue(t.join(", "))}onAnnotationClick(e){const t=e.annotation?e.annotation.id:"";this.ins.activeAnnotation.setValue(t)}onModelComponent(e){const t=e.object;e.add?t.on("tag-update",this.refreshTagCloud,this):e.remove&&t.off("tag-update",this.refreshTagCloud,this)}onAnnotationsComponent(e){const t=e.object;e.add?(t.on("tag-update",this.refreshTagCloud,this),t.on("click",this.onAnnotationClick,this),t.ins.visible.setValue(this.ins.annotationsVisible.value)):e.remove&&(t.off("tag-update",this.refreshTagCloud,this),t.off("click",this.onAnnotationClick,this))}}t.default=h,h.typeName="CVViewer",h.text="Viewer",h.icon="",h.ins={annotationsVisible:r.types.Boolean("Annotations.Visible"),activeAnnotation:r.types.String("Annotations.ActiveId"),activeTags:r.types.String("Tags.Active"),sortedTags:r.types.String("Tags.Sorted"),radioTags:r.types.Boolean("Tags.Radio"),shader:r.types.Enum("Renderer.Shader",n.EShaderMode),exposure:r.types.Number("Renderer.Exposure",1),gamma:r.types.Number("Renderer.Gamma",2),quality:r.types.Enum("Models.Quality",o.EDerivativeQuality,o.EDerivativeQuality.High)},h.outs={tagCloud:r.types.String("Tags.Cloud")}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(12),n=s(229),o=new r.Matrix4,a=new r.Box3,l=new r.Vector3,c=new r.Vector3;var h,u,d;!function(e){e[e.Orbit=0]="Orbit",e[e.FirstPerson=1]="FirstPerson"}(h||(h={})),function(e){e[e.Off=0]="Off",e[e.Pan=1]="Pan",e[e.Orbit=2]="Orbit",e[e.Dolly=3]="Dolly",e[e.Zoom=4]="Zoom",e[e.PanDolly=5]="PanDolly",e[e.Roll=6]="Roll"}(u||(u={})),function(e){e[e.Off=0]="Off",e[e.Active=1]="Active",e[e.Release=2]="Release"}(d||(d={}));t.default=class{constructor(e){this.orbit=new r.Vector3(0,0,0),this.offset=new r.Vector3(0,0,50),this.minOrbit=new r.Vector3(-90,-1/0,-1/0),this.maxOrbit=new r.Vector3(90,1/0,1/0),this.minOffset=new r.Vector3(-1/0,-1/0,.1),this.maxOffset=new r.Vector3(1/0,1/0,1e3),this.orientationEnabled=!0,this.offsetEnabled=!0,this.mode=u.Off,this.phase=d.Off,this.prevPinchDist=0,this.deltaX=0,this.deltaY=0,this.deltaPinch=0,this.deltaWheel=0,this.viewportWidth=100,this.viewportHeight=100,this.camera=e}onPointer(e){if(e.isPrimary)if("pointer-down"===e.type)this.phase=d.Active;else if("pointer-up"===e.type)return this.phase=d.Release,!0;"pointer-down"===e.type&&(this.mode=this.getModeFromEvent(e));if(this.deltaX+=1*e.movementX,this.deltaY+=1*e.movementY,2===e.pointerCount){const t=e.activePositions,s=t[1].clientX-t[0].clientX,r=t[1].clientY-t[0].clientY,i=Math.sqrt(s*s+r*r),n=this.prevPinchDist||i;this.deltaPinch*=n>0?i/n:1,this.prevPinchDist=i}else this.deltaPinch=1,this.prevPinchDist=0;return!0}onTrigger(e){return"wheel"===e.type&&(this.deltaWheel+=i.default.limit(e.wheel,-1,1),!0)}setViewportSize(e,t){this.viewportWidth=e,this.viewportHeight=t}updateController(e,t){const s=this.camera;e=e||s;const r=this.orbit,i=this.offset;n.default.decomposeOrbitMatrix(e.matrix,r,i),this.orbit.multiplyScalar(n.default.RAD2DEG),t&&(this.minOffset.min(i),this.maxOffset.max(i))}zoomExtents(e){const t=this.camera,s=this.offset;if(!t)return void console.warn("CameraController.zoomExtents - camera not set");l.copy(this.orbit).multiplyScalar(i.default.DEG2RAD),c.setScalar(0),n.default.composeOrbitMatrix(l,c,o),a.copy(e).applyMatrix4(o.transpose()),a.getSize(l),a.getCenter(c),s.x=c.x,s.y=c.y;const r=Math.max(l.x/t.aspect,l.y);if(t.isOrthographicCamera)s.z=1.1*r;else{const e=1/(2*Math.tan(t.fov*i.default.DEG2RAD*.5));s.z=c.z+r*e+.25*l.z}this.maxOffset.z=Math.max(this.maxOffset.z,s.z+4*l.z)}updateCamera(e,t){const s=this.camera;return e=e||s,!(!this.update()&&!t)&&(l.copy(this.orbit).multiplyScalar(i.default.DEG2RAD),c.copy(this.offset),s.isOrthographicCamera&&(c.z=this.maxOffset.z,s.size=this.offset.z,s.far=2*this.maxOffset.z,s.updateProjectionMatrix()),n.default.composeOrbitMatrix(l,c,e.matrix),e.matrixWorldNeedsUpdate=!0,!0)}update(){if(this.phase===d.Off&&0===this.deltaWheel)return!1;if(0!==this.deltaWheel)return this.updatePose(0,0,.07*this.deltaWheel+1,0,0,0),this.deltaWheel=0,!0;if(this.phase===d.Active)return(0!==this.deltaX||0!==this.deltaY||1!==this.deltaPinch)&&(this.updateByMode(),this.deltaX=0,this.deltaY=0,this.deltaPinch=1,!0);if(this.phase===d.Release){return this.deltaX*=.85,this.deltaY*=.85,this.deltaPinch=1,this.updateByMode(),Math.abs(this.deltaX)+Math.abs(this.deltaY)<.1&&(this.mode=u.Off,this.phase=d.Off),!0}return!1}updateByMode(){switch(this.mode){case u.Orbit:this.updatePose(0,0,1,this.deltaY,this.deltaX,0);break;case u.Pan:this.updatePose(this.deltaX,this.deltaY,1,0,0,0);break;case u.Roll:this.updatePose(0,0,1,0,0,this.deltaX);break;case u.Dolly:this.updatePose(0,0,.0075*this.deltaY+1,0,0,0);break;case u.PanDolly:const e=.42*(this.deltaPinch-1)+1;this.updatePose(.75*this.deltaX,.75*this.deltaY,1/e,0,0,0)}}updatePose(e,t,s,r,n,o){const{orbit:a,minOrbit:l,maxOrbit:c,offset:h,minOffset:u,maxOffset:d}=this;if(this.orientationEnabled&&(a.x+=-1*r*220/this.viewportHeight,a.y+=-1*n*220/this.viewportHeight,a.z+=-1*o*220/this.viewportHeight,a.x=i.default.limit(a.x,l.x,c.x),a.y=i.default.limit(a.y,l.y,c.y),a.z=i.default.limit(a.z,l.z,c.z)),this.offsetEnabled){const r=h.z=s*h.z;h.x+=e*r*-1/this.viewportHeight,h.y-=t*r*-1/this.viewportHeight,h.x=i.default.limit(h.x,u.x,d.x),h.y=i.default.limit(h.y,u.y,d.y),h.z=i.default.limit(h.z,u.z,d.z)}}getModeFromEvent(e){if("mouse"===e.source){const t=e.originalEvent.button;if(0===t)return e.ctrlKey?u.Pan:e.altKey?u.Dolly:u.Orbit;if(2===t)return e.altKey?u.Roll:u.Pan;if(1===t)return u.Dolly}else if("touch"===e.source){const t=e.pointerCount;return 1===t?u.Orbit:2===t?u.PanDolly:u.Pan}}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(109);class i extends r.default{get settingProperties(){return[this.ins.style,this.ins.color0,this.ins.color1]}get snapshotProperties(){return[this.ins.color0,this.ins.color1]}fromData(e){this.ins.copyValues({style:r.EBackgroundStyle[e.style]||r.EBackgroundStyle.Solid,color0:e.color0||[.2,.25,.3],color1:e.color1||[.01,.03,.05]})}toData(){const e=this.ins;return{style:r.EBackgroundStyle[e.style.value],color0:e.color0.cloneValue(),color1:e.color1.cloneValue()}}}t.default=i,i.typeName="CVBackground"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(11),i=s(230);t.EBackgroundStyle=i.EBackgroundStyle;class n extends r.default{constructor(e,t){super(e,t),this.ins=this.addInputs(n.backgroundIns),this.object3D=new i.default}get background(){return this.object3D}update(e){super.update(e);const t=this.ins,s=this.background.material;return t.style.changed&&(s.style=t.style.getValidatedValue()),t.color0.changed&&s.color0.fromArray(t.color0.value),t.color1.changed&&s.color1.fromArray(t.color1.value),t.noise.changed&&(s.noise=t.noise.value),!0}dispose(){this.background.dispose(),super.dispose()}}t.default=n,n.typeName="CBackground",n.backgroundIns={style:r.types.Enum("Background.Style",i.EBackgroundStyle,i.EBackgroundStyle.RadialGradient),color0:r.types.ColorRGB("Background.Color0",[.2,.25,.3]),color1:r.types.ColorRGB("Background.Color1",[.01,.03,.05]),noise:r.types.Number("Background.Noise",{min:0,max:1,bar:!0,preset:.02})}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(231);class i extends r.default{constructor(e,t){super(e,t),this.ins.visible.setValue(!1),this.ins.receiveShadow.setValue(!0),this.floor.renderOrder=-1}get settingProperties(){return[this.ins.visible,this.ins.position,this.ins.radius,this.ins.color,this.ins.opacity,this.ins.receiveShadow]}get snapshotProperties(){return[this.ins.opacity]}fromData(e){e=e||{},this.ins.copyValues({visible:!!e.visible,position:e.position||[0,-25,0],radius:void 0!==e.size?e.size:50,color:e.color||[.6,.75,.8],opacity:void 0!==e.opacity?e.opacity:.5,receiveShadow:!!e.receiveShadow})}toData(){const e=this.ins;return{visible:e.visible.value,position:e.position.cloneValue(),size:e.radius.value,color:e.color.cloneValue(),opacity:e.opacity.value,receiveShadow:e.receiveShadow.value}}}t.default=i,i.typeName="CVFloor",i.text="Floor",i.icon=""},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(235),n=s(0),o=s(11),a=s(43),l=s(22),c=new r.Vector3,h=new r.Vector3,u=(new r.Matrix4).makeRotationX(.5*Math.PI),d=new r.Matrix4;class p extends o.default{constructor(){super(...arguments),this.ins=this.addInputs(p.gridIns),this.outs=this.addOutputs(p.gridOuts),this._lastViewport=null,this._gridProps={size:20,mainDivisions:2,subDivisions:10,mainColor:new r.Color(.5,.7,.8),subColor:new r.Color(.25,.35,.4)}}get settingProperties(){return[this.ins.visible,this.ins.color,this.ins.opacity]}get snapshotProperties(){return[this.ins.opacity]}get grid(){return this.object3D}create(){this.ins.pickable.setValue(!1),this.ins.visible.setValue(!1),super.create()}activate(){this.getGraphComponent(l.default).outs.boundingBox.linkTo(this.ins.boundingBox)}update(){const e=this.ins;if(e.color.changed||e.boundingBox.changed){const t=this._gridProps;if(e.color.changed){const s=t.mainColor,r=t.subColor;s.fromArray(e.color.value),r.r=.5*s.r,r.g=.5*s.g,r.b=.5*s.b}if(e.boundingBox.changed){const e=this.getGraphComponent(l.default),s=e.outs.boundingBox.value,r=e.ins.units.value;s.getSize(c);let i=Math.max(c.x,c.y,c.z),n=1;for(;i/n>5;)n*=10;i=Math.ceil(i/n)*n*2,t.size=i,this.outs.size.setValue(i),this.outs.units.setValue(r),t.mainDivisions=i/n,t.subDivisions=10,h.set(0,s.min.y,0)}this.object3D?this.grid.update(t):this.object3D=new i.default(t),e.boundingBox.changed&&(this.grid.position.copy(h),this.grid.updateMatrix())}return e.visible.changed&&(this.grid.visible=e.visible.value),e.opacity.changed&&(this.grid.opacity=e.opacity.value),!0}preRender(e){const t=e.viewport,s=this.object3D;if(t!==this._lastViewport){this._lastViewport=t;const r=e.viewport.camera;r?s.matrix.extractRotation(r.matrixWorld).multiply(u):s.matrix.extractRotation(d),s.updateMatrixWorld(!0)}}postRender(e){this.object3D.matrix.extractRotation(d)}fromData(e){e=e||{},this.ins.copyValues({visible:!!e.visible,color:e.color||[.5,.7,.8]})}toData(){const e=this.ins;return{visible:e.visible.cloneValue(),color:e.color.cloneValue()}}}t.default=p,p.typeName="CVGrid",p.text="Grid",p.icon="",p.gridIns={color:n.types.ColorRGB("Grid.Color",[.5,.7,.8]),opacity:n.types.Percent("Grid.Opacity",1),boundingBox:n.types.Object("Scene.BoundingBox",r.Box3)},p.gridOuts={size:n.types.Number("Size"),units:n.types.Enum("Units",a.EUnitType)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(0),n=s(33),o=s(22),a=s(15),l=[[-1,0,0,0],[0,-1,0,0],[0,0,-1,0],[1,0,0,0],[0,1,0,0],[0,0,1,0]];class c extends i.default{constructor(){super(...arguments),this.ins=this.addInputs(c.ins),this.plane=null,this.axisIndex=-1}get settingProperties(){return[this.ins.enabled]}get snapshotProperties(){return[this.ins.enabled,this.ins.axis,this.ins.position,this.ins.inverted]}create(){super.create();const e=this.getGraphComponent(o.default);this.ins.boundingBox.linkFrom(e.outs.boundingBox)}update(e){const t=this.ins;if(t.axis.changed){const e=t.axis.getValidatedValue();e===this.axisIndex?t.inverted.setValue(!t.inverted.value):(t.inverted.setValue(!1),this.axisIndex=e)}if(!t.enabled.value&&!t.enabled.changed)return!1;const s=t.axis.getValidatedValue(),r=t.inverted.value,i=s+(r?3:0),n=this.ins.boundingBox.value;if(!n)return!0;this.plane=l[i];const o=n.min.getComponent(s),c=n.max.getComponent(s),h=1-t.position.value;return this.plane[3]=r?h*(c-o)-c:c-h*(c-o),this.getGraphComponents(a.default).forEach(e=>{e.object3D.traverse(e=>{if(e.isMesh){const t=e.material;t.isUberPBRMaterial&&this.updateMaterial(t)}})}),!0}fromData(e){e=e||{},this.ins.setValues({enabled:e.enabled||!1,axis:n.ESliceAxis[e.axis]||n.ESliceAxis.X,position:e.position||0,inverted:e.inverted||!1})}toData(){const e=this.ins;return{enabled:e.enabled.value,axis:n.ESliceAxis[e.axis.getValidatedValue()],position:e.position.value,inverted:e.inverted.value}}updateMaterial(e){const t=this.ins;t.enabled.changed&&(e.enableCutPlane(t.enabled.value),e.needsUpdate=!0),e.cutPlaneDirection.fromArray(this.plane),e.cutPlaneColor.fromArray(t.color.value)}}t.default=c,c.typeName="CVSlicer",c.text="Slicer",c.icon="",c.ins={enabled:i.types.Boolean("Slice.Enabled"),axis:i.types.Enum("Slice.Axis",n.ESliceAxis),position:i.types.Number("Slice.Position",{min:0,max:1,preset:.5}),inverted:i.types.Boolean("Slice.Inverted"),color:i.types.ColorRGB("Slice.Color",[0,.61,.87]),boundingBox:i.types.Object("Scene.BoundingBox",r.Box3)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(66),n=s(13);class o extends r.default{constructor(){super(...arguments),this.ins=this.addInputs(o.ins),this.outs=this.addOutputs(o.outs),this._tours=[]}get analytics(){return this.getMainComponent(n.default)}get snapshots(){return this.getComponent(i.default)}get tours(){return this._tours}get activeSteps(){const e=this.activeTour;return e?e.steps:null}get activeTour(){return this._tours[this.outs.tourIndex.value]}get activeStep(){const e=this.activeTour;return e?e.steps[this.outs.stepIndex.value]:null}dispose(){super.dispose()}update(e){const{ins:t,outs:s}=this,r=this._tours,n=this.snapshots;if(t.enabled.changed){if(this.analytics.sendProperty("Tours.Enabled",t.enabled.value),!t.enabled.value)return s.tourIndex.set(),n.tweenTo(o.sceneSnapshotId,e.secondsElapsed),n.deleteState(o.sceneSnapshotId),!0;{const e={id:o.sceneSnapshotId,curve:i.EEasingCurve.EaseOutQuad,duration:1,threshold:0,values:n.getCurrentValues()};n.setState(e)}}const a=Math.min(r.length-1,Math.max(-1,t.tourIndex.value)),l=r[a],c=l?l.steps.length:0;s.stepCount.setValue(c);let h=-1;if((t.tourIndex.changed||t.enabled.changed)&&(a!==s.tourIndex.value&&(h=0),s.tourIndex.setValue(a),s.tourTitle.setValue(l?l.title:""),s.tourLead.setValue(l?l.lead:"")),0===c)return s.stepIndex.setValue(-1),s.stepTitle.setValue(""),!0;let u=!0;if(t.enabled.changed&&(h=s.stepIndex.value),t.stepIndex.changed&&(h=Math.min(l.steps.length-1,Math.max(0,t.stepIndex.value)),u=!1),t.first.changed&&(h=0),t.next.changed&&(h=s.stepIndex.value+1)>=c&&(s.tourIndex.setValue(-1),s.tourTitle.setValue(""),s.tourLead.setValue(""),h=-1),t.previous.changed&&(h=(s.stepIndex.value+c-1)%c),h>=0){const e=l.steps[h];s.stepIndex.setValue(h),s.stepTitle.setValue(e.title),n.ins.id.setValue(e.id),u?n.ins.tween.set():n.ins.recall.set()}return!0}fromData(e){this._tours=e.map(e=>({title:e.title,steps:e.steps,lead:e.lead||"",tags:e.tags||[]})),this.ins.tourIndex.setValue(-1),this.outs.count.setValue(this._tours.length)}toData(){return 0===this._tours.length?null:this._tours.map(e=>{const t={title:e.title,steps:e.steps};return e.lead&&(t.lead=e.lead),e.tags.length>0&&(t.tags=e.tags),t})}}t.default=o,o.typeName="CVTours",o.sceneSnapshotId="scene-default",o.ins={enabled:r.types.Boolean("Tours.Enabled"),tourIndex:r.types.Integer("Tours.Index",-1),stepIndex:r.types.Integer("Step.Index"),next:r.types.Event("Step.Next"),previous:r.types.Event("Step.Previous"),first:r.types.Event("Step.First")},o.outs={count:r.types.Integer("Tours.Count"),tourIndex:r.types.Integer("Tour.Index",-1),tourTitle:r.types.String("Tour.Title"),tourLead:r.types.String("Tour.Lead"),stepCount:r.types.Integer("Tour.Steps"),stepIndex:r.types.Integer("Step.Index"),stepTitle:r.types.String("Step.Title")}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(10),i=s(51),n=s(26),o=s(80),a=s(39),l=s(19),c=s(32),h=s(13);class u extends r.default{get pulse(){return this.components.get(i.default)}get renderer(){return this.components.get(n.default)}get fullscreen(){return this.components.get(a.default)}get selection(){return this.components.get(o.default)}get assetManager(){return this.components.get(l.default)}get assetReader(){return this.components.get(c.default)}get analytics(){return this.components.get(h.default)}createComponents(){this.createComponent(i.default),this.createComponent(n.default),this.createComponent(a.default),this.createComponent(l.default),this.createComponent(c.default),this.createComponent(h.default),this.createComponent(o.default).ins.viewportBrackets.setValue(!1)}}t.default=u,u.typeName="NVEngine"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(10),i=s(31),n=s(29),o=s(46);class a extends r.default{get scene(){return this.components.get(i.default)}get documentProvider(){return this.components.get(n.default)}get nodeProvider(){return this.components.get(o.default)}createComponents(){this.createComponent(i.default,"Master Scene"),this.createComponent(n.default),this.createComponent(o.default)}}t.default=a,a.typeName="NVDocuments"},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0}),s(7),s(47),s(242);const i=s(64),n=s(23);class o extends n.default{createView(){return new a(this)}}t.default=o,o.typeName="CVViewTool",o.text="View",o.icon="eye";let a=class extends n.ToolView{firstConnected(){super.firstConnected(),this.classList.add("sv-view-tool-view")}render(){const e=this.activeDocument;if(!e)return n.html``;const t=this.tool,s=e.setup.navigation,r=s.ins.projection,o=s.ins.preset,a=s.ins.zoomExtents,l=[i.EViewPreset.Front,i.EViewPreset.Back,i.EViewPreset.Left,i.EViewPreset.Right,i.EViewPreset.Top,i.EViewPreset.Bottom];return n.html`<div class="sv-section"><ff-button class="sv-section-lead" transparent icon=${t.icon}></ff-button>
            <div class="sv-tool-controls">
                <sv-property-options .property=${r}></sv-property-options>
                <sv-property-options .property=${o} name="View" .indexMap=${l}></sv-property-options>
                <sv-property-event .property=${a} name="Center" icon="zoom"></sv-property-event>
            </div>
        </div>`}onActiveDocument(e,t){this.requestUpdate()}};a=r([n.customElement("sv-view-tool-view")],a),t.ViewToolView=a},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0}),s(47);const i=s(23);class n extends i.default{createView(){return new o(this)}}t.default=n,n.typeName="CVRenderTool",n.text="Material",n.icon="palette";let o=class extends i.ToolView{constructor(){super(...arguments),this.viewer=null}firstConnected(){super.firstConnected(),this.classList.add("sv-group","sv-render-tool-view")}render(){const e=this.tool,t=this.viewer;if(!t)return i.html``;const s=t.ins.shader;return i.html`<div class="sv-section"><ff-button class="sv-section-lead" transparent icon=${e.icon}></ff-button>
            <div class="sv-tool-controls">
                <sv-property-options .property=${s} name="Material"></sv-property-options>
            </div>
        </div>`}onActiveDocument(e,t){this.viewer&&(this.viewer.ins.shader.off("value",this.onUpdate,this),this.viewer=null),t&&(this.viewer=t.setup.viewer,this.viewer.ins.shader.on("value",this.onUpdate,this))}};o=r([i.customElement("sv-render-tool-view")],o),t.RenderToolView=o},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(23),n=s(109);class o extends i.default{createView(){return new a(this)}}t.default=o,o.typeName="CVEnvironmentTool",o.text="Environment",o.icon="environment";let a=class extends i.ToolView{firstConnected(){super.firstConnected(),this.classList.add("sv-group","sv-environment-tool-view")}render(){const e=this.tool;if(!this.activeDocument)return i.html`No active document`;const t=this.activeDocument.setup,s=t.grid,r=t.floor,o=t.background,a=o.ins.style.getValidatedValue(),l=a===n.EBackgroundStyle.Solid;n.EBackgroundStyle.LinearGradient;return i.html`<div class="sv-section"><ff-button class="sv-section-lead" transparent icon=${e.icon}></ff-button>
            <div class="sv-tool-controls">
                <sv-property-options .property=${o.ins.style} .options=${["Solid","Linear","Radial"]} name="Background"></sv-property-options>
                <sv-property-color class="sv-nogap" .property=${o.ins.color0} name=" "></sv-property-color>
                ${l?null:i.html`<sv-property-color class="sv-nogap" .property=${o.ins.color1} name=" "></sv-property-color>`}
                <sv-property-boolean .property=${s.ins.visible} name="Grid"></sv-property-boolean>
                <sv-property-color class="sv-nogap" .property=${s.ins.color} name=" "></sv-property-color>
                <sv-property-boolean .property=${r.ins.visible} name="Floor"></sv-property-boolean>
                <sv-property-color class="sv-nogap" .property=${r.ins.color} name=" "></sv-property-color>
            </div>
        </div>`}onActiveDocument(e,t){if(e){e.setup.background.ins.style.off("value",this.onUpdate,this)}if(t){t.setup.background.ins.style.on("value",this.onUpdate,this)}this.requestUpdate()}};a=r([i.customElement("sv-environment-tool-view")],a),t.EnvironmentToolView=a},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(14);s(68),s(47),s(120),s(243);const n=s(23);class o extends n.default{constructor(){super(...arguments),this.lights=[],this.ins=this.addInputs(o.ins),this.outs=this.addOutputs(o.outs)}update(e){return this.outs.light.setValue(this.lights[this.ins.light.getValidatedValue()]),!0}createView(){return new a(this)}onActiveDocument(e,t){this.lights=t?t.getInnerComponents(i.default):[],this.ins.light.setOptions(this.lights.map(e=>e.node.name)),this.outs.light.setValue(this.lights[0]),super.onActiveDocument(e,t)}}t.default=o,o.typeName="CVLightTool",o.text="Lights",o.icon="bulb",o.ins={light:n.types.Option("Tool.Light",[])},o.outs={light:n.types.Object("Tool.SelectedLight",i.default)};let a=class extends n.ToolView{constructor(){super(...arguments),this.lights=null}firstConnected(){super.firstConnected(),this.classList.add("sv-group","sv-light-tool-view")}connected(){super.connected(),this.tool.outs.light.on("value",this.onUpdate,this)}disconnected(){this.tool.outs.light.off("value",this.onUpdate,this),super.disconnected()}render(){const e=this.tool,t=e.lights,s=this.activeDocument;if(!t||!s)return n.html`No editable lights in this scene.`;const r=e.outs.light.value,i=s.setup.navigation,o=r?n.html`<div class="sv-section">
            <ff-button class="sv-section-lead" transparent icon="cog"></ff-button>
            <div class="sv-tool-controls">
                <!-- <sv-property-boolean .property=${r.ins.visible} name="Switch"></sv-property-boolean> -->
                <sv-property-slider .property=${r.ins.intensity} name="Intensity" min="0" max="2"></sv-property-slider>
                <sv-property-color .property=${r.ins.color} name="Color"></sv-property-color>
            </div>
        </div>`:null;return n.html`${o}<div class="sv-section"><ff-button class="sv-section-lead" transparent icon=${e.icon}></ff-button>
            <div class="sv-tool-controls">
                <!-- <sv-property-boolean .property=${i.ins.lightsFollowCamera} name="Follow Camera"></sv-property-boolean> -->
                <sv-property-options .property=${e.ins.light} name="Select Scene Light"></sv-property-options>
            </div>
        </div>`}onActiveDocument(e,t){e&&e.setup.navigation.ins.lightsFollowCamera.off("value",this.onUpdate,this),t&&t.setup.navigation.ins.lightsFollowCamera.on("value",this.onUpdate,this),this.requestUpdate()}};a=r([n.customElement("sv-light-tool-view")],a),t.LightToolView=a},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(2);s(121);let n=class extends i.default{constructor(){super(...arguments),this.property=null,this.name="",this.min=void 0,this.max=void 0}firstConnected(){super.firstConnected(),this.classList.add("sv-property-view","sv-property-slider")}update(e){if(!this.property)throw new Error("missing property attribute");if("number"!==this.property.type)throw new Error(`not a number property: '${this.property.path}'`);if(e.has("property")){const t=e.get("property");t&&t.off("value",this.onUpdate,this),this.property&&this.property.on("value",this.onUpdate,this)}super.update(e)}render(){const e=this.property,t=this.name||e.name,s=e.getValidatedValue(),r=isFinite(this.min)?this.min:e.schema.min,n=(s-r)/((isFinite(this.max)?this.max:e.schema.max)-r);return i.html`<label class="ff-label ff-off">${t}</label>
            <ff-linear-slider .value=${n} @change=${this.onSliderChange}></ff-linear-slider>`}onSliderChange(e){const t=this.property,s=isFinite(this.min)?this.min:t.schema.min,r=isFinite(this.max)?this.max:t.schema.max,i=s+e.detail.value*(r-s);t.setValue(i)}};r([i.property({attribute:!1})],n.prototype,"property",void 0),r([i.property({type:String})],n.prototype,"name",void 0),r([i.property({type:Number})],n.prototype,"min",void 0),r([i.property({type:Number})],n.prototype,"max",void 0),n=r([i.customElement("sv-property-slider")],n),t.default=n},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(12),n=s(2),o=s(122);let a=class extends n.default{constructor(){super(),this.direction="horizontal",this.value=0,this._isVertical=!1,this._offsetX=0,this._offsetY=0,this._knob=(new n.default).addClass("ff-knob").setStyle({display:"block",position:"relative "}),new o.default(this)}dragStart(e){const t=this._knob,s=this.getBoundingClientRect();e.target===this._knob?(this._offsetX=e.clientX-t.offsetLeft+.5*(t.clientWidth-t.offsetWidth),this._offsetY=e.clientY-t.offsetTop+.5*(t.clientHeight-t.offsetHeight)):(this._offsetX=s.left+.8*t.clientWidth,this._offsetY=s.top+.8*t.clientHeight),this.dragMove(e)}dragMove(e){const t=this._knob,s=e.clientX-this._offsetX,r=e.clientY-this._offsetY;let n=this._isVertical?1-r/(this.clientHeight-t.clientHeight):s/(this.clientWidth-t.clientWidth);(n=i.default.limit(n,0,1))!==this.value&&(this.value=n,this.emitChangeEvent(!0))}dragEnd(){this.emitChangeEvent(!1)}firstConnected(){this.setStyle({position:"relative",touchAction:"none"}),this.setAttribute("touch-action","none"),this.setAttribute("tabindex","0"),this.classList.add("ff-control","ff-linear-slider"),this.appendChild(this._knob)}update(e){if(e.has("direction")&&(this._isVertical="vertical"===this.direction,this.setClass("ff-horizontal",!this._isVertical),this.setClass("ff-vertical",this._isVertical)),e.has("value")){const e=i.default.limit(this.value,0,1),t=this._isVertical?0:100*e,s=this._isVertical?100*(1-e):0;this._knob.style.left=`${t.toFixed(3)}%`,this._knob.style.top=`${s.toFixed(3)}%`}super.update(e)}emitChangeEvent(e){this.dispatchEvent(new CustomEvent("change",{detail:{value:this.value,isDragging:e},bubbles:!0}))}};r([n.property({type:String})],a.prototype,"direction",void 0),r([n.property({type:Number})],a.prototype,"value",void 0),a=r([n.customElement("ff-linear-slider")],a),t.default=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e){this.isEnabled=!0,this._isDragging=!1,this._startX=0,this._startY=0,this._lastX=0,this._lastY=0,this.target=e,this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),e.addEventListener("pointerdown",this.onPointerDown),e.addEventListener("pointermove",this.onPointerMove),e.addEventListener("pointerup",this.onPointerUp),e.addEventListener("pointercancel",this.onPointerUp)}get isDragging(){return this._isDragging}get startX(){return this._startX}get startY(){return this._startY}onPointerDown(e){e.isPrimary&&this.isEnabled&&(this._isDragging=!0,this._startX=this._lastX=e.clientX,this._startY=this._lastY=e.clientY,this.target.setPointerCapture(e.pointerId),this.target.dragStart(e)),e.stopPropagation(),e.preventDefault()}onPointerMove(e){if(e.isPrimary&&this._isDragging){const t=e.clientX-this._lastX;this._lastX=e.clientX;const s=e.clientY-this._lastY;this._lastY=e.clientY,this.target.dragMove(e,t,s)}e.stopPropagation(),e.preventDefault()}onPointerUp(e){this._isDragging&&e.isPrimary&&(this.target.dragEnd(e),this.target.releasePointerCapture(e.pointerId),this._isDragging=!1),e.stopPropagation(),e.preventDefault()}}},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0}),s(68),s(247);const i=s(65),n=s(23);class o extends n.default{createView(){return new a(this)}}t.default=o,o.typeName="CVTapeTool",o.text="Measure",o.icon="tape";let a=class extends n.ToolView{firstConnected(){super.firstConnected(),this.classList.add("sv-group","sv-tape-tool-view")}render(){const e=this.activeDocument;if(!e)return n.html``;const t=this.tool,s=e.setup.tape,r=s.ins.visible,o=s.outs.state.value,a=s.outs.distance.value;let l;if(r.value)if(0===a)l="Tap on model to set start of tape.";else if(o===i.ETapeState.SetStart){const t=e.root.scene.ins.units.getOptionText();l=`${a.toFixed(2)} ${t}`}else l="Tap on model to set end of tape.";else l="Switch on to take measurements.";return n.html`<div class="sv-section"><ff-button class="sv-section-lead" transparent icon=${t.icon}></ff-button>
            <div class="sv-tool-controls">
                <sv-property-boolean .property=${r} name="Tape Tool"></sv-property-boolean>
                <div class="sv-property-view"><label class="ff-label ff-off">Measured Distance</label>
                <div class="ff-string">${l}</div></div>
            </div></div>`}onActiveDocument(e,t){e&&e.setup.tape.off("update",this.onUpdate,this),t&&t.setup.tape.on("update",this.onUpdate,this),this.requestUpdate()}};a=r([n.customElement("sv-tape-tool-view")],a),t.TapeToolView=a},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0}),s(68),s(47),s(120);const i=s(23);class n extends i.default{createView(){return new o(this)}}t.default=n,n.typeName="CVSliceTool",n.text="Slice",n.icon="knife";let o=class extends i.ToolView{firstConnected(){super.firstConnected(),this.classList.add("sv-group","sv-slice-tool-view")}render(){const e=this.activeDocument;if(!e)return i.html``;const t=this.tool,s=e.setup.slicer,r=s.ins.enabled,n=s.ins.axis,o=s.ins.position;return i.html`<div class="sv-section"><ff-button class="sv-section-lead" transparent icon=${t.icon}></ff-button>
            <div class="sv-tool-controls">
                <sv-property-boolean .property=${r} name="Slice Tool"></sv-property-boolean>
                <sv-property-options .property=${n}></sv-property-options>
                <sv-property-slider .property=${o}></sv-property-slider>
            </div>
        </div>`}onActiveDocument(e,t){this.requestUpdate()}};o=r([i.customElement("sv-slice-tool-view")],o),t.SliceToolView=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(10),i=s(38),n=s(116),o=s(117),a=s(118),l=s(119),c=s(123),h=s(124);class u extends r.default{get toolProvider(){return this.getComponent(i.default)}createComponents(){this.createComponent(i.default),this.createComponent(n.default),this.createComponent(o.default),this.createComponent(a.default),this.createComponent(l.default),this.createComponent(c.default),this.createComponent(h.default)}}t.default=u,u.typeName="NVTools"},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(2);var n;!function(e){e[e.TopLeft=0]="TopLeft",e[e.TopCenter=1]="TopCenter",e[e.TopRight=2]="TopRight",e[e.BottomLeft=3]="BottomLeft",e[e.BottomCenter=4]="BottomCenter",e[e.BottomRight=5]="BottomRight"}(n=t.ELocation||(t.ELocation={}));let o=class extends i.default{constructor(){super(),this.labels=[],this.labels.push({},{},{},{},{},{})}setLabel(e,t,s,r){this.labels[e][t]={text:s,className:r},this.requestUpdate()}unsetLabel(e,t){delete this.labels[e][t],this.requestUpdate()}firstConnected(){this.classList.add("ff-container","ff-viewport-overlay")}render(){const e=this.labels;return i.html`<div class="ff-row">
            <div class="ff-labels ff-top-left">${Object.keys(e[n.TopLeft]).map(t=>{const s=e[n.TopLeft][t];return i.html`<div class=${"ff-label "+s.className||!1}>${s.text}</div>`})}</div>
            <div class="ff-labels ff-top-center">${Object.keys(e[n.TopCenter]).map(t=>{const s=e[n.TopCenter][t];return i.html`<div class=${"ff-label "+s.className||!1}>${s.text}</div>`})}</div>
            <div class="ff-labels ff-top-right">${Object.keys(e[n.TopRight]).map(t=>{const s=e[n.TopRight][t];return i.html`<div class=${"ff-label "+s.className||!1}>${s.text}</div>`})}</div>
        </div><div class="ff-row">
            <div class="ff-labels ff-bottom-left">${Object.keys(e[n.BottomLeft]).map(t=>{const s=e[n.BottomLeft][t];return i.html`<div class=${"ff-label "+s.className||!1}>${s.text}</div>`})}</div>
            <div class="ff-labels ff-bottom-center">${Object.keys(e[n.BottomCenter]).map(t=>{const s=e[n.BottomCenter][t];return i.html`<div class=${"ff-label "+s.className||!1}>${s.text}</div>`})}</div>
            <div class="ff-labels ff-bottom-right">${Object.keys(e[n.BottomRight]).map(t=>{const s=e[n.BottomRight][t];return i.html`<div class=${"ff-label "+s.className||!1}>${s.text}</div>`})}</div>
        </div>`}};o=r([i.customElement("ff-viewport-overlay")],o),t.default=o},function(e,t,s){"use strict";s.r(t);var r=s(4),i=s(9),n=s(3);const o=133;function a(e,t){const{element:{content:s},parts:r}=e,i=document.createTreeWalker(s,o,null,!1);let n=c(r),a=r[n],l=-1,h=0;const u=[];let d=null;for(;i.nextNode();){l++;const e=i.currentNode;for(e.previousSibling===d&&(d=null),t.has(e)&&(u.push(e),null===d&&(d=e)),null!==d&&h++;void 0!==a&&a.index===l;)a.index=null!==d?-1:a.index-h,a=r[n=c(r,n)]}u.forEach(e=>e.parentNode.removeChild(e))}const l=e=>{let t=11===e.nodeType?0:1;const s=document.createTreeWalker(e,o,null,!1);for(;s.nextNode();)t++;return t},c=(e,t=-1)=>{for(let s=t+1;s<e.length;s++){const t=e[s];if(Object(n.d)(t))return s}return-1};var h=s(18),u=s(16),d=s(25);const p=(e,t)=>`${e}--${t}`;let f=!0;void 0===window.ShadyCSS?f=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),f=!1);const m=e=>t=>{const s=p(t.type,e);let r=u.a.get(s);void 0===r&&(r={stringsArray:new WeakMap,keyString:new Map},u.a.set(s,r));let i=r.stringsArray.get(t.strings);if(void 0!==i)return i;const o=t.strings.join(n.f);if(void 0===(i=r.keyString.get(o))){const s=t.getTemplateElement();f&&window.ShadyCSS.prepareTemplateDom(s,e),i=new n.a(t,s),r.keyString.set(o,i)}return r.stringsArray.set(t.strings,i),i},v=["html","svg"],g=new Set,y=(e,t,s)=>{g.add(e);const r=s?s.element:document.createElement("template"),i=t.querySelectorAll("style"),{length:n}=i;if(0===n)return void window.ShadyCSS.prepareTemplateStyles(r,e);const h=document.createElement("style");for(let e=0;e<n;e++){const t=i[e];t.parentNode.removeChild(t),h.textContent+=t.textContent}(e=>{v.forEach(t=>{const s=u.a.get(p(t,e));void 0!==s&&s.keyString.forEach(e=>{const{element:{content:t}}=e,s=new Set;Array.from(t.querySelectorAll("style")).forEach(e=>{s.add(e)}),a(e,s)})})})(e);const d=r.content;s?function(e,t,s=null){const{element:{content:r},parts:i}=e;if(null==s)return void r.appendChild(t);const n=document.createTreeWalker(r,o,null,!1);let a=c(i),h=0,u=-1;for(;n.nextNode();){for(u++,n.currentNode===s&&(h=l(t),s.parentNode.insertBefore(t,s));-1!==a&&i[a].index===u;){if(h>0){for(;-1!==a;)i[a].index+=h,a=c(i,a);return}a=c(i,a)}}}(s,h,d.firstChild):d.insertBefore(h,d.firstChild),window.ShadyCSS.prepareTemplateStyles(r,e);const f=d.querySelector("style");if(window.ShadyCSS.nativeShadow&&null!==f)t.insertBefore(f.cloneNode(!0),t.firstChild);else if(s){d.insertBefore(h,d.firstChild);const e=new Set;e.add(h),a(s,e)}};window.JSCompiler_renameProperty=(e,t)=>e;const b={toAttribute(e,t){switch(t){case Boolean:return e?"":null;case Object:case Array:return null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){switch(t){case Boolean:return null!==e;case Number:return null===e?null:Number(e);case Object:case Array:return JSON.parse(e)}return e}},w=(e,t)=>t!==e&&(t==t||e==e),_={attribute:!0,type:String,converter:b,reflect:!1,hasChanged:w},E=Promise.resolve(!0),x=1,P=4,S=8,C=16,T=32,M="finalized";class A extends HTMLElement{constructor(){super(),this._updateState=0,this._instanceProperties=void 0,this._updatePromise=E,this._hasConnectedResolver=void 0,this._changedProperties=new Map,this._reflectingProperties=void 0,this.initialize()}static get observedAttributes(){this.finalize();const e=[];return this._classProperties.forEach((t,s)=>{const r=this._attributeNameForProperty(s,t);void 0!==r&&(this._attributeToPropertyMap.set(r,s),e.push(r))}),e}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const e=Object.getPrototypeOf(this)._classProperties;void 0!==e&&e.forEach((e,t)=>this._classProperties.set(t,e))}}static createProperty(e,t=_){if(this._ensureClassProperties(),this._classProperties.set(e,t),t.noAccessor||this.prototype.hasOwnProperty(e))return;const s="symbol"==typeof e?Symbol():`__${e}`;Object.defineProperty(this.prototype,e,{get(){return this[s]},set(t){const r=this[e];this[s]=t,this._requestUpdate(e,r)},configurable:!0,enumerable:!0})}static finalize(){const e=Object.getPrototypeOf(this);if(e.hasOwnProperty(M)||e.finalize(),this[M]=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const e=this.properties,t=[...Object.getOwnPropertyNames(e),..."function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e):[]];for(const s of t)this.createProperty(s,e[s])}}static _attributeNameForProperty(e,t){const s=t.attribute;return!1===s?void 0:"string"==typeof s?s:"string"==typeof e?e.toLowerCase():void 0}static _valueHasChanged(e,t,s=w){return s(e,t)}static _propertyValueFromAttribute(e,t){const s=t.type,r=t.converter||b,i="function"==typeof r?r:r.fromAttribute;return i?i(e,s):e}static _propertyValueToAttribute(e,t){if(void 0===t.reflect)return;const s=t.type,r=t.converter;return(r&&r.toAttribute||b.toAttribute)(e,s)}initialize(){this._saveInstanceProperties(),this._requestUpdate()}_saveInstanceProperties(){this.constructor._classProperties.forEach((e,t)=>{if(this.hasOwnProperty(t)){const e=this[t];delete this[t],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(t,e)}})}_applyInstanceProperties(){this._instanceProperties.forEach((e,t)=>this[t]=e),this._instanceProperties=void 0}connectedCallback(){this._updateState=this._updateState|T,this._hasConnectedResolver&&(this._hasConnectedResolver(),this._hasConnectedResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(e,t,s){t!==s&&this._attributeToProperty(e,s)}_propertyToAttribute(e,t,s=_){const r=this.constructor,i=r._attributeNameForProperty(e,s);if(void 0!==i){const e=r._propertyValueToAttribute(t,s);if(void 0===e)return;this._updateState=this._updateState|S,null==e?this.removeAttribute(i):this.setAttribute(i,e),this._updateState=this._updateState&~S}}_attributeToProperty(e,t){if(this._updateState&S)return;const s=this.constructor,r=s._attributeToPropertyMap.get(e);if(void 0!==r){const e=s._classProperties.get(r)||_;this._updateState=this._updateState|C,this[r]=s._propertyValueFromAttribute(t,e),this._updateState=this._updateState&~C}}_requestUpdate(e,t){let s=!0;if(void 0!==e){const r=this.constructor,i=r._classProperties.get(e)||_;r._valueHasChanged(this[e],t,i.hasChanged)?(this._changedProperties.has(e)||this._changedProperties.set(e,t),!0!==i.reflect||this._updateState&C||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(e,i))):s=!1}!this._hasRequestedUpdate&&s&&this._enqueueUpdate()}requestUpdate(e,t){return this._requestUpdate(e,t),this.updateComplete}async _enqueueUpdate(){let e,t;this._updateState=this._updateState|P;const s=this._updatePromise;this._updatePromise=new Promise((s,r)=>{e=s,t=r});try{await s}catch(e){}this._hasConnected||await new Promise(e=>this._hasConnectedResolver=e);try{const e=this.performUpdate();null!=e&&await e}catch(e){t(e)}e(!this._hasRequestedUpdate)}get _hasConnected(){return this._updateState&T}get _hasRequestedUpdate(){return this._updateState&P}get hasUpdated(){return this._updateState&x}performUpdate(){this._instanceProperties&&this._applyInstanceProperties();let e=!1;const t=this._changedProperties;try{(e=this.shouldUpdate(t))&&this.update(t)}catch(t){throw e=!1,t}finally{this._markUpdated()}e&&(this._updateState&x||(this._updateState=this._updateState|x,this.firstUpdated(t)),this.updated(t))}_markUpdated(){this._changedProperties=new Map,this._updateState=this._updateState&~P}get updateComplete(){return this._getUpdateComplete()}_getUpdateComplete(){return this._updatePromise}shouldUpdate(e){return!0}update(e){void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach((e,t)=>this._propertyToAttribute(t,this[t],e)),this._reflectingProperties=void 0)}updated(e){}firstUpdated(e){}}A[M]=!0;const O=e=>t=>"function"==typeof t?((e,t)=>(window.customElements.define(e,t),t))(e,t):((e,t)=>{const{kind:s,elements:r}=t;return{kind:s,elements:r,finisher(t){window.customElements.define(e,t)}}})(e,t),R=(e,t)=>"method"!==t.kind||!t.descriptor||"value"in t.descriptor?{kind:"field",key:Symbol(),placement:"own",descriptor:{},initializer(){"function"==typeof t.initializer&&(this[t.key]=t.initializer.call(this))},finisher(s){s.createProperty(t.key,e)}}:Object.assign({},t,{finisher(s){s.createProperty(t.key,e)}}),D=(e,t,s)=>{t.constructor.createProperty(s,e)};function j(e){return(t,s)=>void 0!==s?D(e,t,s):R(e,t)}function k(e){return(t,s)=>{const r={get(){return this.renderRoot.querySelector(e)},enumerable:!0,configurable:!0};return void 0!==s?N(r,t,s):V(r,t)}}function L(e){return(t,s)=>{const r={get(){return this.renderRoot.querySelectorAll(e)},enumerable:!0,configurable:!0};return void 0!==s?N(r,t,s):V(r,t)}}const N=(e,t,s)=>{Object.defineProperty(t,s,e)},V=(e,t)=>({kind:"method",placement:"prototype",key:t.key,descriptor:e}),I=e=>(t,s)=>void 0!==s?((e,t,s)=>{Object.assign(t[s],e)})(e,t,s):((e,t)=>Object.assign({},t,{finisher(s){Object.assign(s.prototype[t.key],e)}}))(e,t),B="adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,z=Symbol();class F{constructor(e,t){if(t!==z)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e}get styleSheet(){return void 0===this._styleSheet&&(B?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}const $=e=>new F(String(e),z),U=(e,...t)=>{const s=t.reduce((t,s,r)=>t+(e=>{if(e instanceof F)return e.cssText;if("number"==typeof e)return e;throw new Error(`Value passed to 'css' function must be a 'css' function result: ${e}. Use 'unsafeCSS' to pass non-literal values, but\n            take care to ensure page security.`)})(s)+e[r+1],e[0]);return new F(s,z)};s.d(t,"LitElement",(function(){return G})),s.d(t,"defaultConverter",(function(){return b})),s.d(t,"notEqual",(function(){return w})),s.d(t,"UpdatingElement",(function(){return A})),s.d(t,"customElement",(function(){return O})),s.d(t,"property",(function(){return j})),s.d(t,"query",(function(){return k})),s.d(t,"queryAll",(function(){return L})),s.d(t,"eventOptions",(function(){return I})),s.d(t,"html",(function(){return r.html})),s.d(t,"svg",(function(){return r.svg})),s.d(t,"TemplateResult",(function(){return r.TemplateResult})),s.d(t,"SVGTemplateResult",(function(){return r.SVGTemplateResult})),s.d(t,"supportsAdoptingStyleSheets",(function(){return B})),s.d(t,"CSSResult",(function(){return F})),s.d(t,"unsafeCSS",(function(){return $})),s.d(t,"css",(function(){return U})),(window.litElementVersions||(window.litElementVersions=[])).push("2.2.1");const H=e=>e.flat?e.flat(1/0):function e(t,s=[]){for(let r=0,i=t.length;r<i;r++){const i=t[r];Array.isArray(i)?e(i,s):s.push(i)}return s}(e);class G extends A{static finalize(){super.finalize.call(this),this._styles=this.hasOwnProperty(JSCompiler_renameProperty("styles",this))?this._getUniqueStyles():this._styles||[]}static _getUniqueStyles(){const e=this.styles,t=[];if(Array.isArray(e)){H(e).reduceRight((e,t)=>(e.add(t),e),new Set).forEach(e=>t.unshift(e))}else e&&t.push(e);return t}initialize(){super.initialize(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow({mode:"open"})}adoptStyles(){const e=this.constructor._styles;0!==e.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?B?this.renderRoot.adoptedStyleSheets=e.map(e=>e.styleSheet):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(e.map(e=>e.cssText),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}update(e){super.update(e);const t=this.render();t instanceof r.TemplateResult&&this.constructor.render(t,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach(e=>{const t=document.createElement("style");t.textContent=e.cssText,this.renderRoot.appendChild(t)}))}render(){}}G.finalized=!0,G.render=(e,t,s)=>{if(!s||"object"!=typeof s||!s.scopeName)throw new Error("The `scopeName` option is required.");const r=s.scopeName,n=h.a.has(t),o=f&&11===t.nodeType&&!!t.host,a=o&&!g.has(r),l=a?document.createDocumentFragment():t;if(Object(h.b)(e,l,Object.assign({templateFactory:m(r)},s)),a){const e=h.a.get(l);h.a.delete(l);const s=e.value instanceof d.a?e.value.template:void 0;y(r,l,s),Object(i.b)(t,t.firstChild),t.appendChild(l),h.a.set(t,e)}!n&&o&&window.ShadyCSS.styleElement(t.host)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(!e||!t)return!1;let s=e.prototype;for(;s;){if(s===t.prototype)return!0;s=s.prototype}return!1}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(72);t.default=class{constructor(e,t,s,i){if(1===e.elementCount&&s>=0)throw new Error("non-array source property; can't link to element");if(1===t.elementCount&&i>=0)throw new Error("non-array destination property; can't link to element");this.source=e,this.destination=t,this.sourceIndex=s,this.destinationIndex=i;const n=void 0===s?-1:s,o=void 0===i?-1:i,a=e.elementCount>1&&n<0&&o<0;this.fnConvert=r.getConversionFunction(e.type,t.type,a);const l=r.getElementCopyFunction(n,o,this.fnConvert);this.fnCopy=r.getMultiCopyFunction(e.isMulti(),t.isMulti(),l)}push(){this.destination.setValue(this.fnCopy(this.source.value,this.destination.value,this.fnConvert))}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enumToArray=function(e){return Object.keys(e).filter(e=>isNaN(Number(e)))}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(8),i=s(71),n=s(30);class o extends r.default{constructor(e){super(),this.addEvent("property"),this.linkable=e,this.properties=[]}get customProperties(){return this.properties.filter(e=>e.custom)}dispose(){this.unlinkAllProperties()}isInputGroup(){return this===this.linkable.ins}isOutputGroup(){return this===this.linkable.outs}createProperties(e,t){return Object.keys(e).forEach((s,r)=>{const i=void 0===t?void 0:t+r,n=e[s];this.createProperty(n.path,n.schema,s,i)}),this}createProperty(e,t,s,r){const n=new i.default(e,t);return this.addProperty(n,s,r),n}createCustomProperty(e,t,s){const r=new i.default(e,t,!0);return this.addCustomProperty(r,s),r}addCustomProperty(e,t){const s=n.default(5);this.addProperty(e,s,t)}addProperty(e,t,s){if(e.group)throw new Error("can't add, property already part of a group");if(this[t])throw new Error(`key '${t}' already exists in group`);e._group=this,e._key=t,void 0===s?this.properties.push(e):this.properties.splice(s,0,e),this[t]=e,this.emit({type:"property",add:!0,remove:!1,property:e})}removeProperty(e){if(e.group!==this)throw new Error("can't remove, property not in this group");if(e.hasLinks())throw new Error("can't remove, property has links");if(this[e.key]!==e)throw new Error(`property key '${e.key}' not found in group`);this.properties.slice(this.properties.indexOf(e),1),delete this[e.key],e._group=null,e._key="",this.emit({type:"property",add:!1,remove:!0,property:e})}getProperty(e){const t=this[e];if(!t)throw new Error(`no property found with key '${e}'`);return t}getKeys(e=!1){const t=[];return this.properties.forEach(s=>{(e||"object"!==s.type)&&t.push(s.key)}),t}getValues(e=!1){const t=[];return this.properties.map(s=>{(e||"object"!==s.type)&&t.push(s.value)}),t}cloneValues(e=!1){const t=[];return this.properties.map(s=>{(e||"object"!==s.type)&&t.push(s.cloneValue())}),t}setValues(e){Object.keys(e).forEach(t=>this.getProperty(t).value=e[t])}copyValues(e){Object.keys(e).forEach(t=>this.getProperty(t).copyValue(e[t]))}unlinkAllProperties(){this.properties.forEach(e=>e.unlink())}toJSON(){let e=null;return this.properties.forEach(t=>{const s=t.toJSON();s&&((e=e||{})[t.key]=s)}),e}fromJSON(e){Object.keys(e).forEach(t=>{const s=e[t];if(s.schema){const e=new i.default(s.path,s.schema,!0);this.addProperty(e,t)}})}linksFromJSON(e,t){Object.keys(e).forEach(s=>{this[s].fromJSON(e[s],t)})}}t.default=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0);t.default=class{constructor(e,t){this._typeName=t?r.default.getTypeName(t):null,this._id=t instanceof r.default?t.id:void 0,this._system=e}get component(){return this._id&&this._system.components.getById(this._id)||null}set component(e){if(e&&this._typeName&&!(e instanceof this._system.registry.getType(this._typeName)))throw new Error(`can't assign component of class '${e.constructor.name||"unknown"}' to link of class '${this._typeName}'`);this._id=e?e.id:void 0}}},function(e,t,s){"use strict";s.r(t),s.d(t,"repeat",(function(){return u}));var r=s(4);const i=(e,t)=>{const s=e.startNode.parentNode,i=void 0===t?e.endNode:t.startNode,n=s.insertBefore(Object(r.createMarker)(),i);s.insertBefore(Object(r.createMarker)(),i);const o=new r.NodePart(e.options);return o.insertAfterNode(n),o},n=(e,t)=>(e.setValue(t),e.commit(),e),o=(e,t,s)=>{const i=e.startNode.parentNode,n=s?s.startNode:e.endNode,o=t.endNode.nextSibling;o!==n&&Object(r.reparentNodes)(i,t.startNode,o,n)},a=e=>{Object(r.removeNodes)(e.startNode.parentNode,e.startNode,e.endNode.nextSibling)},l=(e,t,s)=>{const r=new Map;for(let i=t;i<=s;i++)r.set(e[i],i);return r},c=new WeakMap,h=new WeakMap,u=Object(r.directive)((e,t,s)=>{let u;return void 0===s?s=t:void 0!==t&&(u=t),t=>{if(!(t instanceof r.NodePart))throw new Error("repeat can only be used in text bindings");const d=c.get(t)||[],p=h.get(t)||[],f=[],m=[],v=[];let g,y,b=0;for(const t of e)v[b]=u?u(t,b):b,m[b]=s(t,b),b++;let w=0,_=d.length-1,E=0,x=m.length-1;for(;w<=_&&E<=x;)if(null===d[w])w++;else if(null===d[_])_--;else if(p[w]===v[E])f[E]=n(d[w],m[E]),w++,E++;else if(p[_]===v[x])f[x]=n(d[_],m[x]),_--,x--;else if(p[w]===v[x])f[x]=n(d[w],m[x]),o(t,d[w],f[x+1]),w++,x--;else if(p[_]===v[E])f[E]=n(d[_],m[E]),o(t,d[_],d[w]),_--,E++;else if(void 0===g&&(g=l(v,E,x),y=l(p,w,_)),g.has(p[w]))if(g.has(p[_])){const e=y.get(v[E]),s=void 0!==e?d[e]:null;if(null===s){const e=i(t,d[w]);n(e,m[E]),f[E]=e}else f[E]=n(s,m[E]),o(t,s,d[w]),d[e]=null;E++}else a(d[_]),_--;else a(d[w]),w++;for(;E<=x;){const e=i(t,f[x+1]);n(e,m[E]),f[E++]=e}for(;w<=_;){const e=d[w++];null!==e&&a(e)}c.set(t,f),h.set(t,v)}})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(135),i=s(74),n=s(75),o=s(50),a=s(76),l=s(139),c=s(238),h=s(248),u=s(29),d=s(19),p=s(32),f=s(114),m=s(115),v=s(125),g=s(70),y=s(36);class b{constructor(e,t,s){this.props=t||{},console.log(b.splashMessage);const r=new n.default;r.add(l.default),r.add(c.default),this.commander=new i.default;const o=this.system=new a.default(r),u=o.graph.createCustomNode(f.default);o.graph.createCustomNode(v.default),o.graph.createCustomNode(m.default),e&&new g.default(this).appendTo(e),s||(this.documentProvider.createDocument(h),this.evaluateProps()),u.pulse.start()}get assetManager(){return this.system.getMainComponent(d.default)}get assetReader(){return this.system.getMainComponent(p.default)}get documentProvider(){return this.system.getMainComponent(u.default)}setBaseUrl(e){this.assetManager.baseUrl=e}loadDocument(e,t,s){const r=y.EDerivativeQuality[s];return this.assetReader.getJSON(e).then(s=>(t=void 0===t?!s.lights&&!s.cameras:t,this.documentProvider.amendDocument(s,e,t))).then(e=>(isFinite(r)&&e.setup.viewer.ins.quality.setValue(r),e))}loadModel(e,t){return this.documentProvider.appendModel(e,t)}loadGeometry(e,t,s,r,i){return this.documentProvider.appendGeometry(e,t,s,r,i)}evaluateProps(){const e=this.props,t=this.assetManager;e.root=e.root||r.default("root")||r.default("r"),e.document=e.document||r.default("document")||r.default("d"),e.model=e.model||r.default("model")||r.default("m"),e.geometry=e.geometry||r.default("geometry")||r.default("g"),e.texture=e.texture||r.default("texture")||r.default("t"),e.quality=e.quality||r.default("quality")||r.default("q");const s=e.root||e.document||e.model||e.geometry;this.setBaseUrl(new URL(s||".",window.location).href),e.document?(e.document=e.root?e.document:t.getAssetName(e.document),this.loadDocument(e.document,void 0,e.quality).catch(e=>o.default.show(`Failed to load document: ${e.message}`,"error"))):e.model?(e.model=e.root?e.model:t.getAssetName(e.model),this.loadModel(e.model,e.quality)):e.geometry?(e.geometry=e.root?e.geometry:t.getAssetName(e.geometry),e.texture=e.root?e.texture:t.getAssetName(e.texture),this.loadGeometry(e.geometry,e.texture,null,null,e.quality)):this.loadDocument("document.svx.json",void 0).catch(()=>{})}}t.default=b,b.splashMessage="\n  _________       .__  __  .__                        .__                ________ ________   \n /   _____/ _____ |__|/  |_|  |__   __________   ____ |__|____    ____   \\_____  \\\\______ \\  \n \\_____  \\ /     \\|  \\   __\\  |  \\ /  ___/  _ \\ /    \\|  \\__  \\  /    \\    _(__  < |    |  \\ \n /        \\  Y Y  \\  ||  | |   Y  \\\\___ (  <_> )   |  \\  |/ __ \\|   |  \\  /       \\|    `   \\\n/_______  /__|_|  /__||__| |___|  /____  >____/|___|  /__(____  /___|  / /______  /_______  /\n        \\/      \\/              \\/     \\/           \\/        \\/     \\/         \\/        \\/ \n    \nVoyager - 3D Explorer and Tool Suite\n3D Foundation Project\n(c) 2019 Smithsonian Institution\n\nhttps://3d.si.edu\nhttps://github.com/smithsonian/dpo-voyager\n\n-----------------------------------------------------\nVersion: Voyager Explorer v0.7.0-20-g1137fe7\n  PROD\n-----------------------------------------------------\n    ",window.VoyagerExplorer=b},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const s=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);if(s)return s[2]?decodeURIComponent(s[2].replace(/\+/g," ")):""}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(137);t.default=class{constructor(e,t){this._args=e,this._props=t,this._args=e,this._state=null}get name(){return this._props.name||r.normalize(this._props.do.name)}do(){if(this._state)throw new Error("undo should be called before execute can be applied again");this._state=this._props.do.apply(this._props.target,this._args)}undo(){if(!this._props.undo)throw new Error("can't undo this command");if(!this._state)throw new Error("execute should be called before undo can be applied");this._props.undo.call(this._props.target,this._state),this._state=null}canDo(){return!this._props.canDo||this._props.canDo()}canUndo(){return!!this._props.undo}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.camelize=function(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,(e,t)=>0==t?e.toLowerCase():e.toUpperCase()).replace(/\s+/g,"")},t.normalize=function(e){return e.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase())}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.visited={},this.visiting={},this.sorted=[]}sort(e){for(let t=0,s=e.length;t<s;++t)this.visit(e[t]);const t=this.sorted;return this.visited={},this.visiting={},this.sorted=[],t}visit(e){const t=this.visited,s=this.visiting;if(t[e.id]||s[e.id])return;s[e.id]=!0;const r=e.outs.properties.concat(e.ins.properties);for(let e=0,t=r.length;e<t;++e){const t=r[e].outLinks;for(let e=0,s=t.length;e<s;++e){const s=t[e].destination.group,r=s.properties;for(let e=0,t=r.length;e<t;++e){const t=r[e].outLinks;for(let e=0,s=t.length;e<s;++e){const s=t[e].destination.group;this.visit(s.linkable)}}this.visit(s.linkable)}}s[e.id]=void 0,t[e.id]=!0,this.sorted.unshift(e)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(41),i=s(51),n=s(52),o=s(78),a=s(79),l=s(26),c=s(39),h=s(80),u=s(31),d=s(10),p=s(13),f=s(19),m=s(32),v=s(83),g=s(29),y=s(22),b=s(45),w=s(60),_=s(28),E=s(15),x=s(237),P=s(61),S=s(92),C=s(93),T=s(94),M=s(95),A=s(105),O=s(106),R=s(62),D=s(64),j=s(108),k=s(110),L=s(111),N=s(65),V=s(112),I=s(113),B=s(66),z=s(114),F=s(115),$=s(104),U=s(34),H=[r.default,i.default,n.default,o.default,a.default,l.default,c.default,h.default,u.default,d.default,p.default,f.default,m.default,v.default,g.default,y.default,b.default,w.default,_.default,E.default,x.default,P.default,S.default,C.default,T.default,M.default,A.default,O.default,R.default,D.default,j.default,k.default,L.default,N.default,V.default,I.default,B.default,z.default,F.default,$.default,U.default];t.default=H},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(74);t.Commander=r.default;const i=s(0);t.types=i.types;class n extends i.default{createActions(e){return{}}}t.default=n,n.typeName="CController",n.isSystemSingleton=!0},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=Math.PI,i=.5*r;var n;!function(e){e[e.Linear=0]="Linear",e[e.EaseQuad=1]="EaseQuad",e[e.EaseInQuad=2]="EaseInQuad",e[e.EaseOutQuad=3]="EaseOutQuad",e[e.EaseCubic=4]="EaseCubic",e[e.EaseInCubic=5]="EaseInCubic",e[e.EaseOutCubic=6]="EaseOutCubic",e[e.EaseQuart=7]="EaseQuart",e[e.EaseInQuart=8]="EaseInQuart",e[e.EaseOutQuart=9]="EaseOutQuart",e[e.EaseQuint=10]="EaseQuint",e[e.EaseInQuint=11]="EaseInQuint",e[e.EaseOutQuint=12]="EaseOutQuint",e[e.EaseSine=13]="EaseSine",e[e.EaseInSine=14]="EaseInSine",e[e.EaseOutSine=15]="EaseOutSine"}(n=t.EEasingCurve||(t.EEasingCurve={})),t.getEasingFunction=function(e){return t.easingFunctions[n[e]]},t.easingFunctions={Linear:function(e){return e},EaseQuad:function(e){return e<.5?2*e*e:(4-2*e)*e-1},EaseInQuad:function(e){return e*e},EaseOutQuad:function(e){return e*(2-e)},EaseCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},EaseInCubic:function(e){return e*e*e},EaseOutCubic:function(e){return--e*e*e+1},EaseQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},EaseInQuart:function(e){return e*e*e*e},EaseOutQuart:function(e){return 1- --e*e*e*e},EaseQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e},EaseInQuint:function(e){return e*e*e*e*e},EaseOutQuint:function(e){return 1+--e*e*e*e*e},EaseSine:function(e){return-.5*(Math.cos(e*r)-1)},EaseInSine:function(e){return 1-Math.cos(e*i)},EaseOutSine:function(e){return Math.sin(e*i)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(54),n=new r.Vector3,o=new r.Matrix4;class a extends r.LineSegments{constructor(e,t){t=Object.assign({},a.defaultProps,t);const s=new r.Box3;s.makeEmpty(),i.computeLocalBoundingBox(e,s);const n=t.length,o=[s.min.x,s.min.y,s.min.z],l=[s.max.x,s.max.y,s.max.z],c=[(l[0]-o[0])*n,(l[1]-o[1])*n,(l[2]-o[2])*n];let h;h=isFinite(c[0])&&isFinite(c[1])&&isFinite(c[2])?[o[0],o[1],o[2],o[0]+c[0],o[1],o[2],o[0],o[1],o[2],o[0],o[1]+c[1],o[2],o[0],o[1],o[2],o[0],o[1],o[2]+c[2],l[0],o[1],o[2],l[0]-c[0],o[1],o[2],l[0],o[1],o[2],l[0],o[1]+c[1],o[2],l[0],o[1],o[2],l[0],o[1],o[2]+c[2],o[0],l[1],o[2],o[0]+c[0],l[1],o[2],o[0],l[1],o[2],o[0],l[1]-c[1],o[2],o[0],l[1],o[2],o[0],l[1],o[2]+c[2],o[0],o[1],l[2],o[0]+c[0],o[1],l[2],o[0],o[1],l[2],o[0],o[1]+c[1],l[2],o[0],o[1],l[2],o[0],o[1],l[2]-c[2],o[0],l[1],l[2],o[0]+c[0],l[1],l[2],o[0],l[1],l[2],o[0],l[1]-c[1],l[2],o[0],l[1],l[2],o[0],l[1],l[2]-c[2],l[0],o[1],l[2],l[0]-c[0],o[1],l[2],l[0],o[1],l[2],l[0],o[1]+c[1],l[2],l[0],o[1],l[2],l[0],o[1],l[2]-c[2],l[0],l[1],o[2],l[0]-c[0],l[1],o[2],l[0],l[1],o[2],l[0],l[1]-c[1],o[2],l[0],l[1],o[2],l[0],l[1],o[2]+c[2],l[0],l[1],l[2],l[0]-c[0],l[1],l[2],l[0],l[1],l[2],l[0],l[1]-c[1],l[2],l[0],l[1],l[2],l[0],l[1],l[2]-c[2]]:[-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1,0,0,1];const u=new r.BufferGeometry;u.addAttribute("position",new r.Float32BufferAttribute(h,3)),super(u,new r.LineBasicMaterial({color:t.color,depthTest:!1})),this.renderOrder=1,this.onBeforeRender=()=>{e.updateMatrixWorld(!1),this.matrixWorld.copy(e.matrixWorld)}}dispose(){this.parent&&this.parent.remove(this),this.geometry.dispose()}static expandBoundingBox(e,t,s){const r=e.geometry;if(void 0!==r){let i=e;for(o.identity();i&&i!==t;)o.premultiply(i.matrix),i=i.parent;if(r.isGeometry){const e=r.vertices;for(let t=0,r=e.length;t<r;++t)n.copy(e[t]).applyMatrix4(o),s.expandByPoint(n)}else if(r.isBufferGeometry){const e=r.attributes.position;if(void 0!==e)for(let t=0,r=e.count;t<r;++t)n.fromBufferAttribute(e,t).applyMatrix4(o),s.expandByPoint(n)}}const i=e.children;for(let e=0,r=i.length;e<r;++e)a.expandBoundingBox(i[e],t,s)}}t.default=a,a.defaultProps={color:new r.Color("#ffd633"),length:.25}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1);class i extends r.ShaderMaterial{constructor(){super(...arguments),this.isIndexShader=!0,this.uniformsNeedUpdate=!1,this.lights=!1,this.uniforms={index:{value:[0,0,0]}},this.vertexShader=["void main() {","  #include <begin_vertex>","  #include <project_vertex>","}"].join("\n"),this.fragmentShader=["uniform vec3 index;","void main() {","  gl_FragColor = vec4(index, 1.0);","}"].join("\n")}static indexFromPixel(e){return e[0]+e[1]<<8+e[2]<<16}static zoneFromPixel(e){return e[3]}setIndex(e){const t=e>>16,s=(e>>8)-(t<<8),r=e-(t<<16)-(s<<8),i=this.uniforms.index.value;i[0]=r/255,i[1]=s/255,i[2]=t/255,this.uniformsNeedUpdate=!0}}t.default=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1);class i extends r.ShaderMaterial{constructor(){super(...arguments),this.isPositionShader=!0,this.uniforms={index:{value:0},range:{value:[-1,1]}},this.vertexShader=["varying vec3 vLocalPosition;","void main() {","  #include <begin_vertex>","  #include <project_vertex>","  vLocalPosition = vec3(position);","}"].join("\n"),this.fragmentShader=["uniform float index;","uniform vec2 range;","varying vec3 vLocalPosition;","vec4 toVec4(float v) {","  float vn = (v - range.x) / (range.y - range.x);","  float b0 = floor(vn * 255.0) / 255.0; vn = (vn - b0) * 256.0;","  float b1 = floor(vn * 255.0) / 255.0; vn = (vn - b1) * 256.0;","  float b2 = floor(vn * 255.0) / 255.0; vn = (vn - b2) * 256.0;","  float b3 = floor(vn * 255.0) / 255.0;","  return vec4(clamp(b0, 0.0, 1.0), clamp(b1, 0.0, 1.0), clamp(b2, 0.0, 1.0), clamp(b3, 0.0, 1.0));","}","void main() {","  gl_FragColor = (index == 0.0 ? toVec4(vLocalPosition.x)","    : (index == 1.0 ? toVec4(vLocalPosition.y) : toVec4(vLocalPosition.z)));","}"].join("\n")}}t.default=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1);class i extends r.ShaderMaterial{constructor(){super(...arguments),this.isNormalShader=!0,this.uniforms={index:{value:0}},this.vertexShader=["varying vec3 vLocalNormal;","void main() {","  #include <beginnormal_vertex>","  #include <begin_vertex>","  #include <project_vertex>","  vLocalNormal = vec3(normal);","}"].join("\n"),this.fragmentShader=["uniform vec3 index;","varying vec3 vLocalNormal;","void main() {","  vec3 normal = normalize(vLocalNormal);","  gl_FragColor = vec4(normal * 0.5 + 0.5, 1.0);","}"].join("\n")}}t.default=i},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function o(e){try{l(r.next(e))}catch(e){n(e)}}function a(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.default={json:function(e,t,s){return r(this,void 0,void 0,(function*(){return s&&"string"!=typeof s&&(s=JSON.stringify(s)),fetch(e,{headers:{Accept:"application/json","Content-Type":"application/json"},method:t,credentials:"same-origin",body:s}).then(s=>{if(!s.ok){const r=`fetch.json (${t} at '${e}'), error: ${s.status} - ${s.statusText}`;throw console.warn(r),new Error(r)}return s.json()}).catch(s=>{throw console.warn(`fetch.json (${t} at '${e}'), error: ${s.message}`),s})}))},text:function(e,t,s){return r(this,void 0,void 0,(function*(){return fetch(e,{headers:{Accept:"text/plain","Content-Type":"text/plain"},method:t,credentials:"include",body:s}).then(e=>{if(!e.ok)throw new Error(`status: ${e.status}`);return e.text()}).catch(s=>{throw console.warn(`fetch.text (${t} at '${e}'), error: ${s.message}`),s})}))},file:function(e,t,s,i=!0){return r(this,void 0,void 0,(function*(){const r={method:t,credentials:"include",body:s};return i||(r.headers={"Content-Type":"application/octet-stream"}),fetch(e,r).then(e=>{if(!e.ok)throw new Error(`status: ${e.status}`);return e}).catch(s=>{throw console.warn(`fetch.file (${t} at '${e}'), error: ${s.message}`),s})}))},buffer:function(e,t,s){return r(this,void 0,void 0,(function*(){return fetch(e,{headers:{Accept:"application/octet-stream","Content-Type":"application/octet-stream"},method:t,credentials:"include",body:s}).then(e=>{if(!e.ok)throw new Error(`status: ${e.status}`);return e.arrayBuffer()}).catch(s=>{throw console.warn(`fetch.buffer (${t} at '${e}'), error: ${s.message}`),s})}))}}},function(e,t,s){"use strict";var r=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function o(e){try{l(r.next(e))}catch(e){n(e)}}function a(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e){this._loadingManager=e}get(e){return r(this,void 0,void 0,(function*(){return this._loadingManager.itemStart(e),fetch(e,{headers:{Accept:"application/json"}}).then(t=>{if(!t.ok)throw this._loadingManager.itemError(e),new Error(`failed to fetch from '${e}', status: ${t.status} ${t.statusText}`);return this._loadingManager.itemEnd(e),t.json()})}))}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(149),i=s(1);s(150),s(151);const n=i.GLTFLoader,o=i.DRACOLoader,a=s(56);class l{constructor(e){this.loadingManager=e;const t=r.default("js/draco/",window.location.origin+window.location.pathname);const s=new o;s.setDecoderPath(t),this.gltfLoader=new n(e),this.gltfLoader.setDRACOLoader(s)}isValid(e){const t=e.split(".").pop().toLowerCase();return l.extensions.indexOf(t)>=0}isValidMimeType(e){return l.mimeTypes.indexOf(e)>=0}get(e){return new Promise((t,s)=>{this.gltfLoader.load(e,e=>{t(this.createModelGroup(e))},null,t=>{console.error(`failed to load '${e}': ${t}`),s(new Error(t))})})}createModelGroup(e){const t=e.scene;if("Scene"!==t.type)throw new Error("not a valid gltf scene");const s=new i.Group;return t.children.forEach(e=>s.add(e)),s.traverse(e=>{if("Mesh"===e.type){const t=e;t.castShadow=!0;const s=t.material;s.map&&(s.map.encoding=i.sRGBEncoding),t.geometry.computeBoundingBox();const r=new a.default;"MeshStandardMaterial"===s.type&&r.copyStandardMaterial(s),s.userData.objectSpaceNormals&&r.enableObjectSpaceNormalMap(!0),t.material=r}}),s}}t.default=l,l.extensions=["gltf","glb"],l.mimeTypes=["model/gltf+json","model/gltf-binary"]},function(e,t,s){"use strict";function r(e){return"/"===e.charAt(0)}function i(e,t){for(var s=t,r=s+1,i=e.length;r<i;s+=1,r+=1)e[s]=e[r];e.pop()}s.r(t),t.default=function(e,t){void 0===t&&(t="");var s,n=e&&e.split("/")||[],o=t&&t.split("/")||[],a=e&&r(e),l=t&&r(t),c=a||l;if(e&&r(e)?o=n:n.length&&(o.pop(),o=o.concat(n)),!o.length)return"/";if(o.length){var h=o[o.length-1];s="."===h||".."===h||""===h}else s=!1;for(var u=0,d=o.length;d>=0;d--){var p=o[d];"."===p?i(o,d):".."===p?(i(o,d),u++):u&&(i(o,d),u--)}if(!c)for(;u--;u)o.unshift("..");!c||""===o[0]||o[0]&&r(o[0])||o.unshift("");var f=o.join("/");return s&&"/"!==f.substr(-1)&&(f+="/"),f}},function(e,t){THREE.GLTFLoader=function(){function e(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.dracoLoader=null,this.ddsLoader=null}function t(){var e={};return{get:function(t){return e[t]},add:function(t,s){e[t]=s},remove:function(t){delete e[t]},removeAll:function(){e={}}}}e.prototype={constructor:e,crossOrigin:"anonymous",load:function(e,t,s,r){var i,n=this;i=void 0!==this.resourcePath?this.resourcePath:void 0!==this.path?this.path:THREE.LoaderUtils.extractUrlBase(e),n.manager.itemStart(e);var o=function(t){r?r(t):console.error(t),n.manager.itemError(e),n.manager.itemEnd(e)},a=new THREE.FileLoader(n.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),"use-credentials"===n.crossOrigin&&a.setWithCredentials(!0),a.load(e,(function(s){try{n.parse(s,i,(function(s){t(s),n.manager.itemEnd(e)}),o)}catch(e){o(e)}}),s,o)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(e){return this.ddsLoader=e,this},parse:function(e,t,a,l){var p,f={};if("string"==typeof e)p=e;else if(THREE.LoaderUtils.decodeText(new Uint8Array(e,0,4))===o){try{f[s.KHR_BINARY_GLTF]=new c(e)}catch(e){return void(l&&l(e))}p=f[s.KHR_BINARY_GLTF].content}else p=THREE.LoaderUtils.decodeText(new Uint8Array(e));var m=JSON.parse(p);if(void 0===m.asset||m.asset.version[0]<2)l&&l(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead."));else{if(m.extensionsUsed)for(var v=0;v<m.extensionsUsed.length;++v){var g=m.extensionsUsed[v],y=m.extensionsRequired||[];switch(g){case s.KHR_LIGHTS_PUNCTUAL:f[g]=new i(m);break;case s.KHR_MATERIALS_UNLIT:f[g]=new n;break;case s.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:f[g]=new d;break;case s.KHR_DRACO_MESH_COMPRESSION:f[g]=new h(m,this.dracoLoader);break;case s.MSFT_TEXTURE_DDS:f[s.MSFT_TEXTURE_DDS]=new r(this.ddsLoader);break;case s.KHR_TEXTURE_TRANSFORM:f[s.KHR_TEXTURE_TRANSFORM]=new u;break;default:y.indexOf(g)>=0&&console.warn('THREE.GLTFLoader: Unknown extension "'+g+'".')}}new B(m,f,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager}).parse(a,l)}}};var s={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function r(e){if(!e)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader");this.name=s.MSFT_TEXTURE_DDS,this.ddsLoader=e}function i(e){this.name=s.KHR_LIGHTS_PUNCTUAL;var t=e.extensions&&e.extensions[s.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=t.lights||[]}function n(){this.name=s.KHR_MATERIALS_UNLIT}i.prototype.loadLight=function(e){var t,s=this.lightDefs[e],r=new THREE.Color(16777215);void 0!==s.color&&r.fromArray(s.color);var i=void 0!==s.range?s.range:0;switch(s.type){case"directional":(t=new THREE.DirectionalLight(r)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new THREE.PointLight(r)).distance=i;break;case"spot":(t=new THREE.SpotLight(r)).distance=i,s.spot=s.spot||{},s.spot.innerConeAngle=void 0!==s.spot.innerConeAngle?s.spot.innerConeAngle:0,s.spot.outerConeAngle=void 0!==s.spot.outerConeAngle?s.spot.outerConeAngle:Math.PI/4,t.angle=s.spot.outerConeAngle,t.penumbra=1-s.spot.innerConeAngle/s.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+s.type+'".')}return t.position.set(0,0,0),t.decay=2,void 0!==s.intensity&&(t.intensity=s.intensity),t.name=s.name||"light_"+e,Promise.resolve(t)},n.prototype.getMaterialType=function(){return THREE.MeshBasicMaterial},n.prototype.extendParams=function(e,t,s){var r=[];e.color=new THREE.Color(1,1,1),e.opacity=1;var i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){var n=i.baseColorFactor;e.color.fromArray(n),e.opacity=n[3]}void 0!==i.baseColorTexture&&r.push(s.assignTexture(e,"map",i.baseColorTexture))}return Promise.all(r)};var o="glTF",a=12,l={JSON:1313821514,BIN:5130562};function c(e){this.name=s.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,a);if(this.header={magic:THREE.LoaderUtils.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==o)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.");for(var r=new DataView(e,a),i=0;i<r.byteLength;){var n=r.getUint32(i,!0);i+=4;var c=r.getUint32(i,!0);if(i+=4,c===l.JSON){var h=new Uint8Array(e,a+i,n);this.content=THREE.LoaderUtils.decodeText(h)}else if(c===l.BIN){var u=a+i;this.body=e.slice(u,u+n)}i+=n}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function h(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=s.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t}function u(){this.name=s.KHR_TEXTURE_TRANSFORM}function d(){return{name:s.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return THREE.ShaderMaterial},extendParams:function(e,t,s){var r=t.extensions[this.name],i=THREE.ShaderLib.standard,n=THREE.UniformsUtils.clone(i.uniforms),o=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),a=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),l=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),c=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),h=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),u=i.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",o).replace("#include <metalnessmap_pars_fragment>",a).replace("#include <roughnessmap_fragment>",l).replace("#include <metalnessmap_fragment>",c).replace("#include <lights_physical_fragment>",h);delete n.roughness,delete n.metalness,delete n.roughnessMap,delete n.metalnessMap,n.specular={value:(new THREE.Color).setHex(1118481)},n.glossiness={value:.5},n.specularMap={value:null},n.glossinessMap={value:null},e.vertexShader=i.vertexShader,e.fragmentShader=u,e.uniforms=n,e.defines={STANDARD:""},e.color=new THREE.Color(1,1,1),e.opacity=1;var d=[];if(Array.isArray(r.diffuseFactor)){var p=r.diffuseFactor;e.color.fromArray(p),e.opacity=p[3]}if(void 0!==r.diffuseTexture&&d.push(s.assignTexture(e,"map",r.diffuseTexture)),e.emissive=new THREE.Color(0,0,0),e.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,e.specular=new THREE.Color(1,1,1),Array.isArray(r.specularFactor)&&e.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture){var f=r.specularGlossinessTexture;d.push(s.assignTexture(e,"glossinessMap",f)),d.push(s.assignTexture(e,"specularMap",f))}return Promise.all(d)},createMaterial:function(e){var t=new THREE.ShaderMaterial({defines:e.defines,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,fog:!0,lights:!0,opacity:e.opacity,transparent:e.transparent});return t.isGLTFSpecularGlossinessMaterial=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t.extensions.derivatives=!0,t},cloneMaterial:function(e){var t=e.clone();t.isGLTFSpecularGlossinessMaterial=!0;for(var s=this.specularGlossinessParams,r=0,i=s.length;r<i;r++){var n=e[s[r]];t[s[r]]=n&&n.isColor?n.clone():n}return t},refreshUniforms:function(e,t,s,r,i){if(!0===i.isGLTFSpecularGlossinessMaterial){var n,o=i.uniforms,a=i.defines;o.opacity.value=i.opacity,o.diffuse.value.copy(i.color),o.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),o.map.value=i.map,o.specularMap.value=i.specularMap,o.alphaMap.value=i.alphaMap,o.lightMap.value=i.lightMap,o.lightMapIntensity.value=i.lightMapIntensity,o.aoMap.value=i.aoMap,o.aoMapIntensity.value=i.aoMapIntensity,i.map?n=i.map:i.specularMap?n=i.specularMap:i.displacementMap?n=i.displacementMap:i.normalMap?n=i.normalMap:i.bumpMap?n=i.bumpMap:i.glossinessMap?n=i.glossinessMap:i.alphaMap?n=i.alphaMap:i.emissiveMap&&(n=i.emissiveMap),void 0!==n&&(n.isWebGLRenderTarget&&(n=n.texture),!0===n.matrixAutoUpdate&&n.updateMatrix(),o.uvTransform.value.copy(n.matrix)),i.envMap&&(o.envMap.value=i.envMap,o.envMapIntensity.value=i.envMapIntensity,o.flipEnvMap.value=i.envMap.isCubeTexture?-1:1,o.reflectivity.value=i.reflectivity,o.refractionRatio.value=i.refractionRatio,o.maxMipLevel.value=e.properties.get(i.envMap).__maxMipLevel),o.specular.value.copy(i.specular),o.glossiness.value=i.glossiness,o.glossinessMap.value=i.glossinessMap,o.emissiveMap.value=i.emissiveMap,o.bumpMap.value=i.bumpMap,o.normalMap.value=i.normalMap,o.displacementMap.value=i.displacementMap,o.displacementScale.value=i.displacementScale,o.displacementBias.value=i.displacementBias,null!==o.glossinessMap.value&&void 0===a.USE_GLOSSINESSMAP&&(a.USE_GLOSSINESSMAP="",a.USE_ROUGHNESSMAP=""),null===o.glossinessMap.value&&void 0!==a.USE_GLOSSINESSMAP&&(delete a.USE_GLOSSINESSMAP,delete a.USE_ROUGHNESSMAP)}}}}function p(e,t,s,r){THREE.Interpolant.call(this,e,t,s,r)}h.prototype.decodePrimitive=function(e,t){var s=this.json,r=this.dracoLoader,i=e.extensions[this.name].bufferView,n=e.extensions[this.name].attributes,o={},a={},l={};for(var c in n){var h=C[c]||c.toLowerCase();o[h]=n[c]}for(c in e.attributes){h=C[c]||c.toLowerCase();if(void 0!==n[c]){var u=s.accessors[e.attributes[c]],d=E[u.componentType];l[h]=d,a[h]=!0===u.normalized}}return t.getDependency("bufferView",i).then((function(e){return new Promise((function(t){r.decodeDracoFile(e,(function(e){for(var s in e.attributes){var r=e.attributes[s],i=a[s];void 0!==i&&(r.normalized=i)}t(e)}),o,l)}))}))},u.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},p.prototype=Object.create(THREE.Interpolant.prototype),p.prototype.constructor=p,p.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,s=this.sampleValues,r=this.valueSize,i=e*r*3+r,n=0;n!==r;n++)t[n]=s[i+n];return t},p.prototype.beforeStart_=p.prototype.copySampleValue_,p.prototype.afterEnd_=p.prototype.copySampleValue_,p.prototype.interpolate_=function(e,t,s,r){for(var i=this.resultBuffer,n=this.sampleValues,o=this.valueSize,a=2*o,l=3*o,c=r-t,h=(s-t)/c,u=h*h,d=u*h,p=e*l,f=p-l,m=-2*d+3*u,v=d-u,g=1-m,y=v-u+h,b=0;b!==o;b++){var w=n[f+b+o],_=n[f+b+a]*c,E=n[p+b+o],x=n[p+b]*c;i[b]=g*w+y*_+m*E+v*x}return i};var f,m=0,v=1,g=2,y=3,b=4,w=5,_=6,E={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},x={9728:THREE.NearestFilter,9729:THREE.LinearFilter,9984:THREE.NearestMipmapNearestFilter,9985:THREE.LinearMipmapNearestFilter,9986:THREE.NearestMipmapLinearFilter,9987:THREE.LinearMipmapLinearFilter},P={33071:THREE.ClampToEdgeWrapping,33648:THREE.MirroredRepeatWrapping,10497:THREE.RepeatWrapping},S={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},C={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},T={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},M={CUBICSPLINE:void 0,LINEAR:THREE.InterpolateLinear,STEP:THREE.InterpolateDiscrete},A="OPAQUE",O="MASK",R="BLEND",D={"image/png":THREE.RGBAFormat,"image/jpeg":THREE.RGBFormat};function j(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:t+e)}function k(e,t,s){for(var r in s.extensions)void 0===e[r]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[r]=s.extensions[r])}function L(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function N(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var s=0,r=t.weights.length;s<r;s++)e.morphTargetInfluences[s]=t.weights[s];if(t.extras&&Array.isArray(t.extras.targetNames)){var i=t.extras.targetNames;if(e.morphTargetInfluences.length===i.length){e.morphTargetDictionary={};for(s=0,r=i.length;s<r;s++)e.morphTargetDictionary[i[s]]=s}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function V(e){for(var t="",s=Object.keys(e).sort(),r=0,i=s.length;r<i;r++)t+=s[r]+":"+e[s[r]]+";";return t}function I(e){if(e.isInterleavedBufferAttribute){for(var t=e.count,s=e.itemSize,r=e.array.slice(0,t*s),i=0,n=0;i<t;++i)r[n++]=e.getX(i),s>=2&&(r[n++]=e.getY(i)),s>=3&&(r[n++]=e.getZ(i)),s>=4&&(r[n++]=e.getW(i));return new THREE.BufferAttribute(r,s,e.normalized)}return e.clone()}function B(e,s,r){this.json=e||{},this.extensions=s||{},this.options=r||{},this.cache=new t,this.primitiveCache={},this.textureLoader=new THREE.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new THREE.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function z(e,t,s){var r=t.attributes,i=[];function n(t,r){return s.getDependency("accessor",t).then((function(t){e.addAttribute(r,t)}))}for(var o in r){var a=C[o]||o.toLowerCase();a in e.attributes||i.push(n(r[o],a))}if(void 0!==t.indices&&!e.index){var l=s.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));i.push(l)}return L(e,t),Promise.all(i).then((function(){return void 0!==t.targets?function(e,t,s){for(var r=!1,i=!1,n=0,o=t.length;n<o;n++){if(void 0!==(c=t[n]).POSITION&&(r=!0),void 0!==c.NORMAL&&(i=!0),r&&i)break}if(!r&&!i)return Promise.resolve(e);var a=[],l=[];for(n=0,o=t.length;n<o;n++){var c=t[n];if(r){var h=void 0!==c.POSITION?s.getDependency("accessor",c.POSITION):e.attributes.position;a.push(h)}if(i){h=void 0!==c.NORMAL?s.getDependency("accessor",c.NORMAL):e.attributes.normal;l.push(h)}}return Promise.all([Promise.all(a),Promise.all(l)]).then((function(s){for(var n=s[0],o=s[1],a=0,l=n.length;a<l;a++)e.attributes.position!==n[a]&&(n[a]=I(n[a]));for(a=0,l=o.length;a<l;a++)e.attributes.normal!==o[a]&&(o[a]=I(o[a]));for(a=0,l=t.length;a<l;a++){var c=t[a],h="morphTarget"+a;if(r&&void 0!==c.POSITION){var u=n[a];u.name=h;for(var d=e.attributes.position,p=0,f=u.count;p<f;p++)u.setXYZ(p,u.getX(p)+d.getX(p),u.getY(p)+d.getY(p),u.getZ(p)+d.getZ(p))}if(i&&void 0!==c.NORMAL){var m=o[a];m.name=h;var v=e.attributes.normal;for(p=0,f=m.count;p<f;p++)m.setXYZ(p,m.getX(p)+v.getX(p),m.getY(p)+v.getY(p),m.getZ(p)+v.getZ(p))}}return r&&(e.morphAttributes.position=n),i&&(e.morphAttributes.normal=o),e}))}(e,t.targets,s):e}))}return B.prototype.parse=function(e,t){var s=this,r=this.json,i=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then((function(t){var n={scene:t[0][r.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:r.asset,parser:s,userData:{}};k(i,n,r),L(n,r),e(n)})).catch(t)},B.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],s=this.json.meshes||[],r={},i={},n=0,o=t.length;n<o;n++)for(var a=t[n].joints,l=0,c=a.length;l<c;l++)e[a[l]].isBone=!0;for(var h=0,u=e.length;h<u;h++){var d=e[h];void 0!==d.mesh&&(void 0===r[d.mesh]&&(r[d.mesh]=i[d.mesh]=0),r[d.mesh]++,void 0!==d.skin&&(s[d.mesh].isSkinnedMesh=!0))}this.json.meshReferences=r,this.json.meshUses=i},B.prototype.getDependency=function(e,t){var r=e+":"+t,i=this.cache.get(r);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this.loadNode(t);break;case"mesh":i=this.loadMesh(t);break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this.loadBufferView(t);break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this.loadMaterial(t);break;case"texture":i=this.loadTexture(t);break;case"skin":i=this.loadSkin(t);break;case"animation":i=this.loadAnimation(t);break;case"camera":i=this.loadCamera(t);break;case"light":i=this.extensions[s.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(r,i)}return i},B.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var s=this,r=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(r.map((function(t,r){return s.getDependency(e,r)}))),this.cache.add(e,t)}return t},B.prototype.loadBuffer=function(e){var t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[s.KHR_BINARY_GLTF].body);var i=this.options;return new Promise((function(e,s){r.load(j(t.uri,i.path),e,void 0,(function(){s(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))},B.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var s=t.byteLength||0,r=t.byteOffset||0;return e.slice(r,r+s)}))},B.prototype.loadAccessor=function(e){var t=this,s=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse)return Promise.resolve(null);var i=[];return void 0!==r.bufferView?i.push(this.getDependency("bufferView",r.bufferView)):i.push(null),void 0!==r.sparse&&(i.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(i).then((function(e){var i,n,o=e[0],a=S[r.type],l=E[r.componentType],c=l.BYTES_PER_ELEMENT,h=c*a,u=r.byteOffset||0,d=void 0!==r.bufferView?s.bufferViews[r.bufferView].byteStride:void 0,p=!0===r.normalized;if(d&&d!==h){var f=Math.floor(u/d),m="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+f+":"+r.count,v=t.cache.get(m);v||(i=new l(o,f*d,r.count*d/c),v=new THREE.InterleavedBuffer(i,d/c),t.cache.add(m,v)),n=new THREE.InterleavedBufferAttribute(v,a,u%d/c,p)}else i=null===o?new l(r.count*a):new l(o,u,r.count*a),n=new THREE.BufferAttribute(i,a,p);if(void 0!==r.sparse){var g=S.SCALAR,y=E[r.sparse.indices.componentType],b=r.sparse.indices.byteOffset||0,w=r.sparse.values.byteOffset||0,_=new y(e[1],b,r.sparse.count*g),x=new l(e[2],w,r.sparse.count*a);null!==o&&n.setArray(n.array.slice());for(var P=0,C=_.length;P<C;P++){var T=_[P];if(n.setX(T,x[P*a]),a>=2&&n.setY(T,x[P*a+1]),a>=3&&n.setZ(T,x[P*a+2]),a>=4&&n.setW(T,x[P*a+3]),a>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return n}))},B.prototype.loadTexture=function(e){var t,r=this,i=this.json,n=this.options,o=this.textureLoader,a=window.URL||window.webkitURL,l=i.textures[e],c=l.extensions||{},h=(t=c[s.MSFT_TEXTURE_DDS]?i.images[c[s.MSFT_TEXTURE_DDS].source]:i.images[l.source]).uri,u=!1;return void 0!==t.bufferView&&(h=r.getDependency("bufferView",t.bufferView).then((function(e){u=!0;var s=new Blob([e],{type:t.mimeType});return h=a.createObjectURL(s)}))),Promise.resolve(h).then((function(e){var t=THREE.Loader.Handlers.get(e);return t||(t=c[s.MSFT_TEXTURE_DDS]?r.extensions[s.MSFT_TEXTURE_DDS].ddsLoader:o),new Promise((function(s,r){t.load(j(e,n.path),s,void 0,r)}))})).then((function(e){!0===u&&a.revokeObjectURL(h),e.flipY=!1,void 0!==l.name&&(e.name=l.name),t.mimeType in D&&(e.format=D[t.mimeType]);var s=(i.samplers||{})[l.sampler]||{};return e.magFilter=x[s.magFilter]||THREE.LinearFilter,e.minFilter=x[s.minFilter]||THREE.LinearMipmapLinearFilter,e.wrapS=P[s.wrapS]||THREE.RepeatWrapping,e.wrapT=P[s.wrapT]||THREE.RepeatWrapping,e}))},B.prototype.assignTexture=function(e,t,r){var i=this;return this.getDependency("texture",r.index).then((function(n){if(!n.isCompressedTexture)switch(t){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":n.format=THREE.RGBFormat}if(i.extensions[s.KHR_TEXTURE_TRANSFORM]){var o=void 0!==r.extensions?r.extensions[s.KHR_TEXTURE_TRANSFORM]:void 0;o&&(n=i.extensions[s.KHR_TEXTURE_TRANSFORM].extendTexture(n,o))}e[t]=n}))},B.prototype.assignFinalMaterial=function(e){var t=e.geometry,r=e.material,i=this.extensions,n=void 0!==t.attributes.tangent,o=void 0!==t.attributes.color,a=void 0===t.attributes.normal,l=!0===e.isSkinnedMesh,c=Object.keys(t.morphAttributes).length>0,h=c&&void 0!==t.morphAttributes.normal;if(e.isPoints){var u="PointsMaterial:"+r.uuid,d=this.cache.get(u);d||(d=new THREE.PointsMaterial,THREE.Material.prototype.copy.call(d,r),d.color.copy(r.color),d.map=r.map,d.lights=!1,d.sizeAttenuation=!1,this.cache.add(u,d)),r=d}else if(e.isLine){u="LineBasicMaterial:"+r.uuid;var p=this.cache.get(u);p||(p=new THREE.LineBasicMaterial,THREE.Material.prototype.copy.call(p,r),p.color.copy(r.color),p.lights=!1,this.cache.add(u,p)),r=p}if(n||o||a||l||c){u="ClonedMaterial:"+r.uuid+":";r.isGLTFSpecularGlossinessMaterial&&(u+="specular-glossiness:"),l&&(u+="skinning:"),n&&(u+="vertex-tangents:"),o&&(u+="vertex-colors:"),a&&(u+="flat-shading:"),c&&(u+="morph-targets:"),h&&(u+="morph-normals:");var f=this.cache.get(u);f||(f=r.isGLTFSpecularGlossinessMaterial?i[s.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].cloneMaterial(r):r.clone(),l&&(f.skinning=!0),n&&(f.vertexTangents=!0),o&&(f.vertexColors=THREE.VertexColors),a&&(f.flatShading=!0),c&&(f.morphTargets=!0),h&&(f.morphNormals=!0),this.cache.add(u,f)),r=f}r.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&(console.log("THREE.GLTFLoader: Duplicating UVs to support aoMap."),t.addAttribute("uv2",new THREE.BufferAttribute(t.attributes.uv.array,2))),r.isGLTFSpecularGlossinessMaterial&&(e.onBeforeRender=i[s.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms),e.material=r},B.prototype.loadMaterial=function(e){var t,r=this.json,i=this.extensions,n=r.materials[e],o={},a=n.extensions||{},l=[];if(a[s.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var c=i[s.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=c.getMaterialType(),l.push(c.extendParams(o,n,this))}else if(a[s.KHR_MATERIALS_UNLIT]){var h=i[s.KHR_MATERIALS_UNLIT];t=h.getMaterialType(),l.push(h.extendParams(o,n,this))}else{t=THREE.MeshStandardMaterial;var u=n.pbrMetallicRoughness||{};if(o.color=new THREE.Color(1,1,1),o.opacity=1,Array.isArray(u.baseColorFactor)){var d=u.baseColorFactor;o.color.fromArray(d),o.opacity=d[3]}void 0!==u.baseColorTexture&&l.push(this.assignTexture(o,"map",u.baseColorTexture)),o.metalness=void 0!==u.metallicFactor?u.metallicFactor:1,o.roughness=void 0!==u.roughnessFactor?u.roughnessFactor:1,void 0!==u.metallicRoughnessTexture&&(l.push(this.assignTexture(o,"metalnessMap",u.metallicRoughnessTexture)),l.push(this.assignTexture(o,"roughnessMap",u.metallicRoughnessTexture)))}!0===n.doubleSided&&(o.side=THREE.DoubleSide);var p=n.alphaMode||A;return p===R?o.transparent=!0:(o.transparent=!1,p===O&&(o.alphaTest=void 0!==n.alphaCutoff?n.alphaCutoff:.5)),void 0!==n.normalTexture&&t!==THREE.MeshBasicMaterial&&(l.push(this.assignTexture(o,"normalMap",n.normalTexture)),o.normalScale=new THREE.Vector2(1,1),void 0!==n.normalTexture.scale&&o.normalScale.set(n.normalTexture.scale,n.normalTexture.scale)),void 0!==n.occlusionTexture&&t!==THREE.MeshBasicMaterial&&(l.push(this.assignTexture(o,"aoMap",n.occlusionTexture)),void 0!==n.occlusionTexture.strength&&(o.aoMapIntensity=n.occlusionTexture.strength)),void 0!==n.emissiveFactor&&t!==THREE.MeshBasicMaterial&&(o.emissive=(new THREE.Color).fromArray(n.emissiveFactor)),void 0!==n.emissiveTexture&&t!==THREE.MeshBasicMaterial&&l.push(this.assignTexture(o,"emissiveMap",n.emissiveTexture)),Promise.all(l).then((function(){var e;return e=t===THREE.ShaderMaterial?i[s.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(o):new t(o),void 0!==n.name&&(e.name=n.name),e.map&&(e.map.encoding=THREE.sRGBEncoding),e.emissiveMap&&(e.emissiveMap.encoding=THREE.sRGBEncoding),e.specularMap&&(e.specularMap.encoding=THREE.sRGBEncoding),L(e,n),n.extensions&&k(i,e,n),e}))},B.prototype.loadGeometries=function(e){var t=this,r=this.extensions,i=this.primitiveCache;function n(e){return r[s.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(s){return z(s,e,t)}))}for(var o,a,l=[],c=0,h=e.length;c<h;c++){var u,d=e[c],p=(a=void 0,(a=(o=d).extensions&&o.extensions[s.KHR_DRACO_MESH_COMPRESSION])?"draco:"+a.bufferView+":"+a.indices+":"+V(a.attributes):o.indices+":"+V(o.attributes)+":"+o.mode),f=i[p];if(f)l.push(f.promise);else u=d.extensions&&d.extensions[s.KHR_DRACO_MESH_COMPRESSION]?n(d):z(new THREE.BufferGeometry,d,t),i[p]={primitive:d,promise:u},l.push(u)}return Promise.all(l)},B.prototype.loadMesh=function(e){for(var t=this,s=this.json.meshes[e],r=s.primitives,i=[],n=0,o=r.length;n<o;n++){var a=void 0===r[n].material?f=f||new THREE.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:THREE.FrontSide}):this.getDependency("material",r[n].material);i.push(a)}return Promise.all(i).then((function(i){return t.loadGeometries(r).then((function(n){for(var o=[],a=0,l=n.length;a<l;a++){var c,h=n[a],u=r[a],d=i[a];if(u.mode===b||u.mode===w||u.mode===_||void 0===u.mode)!0!==(c=!0===s.isSkinnedMesh?new THREE.SkinnedMesh(h,d):new THREE.Mesh(h,d)).isSkinnedMesh||c.geometry.attributes.skinWeight.normalized||c.normalizeSkinWeights(),u.mode===w?c.drawMode=THREE.TriangleStripDrawMode:u.mode===_&&(c.drawMode=THREE.TriangleFanDrawMode);else if(u.mode===v)c=new THREE.LineSegments(h,d);else if(u.mode===y)c=new THREE.Line(h,d);else if(u.mode===g)c=new THREE.LineLoop(h,d);else{if(u.mode!==m)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+u.mode);c=new THREE.Points(h,d)}Object.keys(c.geometry.morphAttributes).length>0&&N(c,s),c.name=s.name||"mesh_"+e,n.length>1&&(c.name+="_"+a),L(c,s),t.assignFinalMaterial(c),o.push(c)}if(1===o.length)return o[0];var p=new THREE.Group;for(a=0,l=o.length;a<l;a++)p.add(o[a]);return p}))}))},B.prototype.loadCamera=function(e){var t,s=this.json.cameras[e],r=s[s.type];if(r)return"perspective"===s.type?t=new THREE.PerspectiveCamera(THREE.Math.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===s.type&&(t=new THREE.OrthographicCamera(r.xmag/-2,r.xmag/2,r.ymag/2,r.ymag/-2,r.znear,r.zfar)),void 0!==s.name&&(t.name=s.name),L(t,s),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")},B.prototype.loadSkin=function(e){var t=this.json.skins[e],s={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(s):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return s.inverseBindMatrices=e,s}))},B.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],s=[],r=[],i=[],n=[],o=[],a=0,l=t.channels.length;a<l;a++){var c=t.channels[a],h=t.samplers[c.sampler],u=c.target,d=void 0!==u.node?u.node:u.id,f=void 0!==t.parameters?t.parameters[h.input]:h.input,m=void 0!==t.parameters?t.parameters[h.output]:h.output;s.push(this.getDependency("node",d)),r.push(this.getDependency("accessor",f)),i.push(this.getDependency("accessor",m)),n.push(h),o.push(u)}return Promise.all([Promise.all(s),Promise.all(r),Promise.all(i),Promise.all(n),Promise.all(o)]).then((function(s){for(var r=s[0],i=s[1],n=s[2],o=s[3],a=s[4],l=[],c=0,h=r.length;c<h;c++){var u=r[c],d=i[c],f=n[c],m=o[c],v=a[c];if(void 0!==u){var g;switch(u.updateMatrix(),u.matrixAutoUpdate=!0,T[v.path]){case T.weights:g=THREE.NumberKeyframeTrack;break;case T.rotation:g=THREE.QuaternionKeyframeTrack;break;case T.position:case T.scale:default:g=THREE.VectorKeyframeTrack}var y=u.name?u.name:u.uuid,b=void 0!==m.interpolation?M[m.interpolation]:THREE.InterpolateLinear,w=[];T[v.path]===T.weights?u.traverse((function(e){!0===e.isMesh&&e.morphTargetInfluences&&w.push(e.name?e.name:e.uuid)})):w.push(y);var _=f.array;if(f.normalized){var E;if(_.constructor===Int8Array)E=1/127;else if(_.constructor===Uint8Array)E=1/255;else if(_.constructor==Int16Array)E=1/32767;else{if(_.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");E=1/65535}for(var x=new Float32Array(_.length),P=0,S=_.length;P<S;P++)x[P]=_[P]*E;_=x}for(P=0,S=w.length;P<S;P++){var C=new g(w[P]+"."+T[v.path],d.array,_,b);"CUBICSPLINE"===m.interpolation&&(C.createInterpolant=function(e){return new p(this.times,this.values,this.getValueSize()/3,e)},C.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),l.push(C)}}}var A=void 0!==t.name?t.name:"animation_"+e;return new THREE.AnimationClip(A,void 0,l)}))},B.prototype.loadNode=function(e){var t,r=this.json,i=this.extensions,n=this,o=r.meshReferences,a=r.meshUses,l=r.nodes[e];return(t=[],void 0!==l.mesh&&t.push(n.getDependency("mesh",l.mesh).then((function(e){var t;if(o[l.mesh]>1){var s=a[l.mesh]++;(t=e.clone()).name+="_instance_"+s,t.onBeforeRender=e.onBeforeRender;for(var r=0,i=t.children.length;r<i;r++)t.children[r].name+="_instance_"+s,t.children[r].onBeforeRender=e.children[r].onBeforeRender}else t=e;return void 0!==l.weights&&t.traverse((function(e){if(e.isMesh)for(var t=0,s=l.weights.length;t<s;t++)e.morphTargetInfluences[t]=l.weights[t]})),t}))),void 0!==l.camera&&t.push(n.getDependency("camera",l.camera)),l.extensions&&l.extensions[s.KHR_LIGHTS_PUNCTUAL]&&void 0!==l.extensions[s.KHR_LIGHTS_PUNCTUAL].light&&t.push(n.getDependency("light",l.extensions[s.KHR_LIGHTS_PUNCTUAL].light)),Promise.all(t)).then((function(e){var t;if((t=!0===l.isBone?new THREE.Bone:e.length>1?new THREE.Group:1===e.length?e[0]:new THREE.Object3D)!==e[0])for(var s=0,r=e.length;s<r;s++)t.add(e[s]);if(void 0!==l.name&&(t.userData.name=l.name,t.name=THREE.PropertyBinding.sanitizeNodeName(l.name)),L(t,l),l.extensions&&k(i,t,l),void 0!==l.matrix){var n=new THREE.Matrix4;n.fromArray(l.matrix),t.applyMatrix(n)}else void 0!==l.translation&&t.position.fromArray(l.translation),void 0!==l.rotation&&t.quaternion.fromArray(l.rotation),void 0!==l.scale&&t.scale.fromArray(l.scale);return t}))},B.prototype.loadScene=function(){function e(t,s,r,i){var n=r.nodes[t];return i.getDependency("node",t).then((function(e){return void 0===n.skin?e:i.getDependency("skin",n.skin).then((function(e){for(var s=[],r=0,n=(t=e).joints.length;r<n;r++)s.push(i.getDependency("node",t.joints[r]));return Promise.all(s)})).then((function(s){return e.traverse((function(e){if(e.isMesh){for(var r=[],i=[],n=0,o=s.length;n<o;n++){var a=s[n];if(a){r.push(a);var l=new THREE.Matrix4;void 0!==t.inverseBindMatrices&&l.fromArray(t.inverseBindMatrices.array,16*n),i.push(l)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[n])}e.bind(new THREE.Skeleton(r,i),e.matrixWorld)}})),e}));var t})).then((function(t){s.add(t);var o=[];if(n.children)for(var a=n.children,l=0,c=a.length;l<c;l++){var h=a[l];o.push(e(h,t,r,i))}return Promise.all(o)}))}return function(t){var s=this.json,r=this.extensions,i=this.json.scenes[t],n=new THREE.Scene;void 0!==i.name&&(n.name=i.name),L(n,i),i.extensions&&k(r,n,i);for(var o=i.nodes||[],a=[],l=0,c=o.length;l<c;l++)a.push(e(o[l],n,s,this));return Promise.all(a).then((function(){return n}))}}(),e}()},function(e,t){THREE.DRACOLoader=function(e){this.manager=e||THREE.DefaultLoadingManager,this.path="",this.crossOrigin="anonymous",this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}},THREE.DRACOLoader.prototype={constructor:THREE.DRACOLoader,setPath:function(e){return this.path=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},setDecoderPath:function(e){return this.decoderPath=e,this},setDecoderConfig:function(e){return this.decoderConfig=e,this},setWorkerLimit:function(e){return this.workerLimit=e,this},setVerbosity:function(){console.warn("THREE.DRACOLoader: The .setVerbosity() method has been removed.")},setDrawMode:function(){console.warn("THREE.DRACOLoader: The .setDrawMode() method has been removed.")},setSkipDequantization:function(){console.warn("THREE.DRACOLoader: The .setSkipDequantization() method has been removed.")},load:function(e,t,s,r){var i=new THREE.FileLoader(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),"use-credentials"===this.crossOrigin&&i.setWithCredentials(!0),i.load(e,e=>{var s={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes};this.decodeGeometry(e,s).then(t).catch(r)},s,r)},decodeDracoFile:function(e,t,s,r){var i={attributeIDs:s||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes};this.decodeGeometry(e,i).then(t)},decodeGeometry:function(e,t){var s,r=this.workerNextTaskID++,i=e.byteLength;for(var n in t.attributeTypes){var o=t.attributeTypes[n];void 0!==o.BYTES_PER_ELEMENT&&(t.attributeTypes[n]=o.name)}var a=this._getWorker(r,i).then(i=>(s=i,new Promise((i,n)=>{s._callbacks[r]={resolve:i,reject:n},s.postMessage({type:"decode",id:r,taskConfig:t,buffer:e},[e])}))).then(e=>this._createGeometry(e.geometry));return a.finally(()=>{s&&r&&this._releaseTask(s,r)}),a},_createGeometry:function(e){var t=new THREE.BufferGeometry;e.index&&t.setIndex(new THREE.BufferAttribute(e.index.array,1));for(var s=0;s<e.attributes.length;s++){var r=e.attributes[s],i=r.name,n=r.array,o=r.itemSize;t.addAttribute(i,new THREE.BufferAttribute(n,o))}return t},_loadLibrary:function(e,t){var s=new THREE.FileLoader(this.manager);return s.setPath(this.decoderPath),s.setResponseType(t),new Promise((t,r)=>{s.load(e,t,void 0,r)})},_initDecoder:function(){if(this.decoderPending)return this.decoderPending;var e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(t=>{var s=t[0];e||(this.decoderConfig.wasmBinary=t[1]);var r=THREE.DRACOLoader.DRACOWorker.toString(),i=["/* draco decoder */",s,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([i]))}),this.decoderPending},_getWorker:function(e,t){return this._initDecoder().then(()=>{var s;this.workerPool.length<this.workerLimit?((s=new Worker(this.workerSourceURL))._callbacks={},s._taskCosts={},s._taskLoad=0,s.postMessage({type:"init",decoderConfig:this.decoderConfig}),s.onmessage=function(e){var t=e.data;switch(t.type){case"decode":s._callbacks[t.id].resolve(t);break;case"error":s._callbacks[t.id].reject(t);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+t.type+'"')}},this.workerPool.push(s)):this.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));return(s=this.workerPool[this.workerPool.length-1])._taskCosts[e]=t,s._taskLoad+=t,s})},_releaseTask:function(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]},debug:function(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))},dispose:function(){for(var e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}},THREE.DRACOLoader.DRACOWorker=function(){var e,t;function s(e,t,s,r,i,n){var o,a,l=n.num_components(),c=s.num_points()*l;switch(i){case Float32Array:o=new e.DracoFloat32Array,t.GetAttributeFloatForAllPoints(s,n,o),a=new Float32Array(c);break;case Int8Array:o=new e.DracoInt8Array,t.GetAttributeInt8ForAllPoints(s,n,o),a=new Int8Array(c);break;case Int16Array:o=new e.DracoInt16Array,t.GetAttributeInt16ForAllPoints(s,n,o),a=new Int16Array(c);break;case Int32Array:o=new e.DracoInt32Array,t.GetAttributeInt32ForAllPoints(s,n,o),a=new Int32Array(c);break;case Uint8Array:o=new e.DracoUInt8Array,t.GetAttributeUInt8ForAllPoints(s,n,o),a=new Uint8Array(c);break;case Uint16Array:o=new e.DracoUInt16Array,t.GetAttributeUInt16ForAllPoints(s,n,o),a=new Uint16Array(c);break;case Uint32Array:o=new e.DracoUInt32Array,t.GetAttributeUInt32ForAllPoints(s,n,o),a=new Uint32Array(c);break;default:throw new Error("THREE.DRACOLoader: Unexpected attribute type.")}for(var h=0;h<c;h++)a[h]=o.GetValue(h);return e.destroy(o),{name:r,array:a,itemSize:l}}onmessage=function(r){var i=r.data;switch(i.type){case"init":e=i.decoderConfig,t=new Promise((function(t,s){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":var n=i.buffer,o=i.taskConfig;t.then(e=>{var t=e.draco,r=new t.Decoder,a=new t.DecoderBuffer;a.Init(new Int8Array(n),n.byteLength);try{var l=function(e,t,r,i){var n,o,a=i.attributeIDs,l=i.attributeTypes,c=t.GetEncodedGeometryType(r);if(c===e.TRIANGULAR_MESH)n=new e.Mesh,o=t.DecodeBufferToMesh(r,n);else{if(c!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");n=new e.PointCloud,o=t.DecodeBufferToPointCloud(r,n)}if(!o.ok()||0===n.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+o.error_msg());var h={index:null,attributes:[]};n.num_points(),n.num_attributes();for(var u in a){var d=self[l[u]],p=a[u],f=t.GetAttributeByUniqueId(n,p);h.attributes.push(s(e,t,n,u,d,f))}if(c===e.TRIANGULAR_MESH){for(var m=n.num_faces(),v=new Uint32Array(3*m),g=new e.DracoInt32Array,y=0;y<m;++y){t.GetFaceFromMesh(n,y,g);for(var b=0;b<3;++b)v[3*y+b]=g.GetValue(b)}h.index={array:v,itemSize:1},e.destroy(g)}return e.destroy(n),h}(t,r,a,o),c=l.attributes.map(e=>e.array.buffer);l.index&&c.push(l.index.array.buffer),self.postMessage({type:"decode",id:i.id,geometry:l},c)}catch(e){console.error(e),self.postMessage({type:"error",id:i.id,error:e.message})}finally{t.destroy(a),t.destroy(r)}})}}},THREE.DRACOLoader.setDecoderPath=function(){console.warn("THREE.DRACOLoader: The .setDecoderPath() method has been removed. Use instance methods.")},THREE.DRACOLoader.setDecoderConfig=function(){console.warn("THREE.DRACOLoader: The .setDecoderConfig() method has been removed. Use instance methods.")},THREE.DRACOLoader.releaseDecoderModule=function(){console.warn("THREE.DRACOLoader: The .releaseDecoderModule() method has been removed. Use instance methods.")},THREE.DRACOLoader.getDecoderModule=function(){console.warn("THREE.DRACOLoader: The .getDecoderModule() method has been removed. Use instance methods.")}},function(e,t,s){"use strict";s.r(t),t.default="//#define PHYSICAL\n//#define STANDARD\n\n#ifdef PHYSICAL\n    #define REFLECTIVITY\n    #define CLEARCOAT\n    #define TRANSPARENCY\n#endif\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\n#ifdef TRANSPARENCY\n    uniform float transparency;\n#endif\n\n#ifdef REFLECTIVITY\n    uniform float reflectivity;\n#endif\n\n#ifdef CLEARCOAT\n    uniform float clearcoat;\n    uniform float clearcoatRoughness;\n#endif\n\n#ifdef USE_SHEEN\n    uniform vec3 sheen;\n#endif\n\n//#ifndef STANDARD\n//\tuniform float clearCoat;\n//\tuniform float clearCoatRoughness;\n//#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\n    #ifdef USE_TANGENT\n        varying vec3 vTangent;\n        varying vec3 vBitangent;\n    #endif\n#endif\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n\n//#include <uv_pars_fragment>\n//#include <uv2_pars_fragment>\n// REPLACED WITH\n#if defined(USE_MAP) || defined(USE_BUMPMAP) || defined(USE_NORMALMAP) || defined(USE_SPECULARMAP) || defined(USE_ALPHAMAP) || defined(USE_EMISSIVEMAP) || defined(USE_ROUGHNESSMAP) || defined(USE_METALNESSMAP) || defined(USE_LIGHTMAP) || defined(USE_AOMAP)\n\tvarying vec2 vUv;\n#endif\n\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\n#ifdef USE_AOMAP\n    uniform vec3 aoMapMix;\n#endif\n\n#ifdef MODE_XRAY\n    varying float vIntensity;\n#endif\n\n#ifdef CUT_PLANE\n    varying vec3 vWorldPosition;\n    uniform vec4 cutPlaneDirection;\n    uniform vec3 cutPlaneColor;\n#endif\n\nvoid main() {\n    #ifdef CUT_PLANE\n        if (dot(vWorldPosition, cutPlaneDirection.xyz) < -cutPlaneDirection.w) {\n            discard;\n        }\n    #endif\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n    #include <normal_fragment_maps>\n\n\t#ifdef CUT_PLANE\n\t    // on the cut surface (back facing fragments revealed), replace normal with cut plane direction\n        if (!gl_FrontFacing) {\n            normal = -cutPlaneDirection.xyz;\n            diffuseColor.rgb = cutPlaneColor.rgb;\n        }\n\t#endif\n\n    #include <clearcoat_normal_fragment_begin>\n    #include <clearcoat_normal_fragment_maps>\n    #include <emissivemap_fragment>\n\n\t// accumulation\n    #if defined(USE_LIGHTMAP) || defined(USE_AOMAP)\n        vec2 vUv2 = vUv;\n    #endif\n\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t//#include <aomap_fragment>\n\t// REPLACED WITH\n\t#ifdef USE_AOMAP\n\t    // if cut plane is enabled, disable ambient occlusion on back facing fragments\n\t    #ifdef CUT_PLANE\n            if (gl_FrontFacing) {\n\t    #endif\n\n    \t// reads channel R, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\n    \tvec3 aoSample = texture2D(aoMap, vUv).rgb;\n    \tvec3 aoFactors = mix(vec3(1.0), aoSample, clamp(aoMapMix * aoMapIntensity, 0.0, 1.0));\n    \tfloat ambientOcclusion = aoFactors.x * aoFactors.y * aoFactors.z;\n    \tfloat ambientOcclusion2 = ambientOcclusion * ambientOcclusion;\n    \treflectedLight.directDiffuse *= ambientOcclusion2;\n    \treflectedLight.directSpecular *= ambientOcclusion;\n    \t//reflectedLight.indirectDiffuse *= ambientOcclusion;\n\n    \t#if defined(USE_ENVMAP) && defined(PHYSICAL)\n    \t\tfloat dotNV = saturate(dot(geometry.normal, geometry.viewDir));\n    \t\treflectedLight.indirectSpecular *= computeSpecularOcclusion(dotNV, ambientOcclusion, material.specularRoughness);\n    \t#endif\n\n    \t#ifdef CUT_PLANE\n    \t    }\n    \t#endif\n    #endif\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n    // this is a stub for the transparency model\n    #ifdef TRANSPARENCY\n        diffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n    #endif\n\n\tgl_FragColor = vec4(outgoingLight, diffuseColor.a);\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n    #ifdef MODE_NORMALS\n        gl_FragColor = vec4(vec3(normal * 0.5 + 0.5), 1.0);\n    #endif\n\n    #ifdef MODE_XRAY\n        gl_FragColor = vec4(vec3(0.4, 0.7, 1.0) * vIntensity, 1.0);\n    #endif\n}\n"},function(e,t,s){"use strict";s.r(t),t.default="//#define PHYSICAL\n//#define STANDARD\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n\n#include <common>\n\n//#include <uv_pars_vertex>\n//#include <uv2_pars_vertex>\n// REPLACED WITH\n#if defined(USE_MAP) || defined(USE_BUMPMAP) || defined(USE_NORMALMAP) || defined(USE_SPECULARMAP) || defined(USE_ALPHAMAP) || defined(USE_EMISSIVEMAP) || defined(USE_ROUGHNESSMAP) || defined(USE_METALNESSMAP) || defined(USE_LIGHTMAP) || defined(USE_AOMAP)\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\n#ifdef MODE_XRAY\n    varying float vIntensity;\n#endif\n\n#ifdef CUT_PLANE\n    varying vec3 vWorldPosition;\n#endif\n\nvoid main() {\n\n//\t#include <uv_vertex>\n//\t#include <uv2_vertex>\n//  REPLACED WITH\n#if defined(USE_MAP) || defined(USE_BUMPMAP) || defined(USE_NORMALMAP) || defined(USE_SPECULARMAP) || defined(USE_ALPHAMAP) || defined(USE_EMISSIVEMAP) || defined(USE_ROUGHNESSMAP) || defined(USE_METALNESSMAP) || defined(USE_LIGHTMAP) || defined(USE_AOMAP)\n\tvUv = (uvTransform * vec3(uv, 1)).xy;\n#endif\n\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\tvNormal = normalize(transformedNormal);\n\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\n#ifdef MODE_XRAY\n    vIntensity = pow(abs(1.0 - abs(dot(vNormal, vec3(0.0, 0.0, 1.0)))), 3.0);\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = -mvPosition.xyz;\n\n\t// #include <worldpos_vertex>\n\t// REPLACED WITH\n\t#if defined(USE_ENVMAP) || defined(DISTANCE) || defined(USE_SHADOWMAP) || defined(CUT_PLANE)\n    \tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n    #endif\n\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n#ifdef CUT_PLANE\n    vWorldPosition = worldPosition.xyz / worldPosition.w;\n#endif\n\n#ifdef MODE_NORMALS\n    vNormal = normal;\n#endif\n}\n"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1);s(155);const i=r.OBJLoader;s(156);const n=r.PLYLoader;class o{constructor(e){this.objLoader=new i(e),this.plyLoader=new n(e)}isValid(e){const t=e.split(".").pop().toLowerCase();return o.extensions.indexOf(t)>=0}get(e){const t=e.split(".").pop().toLowerCase();return new Promise((s,r)=>{if("obj"===t)this.objLoader.load(e,t=>{const i=t.children[0].geometry;return i&&"Geometry"===i.type||"BufferGeometry"===i.type?s(i):r(new Error(`Can't parse geometry from '${e}'`))});else{if("ply"!==t)throw new Error(`Can't load geometry, unknown extension: '${t}' in '${e}'`);this.plyLoader.load(e,t=>t&&"Geometry"===t.type||"BufferGeometry"===t.type?s(t):r(new Error(`Can't parse geometry from '${e}'`)))}})}}t.default=o,o.extensions=["obj","ply"]},function(e,t){THREE.OBJLoader=function(){var e=/^[og]\s*(.+)?/,t=/^mtllib /,s=/^usemtl /;function r(){var e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);var s=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(e,t){var s=this._finalize(!1);s&&(s.inherited||s.groupCount<=0)&&this.materials.splice(s.index,1);var r={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&t.length>0?t[t.length-1]:"",smooth:void 0!==s?s.smooth:this.smooth,groupStart:void 0!==s?s.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){var t={index:"number"==typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return t.clone=this.clone.bind(t),t}};return this.materials.push(r),r},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){var t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&this.materials.length>1)for(var s=this.materials.length-1;s>=0;s--)this.materials[s].groupCount<=0&&this.materials.splice(s,1);return e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},s&&s.name&&"function"==typeof s.clone){var r=s.clone(0);r.inherited=!0,this.object.materials.push(r)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){var s=parseInt(e,10);return 3*(s>=0?s-1:s+t/3)},parseNormalIndex:function(e,t){var s=parseInt(e,10);return 3*(s>=0?s-1:s+t/3)},parseUVIndex:function(e,t){var s=parseInt(e,10);return 2*(s>=0?s-1:s+t/2)},addVertex:function(e,t,s){var r=this.vertices,i=this.object.geometry.vertices;i.push(r[e+0],r[e+1],r[e+2]),i.push(r[t+0],r[t+1],r[t+2]),i.push(r[s+0],r[s+1],r[s+2])},addVertexPoint:function(e){var t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){var t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,s){var r=this.normals,i=this.object.geometry.normals;i.push(r[e+0],r[e+1],r[e+2]),i.push(r[t+0],r[t+1],r[t+2]),i.push(r[s+0],r[s+1],r[s+2])},addColor:function(e,t,s){var r=this.colors,i=this.object.geometry.colors;i.push(r[e+0],r[e+1],r[e+2]),i.push(r[t+0],r[t+1],r[t+2]),i.push(r[s+0],r[s+1],r[s+2])},addUV:function(e,t,s){var r=this.uvs,i=this.object.geometry.uvs;i.push(r[e+0],r[e+1]),i.push(r[t+0],r[t+1]),i.push(r[s+0],r[s+1])},addUVLine:function(e){var t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,s,r,i,n,o,a,l){var c=this.vertices.length,h=this.parseVertexIndex(e,c),u=this.parseVertexIndex(t,c),d=this.parseVertexIndex(s,c);if(this.addVertex(h,u,d),void 0!==r&&""!==r){var p=this.uvs.length;h=this.parseUVIndex(r,p),u=this.parseUVIndex(i,p),d=this.parseUVIndex(n,p),this.addUV(h,u,d)}if(void 0!==o&&""!==o){var f=this.normals.length;h=this.parseNormalIndex(o,f),u=o===a?h:this.parseNormalIndex(a,f),d=o===l?h:this.parseNormalIndex(l,f),this.addNormal(h,u,d)}this.colors.length>0&&this.addColor(h,u,d)},addPointGeometry:function(e){this.object.geometry.type="Points";for(var t=this.vertices.length,s=0,r=e.length;s<r;s++)this.addVertexPoint(this.parseVertexIndex(e[s],t))},addLineGeometry:function(e,t){this.object.geometry.type="Line";for(var s=this.vertices.length,r=this.uvs.length,i=0,n=e.length;i<n;i++)this.addVertexLine(this.parseVertexIndex(e[i],s));var o=0;for(n=t.length;o<n;o++)this.addUVLine(this.parseUVIndex(t[o],r))}};return e.startObject("",!1),e}function i(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.materials=null}return i.prototype={constructor:i,load:function(e,t,s,r){var i=this,n=new THREE.FileLoader(i.manager);n.setPath(this.path),n.load(e,(function(e){t(i.parse(e))}),s,r)},setPath:function(e){return this.path=e,this},setMaterials:function(e){return this.materials=e,this},parse:function(i){console.time("OBJLoader");var n=new r;-1!==i.indexOf("\r\n")&&(i=i.replace(/\r\n/g,"\n")),-1!==i.indexOf("\\\n")&&(i=i.replace(/\\\n/g,""));for(var o=i.split("\n"),a="",l="",c=[],h="function"==typeof"".trimLeft,u=0,d=o.length;u<d;u++)if(a=o[u],0!==(a=h?a.trimLeft():a.trim()).length&&"#"!==(l=a.charAt(0)))if("v"===l){var p=a.split(/\s+/);switch(p[0]){case"v":n.vertices.push(parseFloat(p[1]),parseFloat(p[2]),parseFloat(p[3])),p.length>=7&&n.colors.push(parseFloat(p[4]),parseFloat(p[5]),parseFloat(p[6]));break;case"vn":n.normals.push(parseFloat(p[1]),parseFloat(p[2]),parseFloat(p[3]));break;case"vt":n.uvs.push(parseFloat(p[1]),parseFloat(p[2]))}}else if("f"===l){for(var f=a.substr(1).trim().split(/\s+/),m=[],v=0,g=f.length;v<g;v++){var y=f[v];if(y.length>0){var b=y.split("/");m.push(b)}}var w=m[0];for(v=1,g=m.length-1;v<g;v++){var _=m[v],E=m[v+1];n.addFace(w[0],_[0],E[0],w[1],_[1],E[1],w[2],_[2],E[2])}}else if("l"===l){var x=a.substring(1).trim().split(" "),P=[],S=[];if(-1===a.indexOf("/"))P=x;else for(var C=0,T=x.length;C<T;C++){var M=x[C].split("/");""!==M[0]&&P.push(M[0]),""!==M[1]&&S.push(M[1])}n.addLineGeometry(P,S)}else if("p"===l){var A=a.substr(1).trim().split(" ");n.addPointGeometry(A)}else if(null!==(c=e.exec(a))){var O=(" "+c[0].substr(1).trim()).substr(1);n.startObject(O)}else if(s.test(a))n.object.startMaterial(a.substring(7).trim(),n.materialLibraries);else if(t.test(a))n.materialLibraries.push(a.substring(7).trim());else{if("s"!==l){if("\0"===a)continue;throw new Error('THREE.OBJLoader: Unexpected line: "'+a+'"')}if((c=a.split(" ")).length>1){var R=c[1].trim().toLowerCase();n.object.smooth="0"!==R&&"off"!==R}else n.object.smooth=!0;(G=n.object.currentMaterial())&&(G.smooth=n.object.smooth)}n.finalize();var D=new THREE.Group;D.materialLibraries=[].concat(n.materialLibraries);for(u=0,d=n.objects.length;u<d;u++){var j=n.objects[u],k=j.geometry,L=j.materials,N="Line"===k.type,V="Points"===k.type,I=!1;if(0!==k.vertices.length){var B=new THREE.BufferGeometry;B.addAttribute("position",new THREE.Float32BufferAttribute(k.vertices,3)),k.normals.length>0?B.addAttribute("normal",new THREE.Float32BufferAttribute(k.normals,3)):B.computeVertexNormals(),k.colors.length>0&&(I=!0,B.addAttribute("color",new THREE.Float32BufferAttribute(k.colors,3))),k.uvs.length>0&&B.addAttribute("uv",new THREE.Float32BufferAttribute(k.uvs,2));for(var z,F=[],$=0,U=L.length;$<U;$++){var H=L[$],G=void 0;if(null!==this.materials)if(G=this.materials.create(H.name),!N||!G||G instanceof THREE.LineBasicMaterial){if(V&&G&&!(G instanceof THREE.PointsMaterial)){var q=new THREE.PointsMaterial({size:10,sizeAttenuation:!1});THREE.Material.prototype.copy.call(q,G),q.color.copy(G.color),q.map=G.map,q.lights=!1,G=q}}else{var Q=new THREE.LineBasicMaterial;THREE.Material.prototype.copy.call(Q,G),Q.color.copy(G.color),Q.lights=!1,G=Q}G||((G=N?new THREE.LineBasicMaterial:V?new THREE.PointsMaterial({size:1,sizeAttenuation:!1}):new THREE.MeshPhongMaterial).name=H.name),G.flatShading=!H.smooth,G.vertexColors=I?THREE.VertexColors:THREE.NoColors,F.push(G)}if(F.length>1){for($=0,U=L.length;$<U;$++){H=L[$];B.addGroup(H.groupStart,H.groupCount,$)}z=N?new THREE.LineSegments(B,F):V?new THREE.Points(B,F):new THREE.Mesh(B,F)}else z=N?new THREE.LineSegments(B,F[0]):V?new THREE.Points(B,F[0]):new THREE.Mesh(B,F[0]);z.name=j.name,D.add(z)}}return console.timeEnd("OBJLoader"),D}},i}()},function(e,t){THREE.PLYLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.propertyNameMapping={}},THREE.PLYLoader.prototype={constructor:THREE.PLYLoader,load:function(e,t,s,r){var i=this,n=new THREE.FileLoader(this.manager);n.setPath(this.path),n.setResponseType("arraybuffer"),n.load(e,(function(e){t(i.parse(e))}),s,r)},setPath:function(e){return this.path=e,this},setPropertyNameMapping:function(e){this.propertyNameMapping=e},parse:function(e){function t(e){var t="",s=0,r=/ply([\s\S]*)end_header\r?\n/.exec(e);null!==r&&(t=r[1],s=r[0].length);var i,n,o,a,l,c,u={comments:[],elements:[],headerLength:s},d=t.split("\n");for(var p=0;p<d.length;p++){var f=d[p];if(""!==(f=f.trim()))switch(n=(o=f.split(/\s+/)).shift(),f=o.join(" "),n){case"format":u.format=o[0],u.version=o[1];break;case"comment":u.comments.push(f);break;case"element":void 0!==i&&u.elements.push(i),(i={}).name=o[0],i.count=parseInt(o[1]),i.properties=[];break;case"property":i.properties.push((a=o,l=h.propertyNameMapping,c=void 0,"list"===(c={type:a[0]}).type?(c.name=a[3],c.countType=a[1],c.itemType=a[2]):c.name=a[1],c.name in l&&(c.name=l[c.name]),c));break;default:console.log("unhandled",n,o)}}return void 0!==i&&u.elements.push(i),u}function s(e,t){switch(t){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(e);case"float":case"double":case"float32":case"float64":return parseFloat(e)}}function r(e,t){for(var r=t.split(/\s+/),i={},n=0;n<e.length;n++)if("list"===e[n].type){for(var o=[],a=s(r.shift(),e[n].countType),l=0;l<a;l++)o.push(s(r.shift(),e[n].itemType));i[e[n].name]=o}else i[e[n].name]=s(r.shift(),e[n].type);return i}function i(e,t){var s,i={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},a="";null!==(s=/end_header\s([\s\S]*)$/.exec(e))&&(a=s[1]);for(var l=a.split("\n"),c=0,h=0,u=0;u<l.length;u++){var d=l[u];if(""!==(d=d.trim())){h>=t.elements[c].count&&(c++,h=0);var p=r(t.elements[c].properties,d);o(i,t.elements[c].name,p),h++}}return n(i)}function n(e){var t=new THREE.BufferGeometry;return e.indices.length>0&&t.setIndex(e.indices),t.addAttribute("position",new THREE.Float32BufferAttribute(e.vertices,3)),e.normals.length>0&&t.addAttribute("normal",new THREE.Float32BufferAttribute(e.normals,3)),e.uvs.length>0&&t.addAttribute("uv",new THREE.Float32BufferAttribute(e.uvs,2)),e.colors.length>0&&t.addAttribute("color",new THREE.Float32BufferAttribute(e.colors,3)),e.faceVertexUvs.length>0&&(t=t.toNonIndexed()).addAttribute("uv",new THREE.Float32BufferAttribute(e.faceVertexUvs,2)),t.computeBoundingSphere(),t}function o(e,t,s){if("vertex"===t)e.vertices.push(s.x,s.y,s.z),"nx"in s&&"ny"in s&&"nz"in s&&e.normals.push(s.nx,s.ny,s.nz),"s"in s&&"t"in s&&e.uvs.push(s.s,s.t),"red"in s&&"green"in s&&"blue"in s&&e.colors.push(s.red/255,s.green/255,s.blue/255);else if("face"===t){var r=s.vertex_indices||s.vertex_index,i=s.texcoord;3===r.length?(e.indices.push(r[0],r[1],r[2]),i&&6===i.length&&(e.faceVertexUvs.push(i[0],i[1]),e.faceVertexUvs.push(i[2],i[3]),e.faceVertexUvs.push(i[4],i[5]))):4===r.length&&(e.indices.push(r[0],r[1],r[3]),e.indices.push(r[1],r[2],r[3]))}}function a(e,t,s,r){switch(s){case"int8":case"char":return[e.getInt8(t),1];case"uint8":case"uchar":return[e.getUint8(t),1];case"int16":case"short":return[e.getInt16(t,r),2];case"uint16":case"ushort":return[e.getUint16(t,r),2];case"int32":case"int":return[e.getInt32(t,r),4];case"uint32":case"uint":return[e.getUint32(t,r),4];case"float32":case"float":return[e.getFloat32(t,r),4];case"float64":case"double":return[e.getFloat64(t,r),8]}}function l(e,t,s,r){for(var i,n={},o=0,l=0;l<s.length;l++)if("list"===s[l].type){var c=[],h=(i=a(e,t+o,s[l].countType,r))[0];o+=i[1];for(var u=0;u<h;u++)i=a(e,t+o,s[l].itemType,r),c.push(i[0]),o+=i[1];n[s[l].name]=c}else i=a(e,t+o,s[l].type,r),n[s[l].name]=i[0],o+=i[1];return[n,o]}var c,h=this;if(e instanceof ArrayBuffer){var u=THREE.LoaderUtils.decodeText(new Uint8Array(e)),d=t(u);c="ascii"===d.format?i(u,d):function(e,t){for(var s,r={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},i="binary_little_endian"===t.format,a=new DataView(e,t.headerLength),c=0,h=0;h<t.elements.length;h++)for(var u=0;u<t.elements[h].count;u++){c+=(s=l(a,c,t.elements[h].properties,i))[1];var d=s[0];o(r,t.elements[h].name,d)}return n(r)}(e,d)}else c=i(e,t(e));return c}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1);class i{constructor(e){this.textureLoader=new r.TextureLoader(e)}isValid(e){const t=e.split(".").pop().toLowerCase();return i.extensions.indexOf(t)>=0}isValidMimeType(e){return i.mimeTypes.indexOf(e)>=0}get(e){return new Promise((t,s)=>{this.textureLoader.load(e,e=>{t(e)},null,e=>{console.error(e),s(new Error(e.message))})})}getImmediate(e){return this.textureLoader.load(e,null,null,e=>{console.error(e)})}}t.default=i,i.extensions=["jpg","png"],i.mimeTypes=["image/jpeg","image/png"]},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=function(e,t){const s=document.createElement("a");s.download=t,s.href=e,document.body.appendChild(s),s.click(),document.body.removeChild(s)};t.default={text:function(e,t){const s=window.URL.createObjectURL(new Blob([e],{type:"text/plain"}));r(s,t)},json:function(e,t){"object"==typeof e&&(e=JSON.stringify(e));const s=window.URL.createObjectURL(new Blob([e],{type:"text/json"}));r(s,t)},url:function(e,t){r(e,t)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(41);t.Node=i.Node,t.types=i.types;const n=s(21),o=s(31);class a extends i.default{constructor(e,t){super(e,t),this.ins=this.addInputs(a.rgIns),this._object3D=null,this._isAttached=!1,this._object3D=new r.Object3D,this._object3D.matrixAutoUpdate=!1}get transform(){return this.node.components.get(n.default,!0)}get scene(){const e=this.transform;return e?e.getParentComponent(o.default,!0):void 0}get object3D(){return this._object3D}create(){super.create(),this.innerRoots.filter(e=>e.is(n.default)).forEach(e=>this._object3D.add(e.object3D)),this.trackComponent(n.default,e=>this.ins.visible.value&&this.attachObject3D(e),e=>this.detachObject3D(e))}dispose(){this.detachObject3D(this.transform),this.innerRoots.filter(e=>e.is(n.default)).forEach(e=>this._object3D.remove(e.object3D)),super.dispose()}update(e){super.update(e);const t=this.ins;if(t.visible.changed){const e=this.transform;t.visible.value?this.attachObject3D(e):this.detachObject3D(e)}return!0}onAddInnerRoot(e){e.is(n.default)&&this._object3D.add(e.object3D)}onRemoveInnerRoot(e){e.is(n.default)&&this._object3D.remove(e.object3D)}attachObject3D(e){this._isAttached||e&&(e.object3D.add(this._object3D),this._isAttached=!0)}detachObject3D(e){this._isAttached&&e&&(e.object3D.remove(this._object3D),this._isAttached=!1)}}t.default=a,a.typeName="CRenderGraph",a.rgIns={visible:i.types.Boolean("Graph.Visible",!0)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(161),i=s(195),n=s(196),o=s(197),a=s(198),l=s(199);t.default=class{constructor(){this._schemaValidator=new r({schemas:[i,n,o,a,l],allErrors:!0}),this._validateDocument=this._schemaValidator.getSchema("https://schemas.3d.si.edu/voyager/document.schema.json")}validate(e){return!!this._validateDocument(e)||(console.warn(this._schemaValidator.errorsText(this._validateDocument.errors,{separator:", ",dataVar:"document"})),!1)}}},function(e,t,s){"use strict";var r=s(162),i=s(57),n=s(166),o=s(84),a=s(85),l=s(167),c=s(168),h=s(189),u=s(27);e.exports=g,g.prototype.validate=function(e,t){var s;if("string"==typeof e){if(!(s=this.getSchema(e)))throw new Error('no schema with key or ref "'+e+'"')}else{var r=this._addSchema(e);s=r.validate||this._compile(r)}var i=s(t);!0!==s.$async&&(this.errors=s.errors);return i},g.prototype.compile=function(e,t){var s=this._addSchema(e,void 0,t);return s.validate||this._compile(s)},g.prototype.addSchema=function(e,t,s,r){if(Array.isArray(e)){for(var n=0;n<e.length;n++)this.addSchema(e[n],void 0,s,r);return this}var o=this._getId(e);if(void 0!==o&&"string"!=typeof o)throw new Error("schema id must be string");return x(this,t=i.normalizeId(t||o)),this._schemas[t]=this._addSchema(e,s,r,!0),this},g.prototype.addMetaSchema=function(e,t,s){return this.addSchema(e,t,s,!0),this},g.prototype.validateSchema=function(e,t){var s=e.$schema;if(void 0!==s&&"string"!=typeof s)throw new Error("$schema must be a string");if(!(s=s||this._opts.defaultMeta||function(e){var t=e._opts.meta;return e._opts.defaultMeta="object"==typeof t?e._getId(t)||t:e.getSchema(f)?f:void 0,e._opts.defaultMeta}(this)))return this.logger.warn("meta-schema not available"),this.errors=null,!0;var r=this.validate(s,e);if(!r&&t){var i="schema is invalid: "+this.errorsText();if("log"!=this._opts.validateSchema)throw new Error(i);this.logger.error(i)}return r},g.prototype.getSchema=function(e){var t=y(this,e);switch(typeof t){case"object":return t.validate||this._compile(t);case"string":return this.getSchema(t);case"undefined":return function(e,t){var s=i.schema.call(e,{schema:{}},t);if(s){var n=s.schema,a=s.root,l=s.baseId,c=r.call(e,n,a,void 0,l);return e._fragments[t]=new o({ref:t,fragment:!0,schema:n,root:a,baseId:l,validate:c}),c}}(this,e)}},g.prototype.removeSchema=function(e){if(e instanceof RegExp)return b(this,this._schemas,e),b(this,this._refs,e),this;switch(typeof e){case"undefined":return b(this,this._schemas),b(this,this._refs),this._cache.clear(),this;case"string":var t=y(this,e);return t&&this._cache.del(t.cacheKey),delete this._schemas[e],delete this._refs[e],this;case"object":var s=this._opts.serialize,r=s?s(e):e;this._cache.del(r);var n=this._getId(e);n&&(n=i.normalizeId(n),delete this._schemas[n],delete this._refs[n])}return this},g.prototype.addFormat=function(e,t){"string"==typeof t&&(t=new RegExp(t));return this._formats[e]=t,this},g.prototype.errorsText=function(e,t){if(!(e=e||this.errors))return"No errors";for(var s=void 0===(t=t||{}).separator?", ":t.separator,r=void 0===t.dataVar?"data":t.dataVar,i="",n=0;n<e.length;n++){var o=e[n];o&&(i+=r+o.dataPath+" "+o.message+s)}return i.slice(0,-s.length)},g.prototype._addSchema=function(e,t,s,r){if("object"!=typeof e&&"boolean"!=typeof e)throw new Error("schema should be object or boolean");var n=this._opts.serialize,a=n?n(e):e,l=this._cache.get(a);if(l)return l;r=r||!1!==this._opts.addUsedSchema;var c=i.normalizeId(this._getId(e));c&&r&&x(this,c);var h,u=!1!==this._opts.validateSchema&&!t;u&&!(h=c&&c==i.normalizeId(e.$schema))&&this.validateSchema(e,!0);var d=i.ids.call(this,e),p=new o({id:c,schema:e,localRefs:d,cacheKey:a,meta:s});"#"!=c[0]&&r&&(this._refs[c]=p);this._cache.put(a,p),u&&h&&this.validateSchema(e,!0);return p},g.prototype._compile=function(e,t){if(e.compiling)return e.validate=n,n.schema=e.schema,n.errors=null,n.root=t||n,!0===e.schema.$async&&(n.$async=!0),n;var s,i;e.compiling=!0,e.meta&&(s=this._opts,this._opts=this._metaOpts);try{i=r.call(this,e.schema,t,e.localRefs)}catch(t){throw delete e.validate,t}finally{e.compiling=!1,e.meta&&(this._opts=s)}return e.validate=i,e.refs=i.refs,e.refVal=i.refVal,e.root=i.root,i;function n(){var t=e.validate,s=t.apply(this,arguments);return n.errors=t.errors,s}},g.prototype.compileAsync=s(190);var d=s(191);g.prototype.addKeyword=d.add,g.prototype.getKeyword=d.get,g.prototype.removeKeyword=d.remove,g.prototype.validateKeyword=d.validate;var p=s(59);g.ValidationError=p.Validation,g.MissingRefError=p.MissingRef,g.$dataMetaSchema=h;var f="http://json-schema.org/draft-07/schema",m=["removeAdditional","useDefaults","coerceTypes","strictDefaults"],v=["/properties"];function g(e){if(!(this instanceof g))return new g(e);e=this._opts=u.copy(e)||{},function(e){var t=e._opts.logger;if(!1===t)e.logger={log:P,warn:P,error:P};else{if(void 0===t&&(t=console),!("object"==typeof t&&t.log&&t.warn&&t.error))throw new Error("logger must implement log, warn and error methods");e.logger=t}}(this),this._schemas={},this._refs={},this._fragments={},this._formats=l(e.format),this._cache=e.cache||new n,this._loadingSchemas={},this._compilations=[],this.RULES=c(),this._getId=function(e){switch(e.schemaId){case"auto":return E;case"id":return w;default:return _}}(e),e.loopRequired=e.loopRequired||1/0,"property"==e.errorDataPath&&(e._errorDataPathProperty=!0),void 0===e.serialize&&(e.serialize=a),this._metaOpts=function(e){for(var t=u.copy(e._opts),s=0;s<m.length;s++)delete t[m[s]];return t}(this),e.formats&&function(e){for(var t in e._opts.formats){var s=e._opts.formats[t];e.addFormat(t,s)}}(this),function(e){var t;e._opts.$data&&(t=s(194),e.addMetaSchema(t,t.$id,!0));if(!1===e._opts.meta)return;var r=s(91);e._opts.$data&&(r=h(r,v));e.addMetaSchema(r,f,!0),e._refs["http://json-schema.org/schema"]=f}(this),"object"==typeof e.meta&&this.addMetaSchema(e.meta),e.nullable&&this.addKeyword("nullable",{metaSchema:{type:"boolean"}}),function(e){var t=e._opts.schemas;if(!t)return;if(Array.isArray(t))e.addSchema(t);else for(var s in t)e.addSchema(t[s],s)}(this)}function y(e,t){return t=i.normalizeId(t),e._schemas[t]||e._refs[t]||e._fragments[t]}function b(e,t,s){for(var r in t){var i=t[r];i.meta||s&&!s.test(r)||(e._cache.del(i.cacheKey),delete t[r])}}function w(e){return e.$id&&this.logger.warn("schema $id ignored",e.$id),e.id}function _(e){return e.id&&this.logger.warn("schema id ignored",e.id),e.$id}function E(e){if(e.$id&&e.id&&e.$id!=e.id)throw new Error("schema $id is different from id");return e.$id||e.id}function x(e,t){if(e._schemas[t]||e._refs[t])throw new Error('schema with key or id "'+t+'" already exists')}function P(){}},function(e,t,s){"use strict";var r=s(57),i=s(27),n=s(59),o=s(85),a=s(86),l=i.ucs2length,c=s(58),h=n.Validation;function u(e,t,s){var r=p.call(this,e,t,s);return r>=0?{index:r,compiling:!0}:(r=this._compilations.length,this._compilations[r]={schema:e,root:t,baseId:s},{index:r,compiling:!1})}function d(e,t,s){var r=p.call(this,e,t,s);r>=0&&this._compilations.splice(r,1)}function p(e,t,s){for(var r=0;r<this._compilations.length;r++){var i=this._compilations[r];if(i.schema==e&&i.root==t&&i.baseId==s)return r}return-1}function f(e,t){return"var pattern"+e+" = new RegExp("+i.toQuotedString(t[e])+");"}function m(e){return"var default"+e+" = defaults["+e+"];"}function v(e,t){return void 0===t[e]?"":"var refVal"+e+" = refVal["+e+"];"}function g(e){return"var customRule"+e+" = customRules["+e+"];"}function y(e,t){if(!e.length)return"";for(var s="",r=0;r<e.length;r++)s+=t(r,e);return s}e.exports=function e(t,s,p,b){var w=this,_=this._opts,E=[void 0],x={},P=[],S={},C=[],T={},M=[];s=s||{schema:t,refVal:E,refs:x};var A=u.call(this,t,s,b);var O=this._compilations[A.index];if(A.compiling)return O.callValidate=function e(){var t=O.validate;var s=t.apply(this,arguments);e.errors=t.errors;return s};var R=this._formats;var D=this.RULES;try{var j=L(t,s,p,b);O.validate=j;var k=O.callValidate;return k&&(k.schema=j.schema,k.errors=null,k.refs=j.refs,k.refVal=j.refVal,k.root=j.root,k.$async=j.$async,_.sourceCode&&(k.source=j.source)),j}finally{d.call(this,t,s,b)}function L(t,o,u,d){var p=!o||o&&o.schema==t;if(o.schema!=s.schema)return e.call(w,t,o,u,d);var b,S=!0===t.$async,T=a({isTop:!0,schema:t,isRoot:p,baseId:d,root:o,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:n.MissingRef,RULES:D,validate:a,util:i,resolve:r,resolveRef:N,usePattern:B,useDefault:z,useCustomRule:F,opts:_,formats:R,logger:w.logger,self:w});T=y(E,v)+y(P,f)+y(C,m)+y(M,g)+T,_.processCode&&(T=_.processCode(T));try{b=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",T)(w,D,R,s,E,C,M,c,l,h),E[0]=b}catch(e){throw w.logger.error("Error compiling schema, function code:",T),e}return b.schema=t,b.errors=null,b.refs=x,b.refVal=E,b.root=p?b:o,S&&(b.$async=!0),!0===_.sourceCode&&(b.source={code:T,patterns:P,defaults:C}),b}function N(t,i,n){i=r.url(t,i);var o,a,l=x[i];if(void 0!==l)return I(o=E[l],a="refVal["+l+"]");if(!n&&s.refs){var c=s.refs[i];if(void 0!==c)return I(o=s.refVal[c],a=V(i,o))}a=V(i);var h=r.call(w,L,s,i);if(void 0===h){var u=p&&p[i];u&&(h=r.inlineRef(u,_.inlineRefs)?u:e.call(w,u,s,p,t))}if(void 0!==h)return function(e,t){var s=x[e];E[s]=t}(i,h),I(h,a);!function(e){delete x[e]}(i)}function V(e,t){var s=E.length;return E[s]=t,x[e]=s,"refVal"+s}function I(e,t){return"object"==typeof e||"boolean"==typeof e?{code:t,schema:e,inline:!0}:{code:t,$async:e&&!!e.$async}}function B(e){var t=S[e];return void 0===t&&(t=S[e]=P.length,P[t]=e),"pattern"+t}function z(e){switch(typeof e){case"boolean":case"number":return""+e;case"string":return i.toQuotedString(e);case"object":if(null===e)return"null";var t=o(e),s=T[t];return void 0===s&&(s=T[t]=C.length,C[s]=e),"default"+s}}function F(e,t,s,r){if(!1!==w._opts.validateSchema){var i=e.definition.dependencies;if(i&&!i.every((function(e){return Object.prototype.hasOwnProperty.call(s,e)})))throw new Error("parent schema must have all required keywords: "+i.join(","));var n=e.definition.validateSchema;if(n)if(!n(t)){var o="keyword schema is invalid: "+w.errorsText(n.errors);if("log"!=w._opts.validateSchema)throw new Error(o);w.logger.error(o)}}var a,l=e.definition.compile,c=e.definition.inline,h=e.definition.macro;if(l)a=l.call(w,t,s,r);else if(h)a=h.call(w,t,s,r),!1!==_.validateSchema&&w.validateSchema(a,!0);else if(c)a=c.call(w,r,e.keyword,t,s);else if(!(a=e.definition.validate))return;if(void 0===a)throw new Error('custom keyword "'+e.keyword+'"failed to compile');var u=M.length;return M[u]=a,{code:"customRule"+u,validate:a}}}},function(e,t,s){!function(e){"use strict";function t(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];if(t.length>1){t[0]=t[0].slice(0,-1);for(var r=t.length-1,i=1;i<r;++i)t[i]=t[i].slice(1,-1);return t[r]=t[r].slice(1),t.join("")}return t[0]}function s(e){return"(?:"+e+")"}function r(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function i(e){return e.toUpperCase()}function n(e){var r=t("[0-9]","[A-Fa-f]"),i=s(s("%[EFef]"+r+"%"+r+r+"%"+r+r)+"|"+s("%[89A-Fa-f]"+r+"%"+r+r)+"|"+s("%"+r+r)),n="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",o=t("[\\:\\/\\?\\#\\[\\]\\@]",n),a=e?"[\\uE000-\\uF8FF]":"[]",l=t("[A-Za-z]","[0-9]","[\\-\\.\\_\\~]",e?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]"),c=s("[A-Za-z]"+t("[A-Za-z]","[0-9]","[\\+\\-\\.]")+"*"),h=s(s(i+"|"+t(l,n,"[\\:]"))+"*"),u=(s(s("25[0-5]")+"|"+s("2[0-4][0-9]")+"|"+s("1[0-9][0-9]")+"|"+s("[1-9][0-9]")+"|[0-9]"),s(s("25[0-5]")+"|"+s("2[0-4][0-9]")+"|"+s("1[0-9][0-9]")+"|"+s("0?[1-9][0-9]")+"|0?0?[0-9]")),d=s(u+"\\."+u+"\\."+u+"\\."+u),p=s(r+"{1,4}"),f=s(s(p+"\\:"+p)+"|"+d),m=s(s(p+"\\:")+"{6}"+f),v=s("\\:\\:"+s(p+"\\:")+"{5}"+f),g=s(s(p)+"?\\:\\:"+s(p+"\\:")+"{4}"+f),y=s(s(s(p+"\\:")+"{0,1}"+p)+"?\\:\\:"+s(p+"\\:")+"{3}"+f),b=s(s(s(p+"\\:")+"{0,2}"+p)+"?\\:\\:"+s(p+"\\:")+"{2}"+f),w=s(s(s(p+"\\:")+"{0,3}"+p)+"?\\:\\:"+p+"\\:"+f),_=s(s(s(p+"\\:")+"{0,4}"+p)+"?\\:\\:"+f),E=s(s(s(p+"\\:")+"{0,5}"+p)+"?\\:\\:"+p),x=s(s(s(p+"\\:")+"{0,6}"+p)+"?\\:\\:"),P=s([m,v,g,y,b,w,_,E,x].join("|")),S=s(s(l+"|"+i)+"+"),C=(s(P+"\\%25"+S),s(P+s("\\%25|\\%(?!"+r+"{2})")+S)),T=s("[vV]"+r+"+\\."+t(l,n,"[\\:]")+"+"),M=s("\\["+s(C+"|"+P+"|"+T)+"\\]"),A=s(s(i+"|"+t(l,n))+"*"),O=s(M+"|"+d+"(?!"+A+")|"+A),R=s("[0-9]*"),D=s(s(h+"@")+"?"+O+s("\\:"+R)+"?"),j=s(i+"|"+t(l,n,"[\\:\\@]")),k=s(j+"*"),L=s(j+"+"),N=s(s(i+"|"+t(l,n,"[\\@]"))+"+"),V=s(s("\\/"+k)+"*"),I=s("\\/"+s(L+V)+"?"),B=s(N+V),z=s(L+V),F="(?!"+j+")",$=(s(V+"|"+I+"|"+B+"|"+z+"|"+F),s(s(j+"|"+t("[\\/\\?]",a))+"*")),U=s(s(j+"|[\\/\\?]")+"*"),H=s(s("\\/\\/"+D+V)+"|"+I+"|"+z+"|"+F),G=s(c+"\\:"+H+s("\\?"+$)+"?"+s("\\#"+U)+"?"),q=s(s("\\/\\/"+D+V)+"|"+I+"|"+B+"|"+F),Q=s(q+s("\\?"+$)+"?"+s("\\#"+U)+"?");return s(G+"|"+Q),s(c+"\\:"+H+s("\\?"+$)+"?"),s(s("\\/\\/("+s("("+h+")@")+"?("+O+")"+s("\\:("+R+")")+"?)")+"?("+V+"|"+I+"|"+z+"|"+F+")"),s("\\?("+$+")"),s("\\#("+U+")"),s(s("\\/\\/("+s("("+h+")@")+"?("+O+")"+s("\\:("+R+")")+"?)")+"?("+V+"|"+I+"|"+B+"|"+F+")"),s("\\?("+$+")"),s("\\#("+U+")"),s(s("\\/\\/("+s("("+h+")@")+"?("+O+")"+s("\\:("+R+")")+"?)")+"?("+V+"|"+I+"|"+z+"|"+F+")"),s("\\?("+$+")"),s("\\#("+U+")"),s("("+h+")@"),s("\\:("+R+")"),{NOT_SCHEME:new RegExp(t("[^]","[A-Za-z]","[0-9]","[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(t("[^\\%\\:]",l,n),"g"),NOT_HOST:new RegExp(t("[^\\%\\[\\]\\:]",l,n),"g"),NOT_PATH:new RegExp(t("[^\\%\\/\\:\\@]",l,n),"g"),NOT_PATH_NOSCHEME:new RegExp(t("[^\\%\\/\\@]",l,n),"g"),NOT_QUERY:new RegExp(t("[^\\%]",l,n,"[\\:\\@\\/\\?]",a),"g"),NOT_FRAGMENT:new RegExp(t("[^\\%]",l,n,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(t("[^]",l,n),"g"),UNRESERVED:new RegExp(l,"g"),OTHER_CHARS:new RegExp(t("[^\\%]",l,o),"g"),PCT_ENCODED:new RegExp(i,"g"),IPV4ADDRESS:new RegExp("^("+d+")$"),IPV6ADDRESS:new RegExp("^\\[?("+P+")"+s(s("\\%25|\\%(?!"+r+"{2})")+"("+S+")")+"?\\]?$")}}var o=n(!1),a=n(!0),l=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var s=[],r=!0,i=!1,n=void 0;try{for(var o,a=e[Symbol.iterator]();!(r=(o=a.next()).done)&&(s.push(o.value),!t||s.length!==t);r=!0);}catch(e){i=!0,n=e}finally{try{!r&&a.return&&a.return()}finally{if(i)throw n}}return s}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},c=2147483647,h=/^xn--/,u=/[^\0-\x7E]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,p={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,m=String.fromCharCode;function v(e){throw new RangeError(p[e])}function g(e,t){var s=e.split("@"),r="";s.length>1&&(r=s[0]+"@",e=s[1]);var i=function(e,t){for(var s=[],r=e.length;r--;)s[r]=t(e[r]);return s}((e=e.replace(d,".")).split("."),t).join(".");return r+i}function y(e){for(var t=[],s=0,r=e.length;s<r;){var i=e.charCodeAt(s++);if(i>=55296&&i<=56319&&s<r){var n=e.charCodeAt(s++);56320==(64512&n)?t.push(((1023&i)<<10)+(1023&n)+65536):(t.push(i),s--)}else t.push(i)}return t}var b=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},w=function(e,t,s){var r=0;for(e=s?f(e/700):e>>1,e+=f(e/t);e>455;r+=36)e=f(e/35);return f(r+36*e/(e+38))},_=function(e){var t,s=[],r=e.length,i=0,n=128,o=72,a=e.lastIndexOf("-");a<0&&(a=0);for(var l=0;l<a;++l)e.charCodeAt(l)>=128&&v("not-basic"),s.push(e.charCodeAt(l));for(var h=a>0?a+1:0;h<r;){for(var u=i,d=1,p=36;;p+=36){h>=r&&v("invalid-input");var m=(t=e.charCodeAt(h++))-48<10?t-22:t-65<26?t-65:t-97<26?t-97:36;(m>=36||m>f((c-i)/d))&&v("overflow"),i+=m*d;var g=p<=o?1:p>=o+26?26:p-o;if(m<g)break;var y=36-g;d>f(c/y)&&v("overflow"),d*=y}var b=s.length+1;o=w(i-u,b,0==u),f(i/b)>c-n&&v("overflow"),n+=f(i/b),i%=b,s.splice(i++,0,n)}return String.fromCodePoint.apply(String,s)},E=function(e){var t=[],s=(e=y(e)).length,r=128,i=0,n=72,o=!0,a=!1,l=void 0;try{for(var h,u=e[Symbol.iterator]();!(o=(h=u.next()).done);o=!0){var d=h.value;d<128&&t.push(m(d))}}catch(e){a=!0,l=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw l}}var p=t.length,g=p;for(p&&t.push("-");g<s;){var _=c,E=!0,x=!1,P=void 0;try{for(var S,C=e[Symbol.iterator]();!(E=(S=C.next()).done);E=!0){var T=S.value;T>=r&&T<_&&(_=T)}}catch(e){x=!0,P=e}finally{try{!E&&C.return&&C.return()}finally{if(x)throw P}}var M=g+1;_-r>f((c-i)/M)&&v("overflow"),i+=(_-r)*M,r=_;var A=!0,O=!1,R=void 0;try{for(var D,j=e[Symbol.iterator]();!(A=(D=j.next()).done);A=!0){var k=D.value;if(k<r&&++i>c&&v("overflow"),k==r){for(var L=i,N=36;;N+=36){var V=N<=n?1:N>=n+26?26:N-n;if(L<V)break;var I=L-V,B=36-V;t.push(m(b(V+I%B,0))),L=f(I/B)}t.push(m(b(L,0))),n=w(i,M,g==p),i=0,++g}}}catch(e){O=!0,R=e}finally{try{!A&&j.return&&j.return()}finally{if(O)throw R}}++i,++r}return t.join("")},x={version:"2.1.0",ucs2:{decode:y,encode:function(e){return String.fromCodePoint.apply(String,function(e){if(Array.isArray(e)){for(var t=0,s=Array(e.length);t<e.length;t++)s[t]=e[t];return s}return Array.from(e)}(e))}},decode:_,encode:E,toASCII:function(e){return g(e,(function(e){return u.test(e)?"xn--"+E(e):e}))},toUnicode:function(e){return g(e,(function(e){return h.test(e)?_(e.slice(4).toLowerCase()):e}))}},P={};function S(e){var t=e.charCodeAt(0);return t<16?"%0"+t.toString(16).toUpperCase():t<128?"%"+t.toString(16).toUpperCase():t<2048?"%"+(t>>6|192).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase():"%"+(t>>12|224).toString(16).toUpperCase()+"%"+(t>>6&63|128).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase()}function C(e){for(var t="",s=0,r=e.length;s<r;){var i=parseInt(e.substr(s+1,2),16);if(i<128)t+=String.fromCharCode(i),s+=3;else if(i>=194&&i<224){if(r-s>=6){var n=parseInt(e.substr(s+4,2),16);t+=String.fromCharCode((31&i)<<6|63&n)}else t+=e.substr(s,6);s+=6}else if(i>=224){if(r-s>=9){var o=parseInt(e.substr(s+4,2),16),a=parseInt(e.substr(s+7,2),16);t+=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}else t+=e.substr(s,9);s+=9}else t+=e.substr(s,3),s+=3}return t}function T(e,t){function s(e){var s=C(e);return s.match(t.UNRESERVED)?s:e}return e.scheme&&(e.scheme=String(e.scheme).replace(t.PCT_ENCODED,s).toLowerCase().replace(t.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=String(e.userinfo).replace(t.PCT_ENCODED,s).replace(t.NOT_USERINFO,S).replace(t.PCT_ENCODED,i)),void 0!==e.host&&(e.host=String(e.host).replace(t.PCT_ENCODED,s).toLowerCase().replace(t.NOT_HOST,S).replace(t.PCT_ENCODED,i)),void 0!==e.path&&(e.path=String(e.path).replace(t.PCT_ENCODED,s).replace(e.scheme?t.NOT_PATH:t.NOT_PATH_NOSCHEME,S).replace(t.PCT_ENCODED,i)),void 0!==e.query&&(e.query=String(e.query).replace(t.PCT_ENCODED,s).replace(t.NOT_QUERY,S).replace(t.PCT_ENCODED,i)),void 0!==e.fragment&&(e.fragment=String(e.fragment).replace(t.PCT_ENCODED,s).replace(t.NOT_FRAGMENT,S).replace(t.PCT_ENCODED,i)),e}function M(e){return e.replace(/^0*(.*)/,"$1")||"0"}function A(e,t){var s=e.match(t.IPV4ADDRESS)||[],r=l(s,2)[1];return r?r.split(".").map(M).join("."):e}function O(e,t){var s=e.match(t.IPV6ADDRESS)||[],r=l(s,3),i=r[1],n=r[2];if(i){for(var o=i.toLowerCase().split("::").reverse(),a=l(o,2),c=a[0],h=a[1],u=h?h.split(":").map(M):[],d=c.split(":").map(M),p=t.IPV4ADDRESS.test(d[d.length-1]),f=p?7:8,m=d.length-f,v=Array(f),g=0;g<f;++g)v[g]=u[g]||d[m+g]||"";p&&(v[f-1]=A(v[f-1],t));var y=v.reduce((function(e,t,s){if(!t||"0"===t){var r=e[e.length-1];r&&r.index+r.length===s?r.length++:e.push({index:s,length:1})}return e}),[]).sort((function(e,t){return t.length-e.length}))[0],b=void 0;if(y&&y.length>1){var w=v.slice(0,y.index),_=v.slice(y.index+y.length);b=w.join(":")+"::"+_.join(":")}else b=v.join(":");return n&&(b+="%"+n),b}return e}var R=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,D=void 0==="".match(/(){0}/)[1];function j(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s={},r=!1!==t.iri?a:o;"suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e);var i=e.match(R);if(i){D?(s.scheme=i[1],s.userinfo=i[3],s.host=i[4],s.port=parseInt(i[5],10),s.path=i[6]||"",s.query=i[7],s.fragment=i[8],isNaN(s.port)&&(s.port=i[5])):(s.scheme=i[1]||void 0,s.userinfo=-1!==e.indexOf("@")?i[3]:void 0,s.host=-1!==e.indexOf("//")?i[4]:void 0,s.port=parseInt(i[5],10),s.path=i[6]||"",s.query=-1!==e.indexOf("?")?i[7]:void 0,s.fragment=-1!==e.indexOf("#")?i[8]:void 0,isNaN(s.port)&&(s.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?i[4]:void 0)),s.host&&(s.host=O(A(s.host,r),r)),void 0!==s.scheme||void 0!==s.userinfo||void 0!==s.host||void 0!==s.port||s.path||void 0!==s.query?void 0===s.scheme?s.reference="relative":void 0===s.fragment?s.reference="absolute":s.reference="uri":s.reference="same-document",t.reference&&"suffix"!==t.reference&&t.reference!==s.reference&&(s.error=s.error||"URI is not a "+t.reference+" reference.");var n=P[(t.scheme||s.scheme||"").toLowerCase()];if(t.unicodeSupport||n&&n.unicodeSupport)T(s,r);else{if(s.host&&(t.domainHost||n&&n.domainHost))try{s.host=x.toASCII(s.host.replace(r.PCT_ENCODED,C).toLowerCase())}catch(e){s.error=s.error||"Host's domain name can not be converted to ASCII via punycode: "+e}T(s,o)}n&&n.parse&&n.parse(s,t)}else s.error=s.error||"URI can not be parsed.";return s}var k=/^\.\.?\//,L=/^\/\.(\/|$)/,N=/^\/\.\.(\/|$)/,V=/^\/?(?:.|\n)*?(?=\/|$)/;function I(e){for(var t=[];e.length;)if(e.match(k))e=e.replace(k,"");else if(e.match(L))e=e.replace(L,"/");else if(e.match(N))e=e.replace(N,"/"),t.pop();else if("."===e||".."===e)e="";else{var s=e.match(V);if(!s)throw new Error("Unexpected dot segment condition");var r=s[0];e=e.slice(r.length),t.push(r)}return t.join("")}function B(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=t.iri?a:o,r=[],i=P[(t.scheme||e.scheme||"").toLowerCase()];if(i&&i.serialize&&i.serialize(e,t),e.host)if(s.IPV6ADDRESS.test(e.host));else if(t.domainHost||i&&i.domainHost)try{e.host=t.iri?x.toUnicode(e.host):x.toASCII(e.host.replace(s.PCT_ENCODED,C).toLowerCase())}catch(s){e.error=e.error||"Host's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+s}T(e,s),"suffix"!==t.reference&&e.scheme&&(r.push(e.scheme),r.push(":"));var n=function(e,t){var s=!1!==t.iri?a:o,r=[];return void 0!==e.userinfo&&(r.push(e.userinfo),r.push("@")),void 0!==e.host&&r.push(O(A(String(e.host),s),s).replace(s.IPV6ADDRESS,(function(e,t,s){return"["+t+(s?"%25"+s:"")+"]"}))),"number"==typeof e.port&&(r.push(":"),r.push(e.port.toString(10))),r.length?r.join(""):void 0}(e,t);if(void 0!==n&&("suffix"!==t.reference&&r.push("//"),r.push(n),e.path&&"/"!==e.path.charAt(0)&&r.push("/")),void 0!==e.path){var l=e.path;t.absolutePath||i&&i.absolutePath||(l=I(l)),void 0===n&&(l=l.replace(/^\/\//,"/%2F")),r.push(l)}return void 0!==e.query&&(r.push("?"),r.push(e.query)),void 0!==e.fragment&&(r.push("#"),r.push(e.fragment)),r.join("")}function z(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={};return arguments[3]||(e=j(B(e,s),s),t=j(B(t,s),s)),!(s=s||{}).tolerant&&t.scheme?(r.scheme=t.scheme,r.userinfo=t.userinfo,r.host=t.host,r.port=t.port,r.path=I(t.path||""),r.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(r.userinfo=t.userinfo,r.host=t.host,r.port=t.port,r.path=I(t.path||""),r.query=t.query):(t.path?("/"===t.path.charAt(0)?r.path=I(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?r.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:r.path=t.path:r.path="/"+t.path,r.path=I(r.path)),r.query=t.query):(r.path=e.path,void 0!==t.query?r.query=t.query:r.query=e.query),r.userinfo=e.userinfo,r.host=e.host,r.port=e.port),r.scheme=e.scheme),r.fragment=t.fragment,r}function F(e,t){return e&&e.toString().replace(t&&t.iri?a.PCT_ENCODED:o.PCT_ENCODED,C)}var $={scheme:"http",domainHost:!0,parse:function(e,t){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e},serialize:function(e,t){return e.port!==("https"!==String(e.scheme).toLowerCase()?80:443)&&""!==e.port||(e.port=void 0),e.path||(e.path="/"),e}},U={scheme:"https",domainHost:$.domainHost,parse:$.parse,serialize:$.serialize},H={},G="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",q="[0-9A-Fa-f]",Q=s(s("%[EFef][0-9A-Fa-f]%"+q+q+"%"+q+q)+"|"+s("%[89A-Fa-f][0-9A-Fa-f]%"+q+q)+"|"+s("%"+q+q)),Y=t("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),X=new RegExp(G,"g"),W=new RegExp(Q,"g"),J=new RegExp(t("[^]","[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]","[\\.]",'[\\"]',Y),"g"),K=new RegExp(t("[^]",G,"[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]"),"g"),Z=K;function ee(e){var t=C(e);return t.match(X)?t:e}var te={scheme:"mailto",parse:function(e,t){var s=e,r=s.to=s.path?s.path.split(","):[];if(s.path=void 0,s.query){for(var i=!1,n={},o=s.query.split("&"),a=0,l=o.length;a<l;++a){var c=o[a].split("=");switch(c[0]){case"to":for(var h=c[1].split(","),u=0,d=h.length;u<d;++u)r.push(h[u]);break;case"subject":s.subject=F(c[1],t);break;case"body":s.body=F(c[1],t);break;default:i=!0,n[F(c[0],t)]=F(c[1],t)}}i&&(s.headers=n)}s.query=void 0;for(var p=0,f=r.length;p<f;++p){var m=r[p].split("@");if(m[0]=F(m[0]),t.unicodeSupport)m[1]=F(m[1],t).toLowerCase();else try{m[1]=x.toASCII(F(m[1],t).toLowerCase())}catch(e){s.error=s.error||"Email address's domain name can not be converted to ASCII via punycode: "+e}r[p]=m.join("@")}return s},serialize:function(e,t){var s,r=e,n=null!=(s=e.to)?s instanceof Array?s:"number"!=typeof s.length||s.split||s.setInterval||s.call?[s]:Array.prototype.slice.call(s):[];if(n){for(var o=0,a=n.length;o<a;++o){var l=String(n[o]),c=l.lastIndexOf("@"),h=l.slice(0,c).replace(W,ee).replace(W,i).replace(J,S),u=l.slice(c+1);try{u=t.iri?x.toUnicode(u):x.toASCII(F(u,t).toLowerCase())}catch(e){r.error=r.error||"Email address's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+e}n[o]=h+"@"+u}r.path=n.join(",")}var d=e.headers=e.headers||{};e.subject&&(d.subject=e.subject),e.body&&(d.body=e.body);var p=[];for(var f in d)d[f]!==H[f]&&p.push(f.replace(W,ee).replace(W,i).replace(K,S)+"="+d[f].replace(W,ee).replace(W,i).replace(Z,S));return p.length&&(r.query=p.join("&")),r}},se=/^([^\:]+)\:(.*)/,re={scheme:"urn",parse:function(e,t){var s=e.path&&e.path.match(se),r=e;if(s){var i=t.scheme||r.scheme||"urn",n=s[1].toLowerCase(),o=s[2],a=i+":"+(t.nid||n),l=P[a];r.nid=n,r.nss=o,r.path=void 0,l&&(r=l.parse(r,t))}else r.error=r.error||"URN can not be parsed.";return r},serialize:function(e,t){var s=t.scheme||e.scheme||"urn",r=e.nid,i=s+":"+(t.nid||r),n=P[i];n&&(e=n.serialize(e,t));var o=e,a=e.nss;return o.path=(r||t.nid)+":"+a,o}},ie=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,ne={scheme:"urn:uuid",parse:function(e,t){var s=e;return s.uuid=s.nss,s.nss=void 0,t.tolerant||s.uuid&&s.uuid.match(ie)||(s.error=s.error||"UUID is not valid."),s},serialize:function(e,t){var s=e;return s.nss=(e.uuid||"").toLowerCase(),s}};P[$.scheme]=$,P[U.scheme]=U,P[te.scheme]=te,P[re.scheme]=re,P[ne.scheme]=ne,e.SCHEMES=P,e.pctEncChar=S,e.pctDecChars=C,e.parse=j,e.removeDotSegments=I,e.serialize=B,e.resolveComponents=z,e.resolve=function(e,t,s){var r=function(e,t){var s=e;if(t)for(var r in t)s[r]=t[r];return s}({scheme:"null"},s);return B(z(j(e,r),j(t,r),r,!0),r)},e.normalize=function(e,t){return"string"==typeof e?e=B(j(e,t),t):"object"===r(e)&&(e=j(B(e,t),t)),e},e.equal=function(e,t,s){return"string"==typeof e?e=B(j(e,s),s):"object"===r(e)&&(e=B(e,s)),"string"==typeof t?t=B(j(t,s),s):"object"===r(t)&&(t=B(t,s)),e===t},e.escapeComponent=function(e,t){return e&&e.toString().replace(t&&t.iri?a.ESCAPE:o.ESCAPE,S)},e.unescapeComponent=F,Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,s){"use strict";e.exports=function(e){for(var t,s=0,r=e.length,i=0;i<r;)s++,(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<r&&56320==(64512&(t=e.charCodeAt(i)))&&i++;return s}},function(e,t,s){"use strict";var r=e.exports=function(e,t,s){"function"==typeof t&&(s=t,t={}),function e(t,s,i,n,o,a,l,c,h,u){if(n&&"object"==typeof n&&!Array.isArray(n)){for(var d in s(n,o,a,l,c,h,u),n){var p=n[d];if(Array.isArray(p)){if(d in r.arrayKeywords)for(var f=0;f<p.length;f++)e(t,s,i,p[f],o+"/"+d+"/"+f,a,o,d,n,f)}else if(d in r.propsKeywords){if(p&&"object"==typeof p)for(var m in p)e(t,s,i,p[m],o+"/"+d+"/"+m.replace(/~/g,"~0").replace(/\//g,"~1"),a,o,d,n,m)}else(d in r.keywords||t.allKeys&&!(d in r.skipKeywords))&&e(t,s,i,p,o+"/"+d,a,o,d,n)}i(n,o,a,l,c,h,u)}}(t,"function"==typeof(s=t.cb||s)?s:s.pre||function(){},s.post||function(){},e,"",e)};r.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0},r.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},r.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},r.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}},function(e,t,s){"use strict";var r=e.exports=function(){this._cache={}};r.prototype.put=function(e,t){this._cache[e]=t},r.prototype.get=function(e){return this._cache[e]},r.prototype.del=function(e){delete this._cache[e]},r.prototype.clear=function(){this._cache={}}},function(e,t,s){"use strict";var r=s(27),i=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,n=[0,31,28,31,30,31,30,31,31,30,31,30,31],o=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d:\d\d)?$/i,a=/^[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*$/i,l=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,c=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,h=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,u=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,d=/^(?:\/(?:[^~/]|~0|~1)*)*$/,p=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,f=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/;function m(e){return e="full"==e?"full":"fast",r.copy(m[e])}function v(e){var t=e.match(i);if(!t)return!1;var s=+t[1],r=+t[2],o=+t[3];return r>=1&&r<=12&&o>=1&&o<=(2==r&&function(e){return e%4==0&&(e%100!=0||e%400==0)}(s)?29:n[r])}function g(e,t){var s=e.match(o);if(!s)return!1;var r=s[1],i=s[2],n=s[3],a=s[5];return(r<=23&&i<=59&&n<=59||23==r&&59==i&&60==n)&&(!t||a)}e.exports=m,m.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d:\d\d)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d:\d\d)$/i,uri:/^(?:[a-z][a-z0-9+-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":c,url:h,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:a,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:_,uuid:u,"json-pointer":d,"json-pointer-uri-fragment":p,"relative-json-pointer":f},m.full={date:v,time:g,"date-time":function(e){var t=e.split(y);return 2==t.length&&v(t[0])&&g(t[1],!0)},uri:function(e){return b.test(e)&&l.test(e)},"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":c,url:h,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:function(e){return e.length<=255&&a.test(e)},ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:_,uuid:u,"json-pointer":d,"json-pointer-uri-fragment":p,"relative-json-pointer":f};var y=/t|\s/i;var b=/\/|:/;var w=/[^\\]\\Z/;function _(e){if(w.test(e))return!1;try{return new RegExp(e),!0}catch(e){return!1}}},function(e,t,s){"use strict";var r=s(169),i=s(27).toHash;e.exports=function(){var e=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],t=["type","$comment"];return e.all=i(t),e.types=i(["number","integer","string","array","object","boolean","null"]),e.forEach((function(s){s.rules=s.rules.map((function(s){var i;if("object"==typeof s){var n=Object.keys(s)[0];i=s[n],s=n,i.forEach((function(s){t.push(s),e.all[s]=!0}))}return t.push(s),e.all[s]={keyword:s,code:r[s],implements:i}})),e.all.$comment={keyword:"$comment",code:r.$comment},s.type&&(e.types[s.type]=s)})),e.keywords=i(t.concat(["$schema","$id","id","$data","$async","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"])),e.custom={},e}},function(e,t,s){"use strict";e.exports={$ref:s(170),allOf:s(171),anyOf:s(172),$comment:s(173),const:s(174),contains:s(175),dependencies:s(176),enum:s(177),format:s(178),if:s(179),items:s(180),maximum:s(87),minimum:s(87),maxItems:s(88),minItems:s(88),maxLength:s(89),minLength:s(89),maxProperties:s(90),minProperties:s(90),multipleOf:s(181),not:s(182),oneOf:s(183),pattern:s(184),properties:s(185),propertyNames:s(186),required:s(187),uniqueItems:s(188),validate:s(86)}},function(e,t,s){"use strict";e.exports=function(e,t,s){var r,i,n=" ",o=e.level,a=e.dataLevel,l=e.schema[t],c=e.errSchemaPath+"/"+t,h=!e.opts.allErrors,u="data"+(a||""),d="valid"+o;if("#"==l||"#/"==l)e.isRoot?(r=e.async,i="validate"):(r=!0===e.root.schema.$async,i="root.refVal[0]");else{var p=e.resolveRef(e.baseId,l,e.isRoot);if(void 0===p){var f=e.MissingRefError.message(e.baseId,l);if("fail"==e.opts.missingRefs){e.logger.error(f),(y=y||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { ref: '"+e.util.escapeQuotes(l)+"' } ",!1!==e.opts.messages&&(n+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(l)+"' "),e.opts.verbose&&(n+=" , schema: "+e.util.toQuotedString(l)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),n+=" } "):n+=" {} ";var m=n;n=y.pop(),!e.compositeRule&&h?e.async?n+=" throw new ValidationError(["+m+"]); ":n+=" validate.errors = ["+m+"]; return false; ":n+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",h&&(n+=" if (false) { ")}else{if("ignore"!=e.opts.missingRefs)throw new e.MissingRefError(e.baseId,l,f);e.logger.warn(f),h&&(n+=" if (true) { ")}}else if(p.inline){var v=e.util.copy(e);v.level++;var g="valid"+v.level;v.schema=p.schema,v.schemaPath="",v.errSchemaPath=l,n+=" "+e.validate(v).replace(/validate\.schema/g,p.code)+" ",h&&(n+=" if ("+g+") { ")}else r=!0===p.$async||e.async&&!1!==p.$async,i=p.code}if(i){var y;(y=y||[]).push(n),n="",e.opts.passContext?n+=" "+i+".call(this, ":n+=" "+i+"( ",n+=" "+u+", (dataPath || '')",'""'!=e.errorPath&&(n+=" + "+e.errorPath);var b=n+=" , "+(a?"data"+(a-1||""):"parentData")+" , "+(a?e.dataPathArr[a]:"parentDataProperty")+", rootData)  ";if(n=y.pop(),r){if(!e.async)throw new Error("async schema referenced by sync schema");h&&(n+=" var "+d+"; "),n+=" try { await "+b+"; ",h&&(n+=" "+d+" = true; "),n+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",h&&(n+=" "+d+" = false; "),n+=" } ",h&&(n+=" if ("+d+") { ")}else n+=" if (!"+b+") { if (vErrors === null) vErrors = "+i+".errors; else vErrors = vErrors.concat("+i+".errors); errors = vErrors.length; } ",h&&(n+=" else { ")}return n}},function(e,t,s){"use strict";e.exports=function(e,t,s){var r=" ",i=e.schema[t],n=e.schemaPath+e.util.getProperty(t),o=e.errSchemaPath+"/"+t,a=!e.opts.allErrors,l=e.util.copy(e),c="";l.level++;var h="valid"+l.level,u=l.baseId,d=!0,p=i;if(p)for(var f,m=-1,v=p.length-1;m<v;)f=p[m+=1],(e.opts.strictKeywords?"object"==typeof f&&Object.keys(f).length>0:e.util.schemaHasRules(f,e.RULES.all))&&(d=!1,l.schema=f,l.schemaPath=n+"["+m+"]",l.errSchemaPath=o+"/"+m,r+="  "+e.validate(l)+" ",l.baseId=u,a&&(r+=" if ("+h+") { ",c+="}"));return a&&(r+=d?" if (true) { ":" "+c.slice(0,-1)+" "),r=e.util.cleanUpCode(r)}},function(e,t,s){"use strict";e.exports=function(e,t,s){var r=" ",i=e.level,n=e.dataLevel,o=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,h="data"+(n||""),u="valid"+i,d="errs__"+i,p=e.util.copy(e),f="";p.level++;var m="valid"+p.level;if(o.every((function(t){return e.opts.strictKeywords?"object"==typeof t&&Object.keys(t).length>0:e.util.schemaHasRules(t,e.RULES.all)}))){var v=p.baseId;r+=" var "+d+" = errors; var "+u+" = false;  ";var g=e.compositeRule;e.compositeRule=p.compositeRule=!0;var y=o;if(y)for(var b,w=-1,_=y.length-1;w<_;)b=y[w+=1],p.schema=b,p.schemaPath=a+"["+w+"]",p.errSchemaPath=l+"/"+w,r+="  "+e.validate(p)+" ",p.baseId=v,r+=" "+u+" = "+u+" || "+m+"; if (!"+u+") { ",f+="}";e.compositeRule=p.compositeRule=g,r+=" "+f+" if (!"+u+") {   var err =   ",!1!==e.createErrors?(r+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(r+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),r+=" } else {  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; } ",e.opts.allErrors&&(r+=" } "),r=e.util.cleanUpCode(r)}else c&&(r+=" if (true) { ");return r}},function(e,t,s){"use strict";e.exports=function(e,t,s){var r=" ",i=e.schema[t],n=e.errSchemaPath+"/"+t,o=(e.opts.allErrors,e.util.toQuotedString(i));return!0===e.opts.$comment?r+=" console.log("+o+");":"function"==typeof e.opts.$comment&&(r+=" self._opts.$comment("+o+", "+e.util.toQuotedString(n)+", validate.root.schema);"),r}},function(e,t,s){"use strict";e.exports=function(e,t,s){var r=" ",i=e.level,n=e.dataLevel,o=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,h="data"+(n||""),u="valid"+i,d=e.opts.$data&&o&&o.$data;d&&(r+=" var schema"+i+" = "+e.util.getData(o.$data,n,e.dataPathArr)+"; "),d||(r+=" var schema"+i+" = validate.schema"+a+";"),r+="var "+u+" = equal("+h+", schema"+i+"); if (!"+u+") {   ";var p=p||[];p.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'const' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { allowedValue: schema"+i+" } ",!1!==e.opts.messages&&(r+=" , message: 'should be equal to constant' "),e.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),r+=" } "):r+=" {} ";var f=r;return r=p.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+f+"]); ":r+=" validate.errors = ["+f+"]; return false; ":r+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" }",c&&(r+=" else { "),r}},function(e,t,s){"use strict";e.exports=function(e,t,s){var r=" ",i=e.level,n=e.dataLevel,o=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,h="data"+(n||""),u="valid"+i,d="errs__"+i,p=e.util.copy(e);p.level++;var f="valid"+p.level,m="i"+i,v=p.dataLevel=e.dataLevel+1,g="data"+v,y=e.baseId,b=e.opts.strictKeywords?"object"==typeof o&&Object.keys(o).length>0:e.util.schemaHasRules(o,e.RULES.all);if(r+="var "+d+" = errors;var "+u+";",b){var w=e.compositeRule;e.compositeRule=p.compositeRule=!0,p.schema=o,p.schemaPath=a,p.errSchemaPath=l,r+=" var "+f+" = false; for (var "+m+" = 0; "+m+" < "+h+".length; "+m+"++) { ",p.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers,!0);var _=h+"["+m+"]";p.dataPathArr[v]=m;var E=e.validate(p);p.baseId=y,e.util.varOccurences(E,g)<2?r+=" "+e.util.varReplace(E,g,_)+" ":r+=" var "+g+" = "+_+"; "+E+" ",r+=" if ("+f+") break; }  ",e.compositeRule=p.compositeRule=w,r+="  if (!"+f+") {"}else r+=" if ("+h+".length == 0) {";var x=x||[];x.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(r+=" , message: 'should contain a valid item' "),e.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),r+=" } "):r+=" {} ";var P=r;return r=x.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+P+"]); ":r+=" validate.errors = ["+P+"]; return false; ":r+=" var err = "+P+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { ",b&&(r+="  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; } "),e.opts.allErrors&&(r+=" } "),r=e.util.cleanUpCode(r)}},function(e,t,s){"use strict";e.exports=function(e,t,s){var r=" ",i=e.level,n=e.dataLevel,o=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,h="data"+(n||""),u="errs__"+i,d=e.util.copy(e),p="";d.level++;var f="valid"+d.level,m={},v={},g=e.opts.ownProperties;for(_ in o){var y=o[_],b=Array.isArray(y)?v:m;b[_]=y}r+="var "+u+" = errors;";var w=e.errorPath;for(var _ in r+="var missing"+i+";",v)if((b=v[_]).length){if(r+=" if ( "+h+e.util.getProperty(_)+" !== undefined ",g&&(r+=" && Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(_)+"') "),c){r+=" && ( ";var E=b;if(E)for(var x=-1,P=E.length-1;x<P;){O=E[x+=1],x&&(r+=" || "),r+=" ( ( "+(k=h+(j=e.util.getProperty(O)))+" === undefined ",g&&(r+=" || ! Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(O)+"') "),r+=") && (missing"+i+" = "+e.util.toQuotedString(e.opts.jsonPointers?O:j)+") ) "}r+=")) {  ";var S="missing"+i,C="' + "+S+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(w,S,!0):w+" + "+S);var T=T||[];T.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { property: '"+e.util.escapeQuotes(_)+"', missingProperty: '"+C+"', depsCount: "+b.length+", deps: '"+e.util.escapeQuotes(1==b.length?b[0]:b.join(", "))+"' } ",!1!==e.opts.messages&&(r+=" , message: 'should have ",1==b.length?r+="property "+e.util.escapeQuotes(b[0]):r+="properties "+e.util.escapeQuotes(b.join(", ")),r+=" when property "+e.util.escapeQuotes(_)+" is present' "),e.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),r+=" } "):r+=" {} ";var M=r;r=T.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+M+"]); ":r+=" validate.errors = ["+M+"]; return false; ":r+=" var err = "+M+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{r+=" ) { ";var A=b;if(A)for(var O,R=-1,D=A.length-1;R<D;){O=A[R+=1];var j=e.util.getProperty(O),k=(C=e.util.escapeQuotes(O),h+j);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(w,O,e.opts.jsonPointers)),r+=" if ( "+k+" === undefined ",g&&(r+=" || ! Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(O)+"') "),r+=") {  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { property: '"+e.util.escapeQuotes(_)+"', missingProperty: '"+C+"', depsCount: "+b.length+", deps: '"+e.util.escapeQuotes(1==b.length?b[0]:b.join(", "))+"' } ",!1!==e.opts.messages&&(r+=" , message: 'should have ",1==b.length?r+="property "+e.util.escapeQuotes(b[0]):r+="properties "+e.util.escapeQuotes(b.join(", ")),r+=" when property "+e.util.escapeQuotes(_)+" is present' "),e.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}r+=" }   ",c&&(p+="}",r+=" else { ")}e.errorPath=w;var L=d.baseId;for(var _ in m){y=m[_];(e.opts.strictKeywords?"object"==typeof y&&Object.keys(y).length>0:e.util.schemaHasRules(y,e.RULES.all))&&(r+=" "+f+" = true; if ( "+h+e.util.getProperty(_)+" !== undefined ",g&&(r+=" && Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(_)+"') "),r+=") { ",d.schema=y,d.schemaPath=a+e.util.getProperty(_),d.errSchemaPath=l+"/"+e.util.escapeFragment(_),r+="  "+e.validate(d)+" ",d.baseId=L,r+=" }  ",c&&(r+=" if ("+f+") { ",p+="}"))}return c&&(r+="   "+p+" if ("+u+" == errors) {"),r=e.util.cleanUpCode(r)}},function(e,t,s){"use strict";e.exports=function(e,t,s){var r=" ",i=e.level,n=e.dataLevel,o=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,h="data"+(n||""),u="valid"+i,d=e.opts.$data&&o&&o.$data;d&&(r+=" var schema"+i+" = "+e.util.getData(o.$data,n,e.dataPathArr)+"; ");var p="i"+i,f="schema"+i;d||(r+=" var "+f+" = validate.schema"+a+";"),r+="var "+u+";",d&&(r+=" if (schema"+i+" === undefined) "+u+" = true; else if (!Array.isArray(schema"+i+")) "+u+" = false; else {"),r+=u+" = false;for (var "+p+"=0; "+p+"<"+f+".length; "+p+"++) if (equal("+h+", "+f+"["+p+"])) { "+u+" = true; break; }",d&&(r+="  }  "),r+=" if (!"+u+") {   ";var m=m||[];m.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { allowedValues: schema"+i+" } ",!1!==e.opts.messages&&(r+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),r+=" } "):r+=" {} ";var v=r;return r=m.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+v+"]); ":r+=" validate.errors = ["+v+"]; return false; ":r+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" }",c&&(r+=" else { "),r}},function(e,t,s){"use strict";e.exports=function(e,t,s){var r=" ",i=e.level,n=e.dataLevel,o=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,h="data"+(n||"");if(!1===e.opts.format)return c&&(r+=" if (true) { "),r;var u,d=e.opts.$data&&o&&o.$data;d?(r+=" var schema"+i+" = "+e.util.getData(o.$data,n,e.dataPathArr)+"; ",u="schema"+i):u=o;var p=e.opts.unknownFormats,f=Array.isArray(p);if(d){r+=" var "+(m="format"+i)+" = formats["+u+"]; var "+(v="isObject"+i)+" = typeof "+m+" == 'object' && !("+m+" instanceof RegExp) && "+m+".validate; var "+(g="formatType"+i)+" = "+v+" && "+m+".type || 'string'; if ("+v+") { ",e.async&&(r+=" var async"+i+" = "+m+".async; "),r+=" "+m+" = "+m+".validate; } if (  ",d&&(r+=" ("+u+" !== undefined && typeof "+u+" != 'string') || "),r+=" (","ignore"!=p&&(r+=" ("+u+" && !"+m+" ",f&&(r+=" && self._opts.unknownFormats.indexOf("+u+") == -1 "),r+=") || "),r+=" ("+m+" && "+g+" == '"+s+"' && !(typeof "+m+" == 'function' ? ",e.async?r+=" (async"+i+" ? await "+m+"("+h+") : "+m+"("+h+")) ":r+=" "+m+"("+h+") ",r+=" : "+m+".test("+h+"))))) {"}else{var m;if(!(m=e.formats[o])){if("ignore"==p)return e.logger.warn('unknown format "'+o+'" ignored in schema at path "'+e.errSchemaPath+'"'),c&&(r+=" if (true) { "),r;if(f&&p.indexOf(o)>=0)return c&&(r+=" if (true) { "),r;throw new Error('unknown format "'+o+'" is used in schema at path "'+e.errSchemaPath+'"')}var v,g=(v="object"==typeof m&&!(m instanceof RegExp)&&m.validate)&&m.type||"string";if(v){var y=!0===m.async;m=m.validate}if(g!=s)return c&&(r+=" if (true) { "),r;if(y){if(!e.async)throw new Error("async format in sync schema");r+=" if (!(await "+(b="formats"+e.util.getProperty(o)+".validate")+"("+h+"))) { "}else{r+=" if (! ";var b="formats"+e.util.getProperty(o);v&&(b+=".validate"),r+="function"==typeof m?" "+b+"("+h+") ":" "+b+".test("+h+") ",r+=") { "}}var w=w||[];w.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { format:  ",r+=d?""+u:""+e.util.toQuotedString(o),r+="  } ",!1!==e.opts.messages&&(r+=" , message: 'should match format \"",r+=d?"' + "+u+" + '":""+e.util.escapeQuotes(o),r+="\"' "),e.opts.verbose&&(r+=" , schema:  ",r+=d?"validate.schema"+a:""+e.util.toQuotedString(o),r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),r+=" } "):r+=" {} ";var _=r;return r=w.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+_+"]); ":r+=" validate.errors = ["+_+"]; return false; ":r+=" var err = "+_+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",c&&(r+=" else { "),r}},function(e,t,s){"use strict";e.exports=function(e,t,s){var r=" ",i=e.level,n=e.dataLevel,o=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,h="data"+(n||""),u="valid"+i,d="errs__"+i,p=e.util.copy(e);p.level++;var f="valid"+p.level,m=e.schema.then,v=e.schema.else,g=void 0!==m&&(e.opts.strictKeywords?"object"==typeof m&&Object.keys(m).length>0:e.util.schemaHasRules(m,e.RULES.all)),y=void 0!==v&&(e.opts.strictKeywords?"object"==typeof v&&Object.keys(v).length>0:e.util.schemaHasRules(v,e.RULES.all)),b=p.baseId;if(g||y){var w;p.createErrors=!1,p.schema=o,p.schemaPath=a,p.errSchemaPath=l,r+=" var "+d+" = errors; var "+u+" = true;  ";var _=e.compositeRule;e.compositeRule=p.compositeRule=!0,r+="  "+e.validate(p)+" ",p.baseId=b,p.createErrors=!0,r+="  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; }  ",e.compositeRule=p.compositeRule=_,g?(r+=" if ("+f+") {  ",p.schema=e.schema.then,p.schemaPath=e.schemaPath+".then",p.errSchemaPath=e.errSchemaPath+"/then",r+="  "+e.validate(p)+" ",p.baseId=b,r+=" "+u+" = "+f+"; ",g&&y?r+=" var "+(w="ifClause"+i)+" = 'then'; ":w="'then'",r+=" } ",y&&(r+=" else { ")):r+=" if (!"+f+") { ",y&&(p.schema=e.schema.else,p.schemaPath=e.schemaPath+".else",p.errSchemaPath=e.errSchemaPath+"/else",r+="  "+e.validate(p)+" ",p.baseId=b,r+=" "+u+" = "+f+"; ",g&&y?r+=" var "+(w="ifClause"+i)+" = 'else'; ":w="'else'",r+=" } "),r+=" if (!"+u+") {   var err =   ",!1!==e.createErrors?(r+=" { keyword: 'if' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { failingKeyword: "+w+" } ",!1!==e.opts.messages&&(r+=" , message: 'should match \"' + "+w+" + '\" schema' "),e.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),r+=" }   ",c&&(r+=" else { "),r=e.util.cleanUpCode(r)}else c&&(r+=" if (true) { ");return r}},function(e,t,s){"use strict";e.exports=function(e,t,s){var r=" ",i=e.level,n=e.dataLevel,o=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,h="data"+(n||""),u="valid"+i,d="errs__"+i,p=e.util.copy(e),f="";p.level++;var m="valid"+p.level,v="i"+i,g=p.dataLevel=e.dataLevel+1,y="data"+g,b=e.baseId;if(r+="var "+d+" = errors;var "+u+";",Array.isArray(o)){var w=e.schema.additionalItems;if(!1===w){r+=" "+u+" = "+h+".length <= "+o.length+"; ";var _=l;l=e.errSchemaPath+"/additionalItems",r+="  if (!"+u+") {   ";var E=E||[];E.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { limit: "+o.length+" } ",!1!==e.opts.messages&&(r+=" , message: 'should NOT have more than "+o.length+" items' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),r+=" } "):r+=" {} ";var x=r;r=E.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+x+"]); ":r+=" validate.errors = ["+x+"]; return false; ":r+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",l=_,c&&(f+="}",r+=" else { ")}var P=o;if(P)for(var S,C=-1,T=P.length-1;C<T;)if(S=P[C+=1],e.opts.strictKeywords?"object"==typeof S&&Object.keys(S).length>0:e.util.schemaHasRules(S,e.RULES.all)){r+=" "+m+" = true; if ("+h+".length > "+C+") { ";var M=h+"["+C+"]";p.schema=S,p.schemaPath=a+"["+C+"]",p.errSchemaPath=l+"/"+C,p.errorPath=e.util.getPathExpr(e.errorPath,C,e.opts.jsonPointers,!0),p.dataPathArr[g]=C;var A=e.validate(p);p.baseId=b,e.util.varOccurences(A,y)<2?r+=" "+e.util.varReplace(A,y,M)+" ":r+=" var "+y+" = "+M+"; "+A+" ",r+=" }  ",c&&(r+=" if ("+m+") { ",f+="}")}if("object"==typeof w&&(e.opts.strictKeywords?"object"==typeof w&&Object.keys(w).length>0:e.util.schemaHasRules(w,e.RULES.all))){p.schema=w,p.schemaPath=e.schemaPath+".additionalItems",p.errSchemaPath=e.errSchemaPath+"/additionalItems",r+=" "+m+" = true; if ("+h+".length > "+o.length+") {  for (var "+v+" = "+o.length+"; "+v+" < "+h+".length; "+v+"++) { ",p.errorPath=e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers,!0);M=h+"["+v+"]";p.dataPathArr[g]=v;A=e.validate(p);p.baseId=b,e.util.varOccurences(A,y)<2?r+=" "+e.util.varReplace(A,y,M)+" ":r+=" var "+y+" = "+M+"; "+A+" ",c&&(r+=" if (!"+m+") break; "),r+=" } }  ",c&&(r+=" if ("+m+") { ",f+="}")}}else if(e.opts.strictKeywords?"object"==typeof o&&Object.keys(o).length>0:e.util.schemaHasRules(o,e.RULES.all)){p.schema=o,p.schemaPath=a,p.errSchemaPath=l,r+="  for (var "+v+" = 0; "+v+" < "+h+".length; "+v+"++) { ",p.errorPath=e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers,!0);M=h+"["+v+"]";p.dataPathArr[g]=v;A=e.validate(p);p.baseId=b,e.util.varOccurences(A,y)<2?r+=" "+e.util.varReplace(A,y,M)+" ":r+=" var "+y+" = "+M+"; "+A+" ",c&&(r+=" if (!"+m+") break; "),r+=" }"}return c&&(r+=" "+f+" if ("+d+" == errors) {"),r=e.util.cleanUpCode(r)}},function(e,t,s){"use strict";e.exports=function(e,t,s){var r,i=" ",n=e.level,o=e.dataLevel,a=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,h=!e.opts.allErrors,u="data"+(o||""),d=e.opts.$data&&a&&a.$data;d?(i+=" var schema"+n+" = "+e.util.getData(a.$data,o,e.dataPathArr)+"; ",r="schema"+n):r=a,i+="var division"+n+";if (",d&&(i+=" "+r+" !== undefined && ( typeof "+r+" != 'number' || "),i+=" (division"+n+" = "+u+" / "+r+", ",e.opts.multipleOfPrecision?i+=" Math.abs(Math.round(division"+n+") - division"+n+") > 1e-"+e.opts.multipleOfPrecision+" ":i+=" division"+n+" !== parseInt(division"+n+") ",i+=" ) ",d&&(i+="  )  "),i+=" ) {   ";var p=p||[];p.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { multipleOf: "+r+" } ",!1!==e.opts.messages&&(i+=" , message: 'should be multiple of ",i+=d?"' + "+r:r+"'"),e.opts.verbose&&(i+=" , schema:  ",i+=d?"validate.schema"+l:""+a,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";var f=i;return i=p.pop(),!e.compositeRule&&h?e.async?i+=" throw new ValidationError(["+f+"]); ":i+=" validate.errors = ["+f+"]; return false; ":i+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",h&&(i+=" else { "),i}},function(e,t,s){"use strict";e.exports=function(e,t,s){var r=" ",i=e.level,n=e.dataLevel,o=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,h="data"+(n||""),u="errs__"+i,d=e.util.copy(e);d.level++;var p="valid"+d.level;if(e.opts.strictKeywords?"object"==typeof o&&Object.keys(o).length>0:e.util.schemaHasRules(o,e.RULES.all)){d.schema=o,d.schemaPath=a,d.errSchemaPath=l,r+=" var "+u+" = errors;  ";var f,m=e.compositeRule;e.compositeRule=d.compositeRule=!0,d.createErrors=!1,d.opts.allErrors&&(f=d.opts.allErrors,d.opts.allErrors=!1),r+=" "+e.validate(d)+" ",d.createErrors=!0,f&&(d.opts.allErrors=f),e.compositeRule=d.compositeRule=m,r+=" if ("+p+") {   ";var v=v||[];v.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(r+=" , message: 'should NOT be valid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),r+=" } "):r+=" {} ";var g=r;r=v.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+g+"]); ":r+=" validate.errors = ["+g+"]; return false; ":r+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else {  errors = "+u+"; if (vErrors !== null) { if ("+u+") vErrors.length = "+u+"; else vErrors = null; } ",e.opts.allErrors&&(r+=" } ")}else r+="  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(r+=" , message: 'should NOT be valid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c&&(r+=" if (false) { ");return r}},function(e,t,s){"use strict";e.exports=function(e,t,s){var r=" ",i=e.level,n=e.dataLevel,o=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,h="data"+(n||""),u="valid"+i,d="errs__"+i,p=e.util.copy(e),f="";p.level++;var m="valid"+p.level,v=p.baseId,g="prevValid"+i,y="passingSchemas"+i;r+="var "+d+" = errors , "+g+" = false , "+u+" = false , "+y+" = null; ";var b=e.compositeRule;e.compositeRule=p.compositeRule=!0;var w=o;if(w)for(var _,E=-1,x=w.length-1;E<x;)_=w[E+=1],(e.opts.strictKeywords?"object"==typeof _&&Object.keys(_).length>0:e.util.schemaHasRules(_,e.RULES.all))?(p.schema=_,p.schemaPath=a+"["+E+"]",p.errSchemaPath=l+"/"+E,r+="  "+e.validate(p)+" ",p.baseId=v):r+=" var "+m+" = true; ",E&&(r+=" if ("+m+" && "+g+") { "+u+" = false; "+y+" = ["+y+", "+E+"]; } else { ",f+="}"),r+=" if ("+m+") { "+u+" = "+g+" = true; "+y+" = "+E+"; }";return e.compositeRule=p.compositeRule=b,r+=f+"if (!"+u+") {   var err =   ",!1!==e.createErrors?(r+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { passingSchemas: "+y+" } ",!1!==e.opts.messages&&(r+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),r+="} else {  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; }",e.opts.allErrors&&(r+=" } "),r}},function(e,t,s){"use strict";e.exports=function(e,t,s){var r,i=" ",n=e.level,o=e.dataLevel,a=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,h=!e.opts.allErrors,u="data"+(o||""),d=e.opts.$data&&a&&a.$data;d?(i+=" var schema"+n+" = "+e.util.getData(a.$data,o,e.dataPathArr)+"; ",r="schema"+n):r=a,i+="if ( ",d&&(i+=" ("+r+" !== undefined && typeof "+r+" != 'string') || "),i+=" !"+(d?"(new RegExp("+r+"))":e.usePattern(a))+".test("+u+") ) {   ";var p=p||[];p.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { pattern:  ",i+=d?""+r:""+e.util.toQuotedString(a),i+="  } ",!1!==e.opts.messages&&(i+=" , message: 'should match pattern \"",i+=d?"' + "+r+" + '":""+e.util.escapeQuotes(a),i+="\"' "),e.opts.verbose&&(i+=" , schema:  ",i+=d?"validate.schema"+l:""+e.util.toQuotedString(a),i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";var f=i;return i=p.pop(),!e.compositeRule&&h?e.async?i+=" throw new ValidationError(["+f+"]); ":i+=" validate.errors = ["+f+"]; return false; ":i+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",h&&(i+=" else { "),i}},function(e,t,s){"use strict";e.exports=function(e,t,s){var r=" ",i=e.level,n=e.dataLevel,o=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,h="data"+(n||""),u="errs__"+i,d=e.util.copy(e),p="";d.level++;var f="valid"+d.level,m="key"+i,v="idx"+i,g=d.dataLevel=e.dataLevel+1,y="data"+g,b="dataProperties"+i,w=Object.keys(o||{}),_=e.schema.patternProperties||{},E=Object.keys(_),x=e.schema.additionalProperties,P=w.length||E.length,S=!1===x,C="object"==typeof x&&Object.keys(x).length,T=e.opts.removeAdditional,M=S||C||T,A=e.opts.ownProperties,O=e.baseId,R=e.schema.required;if(R&&(!e.opts.$data||!R.$data)&&R.length<e.opts.loopRequired)var D=e.util.toHash(R);if(r+="var "+u+" = errors;var "+f+" = true;",A&&(r+=" var "+b+" = undefined;"),M){if(r+=A?" "+b+" = "+b+" || Object.keys("+h+"); for (var "+v+"=0; "+v+"<"+b+".length; "+v+"++) { var "+m+" = "+b+"["+v+"]; ":" for (var "+m+" in "+h+") { ",P){if(r+=" var isAdditional"+i+" = !(false ",w.length)if(w.length>8)r+=" || validate.schema"+a+".hasOwnProperty("+m+") ";else{var j=w;if(j)for(var k=-1,L=j.length-1;k<L;)Y=j[k+=1],r+=" || "+m+" == "+e.util.toQuotedString(Y)+" "}if(E.length){var N=E;if(N)for(var V=-1,I=N.length-1;V<I;)ie=N[V+=1],r+=" || "+e.usePattern(ie)+".test("+m+") "}r+=" ); if (isAdditional"+i+") { "}if("all"==T)r+=" delete "+h+"["+m+"]; ";else{var B=e.errorPath,z="' + "+m+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers)),S)if(T)r+=" delete "+h+"["+m+"]; ";else{r+=" "+f+" = false; ";var F=l;l=e.errSchemaPath+"/additionalProperties",(te=te||[]).push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { additionalProperty: '"+z+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is an invalid additional property":r+="should NOT have additional properties",r+="' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),r+=" } "):r+=" {} ";var $=r;r=te.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+$+"]); ":r+=" validate.errors = ["+$+"]; return false; ":r+=" var err = "+$+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l=F,c&&(r+=" break; ")}else if(C)if("failing"==T){r+=" var "+u+" = errors;  ";var U=e.compositeRule;e.compositeRule=d.compositeRule=!0,d.schema=x,d.schemaPath=e.schemaPath+".additionalProperties",d.errSchemaPath=e.errSchemaPath+"/additionalProperties",d.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers);var H=h+"["+m+"]";d.dataPathArr[g]=m;var G=e.validate(d);d.baseId=O,e.util.varOccurences(G,y)<2?r+=" "+e.util.varReplace(G,y,H)+" ":r+=" var "+y+" = "+H+"; "+G+" ",r+=" if (!"+f+") { errors = "+u+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+h+"["+m+"]; }  ",e.compositeRule=d.compositeRule=U}else{d.schema=x,d.schemaPath=e.schemaPath+".additionalProperties",d.errSchemaPath=e.errSchemaPath+"/additionalProperties",d.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers);H=h+"["+m+"]";d.dataPathArr[g]=m;G=e.validate(d);d.baseId=O,e.util.varOccurences(G,y)<2?r+=" "+e.util.varReplace(G,y,H)+" ":r+=" var "+y+" = "+H+"; "+G+" ",c&&(r+=" if (!"+f+") break; ")}e.errorPath=B}P&&(r+=" } "),r+=" }  ",c&&(r+=" if ("+f+") { ",p+="}")}var q=e.opts.useDefaults&&!e.compositeRule;if(w.length){var Q=w;if(Q)for(var Y,X=-1,W=Q.length-1;X<W;){var J=o[Y=Q[X+=1]];if(e.opts.strictKeywords?"object"==typeof J&&Object.keys(J).length>0:e.util.schemaHasRules(J,e.RULES.all)){var K=e.util.getProperty(Y),Z=(H=h+K,q&&void 0!==J.default);d.schema=J,d.schemaPath=a+K,d.errSchemaPath=l+"/"+e.util.escapeFragment(Y),d.errorPath=e.util.getPath(e.errorPath,Y,e.opts.jsonPointers),d.dataPathArr[g]=e.util.toQuotedString(Y);G=e.validate(d);if(d.baseId=O,e.util.varOccurences(G,y)<2){G=e.util.varReplace(G,y,H);var ee=H}else{ee=y;r+=" var "+y+" = "+H+"; "}if(Z)r+=" "+G+" ";else{if(D&&D[Y]){r+=" if ( "+ee+" === undefined ",A&&(r+=" || ! Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(Y)+"') "),r+=") { "+f+" = false; ";B=e.errorPath,F=l;var te,se=e.util.escapeQuotes(Y);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(B,Y,e.opts.jsonPointers)),l=e.errSchemaPath+"/required",(te=te||[]).push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+se+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+se+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),r+=" } "):r+=" {} ";$=r;r=te.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+$+"]); ":r+=" validate.errors = ["+$+"]; return false; ":r+=" var err = "+$+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l=F,e.errorPath=B,r+=" } else { "}else c?(r+=" if ( "+ee+" === undefined ",A&&(r+=" || ! Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(Y)+"') "),r+=") { "+f+" = true; } else { "):(r+=" if ("+ee+" !== undefined ",A&&(r+=" &&   Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(Y)+"') "),r+=" ) { ");r+=" "+G+" } "}}c&&(r+=" if ("+f+") { ",p+="}")}}if(E.length){var re=E;if(re)for(var ie,ne=-1,oe=re.length-1;ne<oe;){J=_[ie=re[ne+=1]];if(e.opts.strictKeywords?"object"==typeof J&&Object.keys(J).length>0:e.util.schemaHasRules(J,e.RULES.all)){d.schema=J,d.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(ie),d.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(ie),r+=A?" "+b+" = "+b+" || Object.keys("+h+"); for (var "+v+"=0; "+v+"<"+b+".length; "+v+"++) { var "+m+" = "+b+"["+v+"]; ":" for (var "+m+" in "+h+") { ",r+=" if ("+e.usePattern(ie)+".test("+m+")) { ",d.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers);H=h+"["+m+"]";d.dataPathArr[g]=m;G=e.validate(d);d.baseId=O,e.util.varOccurences(G,y)<2?r+=" "+e.util.varReplace(G,y,H)+" ":r+=" var "+y+" = "+H+"; "+G+" ",c&&(r+=" if (!"+f+") break; "),r+=" } ",c&&(r+=" else "+f+" = true; "),r+=" }  ",c&&(r+=" if ("+f+") { ",p+="}")}}}return c&&(r+=" "+p+" if ("+u+" == errors) {"),r=e.util.cleanUpCode(r)}},function(e,t,s){"use strict";e.exports=function(e,t,s){var r=" ",i=e.level,n=e.dataLevel,o=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,h="data"+(n||""),u="errs__"+i,d=e.util.copy(e);d.level++;var p="valid"+d.level;if(r+="var "+u+" = errors;",e.opts.strictKeywords?"object"==typeof o&&Object.keys(o).length>0:e.util.schemaHasRules(o,e.RULES.all)){d.schema=o,d.schemaPath=a,d.errSchemaPath=l;var f="key"+i,m="idx"+i,v="i"+i,g="' + "+f+" + '",y="data"+(d.dataLevel=e.dataLevel+1),b="dataProperties"+i,w=e.opts.ownProperties,_=e.baseId;w&&(r+=" var "+b+" = undefined; "),r+=w?" "+b+" = "+b+" || Object.keys("+h+"); for (var "+m+"=0; "+m+"<"+b+".length; "+m+"++) { var "+f+" = "+b+"["+m+"]; ":" for (var "+f+" in "+h+") { ",r+=" var startErrs"+i+" = errors; ";var E=f,x=e.compositeRule;e.compositeRule=d.compositeRule=!0;var P=e.validate(d);d.baseId=_,e.util.varOccurences(P,y)<2?r+=" "+e.util.varReplace(P,y,E)+" ":r+=" var "+y+" = "+E+"; "+P+" ",e.compositeRule=d.compositeRule=x,r+=" if (!"+p+") { for (var "+v+"=startErrs"+i+"; "+v+"<errors; "+v+"++) { vErrors["+v+"].propertyName = "+f+"; }   var err =   ",!1!==e.createErrors?(r+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { propertyName: '"+g+"' } ",!1!==e.opts.messages&&(r+=" , message: 'property name \\'"+g+"\\' is invalid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),c&&(r+=" break; "),r+=" } }"}return c&&(r+="  if ("+u+" == errors) {"),r=e.util.cleanUpCode(r)}},function(e,t,s){"use strict";e.exports=function(e,t,s){var r=" ",i=e.level,n=e.dataLevel,o=e.schema[t],a=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,h="data"+(n||""),u="valid"+i,d=e.opts.$data&&o&&o.$data;d&&(r+=" var schema"+i+" = "+e.util.getData(o.$data,n,e.dataPathArr)+"; ");var p="schema"+i;if(!d)if(o.length<e.opts.loopRequired&&e.schema.properties&&Object.keys(e.schema.properties).length){var f=[],m=o;if(m)for(var v,g=-1,y=m.length-1;g<y;){v=m[g+=1];var b=e.schema.properties[v];b&&(e.opts.strictKeywords?"object"==typeof b&&Object.keys(b).length>0:e.util.schemaHasRules(b,e.RULES.all))||(f[f.length]=v)}}else f=o;if(d||f.length){var w=e.errorPath,_=d||f.length>=e.opts.loopRequired,E=e.opts.ownProperties;if(c)if(r+=" var missing"+i+"; ",_){d||(r+=" var "+p+" = validate.schema"+a+"; ");var x="' + "+(A="schema"+i+"["+(C="i"+i)+"]")+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(w,A,e.opts.jsonPointers)),r+=" var "+u+" = true; ",d&&(r+=" if (schema"+i+" === undefined) "+u+" = true; else if (!Array.isArray(schema"+i+")) "+u+" = false; else {"),r+=" for (var "+C+" = 0; "+C+" < "+p+".length; "+C+"++) { "+u+" = "+h+"["+p+"["+C+"]] !== undefined ",E&&(r+=" &&   Object.prototype.hasOwnProperty.call("+h+", "+p+"["+C+"]) "),r+="; if (!"+u+") break; } ",d&&(r+="  }  "),r+="  if (!"+u+") {   ",(M=M||[]).push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+x+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+x+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),r+=" } "):r+=" {} ";var P=r;r=M.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+P+"]); ":r+=" validate.errors = ["+P+"]; return false; ":r+=" var err = "+P+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { "}else{r+=" if ( ";var S=f;if(S)for(var C=-1,T=S.length-1;C<T;){R=S[C+=1],C&&(r+=" || "),r+=" ( ( "+(L=h+(k=e.util.getProperty(R)))+" === undefined ",E&&(r+=" || ! Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(R)+"') "),r+=") && (missing"+i+" = "+e.util.toQuotedString(e.opts.jsonPointers?R:k)+") ) "}r+=") {  ";var M;x="' + "+(A="missing"+i)+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(w,A,!0):w+" + "+A),(M=M||[]).push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+x+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+x+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),r+=" } "):r+=" {} ";P=r;r=M.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+P+"]); ":r+=" validate.errors = ["+P+"]; return false; ":r+=" var err = "+P+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { "}else if(_){d||(r+=" var "+p+" = validate.schema"+a+"; ");var A;x="' + "+(A="schema"+i+"["+(C="i"+i)+"]")+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(w,A,e.opts.jsonPointers)),d&&(r+=" if ("+p+" && !Array.isArray("+p+")) {  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+x+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+x+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+p+" !== undefined) { "),r+=" for (var "+C+" = 0; "+C+" < "+p+".length; "+C+"++) { if ("+h+"["+p+"["+C+"]] === undefined ",E&&(r+=" || ! Object.prototype.hasOwnProperty.call("+h+", "+p+"["+C+"]) "),r+=") {  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+x+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+x+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",d&&(r+="  }  ")}else{var O=f;if(O)for(var R,D=-1,j=O.length-1;D<j;){R=O[D+=1];var k=e.util.getProperty(R),L=(x=e.util.escapeQuotes(R),h+k);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(w,R,e.opts.jsonPointers)),r+=" if ( "+L+" === undefined ",E&&(r+=" || ! Object.prototype.hasOwnProperty.call("+h+", '"+e.util.escapeQuotes(R)+"') "),r+=") {  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+x+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+x+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}e.errorPath=w}else c&&(r+=" if (true) {");return r}},function(e,t,s){"use strict";e.exports=function(e,t,s){var r,i=" ",n=e.level,o=e.dataLevel,a=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,h=!e.opts.allErrors,u="data"+(o||""),d="valid"+n,p=e.opts.$data&&a&&a.$data;if(p?(i+=" var schema"+n+" = "+e.util.getData(a.$data,o,e.dataPathArr)+"; ",r="schema"+n):r=a,(a||p)&&!1!==e.opts.uniqueItems){p&&(i+=" var "+d+"; if ("+r+" === false || "+r+" === undefined) "+d+" = true; else if (typeof "+r+" != 'boolean') "+d+" = false; else { "),i+=" var i = "+u+".length , "+d+" = true , j; if (i > 1) { ";var f=e.schema.items&&e.schema.items.type,m=Array.isArray(f);if(!f||"object"==f||"array"==f||m&&(f.indexOf("object")>=0||f.indexOf("array")>=0))i+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+u+"[i], "+u+"[j])) { "+d+" = false; break outer; } } } ";else{i+=" var itemIndices = {}, item; for (;i--;) { var item = "+u+"[i]; ";var v="checkDataType"+(m?"s":"");i+=" if ("+e.util[v](f,"item",!0)+") continue; ",m&&(i+=" if (typeof item == 'string') item = '\"' + item; "),i+=" if (typeof itemIndices[item] == 'number') { "+d+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } "}i+=" } ",p&&(i+="  }  "),i+=" if (!"+d+") {   ";var g=g||[];g.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { i: i, j: j } ",!1!==e.opts.messages&&(i+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),e.opts.verbose&&(i+=" , schema:  ",i+=p?"validate.schema"+l:""+a,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),i+=" } "):i+=" {} ";var y=i;i=g.pop(),!e.compositeRule&&h?e.async?i+=" throw new ValidationError(["+y+"]); ":i+=" validate.errors = ["+y+"]; return false; ":i+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } ",h&&(i+=" else { ")}else h&&(i+=" if (true) { ");return i}},function(e,t,s){"use strict";var r=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"];e.exports=function(e,t){for(var s=0;s<t.length;s++){e=JSON.parse(JSON.stringify(e));var i,n=t[s].split("/"),o=e;for(i=1;i<n.length;i++)o=o[n[i]];for(i=0;i<r.length;i++){var a=r[i],l=o[a];l&&(o[a]={anyOf:[l,{$ref:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#"}]})}}return e}},function(e,t,s){"use strict";var r=s(59).MissingRef;e.exports=function e(t,s,i){var n=this;if("function"!=typeof this._opts.loadSchema)throw new Error("options.loadSchema should be a function");"function"==typeof s&&(i=s,s=void 0);var o=a(t).then((function(){var e=n._addSchema(t,void 0,s);return e.validate||function e(t){try{return n._compile(t)}catch(i){if(i instanceof r)return function(r){var i=r.missingSchema;if(c(i))throw new Error("Schema "+i+" is loaded but "+r.missingRef+" cannot be resolved");var o=n._loadingSchemas[i];o||(o=n._loadingSchemas[i]=n._opts.loadSchema(i)).then(l,l);return o.then((function(e){if(!c(i))return a(e).then((function(){c(i)||n.addSchema(e,i,void 0,s)}))})).then((function(){return e(t)}));function l(){delete n._loadingSchemas[i]}function c(e){return n._refs[e]||n._schemas[e]}}(i);throw i}}(e)}));i&&o.then((function(e){i(null,e)}),i);return o;function a(t){var s=t.$schema;return s&&!n.getSchema(s)?e.call(n,{$ref:s},!0):Promise.resolve()}}},function(e,t,s){"use strict";var r=/^[a-z_$][a-z0-9_$-]*$/i,i=s(192),n=s(193);e.exports={add:function(e,t){var s=this.RULES;if(s.keywords[e])throw new Error("Keyword "+e+" is already defined");if(!r.test(e))throw new Error("Keyword "+e+" is not a valid identifier");if(t){this.validateKeyword(t,!0);var n=t.type;if(Array.isArray(n))for(var o=0;o<n.length;o++)l(e,n[o],t);else l(e,n,t);var a=t.metaSchema;a&&(t.$data&&this._opts.$data&&(a={anyOf:[a,{$ref:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#"}]}),t.validateSchema=this.compile(a,!0))}function l(e,t,r){for(var n,o=0;o<s.length;o++){var a=s[o];if(a.type==t){n=a;break}}n||(n={type:t,rules:[]},s.push(n));var l={keyword:e,definition:r,custom:!0,code:i,implements:r.implements};n.rules.push(l),s.custom[e]=l}return s.keywords[e]=s.all[e]=!0,this},get:function(e){var t=this.RULES.custom[e];return t?t.definition:this.RULES.keywords[e]||!1},remove:function(e){var t=this.RULES;delete t.keywords[e],delete t.all[e],delete t.custom[e];for(var s=0;s<t.length;s++)for(var r=t[s].rules,i=0;i<r.length;i++)if(r[i].keyword==e){r.splice(i,1);break}return this},validate:function e(t,s){e.errors=null;var r=this._validateKeyword=this._validateKeyword||this.compile(n,!0);if(r(t))return!0;e.errors=r.errors;if(s)throw new Error("custom keyword definition is invalid: "+this.errorsText(r.errors));return!1}}},function(e,t,s){"use strict";e.exports=function(e,t,s){var r,i,n=" ",o=e.level,a=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),h=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(a||""),p="valid"+o,f="errs__"+o,m=e.opts.$data&&l&&l.$data;m?(n+=" var schema"+o+" = "+e.util.getData(l.$data,a,e.dataPathArr)+"; ",i="schema"+o):i=l;var v,g,y,b,w,_="definition"+o,E=this.definition,x="";if(m&&E.$data){w="keywordValidate"+o;var P=E.validateSchema;n+=" var "+_+" = RULES.custom['"+t+"'].definition; var "+w+" = "+_+".validate;"}else{if(!(b=e.useCustomRule(this,l,e.schema,e)))return;i="validate.schema"+c,w=b.code,v=E.compile,g=E.inline,y=E.macro}var S=w+".errors",C="i"+o,T="ruleErr"+o,M=E.async;if(M&&!e.async)throw new Error("async keyword in sync schema");if(g||y||(n+=S+" = null;"),n+="var "+f+" = errors;var "+p+";",m&&E.$data&&(x+="}",n+=" if ("+i+" === undefined) { "+p+" = true; } else { ",P&&(x+="}",n+=" "+p+" = "+_+".validateSchema("+i+"); if ("+p+") { ")),g)E.statements?n+=" "+b.validate+" ":n+=" "+p+" = "+b.validate+"; ";else if(y){var A=e.util.copy(e);x="";A.level++;var O="valid"+A.level;A.schema=b.validate,A.schemaPath="";var R=e.compositeRule;e.compositeRule=A.compositeRule=!0;var D=e.validate(A).replace(/validate\.schema/g,w);e.compositeRule=A.compositeRule=R,n+=" "+D}else{(N=N||[]).push(n),n="",n+="  "+w+".call( ",e.opts.passContext?n+="this":n+="self",v||!1===E.schema?n+=" , "+d+" ":n+=" , "+i+" , "+d+" , validate.schema"+e.schemaPath+" ",n+=" , (dataPath || '')",'""'!=e.errorPath&&(n+=" + "+e.errorPath);var j=a?"data"+(a-1||""):"parentData",k=a?e.dataPathArr[a]:"parentDataProperty",L=n+=" , "+j+" , "+k+" , rootData )  ";n=N.pop(),!1===E.errors?(n+=" "+p+" = ",M&&(n+="await "),n+=L+"; "):n+=M?" var "+(S="customErrors"+o)+" = null; try { "+p+" = await "+L+"; } catch (e) { "+p+" = false; if (e instanceof ValidationError) "+S+" = e.errors; else throw e; } ":" "+S+" = null; "+p+" = "+L+"; "}if(E.modifying&&(n+=" if ("+j+") "+d+" = "+j+"["+k+"];"),n+=""+x,E.valid)u&&(n+=" if (true) { ");else{var N;n+=" if ( ",void 0===E.valid?(n+=" !",n+=y?""+O:""+p):n+=" "+!E.valid+" ",n+=") { ",r=this.keyword,(N=N||[]).push(n),n="",(N=N||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: '"+(r||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(h)+" , params: { keyword: '"+this.keyword+"' } ",!1!==e.opts.messages&&(n+=" , message: 'should pass \""+this.keyword+"\" keyword validation' "),e.opts.verbose&&(n+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var V=n;n=N.pop(),!e.compositeRule&&u?e.async?n+=" throw new ValidationError(["+V+"]); ":n+=" validate.errors = ["+V+"]; return false; ":n+=" var err = "+V+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var I=n;n=N.pop(),g?E.errors?"full"!=E.errors&&(n+="  for (var "+C+"="+f+"; "+C+"<errors; "+C+"++) { var "+T+" = vErrors["+C+"]; if ("+T+".dataPath === undefined) "+T+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+T+".schemaPath === undefined) { "+T+'.schemaPath = "'+h+'"; } ',e.opts.verbose&&(n+=" "+T+".schema = "+i+"; "+T+".data = "+d+"; "),n+=" } "):!1===E.errors?n+=" "+I+" ":(n+=" if ("+f+" == errors) { "+I+" } else {  for (var "+C+"="+f+"; "+C+"<errors; "+C+"++) { var "+T+" = vErrors["+C+"]; if ("+T+".dataPath === undefined) "+T+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+T+".schemaPath === undefined) { "+T+'.schemaPath = "'+h+'"; } ',e.opts.verbose&&(n+=" "+T+".schema = "+i+"; "+T+".data = "+d+"; "),n+=" } } "):y?(n+="   var err =   ",!1!==e.createErrors?(n+=" { keyword: '"+(r||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(h)+" , params: { keyword: '"+this.keyword+"' } ",!1!==e.opts.messages&&(n+=" , message: 'should pass \""+this.keyword+"\" keyword validation' "),e.opts.verbose&&(n+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&u&&(e.async?n+=" throw new ValidationError(vErrors); ":n+=" validate.errors = vErrors; return false; ")):!1===E.errors?n+=" "+I+" ":(n+=" if (Array.isArray("+S+")) { if (vErrors === null) vErrors = "+S+"; else vErrors = vErrors.concat("+S+"); errors = vErrors.length;  for (var "+C+"="+f+"; "+C+"<errors; "+C+"++) { var "+T+" = vErrors["+C+"]; if ("+T+".dataPath === undefined) "+T+".dataPath = (dataPath || '') + "+e.errorPath+";  "+T+'.schemaPath = "'+h+'";  ',e.opts.verbose&&(n+=" "+T+".schema = "+i+"; "+T+".data = "+d+"; "),n+=" } } else { "+I+" } "),n+=" } ",u&&(n+=" else { ")}return n}},function(e,t,s){"use strict";var r=s(91);e.exports={$id:"https://github.com/epoberezkin/ajv/blob/master/lib/definition_schema.js",definitions:{simpleTypes:r.definitions.simpleTypes},type:"object",dependencies:{schema:["validate"],$data:["validate"],statements:["inline"],valid:{not:{required:["macro"]}}},properties:{type:r.properties.type,schema:{type:"boolean"},statements:{type:"boolean"},dependencies:{type:"array",items:{type:"string"}},metaSchema:{type:"object"},modifying:{type:"boolean"},valid:{type:"boolean"},$data:{type:"boolean"},async:{type:"boolean"},errors:{anyOf:[{type:"boolean"},{const:"full"}]}}}},function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#","description":"Meta-schema for $data reference (JSON Schema extension proposal)","type":"object","required":["$data"],"properties":{"$data":{"type":"string","anyOf":[{"format":"relative-json-pointer"},{"format":"json-pointer"}]}},"additionalProperties":false}')},function(e){e.exports=JSON.parse('{"$id":"https://schemas.3d.si.edu/voyager/document.schema.json","$schema":"http://json-schema.org/draft-07/schema#","title":"Smithsonian 3D Document","description":"Describes a 3D document containing a scene with 3D models.","definitions":{"scene":{"$id":"#scene","type":"object","properties":{"nodes":{"type":"array","description":"The indices of the scene\'s root nodes.","items":{"type":"integer","minimum":0},"uniqueItems":true,"minItems":1},"setup":{"description":"The index of the scene\'s setup.","type":"integer","minimum":0}}},"node":{"$id":"#node","type":"object","properties":{"name":{"type":"string"},"children":{"type":"array","description":"The indices of this node\'s children.","items":{"type":"integer","minimum":0},"uniqueItems":true,"minItems":1},"matrix":{"description":"A floating-point 4x4 transformation matrix stored in column-major order.","type":"array","items":{"type":"number"},"minItems":16,"maxItems":16,"default":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},"translation":{"description":"The node\'s translation along the x, y, and z axes.","type":"array","items":{"type":"number"},"minItems":3,"maxItems":3,"default":[0,0,0]},"rotation":{"description":"The node\'s unit quaternion rotation in the order (x, y, z, w), where w is the scalar.","type":"array","items":{"type":"number","minimum":-1,"maximum":1},"minItems":4,"maxItems":4,"default":[0,0,0,1]},"scale":{"description":"The node\'s non-uniform scale, given as the scaling factors along the x, y, and z axes.","type":"array","items":{"type":"number"},"minItems":3,"maxItems":3,"default":[1,1,1]},"camera":{"description":"The index of the camera component of this node.","type":"integer","minimum":0},"light":{"description":"The index of the light component of this node.","type":"integer","minimum":0},"meta":{"description":"The index of the meta data component of this node.","type":"integer","minimum":0},"model":{"description":"The index of the model component of this node.","type":"integer","minimum":0}},"not":{"anyOf":[{"required":["matrix","translation"]},{"required":["matrix","rotation"]},{"required":["matrix","scale"]}]}},"camera":{"$id":"#camera","type":"object","properties":{"type":{"description":"Specifies if the camera uses a perspective or orthographic projection.","type":"string","enum":["perspective","orthographic"]},"perspective":{"description":"A perspective camera containing properties to create a perspective projection matrix.","type":"object","properties":{"yfov":{"type":"number","description":"The floating-point vertical field of view in radians.","exclusiveMinimum":0},"aspectRatio":{"type":"number","description":"The floating-point aspect ratio of the field of view.","exclusiveMinimum":0},"znear":{"type":"number","description":"The floating-point distance to the near clipping plane.","exclusiveMinimum":0},"zfar":{"type":"number","description":"The floating-point distance to the far clipping plane.","exclusiveMinimum":0}},"required":["yfov","znear"]},"orthographic":{"description":"An orthographic camera containing properties to create an orthographic projection matrix.","type":"object","properties":{"xmag":{"type":"number","description":"The floating-point horizontal magnification of the view. Must not be zero."},"ymag":{"type":"number","description":"The floating-point vertical magnification of the view. Must not be zero."},"znear":{"type":"number","description":"The floating-point distance to the near clipping plane.","exclusiveMinimum":0},"zfar":{"type":"number","description":"The floating-point distance to the far clipping plane. `zfar` must be greater than `znear`.","exclusiveMinimum":0}},"required":["xmag","ymag","znear","zfar"]}},"required":["type"],"not":{"required":["perspective","orthographic"]}},"light":{"$id":"#light","type":"object","properties":{"type":{"description":"Specifies the type of the light source.","type":"string","enum":["ambient","directional","point","spot","hemisphere"]},"color":{"$ref":"#/definitions/colorRGB"},"intensity":{"type":"number","minimum":0,"default":1},"castShadow":{"type":"boolean","default":false},"point":{"type":"object","properties":{"distance":{"type":"number","minimum":0},"decay":{"type":"number","minimum":0}}},"spot":{"type":"object","properties":{"distance":{"type":"number","minimum":0},"decay":{"type":"number","minimum":0},"angle":{"type":"number","minimum":0},"penumbra":{"type":"number","minimum":0}}},"hemisphere":{"type":"object","properties":{"groundColor":{"$ref":"#/definitions/colorRGB"}}}},"required":["type"],"not":{"required":["point","spot","hemisphere"]}},"colorRGB":{"$id":"#colorRGB","type":"array","items":{"type":"number","minimum":0,"maximum":1},"minItems":3,"maxItems":3,"default":[1,1,1]}},"type":"object","properties":{"asset":{"type":"object","properties":{"type":{"type":"string","const":"application/si-dpo-3d.document+json"},"version":{"description":"Version of this presentation description.","type":"string","minLength":1},"copyright":{"description":"A copyright message to credit the content creator.","type":"string","minLength":1},"generator":{"description":"Tool that generated this presentation description.","type":"string","minLength":1}},"required":["type","version"]},"scene":{"description":"Index of the root scene of the document.","type":"integer","minimum":0},"scenes":{"description":"An array of scenes.","type":"array","items":{"$ref":"#/definitions/scene"}},"nodes":{"description":"An array of nodes.","type":"array","items":{"$ref":"#/definitions/node"},"minItems":1},"metas":{"description":"An array of meta data components.","type":"array","items":{"$ref":"./meta.schema.json"}},"setups":{"description":"An array of setup components.","type":"array","items":{"$ref":"./setup.schema.json"},"minItems":1},"cameras":{"description":"An array of camera components.","type":"array","items":{"$ref":"#/definitions/camera"},"minItems":1},"lights":{"description":"An array of light components.","type":"array","items":{"$ref":"#/definitions/light"},"minItems":1},"models":{"description":"An array of model components.","type":"array","items":{"$ref":"./model.schema.json"},"minItems":1}},"required":["asset","scene","scenes"],"additionalProperties":false}')},function(e){e.exports=JSON.parse('{"$id":"https://schemas.3d.si.edu/voyager/common.schema.json","$schema":"http://json-schema.org/draft-07/schema#","title":"Math","description":"Definitions for mathematical compound objects such as vectors and matrices.","definitions":{"units":{"$id":"#units","type":"string","enum":["inherit","mm","cm","m","km","in","ft","yd","mi"]},"vector2":{"description":"2-component vector.","$id":"#vector2","type":"array","items":{"type":"number"},"minItems":2,"maxItems":2,"default":[0,0]},"vector3":{"description":"3-component vector.","$id":"#vector3","type":"array","items":{"type":"number"},"minItems":3,"maxItems":3,"default":[0,0,0]},"vector4":{"description":"4-component vector.","$id":"#vector4","type":"array","items":{"type":"number"},"minItems":4,"maxItems":4,"default":[0,0,0,0]},"matrix3":{"description":"3 by 3, matrix, storage: column-major.","$id":"#matrix3","type":"array","items":{"type":"number"},"minItems":9,"maxItems":9,"default":[1,0,0,0,1,0,0,0,1]},"matrix4":{"description":"4 by 4 matrix, storage: column-major.","$id":"#matrix4","type":"array","items":{"type":"number"},"minItems":16,"maxItems":16,"default":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},"boundingBox":{"description":"Axis-aligned 3D bounding box.","$id":"#boundingBox","type":"object","properties":{"min":{"$ref":"#/definitions/vector3"},"max":{"$ref":"#/definitions/vector3"}},"required":["min","max"]}}}')},function(e){e.exports=JSON.parse('{"$id":"https://schemas.3d.si.edu/voyager/meta.schema.json","$schema":"http://json-schema.org/draft-07/schema#","title":"Meta","description":"Meta data for a scene or model item.","definitions":{"image":{"$id":"image","description":"Reference to a preview image","type":"object","properties":{"uri":{"description":"Location of the image resource, absolute URL or path relative to this document","type":"string","minLength":1},"quality":{"type":"string","enum":["Thumb","Low","Medium","High"]},"byteSize":{"type":"integer","minimum":1},"width":{"type":"integer","minimum":1},"height":{"type":"integer","minimum":1}},"required":["uri","quality"]},"article":{"$id":"#article","description":"Reference to an external document (HTML)","type":"object","properties":{"id":{"type":"string","minLength":1},"title":{"description":"Short title.","type":"string"},"lead":{"description":"Short lead text.","type":"string"},"tags":{"description":"Array of tags, categorizing the article.","type":"array","items":{"type":"string"}},"uri":{"description":"Location of the article resource, absolute URL or path relative to this document","type":"string","minLength":1},"mimeType":{"description":"MIME type of the resource.","type":"string"},"thumbnailUri":{"description":"Location of a thumbnail/preview image of the resource.","type":"string"}},"required":["id","uri"],"additionalProperties":false}},"type":"object","properties":{"collection":{"description":"Information retrieved from the collection record for the item.","type":"object"},"process":{"description":"Information about how the item was processed.","type":"object"},"images":{"type":"array","items":{"$ref":"#/definitions/image"},"minLength":1},"articles":{"type":"array","items":{"$ref":"#/definitions/article"},"minLength":1},"leadArticle":{"description":"Index of the main article. This is the default article displayed with the item.","type":"integer","minimum":0}},"additionalProperties":false}')},function(e){e.exports=JSON.parse('{"$id":"https://schemas.3d.si.edu/voyager/model.schema.json","$schema":"http://json-schema.org/draft-07/schema#","title":"Model","description":"Describes the visual representations (models, derivatives) of a 3D item.","definitions":{"annotation":{"description":"Spatial annotation (hot spot, hot zone) on a model. Annotations can reference articles.","type":"object","properties":{"id":{"type":"string","minLength":1},"title":{"type":"string"},"lead":{"type":"string"},"marker":{"type":"string"},"tags":{"description":"Array of tags, categorizing the annotation.","type":"array","items":{"type":"string"}},"articleId":{"description":"Id of an article related to this annotation.","type":"string","minLength":1},"imageUri":{"description":"URI of an image resource for this annotation.","type":"string","minLength":1},"style":{"type":"string"},"visible":{"description":"Flag indicating whether the annotation is visible.","type":"boolean","default":true},"expanded":{"description":"Flag indicating whether the annotation is displayed in expanded state.","type":"boolean","default":false},"scale":{"description":"Scales the annotation relative to its default size.","type":"number","default":1},"offset":{"description":"Offsets the annotation along its direction.","type":"number","default":0},"tilt":{"description":"Tilt angle of the annotation relative to the direction vector in degrees.","type":"number","default":0},"azimuth":{"description":"Azimuth angle of a tilted annotation.","type":"number","default":0},"color":{"description":"Color of the annotation","type":"array","minLength":3,"maxLength":3,"items":{"type":"number"}},"position":{"description":"Position where the annotation is anchored, in local item coordinates.","$ref":"./common.schema.json#/definitions/vector3"},"direction":{"description":"Direction of the stem of this annotation, usually corresponds to the surface normal.","$ref":"./common.schema.json#/definitions/vector3"},"zoneIndex":{"description":"Index of the zone on the zone texture.","type":"integer","minimum":0}},"required":["id"],"additionalProperties":false},"derivative":{"description":"Visual representation derived from the master model.","type":"object","properties":{"usage":{"description":"usage categories for a derivative.","type":"string","enum":["Image2D","Web3D","Print3D","Editorial3D"]},"quality":{"type":"string","enum":["Thumb","Low","Medium","High","Highest","LOD","Stream"]},"assets":{"description":"List of individual resources this derivative is composed of.","type":"array","items":{"$ref":"#/definitions/asset"}}}},"asset":{"description":"an individual resource for a 3D model.","type":"object","properties":{"uri":{"type":"string","minLength":1},"type":{"type":"string","enum":["Model","Geometry","Image","Texture","Points","Volume"]},"part":{"type":"string","minLength":1},"mimeType":{"type":"string","minLength":1},"byteSize":{"type":"integer","minimum":1},"numFaces":{"type":"integer","minimum":1},"imageSize":{"type":"integer","minimum":1},"mapType":{"type":"string","enum":["Color","Normal","Occlusion","Emissive","MetallicRoughness","Zone"]}},"required":["uri","type"]},"material":{"description":"Surface properties for this model, shared by all derivatives.","type":"object","properties":{}}},"type":"object","properties":{"units":{"$ref":"./common.schema.json#/definitions/units"},"tags":{"type":"string"},"visible":{"type":"boolean"},"derivatives":{"type":"array","items":{"$ref":"#/definitions/derivative"}},"translation":{"description":"Translation vector. Must be applied to bring model into its \'neutral\' pose.","$ref":"./common.schema.json#/definitions/vector3"},"rotation":{"description":"Rotation quaternion. Must be applied to bring model into its \'neutral\' pose.","$ref":"./common.schema.json#/definitions/vector4"},"boundingBox":{"description":"Bounding box for this model, shared by all derivatives.","$ref":"./common.schema.json#/definitions/boundingBox"},"material":{"$ref":"#/definitions/material"},"annotations":{"description":"List of annotations to be displayed with the model","type":"array","items":{"$ref":"#/definitions/annotation"}}},"required":["units","derivatives"],"additionalProperties":false}')},function(e){e.exports=JSON.parse('{"$id":"https://schemas.3d.si.edu/voyager/setup.schema.json","$schema":"http://json-schema.org/draft-07/schema#","title":"Setup","description":"Tours and settings for explorer documents (background, interface, etc.)","definitions":{"viewer":{"type":"object","properties":{"shader":{"type":"string"},"exposure":{"type":"number"},"gamma":{"type":"number"},"annotationsVisible":{"type":"boolean"},"activeTags":{"type":"string"},"sortedTags":{"type":"string"},"radioTags":{"type":"boolean"}},"required":["shader","exposure","gamma"]},"reader":{"type":"object","properties":{"enabled":{"type":"boolean"},"position":{"type":"string"},"articleId":{"description":"Id of the article currently displayed in the reader.","type":"string","minLength":1}}},"interface":{"type":"object","properties":{"visible":{"type":"boolean"},"logo":{"type":"boolean"},"menu":{"type":"boolean"},"tools":{"type":"boolean"}}},"navigation":{"type":"object","properties":{"type":{"type":"string","enum":["Orbit","Walk"]},"enabled":{"type":"boolean"},"autoZoom":{"type":"boolean"},"orbit":{"$comment":"TODO: Implement","type":"object","properties":{}},"walk":{"$comment":"TODO: Implement","type":"object","properties":{}}}},"background":{"type":"object","properties":{"style":{"type":"string","enum":["Solid","LinearGradient","RadialGradient"]},"color0":{"$ref":"./common.schema.json#/definitions/vector3"},"color1":{"$ref":"./common.schema.json#/definitions/vector3"}}},"floor":{"type":"object","properties":{"visible":{"type":"boolean"},"position":{"$ref":"./common.schema.json#/definitions/vector3"},"size":{"type":"number"},"color":{"$ref":"./common.schema.json#/definitions/vector3"},"opacity":{"type":"number"},"receiveShadow":{"type":"boolean"}}},"grid":{"type":"object","properties":{"visible":{"type":"boolean"},"color":{"$ref":"./common.schema.json#/definitions/vector3"}}},"tape":{"type":"object","properties":{"enabled":{"type":"boolean"},"startPosition":{"$ref":"./common.schema.json#/definitions/vector3"},"startDirection":{"$ref":"./common.schema.json#/definitions/vector3"},"endPosition":{"$ref":"./common.schema.json#/definitions/vector3"},"endDirection":{"$ref":"./common.schema.json#/definitions/vector3"}}},"slicer":{"type":"object","properties":{"enabled":{"type":"boolean"},"axis":{"type":"string","enum":["X","Y","Z"]},"inverted":{"type":"boolean"},"position":{"type":"number"}}},"tours":{"description":"Animated tours.","type":"array","items":{"type":"object","properties":{"title":{"type":"string"},"lead":{"type":"string"},"tags":{"description":"Array of tags, categorizing the tour.","type":"array","items":{"type":"string"}},"steps":{"type":"array","items":{"type":"object","properties":{"title":{"type":"string"},"id":{"type":"string"}}}}}}},"snapshots":{"description":"Snapshots are animatable scene states.","type":"object","properties":{"features":{"type":"array","items":{"type":"string"}},"targets":{"type":"array","items":{"type":"string"}},"states":{"type":"array","items":{"type":"object"}}}}},"type":"object","properties":{"units":{"$ref":"./common.schema.json#/definitions/units"},"interface":{"$ref":"#/definitions/interface"},"viewer":{"$ref":"#/definitions/viewer"},"reader":{"$ref":"#/definitions/reader"},"navigation":{"$ref":"#/definitions/navigation"},"background":{"$ref":"#/definitions/background"},"floor":{"$ref":"#/definitions/floor"},"grid":{"$ref":"#/definitions/grid"},"tape":{"$ref":"#/definitions/tape"},"slicer":{"$ref":"#/definitions/slicer"},"tours":{"$ref":"#/definitions/tours"}}}')},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(0),n=s(35);t.EProjection=n.EProjection;const o=s(11),a=s(12),l=new r.Vector3,c=new r.Vector3,h=new r.Euler,u=new r.Quaternion;class d extends o.default{constructor(e,t){super(e,t),this.ins=this.addInputs(d.camIns),this.object3D=new n.default}get camera(){return this.object3D}update(){const{autoActivate:e,activate:t}=this.ins;if(t.changed||e.changed&&e.value){const e=this.scene;e&&(e.activeCameraComponent=this)}const s=this.camera,{position:r,rotation:i,projection:n,fov:o,size:a,zoom:l,near:c,far:h}=this.ins;return(r.changed||i.changed)&&(s.position.fromArray(r.value),s.rotation.fromArray(i.value),s.updateMatrix()),n.changed&&s.setProjection(n.getValidatedValue()),s.fov=o.value,s.size=a.value,s.zoom=l.value,s.near=c.value,s.far=h.value,s.updateProjectionMatrix(),!0}dispose(){const e=this.scene;e&&e.activeCameraComponent===this&&(e.activeCameraComponent=null),super.dispose()}setPropertiesFromMatrix(e){const t=!e;e=e||this.object3D.matrix;const{position:s,rotation:r,order:i}=this.ins;e.decompose(l,u,c),l.toArray(s.value);const n=i.getOptionText();h.setFromQuaternion(u,n),h.toVector3(l),l.multiplyScalar(a.default.RAD2DEG).toArray(r.value),s.set(t),r.set(t)}}t.default=d,d.typeName="CCamera",d.camIns={autoActivate:i.types.Boolean("Camera.AutoActivate",!0),activate:i.types.Event("Camera.Activate"),position:i.types.Vector3("Transform.Position"),rotation:i.types.Vector3("Transform.Rotation"),order:i.types.Enum("Transform.Order",o.ERotationOrder,o.ERotationOrder.ZYX),projection:i.types.Enum("Projection.Type",n.EProjection,n.EProjection.Perspective),fov:i.types.Number("Projection.FovY",52),size:i.types.Number("Projection.Size",20),zoom:i.types.Number("Projection.Zoom",1),near:i.types.Number("Frustum.ZNear",.01),far:i.types.Number("Frustum.ZFar",1e4)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(14);t.CLight=r.default},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(0),n=s(14);class o extends n.default{constructor(e,t){super(e,t),this.ins=this.addInputs(o.dirLightIns),this.object3D=new r.DirectionalLight,this.light.target.matrixAutoUpdate=!1}get light(){return this.object3D}update(e){super.update(e);const t=this.light,s=this.ins;if((s.position.changed||s.target.changed)&&(t.position.fromArray(s.position.value),t.target.position.fromArray(s.target.value),t.updateMatrix(),t.target.updateMatrix()),s.shadowSize.changed){const e=t.shadow.camera,r=.5*s.shadowSize.value;e.left=e.bottom=-r,e.right=e.top=r,e.updateProjectionMatrix()}return!0}onAddToParent(e){super.onAddToParent(e),e.add(this.light.target)}onRemoveFromParent(e){super.onRemoveFromParent(e),e.remove(this.light.target)}}t.default=o,o.typeName="CDirectionalLight",o.dirLightIns={position:i.types.Vector3("Light.Position"),target:i.types.Vector3("Light.Target",[0,-1,0]),shadowSize:i.types.Number("Shadow.Size",100)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(0),n=s(14);new r.Vector3;class o extends n.default{constructor(e,t){super(e,t),this.ins=this.addInputs(o.pointLightIns),this.object3D=new r.PointLight}get light(){return this.object3D}update(e){super.update(e);const t=this.light,s=this.ins;return s.position.changed&&(t.position.fromArray(s.position.value),t.updateMatrix()),(s.distance.changed||s.decay.changed)&&(t.distance=s.distance.value,t.decay=s.decay.value),t.updateMatrix(),!0}}t.default=o,o.typeName="CPointLight",o.pointLightIns={position:i.types.Vector3("Light.Position"),distance:i.types.Number("Light.Distance"),decay:i.types.Number("Light.Decay",1)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(0),n=s(14);class o extends n.default{constructor(e,t){super(e,t),this.ins=this.addInputs(o.spotLightIns),this.object3D=new r.SpotLight,this.light.target.matrixAutoUpdate=!1}get light(){return this.object3D}update(e){super.update(e);const t=this.light,s=this.ins;return(s.position.changed||s.target.changed)&&(t.position.fromArray(s.position.value),t.target.position.fromArray(s.target.value),t.updateMatrix(),t.target.updateMatrix()),(s.distance.changed||s.decay.changed||s.angle.changed||s.penumbra.changed)&&(t.distance=s.distance.value,t.decay=s.decay.value,t.angle=s.angle.value*r.Math.DEG2RAD,t.penumbra=s.penumbra.value),!0}onAddToParent(e){super.onAddToParent(e),e.add(this.light.target)}onRemoveFromParent(e){super.onRemoveFromParent(e),e.remove(this.light.target)}}t.default=o,o.typeName="CSpotLight",o.spotLightIns={position:i.types.Vector3("Light.Position"),target:i.types.Vector3("Light.Target",[0,-1,0]),distance:i.types.Number("Light.Distance"),decay:i.types.Number("Light.Decay",1),angle:i.types.Number("Light.Angle",45),penumbra:i.types.Percent("Light.Penumbra",.5)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(8);class i extends r.default{constructor(e){super(),this.addEvent("update"),this._list=e||[],this._dict={},e&&e.forEach(e=>{e.id&&(this._dict[e.id]=e)})}get length(){return this._list.length}get ids(){return Object.keys(this._dict)}get items(){return this._list}set items(e){this._list=e,this._dict={},e.forEach(e=>{e.id&&(this._dict[e.id]=e)}),this.emit({type:"update",item:null,what:"update"})}append(e){this._list.push(e),e.id&&(this._dict[e.id]=e),this.emit({type:"update",item:e,what:"add"})}insertBefore(e,t){const s=this._list.indexOf(t);s>=0&&this.insertAt(e,s)}insertAt(e,t){this._list.splice(t,0,e),e.id&&(this._dict[e.id]=e),this.emit({type:"update",item:e,what:"add"})}replaceItem(e,t){const s=this._list.indexOf(t);s>=0&&this.replaceAt(e,s)}replaceAt(e,t){const s=this._list[t];s.id&&delete this._dict[s.id],this._list[t]=e,e.id&&(this._dict[e.id]=e),this.emit({type:"update",item:e,what:"replace"})}moveItem(e,t){const s=this._list.indexOf(e);this.moveAt(s,t)}moveAt(e,t){const s=this._list;if(e+t<0||e+t>=s.length)return;const r=s[e];if(t>0){for(let r=0;r<t;++r)s[e+r]=s[e+r+1];s[e+t]=r}else{if(!(t<0))return;for(let r=0;r>t;--r)s[e+r]=s[e+r-1];s[e+t]=r}this.emit({type:"update",item:r,what:"move"})}removeById(e){const t=this._dict[e];return t&&this.removeItem(t),t}removeItem(e){const t=this._list.indexOf(e);return this.removeAt(t),t}removeAt(e){const t=this._list;if(e<0||e>=t.length)return;const s=t[e];return t.splice(e,1),s.id&&delete this._dict[s.id],this.emit({type:"update",item:s,what:"remove"}),s}getAt(e){return this._list[e]}getById(e){return this._dict[e]}getIndexOf(e){return this._list.indexOf(e)}copy(e){this.items=e.slice()}clone(){return this._list.slice()}}t.default=i,i.prototype[Symbol.iterator]=function(){return{index:0,list:this._list,next:function(){return this.index<this.list.length?{value:this.list[this.index++],done:!1}:{done:!0}}}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(8);class i extends r.default{constructor(e){super(),this.addEvent("update"),this._dict={},e&&e.forEach(e=>{e.id&&(this._dict[e.id]=e)})}get length(){return this.ids.length}get items(){return this.ids.map(e=>this._dict[e])}set items(e){e.forEach(e=>{e.id&&(this._dict[e.id]=e)}),this.emit({type:"update",item:null,what:"update"})}get ids(){return Object.keys(this._dict)}get dictionary(){return this._dict}set dictionary(e){this._dict=e,this.emit({type:"update",item:null,what:"update"})}insert(e,t){if(!(t=t||e.id))throw new Error("can't insert, missing id");if(void 0!==this._dict[t])throw new Error(`id already exists: '${t}'`);this._dict[t]=e,this.emit({type:"update",item:e,what:"insert"})}remove(e){const t="string"==typeof e?e:e.id,s=this._dict[t];void 0!==s&&(delete this._dict[t],this.emit({type:"update",item:s,what:"remove"}))}get(e){return this._dict[e]}getOrCreate(e,t){let s=this._dict[e];return s||(s=this._dict[e]=t,this.emit({type:"update",item:s,what:"insert"})),s}copy(e){this.dictionary=Object.assign({},e)}clone(){return Object.assign({},this._dict)}}t.default=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(43),i={mm:{mm:1,cm:.1,m:.001,km:1,in:.0393701,ft:.00328084,yd:.00109361,mi:1},cm:{mm:10,cm:1,m:.01,km:1,in:.393701,ft:.0328084,yd:.0109361,mi:1},m:{mm:1e3,cm:100,m:1,km:1,in:39.3701,ft:3.28084,yd:1.09361,mi:1},km:{mm:1e6,cm:1e5,m:1e3,km:1,in:39370.1,ft:3280.84,yd:1093.61,mi:1},in:{mm:25.4,cm:2.54,m:.0254,km:1,in:1,ft:.0833333,yd:.0277778,mi:1},ft:{mm:304.8,cm:30.48,m:.3048,km:1,in:12,ft:1,yd:.333334,mi:1},yd:{mm:914.4,cm:91.44,m:.9144,km:1,in:36,ft:3,yd:1,mi:1},mi:{mm:1609e3,cm:160900,m:1609,km:1,in:63346456.693,ft:5278871.391,yd:1759623.797,mi:1}};t.default=function(e,t){const s=r.EUnitType[e],n=r.EUnitType[t];return i[s][n]||1}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(209),i=s(97),n=[],o=[r.EDerivativeQuality.Thumb,r.EDerivativeQuality.Low,r.EDerivativeQuality.Medium,r.EDerivativeQuality.High,r.EDerivativeQuality.Highest];t.default=class{constructor(){this.derivatives={}}select(e,t){const s=r.EDerivativeUsage[e],i=r.EDerivativeQuality[t],n=o.indexOf(t);if(n<0)return console.warn(`derivative quality not supported: '${i}'`),null;const a=this.get(e,t);if(a)return a;for(let t=n+1;t<o.length;++t){const s=this.get(e,o[t]);if(s)return console.warn(`derivative quality '${i}' not available, using higher quality`),s}for(let t=n-1;t>=0;--t){const s=this.get(e,o[t]);if(s)return console.warn(`derivative quality '${i}' not available, using lower quality`),s}return console.warn(`no suitable derivative found for quality '${i}'`+` and usage '${s}'`),null}getByUsage(e){const t=r.EDerivativeUsage[e];return(this.derivatives[t]||n).sort((e,t)=>e.data.quality<t.data.quality?-1:e.data.quality>t.data.quality?1:0)}getArray(){return Object.keys(this.derivatives).reduce((e,t)=>e.concat(this.derivatives[t]),[])}get(e,t){const s=r.EDerivativeUsage[e],i=this.derivatives[s];if(i)for(let e=0,s=i.length;e<s;++e)if(i[e].data.quality===t)return i[e];return null}getOrCreate(e,t){const s=this.getOrCreateBin(e);for(let e=0,r=s.length;e<r;++e)if(s[e].data.quality===t)return s[e];const i=new r.default;return i.set("usage",e),i.set("quality",t),s.push(i),i}createModelAsset(e,t){t="string"==typeof t?r.EDerivativeQuality[t]:t,t=isFinite(t)?t:r.EDerivativeQuality.Medium;const s=this.getOrCreate(r.EDerivativeUsage.Web3D,t),n=new i.default;return n.setModel(e),s.addAsset(n),s}createMeshAsset(e,t,s,n,o){o="string"==typeof o?r.EDerivativeQuality[o]:o,o=isFinite(o)?o:r.EDerivativeQuality.Medium;const a=this.getOrCreate(r.EDerivativeUsage.Web3D,o),l=new i.default;if(l.setGeometry(e),a.addAsset(l),t){const e=new i.default;e.setTexture(t,i.EMapType.Color),a.addAsset(e)}if(s){const e=new i.default;e.setTexture(s,i.EMapType.Occlusion),a.addAsset(e)}if(n){const e=new i.default;e.setTexture(n,i.EMapType.Normal),a.addAsset(e)}return a}clear(){for(let e in this.derivatives)this.derivatives[e].forEach(e=>e.dispose());this.derivatives={}}toJSON(){const e=[];for(let t in this.derivatives)this.derivatives[t].forEach(t=>e.push(t.toJSON()));return e}fromJSON(e){this.clear(),e.forEach(e=>{this.getOrCreateBin(r.EDerivativeUsage[e.usage]).push(new r.default(e))})}toString(e=!1){const t=this.derivatives,s=Object.keys(t);return e?`Derivatives (${s.length}) \n `+s.map(e=>t[e].map(e=>e.toString(!0)).join("\n ")).join("\n "):`Derivatives (${s.length}) `+s.map(e=>`${e} (${t[e].length})`).join(", ")}getOrCreateBin(e){const t=r.EDerivativeUsage[e];return this.derivatives[t]||(this.derivatives[t]=[])}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(54),n=s(42),o=s(36);t.EDerivativeQuality=o.EDerivativeQuality,t.EDerivativeUsage=o.EDerivativeUsage;const a=s(56),l=s(97);t.Asset=l.default,t.EAssetType=l.EAssetType;class c extends n.default{constructor(){super(...arguments),this.model=null}static fromJSON(e){return new c(e)}dispose(){this.unload(),super.dispose()}load(e){if(this.data.usage!==o.EDerivativeUsage.Web3D)throw new Error("can't load, not a Web3D derivative");const t=this.findAsset(l.EAssetType.Model);if(t)return e.getModel(t.data.uri).then(e=>(this.model&&i.disposeObject(this.model),this.model=e,e));const s=this.findAsset(l.EAssetType.Geometry),n=this.findAssets(l.EAssetType.Image);return s?e.getGeometry(s.data.uri).then(t=>(this.model=new r.Mesh(t,new a.default),Promise.all(n.map(t=>e.getTexture(t.data.uri))).catch(e=>(console.warn("failed to load texture files"),[])))).then(e=>{const t=this.model.material;return this.assignTextures(n,e,t),t.map||(t.color.setScalar(.5),t.roughness=.8,t.metalness=0),this.model}):void 0}unload(){this.model&&(i.disposeObject(this.model),this.model=null)}createAsset(e,t){const s=new l.default;return s.data.type=e,s.data.uri=t,this.addAsset(s),s}addAsset(e){if(!e.data.uri)throw new Error("uri must be specified");this.data.assets.push(e),this.update()}removeAsset(e){const t=this.data.assets.indexOf(e);t>=0&&this.data.assets.splice(t,1)}findAsset(e){return this.data.assets.find(t=>t.data.type===e)}findAssets(e){return this.data.assets.filter(t=>t.data.type===e)}toString(e=!1){const t=this.data;return e?`Derivative - usage: '${o.EDerivativeUsage[t.usage]}', quality: '${o.EDerivativeQuality[t.quality]}'\n   `+t.assets.map(e=>e.toString()).join("\n   "):`Derivative - usage: '${o.EDerivativeUsage[t.usage]}', quality: '${o.EDerivativeQuality[t.quality]}', #assets: ${t.assets.length})`}init(){return{usage:o.EDerivativeUsage.Web3D,quality:o.EDerivativeQuality.Medium,assets:[]}}deflate(e,t){t.usage=o.EDerivativeUsage[e.usage],t.quality=o.EDerivativeQuality[e.quality],t.assets=e.assets.map(e=>e.toJSON())}inflate(e,t){if(t.usage=o.EDerivativeUsage[e.usage],void 0===t.usage)throw new Error(`unknown derivative usage: ${e.usage}`);if(t.quality=o.EDerivativeQuality[e.quality],void 0===t.quality)throw new Error(`unknown derivative quality: ${e.quality}`);t.assets=e.assets.map(e=>new l.default(e))}assignTextures(e,t,s){for(let r=0;r<e.length;++r){const i=e[r],n=t[r];switch(i.data.mapType){case l.EMapType.Color:s.map=n;break;case l.EMapType.Occlusion:s.aoMap=n;break;case l.EMapType.Emissive:s.emissiveMap=n;break;case l.EMapType.MetallicRoughness:s.metalnessMap=n,s.roughnessMap=n;break;case l.EMapType.Normal:s.normalMap=n}}}}t.default=c},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(98);t.HTMLSprite=i.default;class n extends r.Object3D{constructor(){super(...arguments),this.isHTMLSpriteGroup=!0,this._visible=!0}get visible(){return this._visible}set visible(e){if(e!==this._visible){this._visible=e;const t=this.children;for(let s=0,r=t.length;s<r;++s)t[s].visible=e}}dispose(){const e=this.children;for(let t=0,s=e.length;t<s;++t)e[t].dispose()}disposeHTMLElements(e){const t=this.children;for(let s=0,r=t.length;s<r;++s)t[s].disposeHTMLElement(e)}render(e,t){if(!this.visible)return;const s=this.children;for(let r=0,i=s.length;r<i;++r){const i=s[r],n=i.getHTMLElement(e);n&&i.renderHTMLElement(n,e,t)}}update(){const e=this.children;for(let t=0,s=e.length;t<s;++t)e[t].update()}}t.default=n},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(1),n=s(12),o=s(44),a=s(2);s(7);const l=s(63),c=s(37),h=["sv-q0","sv-q1","sv-q2","sv-q3"],u=new o.default,d=new i.Vector3(0,1,0);class p extends l.default{constructor(e){super(e),this.quadrant=-1;const t=new i.Geometry;t.vertices.push(new i.Vector3(0,0,0),new i.Vector3(0,1,0));const s=new i.LineBasicMaterial({color:"#009cde",transparent:!0});this.stemLine=new i.Line(t,s),this.stemLine.frustumCulled=!1,this.stemLine.matrixAutoUpdate=!1,this.add(this.stemLine),this.update()}update(){const e=this.annotation.data;this.stemLine.scale.setScalar(e.scale),this.stemLine.position.y=e.offset,this.stemLine.updateMatrix(),this.stemLine.material.color.fromArray(e.color),super.update()}renderHTMLElement(e,t,s){super.renderHTMLElement(e,t,s,this.stemLine,d);const r=n.default.scaleLimit(this.viewAngle*n.default.RAD2DEG,90,100,1,0),i=this.annotation.data.visible?r:0;this.stemLine.material.opacity=i,e.setOpacity(i),this.orientationQuadrant!==this.quadrant&&(e.classList.remove(h[this.quadrant]),e.classList.add(h[this.orientationQuadrant]),this.quadrant=this.orientationQuadrant)}createHTMLElement(){return new f(this)}}t.default=p,p.typeName="Standard",c.default.registerDefaultType(p);let f=class extends l.AnnotationElement{constructor(e){super(e),this.onClickTitle=this.onClickTitle.bind(this),this.titleElement=this.appendElement("div"),this.titleElement.classList.add("sv-title"),this.titleElement.addEventListener("click",this.onClickTitle)}firstConnected(){super.firstConnected(),this.classList.add("sv-standard-annotation")}update(e){super.update(e);const t=this.sprite.annotation.data;this.titleElement.innerText=t.title,u.fromArray(t.color),this.style.borderColor=u.toString()}onClickTitle(e){e.stopPropagation(),this.sprite.emitClickEvent()}};f=r([a.customElement("sv-standard-annotation")],f)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(100);class i{constructor(e,t,s,r){this.x=e||0,this.y=t||0,this.z=s||0,this.w=r||0}static makeZeros(){return new i(0,0,0,0)}static makeOnes(){return new i(1,1,1,1)}static makeUnitX(){return new i(1,0,0,0)}static makeUnitY(){return new i(0,1,0,0)}static makeUnitZ(){return new i(0,0,1,0)}static makeUnitW(){return new i(0,0,0,1)}static makeCopy(e){return new i(e.x,e.y,e.z,e.w)}static makeFromScalar(e){return new i(e,e,e,e)}static makeFromArray(e){return new i(e[0],e[1],e[2],e[3])}static makeFromPosition(e){return new i(e.x,e.y,e.z,1)}static makeFromDirection(e){return new i(e.x,e.y,e.z,0)}static toString(e){return`[${e.x}, ${e.y}, ${e.z}, ${e.w}]`}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}set(e,t,s,r){return this.x=e,this.y=t,this.z=s,this.w=void 0===r?1:r,this}setFromScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setFromArray(e,t=1){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}setPosition(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=1,this}setDirection(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=0,this}setZeros(){return this.x=0,this.y=0,this.z=0,this.w=0,this}setOnes(){return this.x=1,this.y=1,this.z=1,this.w=1,this}setUnitX(){return this.x=1,this.y=0,this.z=0,this.w=0,this}setUnitY(){return this.x=0,this.y=1,this.z=0,this.w=0,this}setUnitZ(){return this.x=0,this.y=0,this.z=1,this.w=0,this}setUnitW(){return this.x=0,this.y=0,this.z=0,this.w=1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}mul(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}div(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}normalize(){const e=1/Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}homogenize(){return this.x/=this.w,this.y/=this.w,this.z/=this.w,this.w=1,this}project(e){const t=this.dot(e)/this.lengthSquared();return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}length(){const e=this.x,t=this.y,s=this.z,r=this.w;return Math.sqrt(e*e+t*t+s*s+r*r)}lengthSquared(){const e=this.x,t=this.y,s=this.z,r=this.w;return e*e+t*t+s*s+r*r}isZero(){return 0===this.x&&0===this.y&&0===this.z&&0===this.w}clone(){return new i(this.x,this.y,this.z,this.w)}toArray(e,t){return e?(void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e):[this.x,this.y,this.z,this.w]}toVector3(e){return e?(e.x=this.x,e.y=this.y,e.z=this.z,e):new r.default(this.x,this.y,this.z)}toString(){return i.toString(this)}}t.default=i,i.zeros=new i(0,0,0,0),i.ones=new i(1,1,1,1),i.unitX=new i(1,0,0,0),i.unitY=new i(0,1,0,0),i.unitZ=new i(0,0,1,0),i.unitW=new i(0,0,0,1)},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(1),n=s(12),o=s(44),a=s(2);s(7);const l=s(63),c=s(37),h=["sv-q0","sv-q1","sv-q2","sv-q3"],u=new o.default,d=new i.Vector3(0,1,0);class p extends l.default{constructor(e){super(e),this.quadrant=-1;const t=new i.Geometry;t.vertices.push(new i.Vector3(0,0,0),new i.Vector3(0,1,0));const s=new i.LineBasicMaterial({color:"#009cde",transparent:!0});this.stemLine=new i.Line(t,s),this.stemLine.frustumCulled=!1,this.stemLine.matrixAutoUpdate=!1,this.add(this.stemLine),this.update()}update(){const e=this.annotation.data;this.stemLine.scale.setScalar(e.scale),this.stemLine.position.y=e.offset,this.stemLine.updateMatrix(),this.stemLine.material.color.fromArray(e.color),super.update()}renderHTMLElement(e,t,s){super.renderHTMLElement(e,t,s,this.stemLine,d);const r=n.default.scaleLimit(this.viewAngle*n.default.RAD2DEG,90,100,1,0),i=this.annotation.data.visible?r:0;this.stemLine.material.opacity=i,e.setOpacity(i),this.orientationQuadrant!==this.quadrant&&(e.classList.remove(h[this.quadrant]),e.classList.add(h[this.orientationQuadrant]),this.quadrant=this.orientationQuadrant)}createHTMLElement(){return new f(this)}}t.default=p,p.typeName="Extended",c.default.registerType(p);let f=class extends l.AnnotationElement{constructor(e){super(e),this.handler=0,this.isExpanded=void 0,this.onClickTitle=this.onClickTitle.bind(this),this.onClickArticle=this.onClickArticle.bind(this),this.titleElement=this.appendElement("div"),this.titleElement.classList.add("sv-title"),this.titleElement.addEventListener("click",this.onClickTitle),this.wrapperElement=this.appendElement("div"),this.contentElement=this.createElement("div",null,this.wrapperElement),this.contentElement.classList.add("sv-content")}firstConnected(){super.firstConnected(),this.classList.add("sv-extended-annotation")}update(e){super.update(e);const t=this.sprite.annotation.data;this.titleElement.innerText=t.title;const s=a.html`<p>${t.lead}</p>
            ${t.articleId?a.html`<ff-button inline text="Read more..." icon="document" @click=${this.onClickArticle}></ff-button>`:null}`;a.render(s,this.contentElement),u.fromArray(t.color),this.style.borderColor=u.toString(),this.isExpanded!==t.expanded&&(this.isExpanded=t.expanded,window.clearTimeout(this.handler),this.isExpanded?(this.classList.add("sv-expanded"),this.contentElement.style.display="inherit",this.contentElement.style.height=this.contentElement.scrollHeight+"px"):(this.classList.remove("sv-expanded"),this.contentElement.style.height="0",this.handler=window.setTimeout(()=>this.contentElement.style.display="none",300)))}onClickTitle(e){e.stopPropagation(),this.sprite.emitClickEvent()}onClickArticle(e){e.stopPropagation(),this.sprite.emitLinkEvent(this.sprite.annotation.data.articleId)}};f=r([a.customElement("sv-extended-annotation")],f)},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(1),n=s(215),o=s(228),a=s(2);s(7);const l=s(55),c=s(82),h=s(63),u=s(37),d=new c.default(new i.LoadingManager),p=new i.Vector3,f=new i.Vector3,m=new i.Quaternion,v=new i.Matrix4;class g extends h.default{constructor(e){super(e),this.offset=new i.Group,this.offset.matrixAutoUpdate=!1,this.add(this.offset),this.ringGeometry=new i.RingBufferGeometry(.45,.5,32),this.ringMaterialA=new i.MeshBasicMaterial,this.ringMaterialB=new i.MeshBasicMaterial({depthFunc:i.GreaterDepth,depthWrite:!1,opacity:g.behindOpacity,transparent:!0}),this.ringMesh=new i.Mesh(this.ringGeometry,this.ringMaterialA);const t=new i.Mesh(this.ringGeometry,this.ringMaterialB),s=new i.Mesh(new i.CircleBufferGeometry(.45,32),new i.MeshBasicMaterial({color:0,opacity:.65,transparent:!0}));s.matrixAutoUpdate=!1,s.position.set(0,0,.005),s.updateMatrix(),this.anchorMesh=new i.Mesh(new i.BufferGeometry,new i.MeshBasicMaterial),this.anchorMesh.frustumCulled=!1,this.offset.add(this.anchorMesh,this.ringMesh,t,s),this.markerGeometry=null,this.markerA=null,this.markerB=null,d.load("fonts/Roboto-Bold").then(e=>{this.markerMaterialA=new i.RawShaderMaterial(o({map:e.texture,transparent:!0,color:16777215})),this.markerMaterialB=new i.RawShaderMaterial(o({map:e.texture,transparent:!0,opacity:g.behindOpacity,color:16777215,depthFunc:i.GreaterDepth,depthWrite:!1})),this.markerGeometry=n({font:e.descriptor}),this.markerA=new i.Mesh(this.markerGeometry,this.markerMaterialA),this.markerA.matrixAutoUpdate=!1,this.markerB=new i.Mesh(this.markerGeometry,this.markerMaterialB),this.markerB.matrixAutoUpdate=!1,l.default.add(this.markerA,!1),l.default.add(this.markerB,!1),this.offset.add(this.markerA,this.markerB),this.update()}),this.update()}update(){const e=this.annotation.data,t=e.color;if(this.ringMaterialA.color.setRGB(t[0],t[1],t[2]),this.ringMaterialB.color.setRGB(t[0],t[1],t[2]),this.markerA){const t=e.marker.length>1?.013:.016,s=this.markerGeometry;s.update(e.marker),s.computeBoundingBox(),s.boundingBox.getCenter(p),this.markerA.position.set(-t*(p.x+1),t*p.y,.01),this.markerA.scale.set(t,-t,-1),this.markerA.updateMatrix(),this.markerB.position.set(-t*(p.x+1),t*p.y,.01),this.markerB.scale.set(t,-t,-1),this.markerB.updateMatrix()}super.update()}renderHTMLElement(e,t,s){const r=this.annotation.data;v.copy(s.matrixWorldInverse),v.multiply(this.matrixWorld),v.decompose(p,m,f),this.offset.quaternion.copy(m.inverse());const n=t.offsetHeight+250,o=55*r.scale/n;let a=1;if(s.isPerspectiveCamera){const e=-p.set(0,0,0).applyMatrix4(v).z,t=s.fov*i.Math.DEG2RAD*.5;a=Math.tan(t)*e*o}else a=.5*s.size*o;if(this.offset.scale.setScalar(a),this.offset.position.set(0,(r.offset+1)*a*.5,0),this.offset.updateMatrix(),r.expanded){p.set(0,0,0).applyMatrix4(this.anchorMesh.modelViewMatrix).applyMatrix4(s.projectionMatrix),f.set(.6,.5,0).applyMatrix4(this.anchorMesh.modelViewMatrix).applyMatrix4(s.projectionMatrix);const r=.5*(p.x+1)*t.clientWidth,i=.5*(1-p.y)*t.clientHeight,n=.5*(f.x+1)*t.clientWidth-r,o=.5*(1-f.y)*t.clientHeight-i;let a=r+n,l=i+o;e.classList.remove("sv-align-right","sv-align-bottom"),a+e.offsetWidth>=t.offsetWidth&&(a=r-n,e.classList.add("sv-align-right")),l+e.offsetHeight>=t.offsetHeight&&(l=i-o,e.classList.add("sv-align-bottom")),e.setPosition(a,l)}}createHTMLElement(){return new y(this)}updateHTMLElement(e){e.setVisible(this.visible),e.requestUpdate()}}t.default=g,g.typeName="Circle",g.behindOpacity=.2,u.default.registerType(g);let y=class extends h.AnnotationElement{constructor(e){super(e)}setVisible(e){super.setVisible(e&&this.sprite.annotation.data.expanded)}firstConnected(){super.firstConnected(),this.classList.add("sv-circle-annotation")}render(){const e=this.sprite.annotation.data;return a.html`<div class="sv-title">${e.title}</div>
            <p>${e.lead}</p>
            ${e.articleId?a.html`<ff-button inline text="Read more..." icon="document" @click=${this.onClickArticle}></ff-button>`:null}`}onClickArticle(e){e.stopPropagation(),this.sprite.emitLinkEvent(this.sprite.annotation.data.articleId)}};y=r([a.customElement("sv-circle-annotation")],y)},function(e,t,s){var r=s(216),i=s(220),n=s(221),o=s(224),a=s(103),l=s(226),c=s(227),h=THREE.BufferGeometry;function u(e){h.call(this),"string"==typeof e&&(e={text:e}),this._opt=a({},e),e&&this.update(e)}e.exports=function(e){return new u(e)},i(u,h),u.prototype.update=function(e){if("string"==typeof e&&(e={text:e}),!(e=a({},this._opt,e)).font)throw new TypeError("must specify a { font } in options");this.layout=r(e);var t=!1!==e.flipY,s=e.font,i=s.common.scaleW,c=s.common.scaleH,h=this.layout.glyphs.filter((function(e){var t=e.data;return t.width*t.height>0}));this.visibleGlyphs=h;var u=l.positions(h),d=l.uvs(h,i,c,t),p=n({clockwise:!0,type:"uint16",count:h.length});if(o.index(this,p,1,"uint16"),o.attr(this,"position",u,2),o.attr(this,"uv",d,2),!e.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(e.multipage){var f=l.pages(h);o.attr(this,"page",f,1)}},u.prototype.computeBoundingSphere=function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var e=this.attributes.position.array,t=this.attributes.position.itemSize;if(!e||!t||e.length<2)return this.boundingSphere.radius=0,void this.boundingSphere.center.set(0,0,0);c.computeSphere(e,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')},u.prototype.computeBoundingBox=function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var e=this.boundingBox,t=this.attributes.position.array,s=this.attributes.position.itemSize;!t||!s||t.length<2?e.makeEmpty():c.computeBox(t,e)}},function(e,t,s){var r=s(217),i=s(218),n=s(219),o=["x","e","a","o","n","s","r","c","u","m","v","w","z"],a=["m","w"],l=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"],c="\t".charCodeAt(0),h=" ".charCodeAt(0),u=0,d=1,p=2;function f(e){this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update(e)}function m(e){return new Function(["return function "+e+"() {","  return this._"+e,"}"].join("\n"))()}function v(e,t){if(!e.chars||0===e.chars.length)return null;var s=y(e.chars,t);return s>=0?e.chars[s]:null}function g(e,t,s){if(!e.kernings||0===e.kernings.length)return 0;for(var r=e.kernings,i=0;i<r.length;i++){var n=r[i];if(n.first===t&&n.second===s)return n.amount}return 0}function y(e,t,s){for(var r=s=s||0;r<e.length;r++)if(e[r].id===t)return r;return-1}e.exports=function(e){return new f(e)},f.prototype.update=function(e){if(e=i({measure:this._measure},e),this._opt=e,this._opt.tabSize=n(this._opt.tabSize,4),!e.font)throw new Error("must provide a valid bitmap font");var t=this.glyphs,s=e.text||"",a=e.font;this._setupSpaceGlyphs(a);var c=r.lines(s,e),h=e.width||0;t.length=0;var f=c.reduce((function(e,t){return Math.max(e,t.width,h)}),0),m=0,v=0,b=n(e.lineHeight,a.common.lineHeight),w=a.common.base,_=b-w,E=e.letterSpacing||0,x=b*c.length-_,P=function(e){if("center"===e)return d;if("right"===e)return p;return u}(this._opt.align);v-=x,this._width=f,this._height=x,this._descender=b-w,this._baseline=w,this._xHeight=function(e){for(var t=0;t<o.length;t++){var s=o[t].charCodeAt(0),r=y(e.chars,s);if(r>=0)return e.chars[r].height}return 0}(a),this._capHeight=function(e){for(var t=0;t<l.length;t++){var s=l[t].charCodeAt(0),r=y(e.chars,s);if(r>=0)return e.chars[r].height}return 0}(a),this._lineHeight=b,this._ascender=b-_-this._xHeight;var S=this;c.forEach((function(e,r){for(var i,n=e.start,o=e.end,l=e.width,c=n;c<o;c++){var h=s.charCodeAt(c),u=S.getGlyph(a,h);if(u){i&&(m+=g(a,i.id,u.id));var y=m;P===d?y+=(f-l)/2:P===p&&(y+=f-l),t.push({position:[y,v],data:u,index:c,line:r}),m+=u.xadvance+E,i=u}}v+=b,m=0})),this._linesTotal=c.length},f.prototype._setupSpaceGlyphs=function(e){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,e.chars&&0!==e.chars.length){var t=v(e,h)||function(e){for(var t=0;t<a.length;t++){var s=a[t].charCodeAt(0),r=y(e.chars,s);if(r>=0)return e.chars[r]}return 0}(e)||e.chars[0],s=this._opt.tabSize*t.xadvance;this._fallbackSpaceGlyph=t,this._fallbackTabGlyph=i(t,{x:0,y:0,xadvance:s,id:c,xoffset:0,yoffset:0,width:0,height:0})}},f.prototype.getGlyph=function(e,t){var s=v(e,t);return s||(t===c?this._fallbackTabGlyph:t===h?this._fallbackSpaceGlyph:null)},f.prototype.computeMetrics=function(e,t,s,r){var i,n=this._opt.letterSpacing||0,o=this._opt.font,a=0,l=0,c=0;if(!o.chars||0===o.chars.length)return{start:t,end:t,width:0};s=Math.min(e.length,s);for(var h=t;h<s;h++){var u,d=e.charCodeAt(h);if(u=this.getGlyph(o,d)){u.xoffset;var p=(a+=i?g(o,i.id,u.id):0)+u.xadvance+n,f=a+u.width;if(f>=r||p>=r)break;a=p,l=f,i=u}c++}return i&&(l+=i.xoffset),{start:t,end:t+c,width:l}},["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach((function(e){Object.defineProperty(f.prototype,e,{get:m(e),configurable:!0})}))},function(e,t){var s=/\n/,r="\n",i=/\s/;function n(e,t,s,r){var i=e.indexOf(t,s);return-1===i||i>r?r:i}function o(e){return i.test(e)}function a(e,t,s,r){return{start:t,end:t+Math.min(r,s-t)}}e.exports=function(t,s){return e.exports.lines(t,s).map((function(e){return t.substring(e.start,e.end)})).join("\n")},e.exports.lines=function(e,t){if(0===(t=t||{}).width&&"nowrap"!==t.mode)return[];e=e||"";var i="number"==typeof t.width?t.width:Number.MAX_VALUE,l=Math.max(0,t.start||0),c="number"==typeof t.end?t.end:e.length,h=t.mode,u=t.measure||a;return"pre"===h?function(e,t,r,i,n){for(var o=[],a=r,l=r;l<i&&l<t.length;l++){var c=t.charAt(l),h=s.test(c);if(h||l===i-1){var u=e(t,a,h?l:l+1,n);o.push(u),a=l+1}}return o}(u,e,l,c,i):function(e,t,s,i,a,l){var c=[],h=a;"nowrap"===l&&(h=Number.MAX_VALUE);for(;s<i&&s<t.length;){for(var u=n(t,r,s,i);s<u&&o(t.charAt(s));)s++;var d=e(t,s,u,h),p=s+(d.end-d.start),f=p+r.length;if(p<u){for(;p>s&&!o(t.charAt(p));)p--;if(p===s)f>s+r.length&&f--,p=f;else for(f=p;p>s&&o(t.charAt(p-r.length));)p--}if(p>=s){var m=e(t,s,p,h);c.push(m)}s=f}return c}(u,e,l,c,i,h)}},function(e,t){e.exports=function(){for(var e={},t=0;t<arguments.length;t++){var r=arguments[t];for(var i in r)s.call(r,i)&&(e[i]=r[i])}return e};var s=Object.prototype.hasOwnProperty},function(e,t){e.exports=function(e,t){return"number"==typeof e?e:"number"==typeof t?t:0}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var s=function(){};s.prototype=t.prototype,e.prototype=new s,e.prototype.constructor=e}},function(e,t,s){var r=s(102),i=s(222),n=s(223),o=[0,2,3],a=[2,1,3];e.exports=function(e,t){e&&(i(e)||n(e))||(t=e||{},e=null);for(var s="string"==typeof(t="number"==typeof t?{count:t}:t||{}).type?t.type:"uint16",l="number"==typeof t.count?t.count:1,c=t.start||0,h=!1!==t.clockwise?o:a,u=h[0],d=h[1],p=h[2],f=6*l,m=e||new(r(s))(f),v=0,g=0;v<f;v+=6,g+=4){var y=v+c;m[y+0]=g+0,m[y+1]=g+1,m[y+2]=g+2,m[y+3]=g+u,m[y+4]=g+d,m[y+5]=g+p}return m}},function(e,t){var s=Object.prototype.toString;e.exports=function(e){return e.BYTES_PER_ELEMENT&&"[object ArrayBuffer]"===s.call(e.buffer)||Array.isArray(e)}},function(e,t){function s(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(s(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&s(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,s){var r=s(225),i=!1;function n(e,t,s,n){if(t=t||[],!e||function(e,t,s){if(e.itemSize!==s)return!0;if(!e.array)return!0;var r=e.array.length;return Array.isArray(t)&&Array.isArray(t[0])?r!==t.length*s:r!==t.length}(e,t,s)){t=r(t,n);var o=e&&"function"!=typeof e.setArray;return e&&!o||(o&&!i&&(i=!0,console.warn(["A WebGL buffer is being updated with a new size or itemSize, ","however this version of ThreeJS only supports fixed-size buffers.","\nThe old buffer may still be kept in memory.\n","To avoid memory leaks, it is recommended that you dispose ","your geometries and create new ones, or update to ThreeJS r82 or newer.\n","See here for discussion:\n","https://github.com/mrdoob/three.js/pull/9631"].join(""))),e=new THREE.BufferAttribute(t,s)),e.itemSize=s,e.needsUpdate=!0,"function"==typeof e.setArray&&e.setArray(t),e}return r(t,e.array),e.needsUpdate=!0,null}e.exports.attr=function(e,t,s,r,i){"number"!=typeof r&&(r=3);"string"!=typeof i&&(i="float32");if(Array.isArray(s)&&Array.isArray(s[0])&&s[0].length!==r)throw new Error("Nested vertex array has unexpected size; expected "+r+" but found "+s[0].length);var o=n(e.getAttribute(t),s,r,i);o&&e.addAttribute(t,o)},e.exports.index=function(e,t,s,r){"number"!=typeof s&&(s=1);"string"!=typeof r&&(r="uint16");var i=!e.index&&"function"!=typeof e.setIndex,o=n(i?e.getAttribute("index"):e.index,t,s,r);o&&(i?e.addAttribute("index",o):e.index=o)}},function(e,t,s){var r=s(102);e.exports=function(e,t,s){if(!e)throw new TypeError("must specify data as first parameter");if(s=0|+(s||0),Array.isArray(e)&&e[0]&&"number"==typeof e[0][0]){var i,n,o,a,l=e[0].length,c=e.length*l;t&&"string"!=typeof t||(t=new(r(t||"float32"))(c+s));var h=t.length-s;if(c!==h)throw new Error("source length "+c+" ("+l+"x"+e.length+") does not match destination length "+h);for(i=0,o=s;i<e.length;i++)for(n=0;n<l;n++)t[o++]=null===e[i][n]?NaN:e[i][n]}else if(t&&"string"!=typeof t)t.set(e,s);else{var u=r(t||"float32");if(Array.isArray(e)||"array"===t)for(t=new u(e.length+s),i=0,o=s,a=t.length;o<a;o++,i++)t[o]=null===e[i]?NaN:e[i];else 0===s?t=new u(e):(t=new u(e.length+s)).set(e,s)}return t}},function(e,t){e.exports.pages=function(e){var t=new Float32Array(4*e.length*1),s=0;return e.forEach((function(e){var r=e.data.page||0;t[s++]=r,t[s++]=r,t[s++]=r,t[s++]=r})),t},e.exports.uvs=function(e,t,s,r){var i=new Float32Array(4*e.length*2),n=0;return e.forEach((function(e){var o=e.data,a=o.x+o.width,l=o.y+o.height,c=o.x/t,h=o.y/s,u=a/t,d=l/s;r&&(h=(s-o.y)/s,d=(s-l)/s),i[n++]=c,i[n++]=h,i[n++]=c,i[n++]=d,i[n++]=u,i[n++]=d,i[n++]=u,i[n++]=h})),i},e.exports.positions=function(e){var t=new Float32Array(4*e.length*2),s=0;return e.forEach((function(e){var r=e.data,i=e.position[0]+r.xoffset,n=e.position[1]+r.yoffset,o=r.width,a=r.height;t[s++]=i,t[s++]=n,t[s++]=i,t[s++]=n+a,t[s++]=i+o,t[s++]=n+a,t[s++]=i+o,t[s++]=n})),t}},function(e,t){var s=2,r={min:[0,0],max:[0,0]};function i(e){var t=e.length/s;r.min[0]=e[0],r.min[1]=e[1],r.max[0]=e[0],r.max[1]=e[1];for(var i=0;i<t;i++){var n=e[i*s+0],o=e[i*s+1];r.min[0]=Math.min(n,r.min[0]),r.min[1]=Math.min(o,r.min[1]),r.max[0]=Math.max(n,r.max[0]),r.max[1]=Math.max(o,r.max[1])}}e.exports.computeBox=function(e,t){i(e),t.min.set(r.min[0],r.min[1],0),t.max.set(r.max[0],r.max[1],0)},e.exports.computeSphere=function(e,t){i(e);var s=r.min[0],n=r.min[1],o=r.max[0]-s,a=r.max[1]-n,l=Math.sqrt(o*o+a*a);t.center.set(s+o/2,n+a/2,0),t.radius=l/2}},function(e,t,s){var r=s(103);e.exports=function(e){var t="number"==typeof(e=e||{}).opacity?e.opacity:1,s="number"==typeof e.alphaTest?e.alphaTest:1e-4,i=e.precision||"highp",n=e.color,o=e.map,a="boolean"!=typeof e.negate||e.negate;return delete e.map,delete e.color,delete e.precision,delete e.opacity,delete e.negate,r({uniforms:{opacity:{type:"f",value:t},map:{type:"t",value:o||new THREE.Texture},color:{type:"c",value:new THREE.Color(n)}},vertexShader:["attribute vec2 uv;","attribute vec4 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * position;","}"].join("\n"),fragmentShader:["#ifdef GL_OES_standard_derivatives","#extension GL_OES_standard_derivatives : enable","#endif","precision "+i+" float;","uniform float opacity;","uniform vec3 color;","uniform sampler2D map;","varying vec2 vUv;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","void main() {","  vec3 sample = "+(a?"1.0 - ":"")+"texture2D(map, vUv).rgb;","  float sigDist = median(sample.r, sample.g, sample.b) - 0.5;","  float alpha = clamp(sigDist/fwidth(sigDist) + 0.5, 0.0, 1.0);","  gl_FragColor = vec4(color.xyz, alpha * opacity);",0===s?"":"  if (gl_FragColor.a < "+s+") discard;","}"].join("\n")},e)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(12),n=new r.Vector4,o=(new r.Vector4,new r.Vector3),a=new r.Vector3,l=new r.Matrix4,c=new r.Euler,h=new r.Quaternion,u={PI:3.141592653589793,DOUBLE_PI:6.283185307179586,HALF_PI:1.5707963267948966,QUARTER_PI:.7853981633974483,DEG2RAD:.017453292519943295,RAD2DEG:57.29577951308232,composeOrbitMatrix:function(e,t,s){const i=e.x,n=e.y,o=e.z,a=t.x,l=t.y,c=t.z,h=Math.sin(i),u=Math.cos(i),d=Math.sin(n),p=Math.cos(n),f=Math.sin(o),m=Math.cos(o),v=p*m,g=m*d*h-f*u,y=m*d*u+f*h,b=p*f,w=h*d*f+m*u,_=f*d*u-m*h,E=-d,x=p*h,P=p*u,S=(s=s||new r.Matrix4).elements;return S[0]=v,S[1]=b,S[2]=E,S[3]=0,S[4]=g,S[5]=w,S[6]=x,S[7]=0,S[8]=y,S[9]=_,S[10]=P,S[11]=0,S[12]=a*v+l*g+c*y,S[13]=a*b+l*w+c*_,S[14]=a*E+l*x+c*P,S[15]=1,s},decomposeOrbitMatrix:function(e,t,s){c.setFromRotationMatrix(e,"ZYX"),c.toVector3(t),l.getInverse(e),n.set(0,0,0,1),n.applyMatrix4(l),s.x=-n.x,s.y=-n.y,s.z=-n.z},isMatrix4Identity:function(e){const t=e.elements;return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]},decomposeTransformMatrix:function(e,t,s,r){l.fromArray(e),l.decompose(o,h,a),c.setFromQuaternion(h,"XYZ"),o.toArray(t),a.toArray(r),c.toVector3(o),n.multiplyScalar(i.default.RAD2DEG),o.toArray(s)}};t.default=u},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1);var i;!function(e){e[e.Solid=0]="Solid",e[e.LinearGradient=1]="LinearGradient",e[e.RadialGradient=2]="RadialGradient"}(i=t.EBackgroundStyle||(t.EBackgroundStyle={}));class n extends r.Mesh{constructor(){super(new o,new a),this.frustumCulled=!1,this.renderOrder=-1/0,this.matrixAutoUpdate=!1}dispose(){this.geometry.dispose(),this.material.dispose()}updateMatrixWorld(e){}}t.default=n;class o extends r.BufferGeometry{constructor(){super();const e=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,1,1,0,1,1,-1,1,0,0,1]),t=new r.InterleavedBuffer(e,5);this.setIndex([0,1,2,0,2,3]),this.addAttribute("position",new r.InterleavedBufferAttribute(t,3,0,!1)),this.addAttribute("uv",new r.InterleavedBufferAttribute(t,2,3,!1))}}t.BackgroundGeometry=o;class a extends r.RawShaderMaterial{constructor(){super(...arguments),this.depthTest=!1,this.depthWrite=!1,this.transparent=!1,this.uniforms={style:{value:i.LinearGradient},color0:{value:new r.Vector3(.15,.2,.25)},color1:{value:new r.Vector3(0,0,0)},noise:{value:.02}},this.vertexShader=["precision highp float;","attribute vec3 position;","attribute vec2 uv;","varying vec2 ndc;","void main() {","  ndc = position.xy;","  gl_Position = vec4(position, 1.0);","}"].join("\n"),this.fragmentShader=["precision highp float;","uniform vec3 color0;","uniform vec3 color1;","uniform float noise;","uniform int style;","varying vec2 ndc;","float rand(vec2 co) {","float dt = dot(co.xy ,vec2(12.9898, 78.233));","float sn = mod(dt, 3.14);","return fract(sin(sn) * 43758.5453);","}","void main() {","  float f = style == 0 ? 0.0 : (style == 1 ? ndc.y * 0.5 + 0.5 : length(ndc) * 0.707);","  gl_FragColor = vec4(mix(color0, color1, f) + noise * rand(ndc), 1.0);","}"].join("\n")}set style(e){this.uniforms.style.value=e}get style(){return this.uniforms.style.value}set color0(e){if(e instanceof r.Color){const t=this.uniforms.color0.value;t.x=e.r,t.y=e.g,t.z=e.b}else this.uniforms.color0.value.copy(e)}get color0(){return this.uniforms.color0.value}set color1(e){if(e instanceof r.Color){const t=this.uniforms.color1.value;t.x=e.r,t.y=e.g,t.z=e.b}else this.uniforms.color1.value.copy(e)}get color1(){return this.uniforms.color1.value}set noise(e){this.uniforms.noise.value=e}get noise(){return this.uniforms.noise.value}}t.BackgroundMaterial=a},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(11),i=s(232);class n extends r.default{constructor(e,t){super(e,t),this.ins=this.addInputs(n.floorIns),this.object3D=new i.default}get floor(){return this.object3D}update(e){super.update(e);const t=this.ins,s=this.floor;return(t.position.changed||t.radius.changed)&&(s.position.fromArray(t.position.value),s.scale.setScalar(t.radius.value),s.updateMatrix()),t.color.changed&&s.material.color.fromArray(t.color.value),t.opacity.changed&&(s.material.opacity=t.opacity.value),!0}dispose(){this.floor.dispose(),super.dispose()}}t.default=n,n.typeName="CFloor",n.floorIns={position:r.types.Vector3("Floor.Position",[0,-25,0]),radius:r.types.Number("Floor.Radius",50),color:r.types.ColorRGB("Floor.Color",[.6,.75,.8]),opacity:r.types.Percent("Floor.Opacity",.5),castShadow:r.types.Boolean("Shadow.Cast"),receiveShadow:r.types.Boolean("Shadow.Receive")}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(233).default,n=s(234).default;class o extends r.Mesh{constructor(){super(new r.PlaneBufferGeometry(2,2,1,1),new a),this.geometry.rotateX(-90*r.Math.DEG2RAD),this.receiveShadow=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}t.default=o;class a extends r.MeshPhongMaterial{constructor(e){super(e),this.defines={},this.type="FloorMaterial",this.isMeshPhongMaterial=!0,this.isFloorMaterial=!0,this.defines={},this.uniforms=r.UniformsUtils.merge([r.ShaderLib.phong.uniforms]),this.vertexShader=n,this.fragmentShader=i,this.transparent=!0,this.shininess=0}}t.FloorMaterial=a},function(e,t,s){"use strict";s.r(t),t.default="\n#define PHONG\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n\n// #include <uv_pars_fragment>\n// replaced with\nvarying vec2 vUv;\n\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t#include <envmap_fragment>\n\n    vec2 coords = vUv * 2.0 - 1.0;\n    float f = dot(coords, coords);\n\tgl_FragColor = vec4(outgoingLight, mix(diffuseColor.a, 0.0, f));\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n\n"},function(e,t,s){"use strict";s.r(t),t.default="\n#define PHONG\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n\n// #include <uv_pars_vertex>\n// replaced with\nvarying vec2 vUv;\nuniform mat3 uvTransform;\n\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t// #include <uv_vertex>\n\t// replaced with\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n\n"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1);class i extends r.LineSegments{constructor(e){super(i.generate(e),new r.LineBasicMaterial({vertexColors:r.VertexColors}))}set opacity(e){this.material.opacity=e,this.material.transparent=e<1}update(e){this.geometry&&this.geometry.dispose(),this.geometry=i.generate(e)}static generate(e){const t=new r.Color(e.mainColor),s=new r.Color(e.subColor),i=e.mainDivisions*e.subDivisions,n=e.size/i,o=.5*e.size,a=[],l=[];for(let r=0,c=0,h=-o;r<=i;++r,h+=n){a.push(-o,0,h,o,0,h),a.push(h,0,-o,h,0,o);const i=r%e.subDivisions==0?t:s;i.toArray(l,c),c+=3,i.toArray(l,c),c+=3,i.toArray(l,c),c+=3,i.toArray(l,c),c+=3}const c=new r.BufferGeometry;return c.addAttribute("position",new r.Float32BufferAttribute(a,3)),c.addAttribute("color",new r.Float32BufferAttribute(l,3)),c}}t.default=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1);class i extends r.Group{constructor(){super();const e=new r.MeshStandardMaterial({color:"white",metalness:1});e.transparent=!0;const t=new r.Mesh(this.createLatheGeometry([0,0,.25,.4,.4,10]),e),s=new r.MeshStandardMaterial({color:"#ffcd00",roughness:.8,metalness:.1});s.transparent=!0;const i=new r.Mesh(this.createLatheGeometry([0,10,3.4,10,3.5,10.1,3.5,11,3.45,11.1,2.05,12.5,2,12.6,2,17.4,2.05,17.5,3.45,18.9,3.5,19,3.5,19.9,3.4,20,0,20]),s);t.matrixAutoUpdate=!1,this.add(t),i.matrixAutoUpdate=!1,this.add(i)}dispose(){}createLatheGeometry(e){const t=[];for(let s=0,i=e.length;s<i;s+=2)t.push(new r.Vector2(e[s],e[s+1]));return new r.LatheBufferGeometry(t,16)}}t.default=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(15);class n extends r.default{constructor(){super(...arguments),this.ins=this.addInputs(n.ins)}get model(){return this.getComponent(i.default)}update(e){return!0}}t.default=n,n.typeName="CVAnnotations",n.ins={}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(46),i=s(38),n=s(116),o=s(117),a=s(118),l=s(119),c=s(123),h=s(124),u=s(125),d=[r.default,i.default,n.default,o.default,a.default,l.default,c.default,h.default,u.default];t.default=d},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(46),i=s(240);class n extends i.default{constructor(){super(...arguments),this.activeNode=null}get nodeProvider(){return this.getGraphComponent(r.default)}startObserving(){super.startObserving();const e=this.nodeProvider;e.on("active-node",this.onActiveNodeEvent,this),e.activeNode&&(this.activeNode=e.activeNode,this.onActiveNode(null,e.activeNode))}stopObserving(){const e=this.nodeProvider;e.off("active-node",this.onActiveNodeEvent,this),e.activeNode&&(this.activeNode=null,this.onActiveNode(e.activeNode,null)),super.stopObserving()}onActiveNode(e,t){}onActiveNodeEvent(e){this.activeNode=e.next,this.onActiveNode(e.previous,e.next)}}t.default=n,n.typeName="CVNodeObserver"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),i=s(29);class n extends r.default{constructor(){super(...arguments),this.activeDocument=null}get documentProvider(){return this.getGraphComponent(i.default)}startObserving(){const e=this.documentProvider;e.on("active-component",this.onActiveDocumentEvent,this),e.activeComponent&&(this.activeDocument=e.activeComponent,this.onActiveDocument(null,e.activeComponent))}stopObserving(){const e=this.documentProvider;e.off("active-component",this.onActiveDocumentEvent,this),e.activeComponent&&(this.activeDocument=null,this.onActiveDocument(e.activeComponent,null))}onActiveDocument(e,t){}onActiveDocumentEvent(e){this.activeDocument=e.next,this.onActiveDocument(e.previous,e.next)}}t.default=n,n.typeName="CVDocumentObserver"},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(2);t.customElement=r.customElement,t.property=r.property,t.html=r.html,t.TemplateResult=r.TemplateResult;const i=s(46),n=s(24);class o extends n.default{constructor(){super(...arguments),this.activeNode=null}get nodeProvider(){return this.system.getMainComponent(i.default)}connected(){super.connected();const e=this.nodeProvider;e.on("active-node",this.onActiveNodeEvent,this),e.activeNode&&(this.activeNode=e.activeNode,this.onActiveNode(null,e.activeNode))}disconnected(){const e=this.nodeProvider;e.off("active-node",this.onActiveNodeEvent,this),e.activeNode&&(this.activeNode=null,this.onActiveNode(e.activeNode,null)),super.disconnected()}onActiveNode(e,t){this.requestUpdate()}onActiveNodeEvent(e){this.activeNode=e.next,this.onActiveNode(e.previous,e.next)}}t.default=o},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(2);s(7);let n=class extends i.default{constructor(){super(...arguments),this.property=null,this.name="",this.text="",this.icon=""}firstConnected(){this.classList.add("sv-property-view","sv-property-event")}update(e){if(!this.property)throw new Error("missing property attribute");if(!this.property.schema.event)throw new Error(`not an event property: '${this.property.path}'`);if(e.has("property")){const t=e.get("property");t&&t.off("value",this.onUpdate,this),this.property&&this.property.on("value",this.onUpdate,this)}super.update(e)}render(){const e=this.property,t=this.name||e.name,s=this.text,r=this.icon;return i.html`<label class="ff-label ff-off">${t}</label>
            <div class="sv-options">
                <ff-button .text=${s} .icon=${r} @click=${this.onButtonClick}></ff-button>
            </div>`}onButtonClick(e){this.property.set()}};r([i.property({attribute:!1})],n.prototype,"property",void 0),r([i.property({type:String})],n.prototype,"name",void 0),r([i.property({type:String})],n.prototype,"text",void 0),r([i.property({type:String})],n.prototype,"icon",void 0),n=r([i.customElement("sv-property-event")],n),t.default=n},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(44),n=s(2);s(7),s(244);let o=class extends n.default{constructor(){super(),this.property=null,this.name="",this.color=new i.default,this.pickerActive=!1,this.onPointerDown=this.onPointerDown.bind(this)}firstConnected(){super.firstConnected(),this.classList.add("sv-property-view","sv-property-color")}connected(){document.addEventListener("pointerdown",this.onPointerDown,{capture:!0,passive:!0})}disconnected(){document.removeEventListener("pointerdown",this.onPointerDown)}update(e){if(!this.property)throw new Error("missing property attribute");if("number"!==this.property.type||3!==this.property.elementCount)throw new Error(`not an color property: '${this.property.path}'`);if(e.has("property")){const t=e.get("property");t&&t.off("value",this.onPropertyChange,this),this.property&&(this.property.on("value",this.onPropertyChange,this),this.color.fromArray(this.property.value))}super.update(e)}render(){const e=this.property,t=this.name||e.name,s=this.color.toString();return n.html`<label class="ff-label ff-off">${t}</label>
            <ff-button style="background-color: ${s}" @click=${this.onButtonClick}></ff-button>
            ${this.pickerActive?n.html`<ff-color-edit .color=${this.color} @change=${this.onColorEditChange}></ff-color-edit>`:null}`}onButtonClick(e){this.pickerActive=!this.pickerActive,this.requestUpdate()}onColorEditChange(e){this.property.setValue(e.detail.color.toRGBArray())}onPropertyChange(e){this.color.fromArray(e),this.requestUpdate()}onPointerDown(e){this.pickerActive&&(e.target instanceof Node&&this.contains(e.target)||(this.pickerActive=!1,this.requestUpdate()))}};r([n.property({attribute:!1})],o.prototype,"property",void 0),r([n.property({type:String})],o.prototype,"name",void 0),o=r([n.customElement("sv-property-color")],o),t.default=o},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(12),n=s(44);t.Color=n.default,s(245);const o=s(121),a=s(246),l=s(2),c=new n.default;let h=class extends l.default{constructor(){super(),this.color=new n.default,this.alpha=!1,this.numeric=!1,this.onLumSatChange=this.onLumSatChange.bind(this),this.onHueChange=this.onHueChange.bind(this),this.onAlphaChange=this.onAlphaChange.bind(this),this.addEventListener("click",e=>e.stopPropagation()),this._hsv=new n.Vector3,this._lumSatSlider=(new a.default).on("change",this.onLumSatChange),this._hueSlider=(new o.default).addClass("ff-hue-slider").on("change",this.onHueChange),this._hueSlider.direction="vertical"}firstConnected(){this.classList.add("ff-flex-column","ff-control","ff-color-edit")}update(e){e.has("color")&&this.color.toHSV(this._hsv),e.has("alpha")&&(this.alpha&&!this._alphaSlider?(this._alphaSlider=(new o.default).addClass("ff-alpha-slider").on("change",this.onAlphaChange),this._alphaSlider.direction="vertical"):!this.alpha&&this._alphaSlider&&this._alphaSlider.remove()),super.update(e)}render(){let e=null;if(this.numeric){const t=this.color,s=t.toString(!1).substr(1),r=this.alpha?l.html`
                <div class="ff-text">A</div><ff-line-edit name="alphaByte" text=${t.alphaByte} align="center" @change=${this.onNumericEdit}></ff-line-edit>
            `:null;e=l.html`<div class="ff-flex-row ff-numeric-controls">
                <div class="ff-text">R</div><ff-line-edit name="redByte" text=${t.redByte} align="center" @change=${this.onNumericEdit}></ff-line-edit>
                <div class="ff-text">G</div><ff-line-edit name="greenByte" text=${t.greenByte} align="center" @change=${this.onNumericEdit}></ff-line-edit>
                <div class="ff-text">B</div><ff-line-edit name="blueByte" text=${t.blueByte} align="center" @change=${this.onNumericEdit}></ff-line-edit>
                ${r}
                <div class="ff-text">#</div><ff-line-edit name="string" text=${s} class="ff-wide" align="center" @change=${this.onNumericEdit}></ff-line-edit>
            </div>`}return l.html`<div class="ff-flex-row ff-slider-controls">
                ${this._lumSatSlider}${this._hueSlider}${this._alphaSlider}
            </div>${e}`}updated(){this._hueSlider.value=1-this._hsv.x/360;const e=`linear-gradient(to bottom, transparent, black), linear-gradient(to right, white, ${c.setHSV(this._hsv.x).toString(!1)})`;if(this._lumSatSlider.style.backgroundImage=e,this._lumSatSlider.setXY(this._hsv.y,this._hsv.z),this.alpha){const e=this.color.toString(!1),t=getComputedStyle(this._alphaSlider).color,s=`linear-gradient(to top, transparent, ${e}), repeating-linear-gradient(-45deg, transparent, transparent 8px, ${t} 8px, ${t} 16px)`;this._alphaSlider.style.backgroundImage=s,this._alphaSlider.value=this.color.alpha}}onLumSatChange(e){e.stopPropagation();const t=e.detail.value;this._hsv.y=t.x,this._hsv.z=t.y,this.color.setHSV(this._hsv),this.requestUpdate(),this.emitChangeEvent(e.detail.isDragging)}onHueChange(e){e.stopPropagation(),this._hsv.x=360*(1-e.target.value),this.color.setHSV(this._hsv),this.requestUpdate(),this.emitChangeEvent(e.detail.isDragging)}onAlphaChange(e){e.stopPropagation(),this.color.alpha=e.target.value,this.requestUpdate(),this.emitChangeEvent(e.detail.isDragging)}onNumericEdit(e){e.stopPropagation();const t=e.target.name;if("string"===t)this.color.setString(e.detail.text,1,!1);else{let s=parseInt(e.detail.text);if(!isFinite(s))return;this.color[t]=i.default.limit(s,0,255)}this.color.toHSV(this._hsv),this.requestUpdate(),this.emitChangeEvent(e.detail.isEditing)}emitChangeEvent(e){this.dispatchEvent(new CustomEvent("change",{detail:{color:this.color,isDragging:e},bubbles:!0}))}};r([l.property({attribute:!1})],h.prototype,"color",void 0),r([l.property({type:Boolean})],h.prototype,"alpha",void 0),r([l.property({type:Boolean})],h.prototype,"numeric",void 0),h=r([l.customElement("ff-color-edit")],h),t.default=h},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(2);let n=class extends i.default{constructor(){super(...arguments),this.name="",this.index=0,this.text="",this.placeholder="",this.align="left",this.initialValue="",this.requestFocus=!1}get inputElement(){return this.getElementsByTagName("input").item(0)}focus(){this.requestFocus=!0,this.performUpdate()}hasFocus(){return this.inputElement===document.activeElement}firstConnected(){this.classList.add("ff-control","ff-line-edit")}shouldUpdate(e){return!this.hasFocus()&&super.shouldUpdate(e)}render(){return i.html`<input
            type="text" .value=${this.text} placeholder=${this.placeholder}
            @keydown=${this.onKeyDown} @change=${this.onChange} @input=${this.onInput}
            @focus=${this.onFocus} @blur=${this.onBlur}
            style="box-sizing: border-box; width:100%; text-align: ${this.align};">`}updated(){this.requestFocus&&(this.requestFocus=!1,this.inputElement.focus())}onKeyDown(e){const t=e.target;"Enter"===e.key?(this.commit(t),t.blur()):"Escape"===e.key&&(this.revert(t),t.blur())}onChange(e){e.stopPropagation(),e.preventDefault(),this.text=e.target.value,this.dispatchChangeEvent(this.text,!1)}onInput(e){e.stopPropagation(),e.preventDefault(),this.text=e.target.value,this.dispatchChangeEvent(this.text,!0)}onFocus(e){this.initialValue=e.target.value,e.target.select()}onBlur(e){this.commit(e.target),this.requestUpdate()}revert(e){e.value=this.initialValue,this.dispatchChangeEvent(e.value,!1)}commit(e){this.initialValue=e.value,this.dispatchChangeEvent(e.value,!1)}dispatchChangeEvent(e,t){this.dispatchEvent(new CustomEvent("change",{detail:{text:e,isEditing:t}}))}};r([i.property({type:String})],n.prototype,"name",void 0),r([i.property({type:Number})],n.prototype,"index",void 0),r([i.property({type:String})],n.prototype,"text",void 0),r([i.property({type:String})],n.prototype,"placeholder",void 0),r([i.property({type:String})],n.prototype,"align",void 0),n=r([i.customElement("ff-line-edit")],n),t.default=n},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(12),n=s(101),o=s(2),a=s(122);let l=class extends o.default{constructor(){super(),this.value=new n.default,this._offsetX=0,this._offsetY=0,this._knob=(new o.default).addClass("ff-knob").setStyle({display:"block",position:"relative "}),new a.default(this)}setXY(e,t){this.value.set(e,t),this.requestUpdate()}dragStart(e){const t=this._knob,s=this.getBoundingClientRect();e.target===this._knob?(this._offsetX=e.clientX-t.offsetLeft+.5*(t.clientWidth-t.offsetWidth),this._offsetY=e.clientY-t.offsetTop+.5*(t.clientHeight-t.offsetHeight)):(this._offsetX=s.left+.8*t.clientWidth,this._offsetY=s.top+.8*t.clientHeight),this.dragMove(e)}dragMove(e){const t=this._knob,s=e.clientX-this._offsetX,r=e.clientY-this._offsetY;let n=s/(this.clientWidth-t.clientWidth);n=i.default.limit(n,0,1);let o=1-r/(this.clientHeight-t.clientHeight);o=i.default.limit(o,0,1),n===this.value.x&&o===this.value.y||(this.value=this.value.set(n,o),this.emitChangeEvent(!0))}dragEnd(){this.emitChangeEvent(!1)}firstConnected(){this.setStyle({position:"relative",touchAction:"none"}),this.setAttribute("touch-action","none"),this.setAttribute("tabindex","0"),this.classList.add("ff-control","ff-vector-slider"),this.appendChild(this._knob)}update(e){const t=100*this.value.x,s=100*(1-this.value.y);this._knob.style.left=`${t.toFixed(3)}%`,this._knob.style.top=`${s.toFixed(3)}%`,super.update(e)}emitChangeEvent(e){this.dispatchEvent(new CustomEvent("change",{detail:{value:this.value,isDragging:e},bubbles:!0}))}};r([o.property({attribute:!1})],l.prototype,"value",void 0),l=r([o.customElement("ff-vector-slider")],l),t.default=l},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(2);s(7);let n=class extends i.default{constructor(){super(...arguments),this.property=null,this.name=""}firstConnected(){this.classList.add("sv-property-view","sv-property-string")}update(e){if(!this.property)throw new Error("missing property attribute");if("string"!==this.property.type)throw new Error(`not a string property: '${this.property.path}'`);if(e.has("property")){const t=e.get("property");t&&t.off("value",this.onUpdate,this),this.property&&this.property.on("value",this.onUpdate,this)}super.update(e)}render(){const e=this.property,t=this.name||e.name,s=e.value;return i.html`<label class="ff-label ff-off">${t}</label>
            <div class="ff-string">${s}</div>`}};r([i.property({attribute:!1})],n.prototype,"property",void 0),r([i.property({type:String})],n.prototype,"name",void 0),n=r([i.customElement("sv-property-string")],n),t.default=n},function(e){e.exports=JSON.parse('{"asset":{"type":"application/si-dpo-3d.document+json","version":"1.0","copyright":"(c) Smithsonian Institution, all rights reserved","generator":"Voyager"},"scene":0,"scenes":[{"nodes":[0,1],"setup":0}],"nodes":[{"translation":[0,0,15],"camera":0},{"name":"Lights","children":[2,3,4,5]},{"translation":[0,0,2],"rotation":[0.4829741,-0.1070728,0.1880998,0.8484633],"scale":[1,1,1],"name":"Key","light":0},{"rotation":[0.3546969,0.163893,-0.3861077,0.8356136],"scale":[1,1,1],"name":"Fill #1","light":1},{"translation":[0,0,1],"rotation":[0.9374013,-0.3018693,0.0532277,0.1652891],"name":"Fill #2","light":2},{"translation":[1,0,-1],"rotation":[0.373256,0.6426073,-0.5786063,0.3360813],"scale":[1,1,1],"name":"Rim","light":3}],"setups":[{"units":"cm","interface":{"visible":true,"logo":true,"menu":true,"tools":true},"viewer":{"shader":"Default","exposure":1,"gamma":2,"annotationsVisible":false},"reader":{"enabled":false,"position":"Overlay"},"navigation":{"type":"Orbit","enabled":true,"autoZoom":true,"lightsFollowCamera":true,"autoRotation":false,"orbit":{"orbit":[-24,-26,0],"offset":[0,0,150],"minOrbit":[-90,null,null],"maxOrbit":[90,null,null],"minOffset":[null,null,0.1],"maxOffset":[null,null,10000]}},"background":{"style":"RadialGradient","color0":[0.2,0.25,0.3],"color1":[0.01,0.03,0.05]},"floor":{"visible":false,"position":[0,-25,0],"size":50,"color":[0.6,0.75,0.8],"opacity":0.5,"receiveShadow":false},"grid":{"visible":false,"color":[0.5,0.7,0.8]},"tape":{"enabled":false,"startPosition":[0,0,0],"startDirection":[0,0,0],"endPosition":[0,0,0],"endDirection":[0,0,0]},"slicer":{"enabled":false,"axis":"X","inverted":false,"position":0.5}}],"cameras":[{"type":"perspective","perspective":{"yfov":52,"znear":0.1,"zfar":100000}}],"lights":[{"color":[1,0.95,0.9],"intensity":1,"type":"directional","shadowEnabled":true},{"color":[0.9,0.95,1],"intensity":0.7,"type":"directional","shadowEnabled":true},{"color":[0.8,0.85,1],"intensity":0.5,"type":"directional"},{"color":[0.85,0.9078313,1],"intensity":0.6,"type":"directional"}]}')},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(69),n=s(33),o=s(19),a=s(250);s(257),s(258);const l=s(24);let c=class extends l.default{constructor(){super(...arguments),this.sceneView=null,this.documentProps=new i.default("value",this.onUpdate,this)}get assetManager(){return this.system.getMainComponent(o.default)}get reader(){return this.activeDocument?this.activeDocument.setup.reader:null}get tours(){return this.activeDocument?this.activeDocument.setup.tours:null}firstConnected(){this.classList.add("sv-content-view"),this.sceneView=new a.default(this.system)}connected(){super.connected(),this.assetManager.outs.busy.on("value",this.performUpdate,this)}disconnected(){this.assetManager.outs.busy.off("value",this.performUpdate,this),super.disconnected()}render(){const e=this.system,t=this.assetManager.outs.busy.value;let s=!1,r=n.EReaderPosition.Overlay,i=!1;const o=this.reader,a=this.tours;a&&(i=a.ins.enabled.value&&-1===a.outs.tourIndex.value),o&&(s=!i&&o.ins.enabled.value,r=o.ins.position.value);const c=this.sceneView;if(s&&r===n.EReaderPosition.Overlay||i?setTimeout(()=>c.classList.add("sv-blur"),1):c.classList.remove("sv-blur"),s){if(r===n.EReaderPosition.Right)return l.html`<div class="ff-fullsize sv-content-split">
                    ${c}
                    <ff-splitter direction="horizontal"></ff-splitter>
                    <sv-reader-view .system=${e} class="sv-reader-split"></sv-reader-view></div>
                    <sv-spinner ?visible=${t}></sv-spinner>`;if(r===n.EReaderPosition.Overlay)return l.html`<div class="ff-fullsize sv-content-stack">${c}
                    <div class="sv-reader-container">
                        <sv-reader-view .system=${e} @close=${this.onReaderClose}></sv-reader-view>
                    </div>
                    <sv-spinner ?visible=${t}></sv-spinner></div>`}return l.html`<div class="ff-fullsize sv-content-only">${c}</div>
            <sv-spinner ?visible=${t}></sv-spinner>`}onReaderClose(){this.reader.ins.enabled.setValue(!1)}onActiveDocument(e,t){e&&this.documentProps.off(),t&&this.documentProps.on(t.setup.reader.ins.position,t.setup.reader.ins.enabled,t.setup.tours.outs.tourIndex),this.requestUpdate()}};c=r([l.customElement("sv-content-view")],c),t.default=c},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(251),n=s(252),o=s(67),a=s(255);let l=class extends o.default{constructor(e){super(e),this.view=null,this.canvas=null,this.overlay=null,this.splitter=null,this.onResize=this.onResize.bind(this),this.manipTarget=new i.default,this.addEventListener("pointerdown",this.manipTarget.onPointerDown),this.addEventListener("pointermove",this.manipTarget.onPointerMove),this.addEventListener("pointerup",this.manipTarget.onPointerUpOrCancel),this.addEventListener("pointercancel",this.manipTarget.onPointerUpOrCancel),this.addEventListener("wheel",this.manipTarget.onWheel),this.addEventListener("contextmenu",this.manipTarget.onContextMenu)}firstConnected(){this.classList.add("sv-scene-view"),this.style.touchAction="none",this.setAttribute("touch-action","none"),this.canvas=this.appendElement("canvas",{display:"block",width:"100%",height:"100%"}),this.overlay=this.appendElement("div",{position:"absolute",top:"0",bottom:"0",left:"0",right:"0",overflow:"hidden"}),this.overlay.classList.add("sv-content-overlay"),this.splitter=this.appendElement(a.default,{position:"absolute",top:"0",bottom:"0",left:"0",right:"0",overflow:"hidden"}),this.splitter.onChange=e=>{this.view.horizontalSplit=e.horizontalSplit,this.view.verticalSplit=e.verticalSplit},this.view=new n.default(this.system,this.canvas,this.overlay),this.view.on("layout",e=>this.splitter.layout=e.layout),this.view.layout=a.EQuadViewLayout.Single,this.splitter.layout=a.EQuadViewLayout.Single,this.manipTarget.next=this.view}connected(){this.view.attach(),window.addEventListener("resize",this.onResize),window.dispatchEvent(new CustomEvent("resize"))}disconnected(){this.view.detach(),window.removeEventListener("resize",this.onResize)}onResize(){this.view.resize()}};l=r([o.customElement("sv-scene-view")],l),t.default=l},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=2;t.default=class{constructor(){this.next=null,this.activePositions=[],this.activeType="",this.centerX=0,this.centerY=0,this.startX=0,this.startY=0,this.isDragging=!1,this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUpOrCancel=this.onPointerUpOrCancel.bind(this),this.onDoubleClick=this.onDoubleClick.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onWheel=this.onWheel.bind(this)}onPointerDown(e){if(this.activeType&&e.pointerType!==this.activeType)return;0===this.activePositions.length&&(this.startX=e.clientX,this.startY=e.clientY,this.isDragging=!1),this.activeType=e.pointerType,this.activePositions.push({id:e.pointerId,clientX:e.clientX,clientY:e.clientY}),e.currentTarget.setPointerCapture(e.pointerId);const t=this.createManipPointerEvent(e,"pointer-down");this.sendPointerEvent(t)&&e.stopPropagation(),e.preventDefault()}onPointerMove(e){const t=this.activePositions;for(let s=0,r=t.length;s<r;++s){const r=t[s];e.pointerId===r.id&&(r.clientX=e.clientX,r.clientY=e.clientY)}if(t.length>0&&!this.isDragging){Math.abs(e.clientX-this.startX)+Math.abs(e.clientY-this.startY)>r&&(this.isDragging=!0)}const s=t.length?"pointer-move":"pointer-hover",i=this.createManipPointerEvent(e,s);this.sendPointerEvent(i)&&e.stopPropagation(),e.preventDefault()}onPointerUpOrCancel(e){const t=this.activePositions;let s=!1;for(let r=0,i=t.length;r<i;++r)if(e.pointerId===t[r].id){t.splice(r,1),s=!0;break}if(!s)return;const r=this.createManipPointerEvent(e,"pointer-up");0===t.length&&(this.activeType=""),this.sendPointerEvent(r)&&e.stopPropagation(),e.preventDefault()}onDoubleClick(e){this.sendTriggerEvent(this.createManipTriggerEvent(e,"double-click"))&&e.preventDefault()}onContextMenu(e){this.sendTriggerEvent(this.createManipTriggerEvent(e,"context-menu")),e.preventDefault()}onWheel(e){this.sendTriggerEvent(this.createManipTriggerEvent(e,"wheel"))&&e.preventDefault()}createManipPointerEvent(e,t){let s=0,r=0,i=0,n=0,o=0,a=0;const l=this.activePositions,c=l.length;if(c>0){for(let e=0;e<c;++e)s+=l[e].clientX,r+=l[e].clientY;s/=c,r/=c,"pointer-move"!==t&&"pointer-hover"!==t||(o=s-this.centerX,a=r-this.centerY),this.centerX=s,this.centerY=r}else s=this.centerX,r=this.centerY;const h=e.currentTarget;if(h instanceof Element){const t=h.getBoundingClientRect();i=e.clientX-t.left,n=e.clientY-t.top}return{originalEvent:e,type:t,source:e.pointerType,isPrimary:e.isPrimary,isDragging:this.isDragging,activePositions:l,pointerCount:c,centerX:s,centerY:r,localX:i,localY:n,movementX:o,movementY:a,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,altKey:e.altKey,metaKey:e.metaKey}}createManipTriggerEvent(e,t){let s=0;"wheel"===t&&(s=e.deltaY);let r=0,i=0;const n=e.currentTarget;if(n instanceof Element){const t=n.getBoundingClientRect();r=e.clientX-t.left,i=e.clientY-t.top}return{originalEvent:e,type:t,wheel:s,centerX:e.clientX,centerY:e.clientY,localX:r,localY:i,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,altKey:e.altKey,metaKey:e.metaKey}}sendPointerEvent(e){return this.next&&this.next.onPointer(e)}sendTriggerEvent(e){return this.next&&this.next.onTrigger(e)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(35),i=s(253);var n;!function(e){e[e.Single=0]="Single",e[e.HorizontalSplit=1]="HorizontalSplit",e[e.VerticalSplit=2]="VerticalSplit",e[e.Quad=3]="Quad"}(n=t.EQuadViewLayout||(t.EQuadViewLayout={}));class o extends i.default{constructor(e,t,s){super(e,t,s),this._layout=n.Quad,this._horizontalSplit=.5,this._verticalSplit=.5,this.addEvent("layout"),this.layout=n.Single}set layout(e){if(e===this._layout)return;this._layout=e;const t=this.viewports;switch(this._layout){case n.Single:this.setViewportCount(1);break;case n.HorizontalSplit:case n.VerticalSplit:this.setViewportCount(2);break;case n.Quad:this.setViewportCount(4)}this.updateSplitPositions(),t[1]&&(t[1].setBuiltInCamera(r.EProjection.Orthographic,r.EViewPreset.Top),t[1].enableCameraControl(!0).orientationEnabled=!1),t[2]&&(t[2].setBuiltInCamera(r.EProjection.Orthographic,r.EViewPreset.Left),t[2].enableCameraControl(!0).orientationEnabled=!1),t[3]&&(t[3].setBuiltInCamera(r.EProjection.Orthographic,r.EViewPreset.Front),t[3].enableCameraControl(!0).orientationEnabled=!1),this.emit({type:"layout",layout:e})}get layout(){return this._layout}set horizontalSplit(e){this._horizontalSplit=e,this.updateSplitPositions()}get horizontalSplit(){return this._horizontalSplit}set verticalSplit(e){this._verticalSplit=e,this.updateSplitPositions()}get verticalSplit(){return this._verticalSplit}updateSplitPositions(){const e=this._horizontalSplit,t=this._verticalSplit;switch(this._layout){case n.Single:this.viewports[0].setSize(0,0,1,1);break;case n.HorizontalSplit:this.viewports[0].setSize(0,0,e,1),this.viewports[1].setSize(e,0,1-e,1);break;case n.VerticalSplit:this.viewports[0].setSize(0,1-t,1,t),this.viewports[1].setSize(0,0,1,1-t);break;case n.Quad:this.viewports[0].setSize(0,1-t,e,t),this.viewports[1].setSize(e,1-t,1-e,t),this.viewports[2].setSize(0,0,e,1-t),this.viewports[3].setSize(e,0,1-e,1-t)}}}t.default=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(8),n=s(81),o=s(254);t.Viewport=o.default;const a=s(126),l=s(55),c=s(26),h=s(35);class u extends i.default{constructor(e,t,s){super(),this.viewports=[],this.rendererComponent=null,this.targetViewport=null,this.targetObject3D=null,this.targetComponent=null,this.targetScene=null,this.targetCamera=null,this.defaultScene=new r.Scene,this.defaultCamera=new h.default,this.system=e,this.canvas=t,this.overlay=s,this.renderer=new r.WebGLRenderer({canvas:t,antialias:!0}),this.renderer.autoClear=!1,this.renderer.gammaOutput=!0,this.renderer.gammaFactor=2,this.picker=new l.default(this.renderer)}dispose(){this.renderer.dispose(),this.viewports.forEach(e=>e.dispose())}get canvasWidth(){return this.canvas.width}get canvasHeight(){return this.canvas.height}attach(){const e=this.canvasWidth,t=this.canvasHeight;this.viewports.forEach(s=>s.setCanvasSize(e,t)),this.renderer.setSize(e,t,!1),this.rendererComponent=this.system.getComponent(c.default,!0),this.rendererComponent.attachView(this)}detach(){this.rendererComponent=this.system.getComponent(c.default,!0),this.rendererComponent.detachView(this),this.rendererComponent=null}renderImage(e,t,s,r){const i=this.canvas.width,n=this.canvas.height;this.setRenderSize(e,t),this.render();const o=this.canvas.toDataURL(s,r);return this.setRenderSize(i,n),o}render(){const e=this.rendererComponent.activeSceneComponent;if(!e)return;let t=e.scene,s=e.activeCamera;t&&s||(t=this.defaultScene,s=this.defaultCamera);const r=this.renderer;r.clear(),r.__view=this;const i=this.viewports;for(let e=0,n=i.length;e<n;++e){const n=i[e];r.__viewport=n;const o=n.updateCamera(s);n.applyViewport(this.renderer),r.render(t,o)}}setRenderSize(e,t){this.canvas.width=e,this.canvas.height=t,this.viewports.forEach(s=>s.setCanvasSize(e,t)),this.renderer.setSize(e,t,!1)}resize(){this.setRenderSize(this.canvas.clientWidth,this.canvas.clientHeight),this.render()}setViewportCount(e){const t=this.viewports;for(let s=e;s<t.length;++s)t[s].dispose();for(let s=t.length;s<e;++s){const e=(new a.default).appendTo(this.overlay);t[s]=new o.default,t[s].setCanvasSize(this.canvasWidth,this.canvasHeight),t[s].overlay=e}t.length=e}getViewportCount(){return this.viewports.length}onPointer(e){if(!this.system)return!1;let t=!1,s=!1;"pointer-hover"===e.type?s=!0:e.isPrimary&&"pointer-down"===e.type&&(s=!0,t=!0);const r=this.routeEvent(e,s,t);if(r){const e=r.component;if(e){e.emit(r);const t=e.getComponent(n.default);!r.stopPropagation&&t&&t.propagateUp(!1,!0,r)}if(r.stopPropagation||this.system.emit(r),!r.stopPropagation){r.viewport.onPointer(r)&&this.system.getMainComponent(c.default).forceRender()}return!0}return!1}onTrigger(e){if(!this.system)return!1;const t=this.routeEvent(e,!0,!0);if(t){const e=t.component;if(e){e.emit(t);const s=e.getComponent(n.default);!t.stopPropagation&&s&&s.propagateUp(!1,!0,t)}if(t.stopPropagation||this.system.emit(t),!t.stopPropagation){t.viewport.onTrigger(t)&&this.system.getMainComponent(c.default).forceRender()}return!0}return!1}pickPosition(e,t,s){return this.picker.pickPosition(this.targetScene,this.targetCamera,e,t,s)}pickNormal(e,t){return this.picker.pickNormal(this.targetScene,this.targetCamera,e,t)}routeEvent(e,t,s){let r=this.targetViewport,i=this.targetObject3D,n=this.targetComponent;if(t){r=null;const t=this.viewports;for(let s=0,i=t.length;s<i;++s){const i=t[s];if(i.isInside(e)){r=i;break}}}if(!r)return null;const o=e;if(o.view=this,o.viewport=r,o.deviceX=r.getDeviceX(e.localX),o.deviceY=r.getDeviceY(e.localY),o.stopPropagation=!1,s){const t=this.rendererComponent.activeSceneComponent,s=this.targetScene=t&&t.scene,r=this.targetCamera=t&&t.activeCamera;if(i=null,n=null,s&&r)if(void 0===(i=this.picker.pickObject(s,r,e)))0;else{let e=i;for(;e&&!n;)(n=e.userData.component)||(e=e.parent);0}}return o.object3D=i,o.component=n,this.targetViewport=r,this.targetObject3D=i,this.targetComponent=n,o}}t.default=u},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(1),i=s(8),n=s(35),o=s(126),a=s(107);class l extends i.default{constructor(e){super(),this.next=null,this._canvasWidth=1,this._canvasHeight=1,this._overlay=null,this._camera=null,this._controller=null,this.addEvent("dispose"),this.next=null,e=e||{},this._relRect={x:e.x||0,y:e.y||0,width:e.width||1,height:e.height||1},this._absRect={x:0,y:0,width:1,height:1},e.overlay&&(this._overlay=e.overlay)}get x(){return this._absRect.x}get y(){return this._absRect.y}get width(){return this._absRect.width}get height(){return this._absRect.height}get canvasWidth(){return this._canvasWidth}get canvasHeight(){return this._canvasHeight}get camera(){return this._camera}get controller(){return this._controller}get overlay(){return this._overlay}set overlay(e){this._overlay=e,this.updateGeometry()}dispose(){this.emit({type:"dispose",viewport:this}),this._overlay&&(this._overlay.remove(),this._overlay=null)}setSize(e,t,s,r){const i=this._relRect;i.x=e,i.y=t,i.width=s,i.height=r,this.updateGeometry()}setCanvasSize(e,t){this._canvasWidth=e,this._canvasHeight=t,this.updateGeometry(),this._controller&&this._controller.setViewportSize(e,t)}setBuiltInCamera(e,t){this._camera?this._camera.setProjection(e):(this._camera=new n.default(e),this._camera.matrixAutoUpdate=!1),void 0!==t&&(this._camera.setPreset(t),this.overlay.setLabel(o.ELocation.TopRight,"view",n.EViewPreset[t],"ff-label-box"))}unsetBuiltInCamera(){this._camera=null,this._controller=null,this.overlay.unsetLabel(o.ELocation.TopRight,"view")}enableCameraControl(e){return!e&&this._controller?this._controller=null:e&&this._camera&&(this._controller||(this._controller=new a.default(this._camera),this._controller.setViewportSize(this.width,this.height),this._controller.updateController())),this._controller}zoomExtents(e){const t=this._camera,s=this._controller;t&&s&&(s.zoomExtents(e),s.updateCamera(null,!0))}isInside(e){return this.isPointInside(e.localX,e.localY)}isPointInside(e,t){const s=this._absRect;return t=this.canvasHeight-t,e>=s.x&&e<s.x+s.width&&t>=s.y&&t<s.y+s.height}getDevicePoint(e,t,s){const i=this._absRect,n=(e-i.x)/i.width*2-1,o=(this.canvasHeight-t-i.y)/i.height*2-1;return s?s.set(n,o):new r.Vector2(n,o)}getDeviceX(e){const t=this._absRect;return(e-t.x)/t.width*2-1}getDeviceY(e){const t=this._absRect;return(this.canvasHeight-e-t.y)/t.height*2-1}updateCamera(e){let t=e;if(this._camera&&(t=this._camera,this._controller&&this._controller.updateCamera()),!t)return;const s=this._absRect,r=s.width/s.height;if(r!==t.userData.aspect)if(t.userData.aspect=r,t.isUniversalCamera||t.isPerspectiveCamera)t.aspect=r,t.updateProjectionMatrix();else if(t.isOrthographicCamera){const e=.5*(t.top-t.bottom);t.left=-e*r,t.right=e*r,t.updateProjectionMatrix()}return t}applyViewport(e){const t=this._absRect;e.setViewport(t.x,t.y,t.width,t.height),e.viewport=this}applyPickViewport(e,t){const s=this._absRect,r=t.localX-s.x,i=this.canvasHeight-t.localY-s.y;e.viewport.set(-r,-i,s.width,s.height)}toViewportEvent(e){const t=e;return t.viewport=this,t.deviceX=this.getDeviceX(e.localX),t.deviceY=this.getDeviceY(e.localY),t}onPointer(e){return!!this._controller&&this._controller.onPointer(e)}onTrigger(e){return!!this._controller&&this._controller.onTrigger(e)}toString(){return`Viewport (x: ${this.x}, y: ${this.y}, width: ${this.width}, height: ${this.height})`}updateGeometry(){const e=this._relRect,t=this._absRect,s=this._canvasWidth,r=this._canvasHeight;t.x=Math.round(e.x*s),t.y=Math.round(e.y*r),t.width=Math.round(e.width*s),t.height=Math.round(e.height*r);const i=this._overlay;if(i){const e=this.canvasHeight-t.y-t.height;i.style.left=t.x?t.x.toFixed()+"px":"0",i.style.top=e?e.toFixed()+"px":"0",i.style.width=t.width.toFixed()+"px",i.style.height=t.height.toFixed()+"px"}}}t.default=l},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0}),s(256);const i=s(2);var n;!function(e){e[e.Single=0]="Single",e[e.HorizontalSplit=1]="HorizontalSplit",e[e.VerticalSplit=2]="VerticalSplit",e[e.Quad=3]="Quad"}(n=t.EQuadViewLayout||(t.EQuadViewLayout={}));let o=class extends i.default{constructor(){super(...arguments),this.layout=n.Single,this.horizontalPosition=.5,this.verticalPosition=.5}firstConnected(){this.classList.add("ff-quad-splitter")}render(){const e=this.layout;if(e===n.Single)return i.html``;const t=[];return e!==n.HorizontalSplit&&e!==n.Quad||t.push(i.html`
                <div class="ff-horizontal" style="position:absolute; top:0; bottom:0; left:0; right:0; display:flex;">
                    <div class="ff-left" style="flex:1 1;"></div>
                    <ff-splitter direction="horizontal" position=${this.horizontalPosition} @ff-splitter-change=${this.onSplitterChange}></ff-splitter>
                    <div style="flex:1 1;"></div>
                </div>
            `),e!==n.VerticalSplit&&e!==n.Quad||t.push(i.html`
                <div class="ff-vertical" style="position:absolute; top:0; bottom:0; left:0; right:0; display:flex; flex-direction: column">
                    <div class="ff-top" style="flex:1 1;"></div>
                    <ff-splitter direction="vertical" position=${this.verticalPosition} @ff-splitter-change=${this.onSplitterChange}></ff-splitter>
                    <div style="flex:1 1;"></div>
                </div>
            `),i.html`${t}`}onSplitterChange(e){"horizontal"===e.detail.direction?this.horizontalPosition=e.detail.position:this.verticalPosition=e.detail.position,this.onChange&&this.onChange({layout:this.layout,horizontalSplit:this.horizontalPosition,verticalSplit:this.verticalPosition,isDragging:e.detail.isDragging})}};r([i.property({attribute:!1})],o.prototype,"layout",void 0),r([i.property({attribute:!1})],o.prototype,"horizontalPosition",void 0),r([i.property({attribute:!1})],o.prototype,"verticalPosition",void 0),o=r([i.customElement("ff-quad-splitter")],o),t.default=o},function(e,t,s){"use strict";var r,i=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const n=s(2);let o=r=class extends n.default{constructor(){super(),this.direction="horizontal",this.width=5,this.margin=20,this.detached=!1,this._isActive=!1,this._offset=0,this._position=0,this.addEventListener("pointerdown",e=>this.onPointerDown(e)),this.addEventListener("pointermove",e=>this.onPointerMove(e)),this.addEventListener("pointerup",e=>this.onPointerUpOrCancel(e)),this.addEventListener("pointercancel",e=>this.onPointerUpOrCancel(e))}get position(){return this._position}isHorizontal(){return"horizontal"===this.direction}update(e){super.update(e);const t=this.isHorizontal(),s=this.width;this.setStyle({padding:t?`0 ${s}px`:`${s}px 0`,margin:t?`0 ${-s}px`:`${-s}px 0`,cursor:t?"col-resize":"row-resize"})}firstUpdated(){this.classList.add("ff-splitter"),this.setAttribute("touch-action","none"),this.setStyle({position:"relative",display:"block",zIndex:"1",touchAction:"none"})}onPointerDown(e){if(e.isPrimary){e.stopPropagation(),e.preventDefault(),this._isActive=!0,this.setPointerCapture(e.pointerId);const t=this.getBoundingClientRect();this._offset=this.isHorizontal()?t.left+.5*t.width-e.clientX:t.top+.5*t.height-e.clientY}}onPointerMove(e){if(e.isPrimary&&this._isActive){e.stopPropagation(),e.preventDefault();const t=this.parentElement;if(!t)return;const s=t.getBoundingClientRect(),i=this.isHorizontal(),n=i?s.width:s.height;let o=this._offset+(i?e.clientX-s.left:e.clientY-s.top),a=o/n;if(!this.detached){const e=this.previousElementSibling,s=this.nextElementSibling;if(e instanceof HTMLElement&&s instanceof HTMLElement){const l=Array.from(t.children);let c=0,h=n,u=!1;l.forEach(t=>{if(t instanceof r)return;if(t===e||t===s)return void(u=!0);const n=t.getBoundingClientRect(),o=i?n.width:n.height;h-=o,u||(c+=o)});const d=this.margin,p=h-d,f=(h-(o=(o-=c)<d?d:o>p?p:o))/n;a=o/n,e.style.flexBasis=(100*a).toFixed(3)+"%",s.style.flexBasis=(100*f).toFixed(3)+"%",setTimeout(()=>window.dispatchEvent(new CustomEvent("resize")),0)}}this._position=a,this.dispatchEvent(new CustomEvent(r.changeEvent,{detail:{direction:this.direction,position:this._position,isDragging:!0}}))}}onPointerUpOrCancel(e){e.isPrimary&&(e.stopPropagation(),e.preventDefault(),this._isActive=!1,this.dispatchEvent(new CustomEvent(r.changeEvent,{detail:{direction:this.direction,position:this._position,isDragging:!1}})))}};o.changeEvent="ff-splitter-change",i([n.property({type:String})],o.prototype,"direction",void 0),i([n.property({type:Number})],o.prototype,"width",void 0),i([n.property({type:Number})],o.prototype,"margin",void 0),i([n.property({type:Boolean})],o.prototype,"detached",void 0),o=r=i([n.customElement("ff-splitter")],o),t.default=o},function(e,t,s){"use strict";var r,i=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const n=s(2);let o=r=class extends n.default{constructor(){super(...arguments),this.visible=!1}firstConnected(){super.firstConnected(),this.classList.add("sv-spinner")}render(){return this.style.visibility=this.visible?"visible":"hidden",r.template}};o.template=n.html`<div class="sv-spinner-wheel"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve"><style type="text/css">.st0{fill:none;stroke:#009ADE;stroke-width:5;stroke-miterlimit:10;}.st1{fill:none;stroke:#FFCD00;stroke-width:5;stroke-miterlimit:10;}</style><circle class="st0" cx="256.6" cy="256" r="252"/><path class="st1" d="M408.6,307c-16.3-28-42.1-28.4-45.3-28.3c0,0,0-0.1,0-0.1L472,256l-108.7-22.6l0,0c1.1-1,22.3-19.7,54-20.2 c23.9-0.4,44.6-29.6,31.4-52.1c0,0-3.9,35.4-48.6,23.6c-31.4-8.3-49.9,9.7-52,12l0,0l60.9-93L316,164.5c0,0,0,0,0,0 c0.1-1.4,1.8-29.6,23.9-52.4c16.7-17.2,10.6-52.5-14.6-59.1c0,0,22.2,27.8-17.7,51c-28.1,16.3-28.4,42.1-28.3,45.3l-0.1,0 L256.6,40.5l-22.7,108.7c0,0,0,0,0,0c-0.9-1-19.7-22.2-20.2-54c-0.4-23.9-29.6-44.6-52.1-31.4c0,0,35.3,3.9,23.6,48.6 c-8.3,31.5,9.8,49.9,12,52.1l0,0l-93-60.9l0,0l0,0l49.6,75.7l11.3,17.2c0,0,0,0,0,0c-0.9,0-29.4-1.6-52.5-23.9 c-17.2-16.7-52.5-10.6-59.1,14.6c0,0,27.8-22.2,51,17.7c16.4,28.1,42.3,28.4,45.3,28.3c0,0,0,0,0,0L41.1,256l108.8,22.7v0 c-0.7,0.7-22,19.7-54,20.2c-23.9,0.4-44.6,29.6-31.4,52.1c0,0,3.9-35.4,48.6-23.6c31.5,8.3,50-9.9,52.1-12c0,0,0,0.1,0.1,0.1 l-60.9,92.9l92.9-60.9c0,1-1.6,29.5-23.9,52.5c-16.7,17.2-10.6,52.5,14.6,59.1c0,0-22.2-27.8,17.7-51c28.1-16.4,28.4-42.2,28.3-45.3 c0,0,0.1,0,0.1,0l22.7,108.7l22.7-108.7l0,0c0.8,0.9,19.7,22.1,20.2,54c0.4,23.9,29.6,44.6,52.1,31.4c0,0-35.3-3.9-23.6-48.5 c8.3-31.5-9.8-49.9-12-52.1c0,0,0.1,0,0.1-0.1l92.9,60.9l-32.1-49.1L348,315.4l0,0c1.3,0.1,29.6,1.7,52.4,23.9 c17.2,16.7,52.5,10.6,59.1-14.6C459.6,324.7,431.8,346.9,408.6,307z"/></svg></div>`,i([n.property({type:Boolean})],o.prototype,"visible",void 0),o=r=i([n.customElement("sv-spinner")],o),t.default=o},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0}),s(7);const i=s(24);let n=class extends i.default{constructor(){super(...arguments),this.reader=null}firstConnected(){super.firstConnected(),this.classList.add("sv-reader-view")}renderMenuEntry(e){const t=e.article;return i.html`<div class="sv-entry" @click=${e=>this.onClickArticle(e,t.id)}>
            <h1>${t.data.title}</h1>
            <p>${t.data.lead}</p>
        </div>`}render(){const e=this.reader;if(!e)return i.html`<div class="ff-placeholder">Please select a document to display its articles.</div>`;if(!e.activeArticle){const t=e.articles;return i.html`<div class="sv-left"></div><div class="sv-article">
                <ff-button class="sv-nav-button" inline title="Close Article Reader" icon="close" @click=${this.onClickClose}></ff-button>
                ${t.map(e=>this.renderMenuEntry(e))}
            </div><div class="sv-right"></div>`}return i.html`<div class="sv-left"></div><div class="sv-article">
                <ff-button class="sv-nav-button" inline title="Close Article Reader" icon="close" @click=${this.onClickClose}></ff-button>
                <ff-button class="sv-nav-button" inline title="Article Menu" icon="bars" @click=${this.onClickMenu}></ff-button>
                <div class="sv-container"></div>
            </div><div class="sv-right"></div>`}onClickMenu(e){e.stopPropagation(),this.reader.ins.articleId.setValue("")}onClickClose(e){e.stopPropagation(),this.dispatchEvent(new CustomEvent("close"))}onClickArticle(e,t){this.reader.ins.articleId.setValue(t)}updated(e){super.updated(e);const t=this.reader;if(t&&t.activeArticle){this.getElementsByClassName("sv-container").item(0).innerHTML=t.outs.content.value}}onActiveDocument(e,t){e&&(this.reader.outs.content.off("value",this.onUpdate,this),this.reader.outs.article.off("value",this.onUpdate,this),this.reader=null),t&&(this.reader=t.setup.reader,this.reader.outs.content.on("value",this.onUpdate,this),this.reader.outs.article.on("value",this.onUpdate,this))}};n=r([i.customElement("sv-reader-view")],n),t.default=n},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(69);s(260);const n=s(38);s(261),s(262),s(266),s(267),s(268),s(269);const o=s(24);let a=class extends o.default{constructor(){super(...arguments),this.documentProps=new i.default("value",this.onUpdate,this)}get toolProvider(){return this.system.getMainComponent(n.default)}firstConnected(){this.style.pointerEvents="none",this.setAttribute("pointer-events","none"),this.classList.add("sv-chrome-view")}connected(){super.connected(),this.toolProvider.ins.visible.on("value",this.onUpdate,this)}disconnected(){this.toolProvider.ins.visible.off("value",this.onUpdate,this),super.disconnected()}render(){const e=this.activeDocument;if(!e)return o.html``;const t=e.setup,s=t.interface.ins.visible.value,r=t.interface.ins.logo.value,i=t.reader.ins.enabled.value,n=t.tours.tours,a=t.tours.ins.enabled.value,l=t.tours.outs.tourIndex.value>=0,c=t.viewer.ins.annotationsVisible.value&&t.viewer.outs.tagCloud.value,h=!i&&this.toolProvider.ins.visible.value;if(!s)return o.html``;let u;return u=a?l?"Tour: "+t.tours.outs.tourTitle.value:"Interactive Tours":e.outs.title.value||e.name||"Untitled Document",o.html`
            <div class="sv-chrome-header">
                <sv-main-menu .system=${this.system}></sv-main-menu>
                <div class="sv-top-bar">
                    <div class="ff-ellipsis sv-main-title">${u}<span class="ff-ellipsis"> </span></div>
                    ${r?o.html`<sv-logo></sv-logo>`:null}
                </div>
            </div>
            <div class="ff-flex-spacer"></div>
            ${a&&l?o.html`<sv-tour-navigator .system=${this.system}></sv-tour-navigator>`:null}
            ${a&&!l?o.html`<sv-tour-menu .tours=${n} @select=${this.onSelectTour}></sv-tour-menu>`:null}
            ${c&&!a?o.html`<sv-tag-cloud .system=${this.system}></sv-tag-cloud>`:null}
            ${h&&!a?o.html`<div class="sv-tool-bar-container"><sv-tool-bar .system=${this.system} @close=${this.closeTools}></sv-tool-bar></div>`:null}`}onSelectTour(e){this.activeDocument.setup.tours.ins.tourIndex.setValue(e.detail.index)}closeTools(){this.toolProvider.ins.visible.setValue(!1)}onActiveDocument(e,t){if(e&&this.documentProps.off(),t){const e=t.setup;this.documentProps.on(t.outs.title,t.outs.assetPath,e.interface.ins.visible,e.interface.ins.logo,e.viewer.ins.annotationsVisible,e.reader.ins.enabled,e.tours.ins.enabled,e.tours.outs.tourIndex)}this.requestUpdate()}};a=r([o.customElement("sv-chrome-view")],a),t.default=a},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(2),n=s(7);let o=class extends i.default{constructor(){super(),this.mode="radio",this.selectionIndex=-1,this.observer=new MutationObserver(this.onObserver),this.selectedButton=null,this.addEventListener("click",e=>this.onClick(e))}firstConnected(){this.classList.add("ff-button-group"),this.parseChildren()}connected(){this.observer.observe(this,{childList:!0})}disconnected(){this.observer.disconnect()}onObserver(e){e.forEach(e=>{"childList"===e.type&&this.parseChildren()})}onClick(e){let t=e.target;for(;t&&t!==this&&!(t instanceof n.default);)t=t.parentElement;t instanceof n.default&&(t.selected?"exclusive"===this.mode&&(t.selected=!1,this.selectedButton=null,this.selectionIndex=-1):(this.selectedButton&&(this.selectedButton.selected=!1),this.selectedButton=t,this.selectedButton.selected=!0,this.selectionIndex=this.getButtons().indexOf(t)))}parseChildren(){const e=this.getButtons();this.selectedButton&&(this.selectionIndex=e.indexOf(this.selectedButton),this.selectionIndex<0&&(this.selectedButton.selected=!1,this.selectedButton=null)),(this.selectionIndex<0||this.selectionIndex>=e.length)&&(this.selectionIndex="radio"===this.mode?0:-1),this.selectionIndex>=0&&(this.selectedButton=e[this.selectionIndex],this.selectedButton.selected=!0)}getButtons(){return this.getChildrenArray().filter(e=>e instanceof n.default)}};r([i.property({type:String})],o.prototype,"mode",void 0),r([i.property({type:Number})],o.prototype,"selectionIndex",void 0),o=r([i.customElement("ff-button-group")],o),t.default=o},function(e,t,s){"use strict";var r,i=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const n=s(2);let o=r=class extends n.default{firstConnected(){super.firstConnected(),this.classList.add("sv-logo")}render(){return n.html`<div class="sv-short">${r.sunburst}</div><div class="sv-full">${r.sunburst}${r.smithsonian}</div>`}};o.sunburst=n.html`<div class="sv-sunburst"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 158 158"><defs><style>.si-blue{fill:#009cde;}.si-yellow{fill:#ffcd00;}</style></defs><title>si-sunburst</title><circle class="si-blue" cx="79.02" cy="79" r="79.02"/><path class="si-yellow" d="M126.69,95c-5.12-8.8-13.2-8.9-14.2-8.87v0L146.59,79l-34.1-7.1h0a27.63,27.63,0,0,1,16.93-6.32c7.5-.11,14-9.29,9.85-16.35,0,0-1.23,11.09-15.23,7.39-9.84-2.6-15.63,3-16.32,3.77h0l19.09-29.14L97.67,50.32h0a27.47,27.47,0,0,1,7.49-16.44c5.23-5.39,3.33-16.47-4.59-18.53,0,0,7,8.71-5.54,16-8.8,5.13-8.9,13.21-8.88,14.21h0L79,11.43l-7.1,34.11h0a27.53,27.53,0,0,1-6.33-16.93c-.11-7.5-9.29-14-16.35-9.86,0,0,11.09,1.24,7.39,15.23C54,43.85,59.7,49.64,60.4,50.31h0L31.24,31.22h0L46.8,55l3.54,5.39h0a27.55,27.55,0,0,1-16.45-7.5c-5.39-5.22-16.47-3.32-18.53,4.59,0,0,8.71-7,16,5.55,5.14,8.82,13.26,8.89,14.22,8.87h0L11.45,79l34.1,7.11h0a27.56,27.56,0,0,1-16.93,6.32c-7.51.12-14,9.3-9.86,16.35,0,0,1.24-11.08,15.24-7.39,9.88,2.61,15.67-3.1,16.32-3.78l0,0L31.25,126.79,60.38,107.7a27.51,27.51,0,0,1-7.5,16.44c-5.22,5.39-3.32,16.47,4.59,18.53,0,0-7-8.71,5.55-16,8.82-5.14,8.89-13.25,8.87-14.21h0L79,146.57l7.11-34.09h0a27.67,27.67,0,0,1,6.33,16.94c.11,7.5,9.29,14,16.34,9.85,0,0-11.08-1.23-7.39-15.23,2.61-9.86-3.07-15.65-3.77-16.32l0,0,29.13,19.09L116.73,111.4l-9-13.76h0a27.64,27.64,0,0,1,16.45,7.5c5.38,5.23,16.47,3.33,18.53-4.59C142.69,100.55,134,107.52,126.69,95Z"/></svg></div>`,o.smithsonian=n.html`<div class="sv-smithsonian"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 990 158"><defs><style>.si-white{fill:#fff;}</style></defs><title>si-text-neg</title><path class="si-white" d="M67,44.45C63.37,31.73,58.2,18,40.91,18c-15.3,0-22.06,11.13-22.06,21.86,0,14.51,9.54,21.27,25.24,29.42,15.5,8,34.39,17.29,34.39,39.55,0,20.87-17.69,37.57-44.13,37.57a69.28,69.28,0,0,1-19.48-3,67.3,67.3,0,0,1-9.74-4.18C3.54,135.09,1,118-.23,108.46l5.76-1.4c3.18,12.13,12.12,32.2,32.6,32.2C53,139.26,62,129.92,62,115.41,62,100.7,51.05,93.75,36.14,85.8,23.42,79,3.34,69.1,3.34,46.64c0-19.08,15.31-35.38,41-35.38,9.14,0,17.49,2.18,25,4.57.8,7.16,1.79,14.91,3.38,27.43Z"/><path class="si-white" d="M200.32,143.44v-5.17c11.73-1.19,13.91-2,13.91-16.1V89c0-14.12-5-23.06-17.49-23.06-7.15,0-14.71,4-22.26,10.33a46.33,46.33,0,0,1,.6,8.35v38.76c0,12.52,1.79,13.72,12.72,14.91v5.17H145.26v-5.17c12.33-1.19,14.12-2.19,14.12-15.31V88.78c0-14.71-5.17-22.86-17.3-22.86-8,0-15.7,5.37-21.66,10.33V123c0,12.92,1.59,14.12,11.33,15.31v5.17H89.81v-5.17c13.12-1.19,14.9-2.39,14.9-15.31V81.82c0-12.72-.59-13.71-12.12-15.5V61.74c8.75-1.59,18.88-4.17,27.63-8.14V69.7c4.17-2.79,8.55-6.37,14.51-10.14,5.17-3.18,9.94-5.37,16.3-5.37,9.54,0,18.08,6,22.06,16.3a185.42,185.42,0,0,1,16.5-11.13c4.17-2.78,9.34-5.17,14.9-5.17,15.51,0,25.25,10.93,25.25,30.41V123c0,13.32,1.59,14.12,12.92,15.31v5.17Z"/><path class="si-white" d="M253.59,143.44v-5.17c12.52-1.19,13.91-2.39,13.91-15.9V81.42c0-12.32-.6-13.12-12.52-15.1V61.55a125.21,125.21,0,0,0,28.22-7.76v68.58c0,13.51,1.39,14.71,14.12,15.9v5.17ZM264.12,26.76a10.22,10.22,0,0,1,10.14-10.33c5.56,0,9.94,4.37,9.94,10.33A10.18,10.18,0,0,1,274.06,36.9,10.42,10.42,0,0,1,264.12,26.76Z"/><path class="si-white" d="M343.82,143.24a20.14,20.14,0,0,1-8.34,2.58c-12.53,0-19.48-7.95-19.48-23.65V64.33H302.28l-.79-2,5.36-5.76H316V42.07L328.92,29l2.78.4V56.58h22.46c1.79,2,1.19,6.36-1.19,7.75H331.7v51.08c0,16.1,6.56,19.08,11.53,19.08s9.54-2,12.32-3.38l1.79,5.17Z"/><path class="si-white" d="M420,143.44v-5.17c11.53-1.19,13.12-2.39,13.12-15.31V90c0-16.3-6.17-24.45-19.48-24.45-7.56,0-15.11,3.78-20.67,10.14V123c0,12.73,1,14.12,12.72,15.31v5.17H363.5v-5.17c11.92-1,13.71-2.19,13.71-15.31V28.15c0-12.52-.39-13.51-13.51-14.71V8.87a218.64,218.64,0,0,0,29.22-6.95V68.7c6.95-7.15,17.69-14.51,28.42-14.51,16.1,0,27.43,10.14,27.43,34V123c0,13.12,1.39,14.32,13.12,15.31v5.17Z"/><path class="si-white" d="M522.91,80c-3.78-11.73-10.74-19.68-20.48-19.68-7.55,0-12.92,6-12.92,13.72,0,8.94,8,13.51,16.9,17.29,14.91,6.16,25,13.32,25,27,0,18.09-16.89,27.43-32.79,27.43-10.14,0-19.28-3.77-22.86-6.76-1.39-2.78-3.18-16.29-3.18-23.45l5.17-1c3.57,13.11,12.52,24.64,24.45,24.64a13.86,13.86,0,0,0,14.11-13.91c0-8.75-5.77-13.52-15.7-18.09-11.93-5.56-24.85-12.12-24.85-27.43,0-13.91,11.93-25.64,30.21-25.64a46.23,46.23,0,0,1,17.69,3.38c1.59,4.57,3.78,16.3,4.38,21.27Z"/><path class="si-white" d="M633,98.52c0,32-23.45,47.3-43.13,47.3-27.23,0-43.53-21.86-43.53-43.92,0-32.8,25.44-47.71,43.53-47.71C614.54,54.19,633,73.87,633,98.52Zm-68.18-3c0,25,10.94,43.72,27.24,43.72,12.32,0,22.46-9.14,22.46-36.37,0-23.26-9.35-42.14-26.64-42.14C575.58,60.75,564.84,73.07,564.84,95.54Z"/><path class="si-white" d="M700.6,143.44v-5.17c11.73-1.19,13.12-2.78,13.12-16.5V88.58c0-13.72-4.77-22.66-18.09-22.66-8,0-15.7,5-21.66,10.14v46.71c0,13.51,1.19,14.31,12.92,15.5v5.17H643.75v-5.17c13.52-1.39,14.52-2.39,14.52-15.5V81.62c0-12.72-1.2-13.32-11.93-15.3V61.74C655.88,60,665.22,57.57,674,53.6V69.5c4-3,8.34-6,13.31-9.35,5.57-3.57,10.74-6,16.5-6,15.7,0,25.64,10.93,25.64,30.21v38.37c0,13.51,1,14.31,12.52,15.5v5.17Z"/><path class="si-white" d="M753.08,143.44v-5.17c12.52-1.19,13.91-2.39,13.91-15.9V81.42c0-12.32-.6-13.12-12.52-15.1V61.55a125.35,125.35,0,0,0,28.22-7.76v68.58c0,13.51,1.39,14.71,14.11,15.9v5.17ZM763.61,26.76a10.22,10.22,0,0,1,10.14-10.33c5.56,0,9.93,4.37,9.93,10.33A10.18,10.18,0,0,1,773.55,36.9,10.42,10.42,0,0,1,763.61,26.76Z"/><path class="si-white" d="M869.74,145.82a16.26,16.26,0,0,1-9.34-3.77,20.82,20.82,0,0,1-4.77-9c-8,5.37-17.49,12.72-23.45,12.72-14.12,0-23.85-11.72-23.85-24.25,0-9.74,5.16-15.9,16.1-19.67,11.92-4,26.43-9.35,30.8-12.92V85.4c0-14.31-6.75-22.46-16.69-22.46a11.23,11.23,0,0,0-8.95,4c-2.58,2.59-4.37,7-6,13.12a5.53,5.53,0,0,1-5.76,4.57c-3.58,0-8.75-4-8.75-8.54,0-3,2.59-5.17,6.36-8,5.57-4,18.49-11.73,29.82-13.92a25.93,25.93,0,0,1,16.3,5.37c6.95,5.76,8.94,13.91,8.94,24.25v37c0,8.94,3.58,11.92,7,11.92a15.11,15.11,0,0,0,7.15-2.18l2,5.17ZM855.23,95.73c-4.17,2.19-13.71,6.36-17.88,8.35-7.76,3.58-12.13,7.36-12.13,14.51,0,10.34,7.95,15.31,14.11,15.31,5.17-.2,12.13-3.58,15.9-7.16Z"/><path class="si-white" d="M948.66,143.44v-5.17c11.72-1.19,13.12-2.78,13.12-16.5V88.58c0-13.72-4.77-22.66-18.09-22.66-8,0-15.71,5-21.67,10.14v46.71c0,13.51,1.2,14.31,12.92,15.5v5.17H891.81v-5.17c13.52-1.39,14.51-2.39,14.51-15.5V81.62c0-12.72-1.19-13.32-11.92-15.3V61.74C903.93,60,913.28,57.57,922,53.6V69.5c4-3,8.35-6,13.32-9.35,5.56-3.57,10.73-6,16.5-6,15.7,0,25.64,10.93,25.64,30.21v38.37c0,13.51,1,14.31,12.52,15.5v5.17Z"/></svg></div>`,o=r=i([n.customElement("sv-logo")],o),t.default=o},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(69),n=s(39),o=s(13),a=s(38),l=s(24),c=s(263);let h=class extends l.default{constructor(){super(...arguments),this.documentProps=new i.default("value",this.onUpdate,this),this.shareButtonSelected=!1}get fullscreen(){return this.system.getMainComponent(n.default)}get toolProvider(){return this.system.getMainComponent(a.default)}get analytics(){return this.system.getMainComponent(o.default)}firstConnected(){super.firstConnected(),this.classList.add("sv-main-menu")}connected(){super.connected(),this.fullscreen.outs.fullscreenActive.on("value",this.onUpdate,this),this.toolProvider.ins.visible.on("value",this.onUpdate,this)}disconnected(){this.toolProvider.ins.visible.off("value",this.onUpdate,this),this.fullscreen.outs.fullscreenActive.off("value",this.onUpdate,this),super.disconnected()}render(){const e=this.activeDocument;if(!e)return l.html``;const t=e.setup,s=t.reader.ins.enabled.value,r=t.tours.outs.count.value>0,i=t.tours.ins.enabled.value,n=t.viewer.ins.annotationsVisible.value&&!i,o=this.fullscreen,a=o.outs.fullscreenAvailable.value,c=o.outs.fullscreenActive.value,h=t.interface.ins.tools.value,u=this.toolProvider.ins.visible.value&&!i;return l.html`${r?l.html`<ff-button icon="globe" title="Interactive Tours"
            ?selected=${i} @click=${this.onToggleTours}></ff-button>`:null}
        <ff-button icon="article" title="Read more..."
            ?selected=${s} ?disabled=${i} @click=${this.onToggleReader}></ff-button>
        ${l.html`<ff-button icon="comment" title="Show/Hide Annotations"
            ?selected=${n} ?disabled=${i} @click=${this.onToggleAnnotations}></ff-button>`}
        <ff-button icon="share" title="Share Experience"
            ?selected=${this.shareButtonSelected} @click=${this.onToggleShare}></ff-button>    
        ${a?l.html`<ff-button icon="expand" title="Fullscreen"
            ?selected=${c} @click=${this.onToggleFullscreen}></ff-button>`:null}
        ${h?l.html`<ff-button icon="tools" title="Tools and Settings"
            ?selected=${u} ?disabled=${i} @click=${this.onToggleTools}></ff-button>`:null}`}onToggleReader(){const e=this.activeDocument.setup.reader.ins;e.enabled.setValue(!e.enabled.value)}onToggleTours(){const e=this.activeDocument.setup.tours.ins,t=this.activeDocument.setup.reader.ins;e.enabled.value?e.enabled.setValue(!1):(t.enabled.value&&t.enabled.setValue(!1),e.enabled.setValue(!0),e.tourIndex.setValue(-1))}onToggleAnnotations(){const e=this.activeDocument.setup.tours.ins,t=this.toolProvider.ins,s=this.activeDocument.setup.viewer.ins;e.enabled.value||(t.visible.value&&t.visible.setValue(!1),s.annotationsVisible.setValue(!s.annotationsVisible.value))}onToggleShare(){this.shareButtonSelected||(this.shareButtonSelected=!0,this.requestUpdate(),c.default.show(this).then(()=>{this.shareButtonSelected=!1,this.requestUpdate()}),this.analytics.sendProperty("Menu.Share"))}onToggleFullscreen(){this.fullscreen.toggle(),this.analytics.sendProperty("Menu.Fullscreen")}onToggleTools(){const e=this.activeDocument.setup.tours.ins,t=this.toolProvider.ins,s=this.activeDocument.setup.viewer.ins;e.enabled.value||(s.annotationsVisible.value&&s.annotationsVisible.setValue(!1),t.visible.setValue(!t.visible.value))}onActiveDocument(e,t){if(e&&this.documentProps.off(),t){const e=t.setup;this.documentProps.on(e.interface.ins.tools,e.reader.ins.enabled,e.tours.ins.enabled,e.tours.outs.count,e.viewer.ins.annotationsVisible,this.toolProvider.ins.visible)}this.requestUpdate()}};h=r([l.customElement("sv-main-menu")],h),t.default=h},function(e,t,s){"use strict";var r,i=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const n=s(264);s(7),s(265);let o=r=class extends n.default{constructor(){super(),this.position="center",this.modal=!0,this.url=window.location.href}static show(e){const t=new r;return e.appendChild(t),new Promise((e,s)=>{t.on("close",()=>e())})}close(){this.dispatchEvent(new CustomEvent("close")),this.remove()}firstConnected(){super.firstConnected(),this.classList.add("sv-share-menu")}render(){const e=encodeURIComponent(this.url),t=encodeURI("Smithsonian Voyager"),s=`http://twitter.com/share?text=${t}&url=${e}`,r=`https://www.facebook.com/sharer/sharer.php?u=${e}`,i=`https://www.linkedin.com/shareArticle?url=${e}&mini=true&title=${t}`,o=`<iframe name="Smithsonian Voyager" src="${e}" width="800" height="450" allowfullscreen="true"></iframe>`,a=`mailto:?subject=${t}&body=${e}`;return n.html`
        <div class="ff-flex-row">
            <div class="ff-flex-spacer ff-title">Share Experience</div>
            <ff-button icon="close" transparent class="ff-close-button" title="Close" @click=${this.close}></ff-button>
        </div>
        <div class="ff-flex-row sv-share-buttons">
            <a href=${s} target="_blank" rel="noopener noreferrer"><ff-button class="sv-share-button-twitter" icon="twitter" title="Twitter"></ff-button></a>
            <a href=${r} target="_blank" rel="noopener noreferrer"><ff-button class="sv-share-button-facebook" icon="facebook" title="Facebook"></ff-button></a>
            <a href=${i} target="_blank" rel="noopener noreferrer"><ff-button class="sv-share-button-linkedin" icon="linkedin" title="LinkedIn"></ff-button></a>
            <a href=${a} target="_blank"><ff-button class="sv-share-button-email" icon="email" title="Email"></ff-button></a>
        </div>
        <div class="ff-title">Embed Link</div>
        <div class="ff-flex-row sv-embed-link">
            <ff-text-edit text=${o}></ff-text-edit>
            <ff-button icon="copy" title="Copy to Clipboard" @click=${this.onClickCopy}></ff-button>
        </div>
        `}onClickCopy(){this.getElementsByTagName("ff-text-edit").item(0).select(),document.execCommand("copy")}};o=r=i([n.customElement("sv-share-menu")],o),t.default=o},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(2);t.customElement=i.customElement,t.property=i.property,t.html=i.html;let n=class extends i.default{constructor(){super(),this.anchor=null,this.portal=null,this.position=void 0,this.align=void 0,this.justify=void 0,this.positionX=0,this.positionY=0,this.offsetX=0,this.offsetY=0,this.keepVisible=!1,this.modal=!1,this._modalPlane=null,this.onResize=this.onResize.bind(this),this.onCaptureEvent=this.onCaptureEvent.bind(this),this.onEatEvent=this.onEatEvent.bind(this)}close(){this.dispatchEvent(new CustomEvent("close"))}connected(){if(this.calculatePosition(),window.addEventListener("resize",this.onResize),this.modal){const e=this._modalPlane=this.createElement("div");e.classList.add("ff-modal-plane"),e.addEventListener("mousedown",this.onEatEvent),e.addEventListener("contextmenu",this.onEatEvent),e.addEventListener("pointerdown",this.onEatEvent),this.parentElement.appendChild(e),setTimeout(()=>e.classList.add("ff-transition"))}else document.addEventListener("mousedown",this.onCaptureEvent,{capture:!0,passive:!0})}disconnected(){window.removeEventListener("resize",this.onResize),this._modalPlane?(this._modalPlane.remove(),this._modalPlane=null):document.removeEventListener("mousedown",this.onCaptureEvent)}firstConnected(){super.firstConnected(),this.setStyle({position:"fixed",zIndex:"1000"}),this.classList.add("ff-popup")}updated(){this.isConnected&&this.calculatePosition()}calculatePosition(){let e,t;const s=this.getBoundingClientRect();let r;if(t=this.portal?this.portal.getBoundingClientRect():{left:0,top:0,right:window.innerWidth,bottom:window.innerHeight,width:window.innerWidth,height:window.innerHeight},"center"===this.position)r=this.center(s,t);else if("anchor"===this.position){const i=this.anchor||this.parentElement;i&&(e=i.getBoundingClientRect(),r=this.positionToAnchor(s,e,t))}else r={x:this.positionX,y:this.positionY};this.keepVisible&&"center"!==this.position&&(r=this.keepElementVisible(r,s,t)),this.style.left=Math.round(r.x)+"px",this.style.top=Math.round(r.y)+"px"}center(e,t){return{x:Math.round(.5*(t.width-e.width)),y:Math.round(.5*(t.height-e.height))}}positionToAnchor(e,t,s){const r=this.align,i=this.justify,n=this.offsetX,o=this.offsetY,a={x:0,y:0};switch(r){case"start":a.x="start"!==i&&"end"!==i?t.left-e.width-n:t.left;break;case"end":a.x="start"!==i&&"end"!==i?t.right+n:t.right-e.width;break;case"fixed":a.x=this.positionX;break;default:a.x=t.left+.5*(t.width-e.width)}switch(i){case"start":a.y=t.top-e.height-o;break;case"end":a.y=t.bottom+o;break;case"fixed":a.y=this.positionY;break;default:a.y=t.top+.5*(t.height-e.height)}return a.x+=this.offsetX,a.y+=this.offsetY,a}keepElementVisible(e,t,s){const r=this.offsetX,i=this.offsetY;return t.width>s.width?e.x=.5*(s.width-t.width):e.x<s.left+r?e.x=s.left+r:e.x+t.width+r>s.right&&(e.x=s.right-t.width-r),t.height>s.height?e.y=.5*(s.height-t.height):e.y<s.top+i?e.y=s.top+i:e.y+t.height+i>s.bottom&&(e.y=s.bottom-t.height-i),e}onResize(){this.calculatePosition()}onCaptureEvent(e){e.target instanceof Node&&this.contains(e.target)||this.close()}onEatEvent(e){console.log("Popup.onEatEvent"),e.stopPropagation(),e.preventDefault()}};r([i.property({attribute:!1})],n.prototype,"anchor",void 0),r([i.property({attribute:!1})],n.prototype,"portal",void 0),r([i.property({type:String})],n.prototype,"position",void 0),r([i.property({type:String})],n.prototype,"align",void 0),r([i.property({type:String})],n.prototype,"justify",void 0),r([i.property({type:Number})],n.prototype,"positionX",void 0),r([i.property({type:Number})],n.prototype,"positionY",void 0),r([i.property({type:Number})],n.prototype,"offsetX",void 0),r([i.property({type:Number})],n.prototype,"offsetY",void 0),r([i.property({type:Boolean})],n.prototype,"keepVisible",void 0),r([i.property({type:Boolean})],n.prototype,"modal",void 0),n=r([i.customElement("ff-popup")],n),t.default=n},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(2);let n=class extends i.default{constructor(){super(...arguments),this.name="",this.index=0,this.text="",this.placeholder="",this.align="left",this.initialValue=""}get textArea(){return this.getElementsByTagName("textarea").item(0)}select(){const e=this.textArea;e&&e.select()}focus(){const e=this.textArea;e&&e.focus()}blur(){const e=this.textArea;e&&e.blur()}hasFocus(){return this.textArea===document.activeElement}firstConnected(){this.classList.add("ff-control","ff-text-edit")}shouldUpdate(e){return!this.hasFocus()&&super.shouldUpdate(e)}render(){return i.html`<textarea
            .value=${this.text} placeholder=${this.placeholder}
            @keydown=${this.onKeyDown} @change=${this.onChange} @input=${this.onInput}
            @focus=${this.onFocus} @blur=${this.onBlur}
            style="text-align: ${this.align};"></textarea>`}onKeyDown(e){const t=e.target;"Escape"===e.key&&(this.revert(t),t.blur())}onChange(e){e.stopPropagation(),e.preventDefault(),this.text=e.target.value,this.dispatchChangeEvent(this.text,!1)}onInput(e){e.stopPropagation(),e.preventDefault(),this.text=e.target.value,this.dispatchChangeEvent(this.text,!0)}onFocus(e){this.initialValue=e.target.value}onBlur(e){this.commit(e.target),this.requestUpdate()}revert(e){e.value=this.initialValue,this.dispatchChangeEvent(e.value,!1)}commit(e){this.initialValue=e.value,this.dispatchChangeEvent(e.value,!1)}dispatchChangeEvent(e,t){this.dispatchEvent(new CustomEvent("change",{detail:{text:e,isEditing:t}}))}};r([i.property({type:String})],n.prototype,"name",void 0),r([i.property({type:Number})],n.prototype,"index",void 0),r([i.property({type:String})],n.prototype,"text",void 0),r([i.property({type:String})],n.prototype,"placeholder",void 0),r([i.property({type:String})],n.prototype,"align",void 0),n=r([i.customElement("ff-text-edit")],n),t.default=n},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(67),n=s(38);let o=class extends i.default{get toolProvider(){return this.system.getMainComponent(n.default)}firstConnected(){super.firstConnected(),this.classList.add("sv-bottom-bar-container","sv-transition","sv-tool-bar"),setTimeout(()=>this.classList.remove("sv-transition"),1)}connected(){super.connected(),this.toolProvider.on("active-component",this.onUpdate,this)}disconnected(){this.toolProvider.off("active-component",this.onUpdate,this),super.disconnected()}render(){const e=this.toolProvider.scopedComponents,t=this.toolProvider.activeComponent,s=e.map(e=>i.html`<ff-button class="sv-tool-button" transparent text=${e.text} icon=${e.icon}
                ?selected=${e===t} @click=${t=>this.onSelectTool(e)}></ff-button>`);return i.html`<div class="sv-blue-bar">${t?t.createView():null}
            <div class="sv-section">
                <ff-button class="sv-section-lead" transparent icon="close" title="Close Tools" @click=${this.onClose}></ff-button>
                <div class="sv-tool-buttons">${s}</div>
                <sv-tool-menu-view .system=${this.system}></sv-tool-menu-view>
            </div></div>`}onSelectTool(e){this.toolProvider.activeComponent=e}onClose(e){this.dispatchEvent(new CustomEvent("close")),e.stopPropagation()}};o=r([i.customElement("sv-tool-bar")],o),t.default=o},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0}),s(7);const i=s(24);let n=class extends i.default{firstConnected(){super.firstConnected(),this.classList.add("sv-bottom-bar-container","sv-tour-navigator","sv-transition"),setTimeout(()=>this.classList.remove("sv-transition"),1)}render(){const e=this.tours,t=e.activeTour;let s,r;if(e&&t){const t=e.outs.stepIndex.value+1,i=e.outs.stepCount.value;s=i>0?e.outs.stepTitle.value:e.outs.tourTitle.value,r=i>0?`Step ${t} of ${i}`:"No tour steps defined"}else s="No tour selected",r="---";return i.html`<div class="sv-blue-bar"><div class="sv-section">
            <ff-button class="sv-section-lead" transparent icon="close" title="Exit Tour" ?disabled=${!t} @click=${this.onClickExit}></ff-button>
            <div class="ff-ellipsis sv-content">
                <div class="ff-ellipsis sv-title">${s}</div>
                <div class="ff-ellipsis sv-text">${r}</div>
            </div>
            <ff-button class="sv-section-trail" transparent icon="bars" title="Show Tour Menu" @click=${this.onClickMenu}></ff-button>
            <ff-button class="sv-section-trail" transparent icon="triangle-left" title="Go Backward" ?disabled=${!t} @click=${this.onClickPrevious}></ff-button>
            <ff-button class="sv-section-trail" transparent icon="triangle-right" title="Go Forward" ?disabled=${!t} @click=${this.onClickNext}></ff-button>
        </div></div>`}onClickExit(){this.tours.ins.enabled.setValue(!1)}onClickMenu(){this.tours.ins.tourIndex.setValue(-1)}onClickPrevious(){this.tours.ins.previous.set()}onClickNext(){this.tours.ins.next.set()}onActiveDocument(e,t){e&&(this.tours.outs.tourIndex.off("value",this.onUpdate,this),this.tours.outs.stepIndex.off("value",this.onUpdate,this)),t&&(this.tours=t.setup.tours,this.tours.outs.tourIndex.on("value",this.onUpdate,this),this.tours.outs.stepIndex.on("value",this.onUpdate,this)),this.requestUpdate()}};n=r([i.customElement("sv-tour-navigator")],n),t.default=n},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0});const i=s(2);s(7);let n=class extends i.default{firstConnected(){super.firstConnected(),this.classList.add("sv-document-overlay","sv-article","sv-tour-menu")}renderEntry(e,t){return i.html`<div class="sv-entry" @click=${e=>this.onClickTour(e,t)}>
            <h1>${e.title}</h1>
            <p>${e.lead}</p>
        </div>`}render(){const e=this.tours;return 0===e.length?i.html`<div class="sv-entry">
                <h1>No tours available.</h1>
            </div>`:i.html`<div class="ff-scroll-y">
            ${e.map((e,t)=>this.renderEntry(e,t))}
        </div>`}onClickTour(e,t){e.stopPropagation(),this.dispatchEvent(new CustomEvent("select",{detail:{index:t}}))}};r([i.property({attribute:!1})],n.prototype,"tours",void 0),n=r([i.customElement("sv-tour-menu")],n),t.default=n},function(e,t,s){"use strict";var r=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};Object.defineProperty(t,"__esModule",{value:!0}),s(7);const i=s(24);let n=class extends i.default{get activeTags(){return this.viewer?this.viewer.ins.activeTags.value.split(",").map(e=>e.trim()).filter(e=>!!e):[]}get tagCloud(){return this.viewer?this.viewer.outs.tagCloud.value.split(",").map(e=>e.trim()).filter(e=>!!e):[]}firstConnected(){super.firstConnected(),this.classList.add("sv-bottom-bar-container","sv-tag-cloud","sv-transition"),setTimeout(()=>this.classList.remove("sv-transition"),1)}render(){const e=this.activeTags,t=this.tagCloud.map(t=>i.html`<ff-button class="sv-tag-button" transparent text=${t}
                ?selected=${e.indexOf(t)>=0}
                @click=${e=>this.onSelectTag(t)}></ff-button>`);return i.html`<div class="sv-blue-bar"><div class="sv-section">
                <ff-button class="sv-section-lead" transparent icon="close" title="Close Tag Menu" @click=${this.onClickClose}></ff-button>
                <div class="sv-tag-buttons">${t}</div>
        </div></div>`}onClickClose(){this.viewer.ins.annotationsVisible.setValue(!1)}onSelectTag(e){let t=this.activeTags;const s=this.viewer.ins.radioTags.value,r=t.indexOf(e);r>=0&&!s?t.splice(r,1):r<0&&(s?t=[e]:t.push(e)),this.viewer.ins.activeTags.setValue(t.join(", "))}onActiveDocument(e,t){e&&(this.viewer.ins.activeTags.off("value",this.onUpdate,this),this.viewer.outs.tagCloud.off("value",this.onUpdate,this)),t&&(this.viewer=t.setup.viewer,this.viewer.ins.activeTags.on("value",this.onUpdate,this),this.viewer.outs.tagCloud.on("value",this.onUpdate,this))}};n=r([i.customElement("sv-tag-cloud")],n),t.default=n},function(e,t,s){}]);